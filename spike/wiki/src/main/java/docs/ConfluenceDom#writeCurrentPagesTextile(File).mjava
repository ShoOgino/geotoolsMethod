    public void writeCurrentPagesTextile(File location) {
        processXML();
        fixAllHeaders();

        for (ConfluencePage tempPage : pageList.values()) {
            if (tempPage.isCurrent()) {
                tempPage.writeTextile(location);

                // test for duplicate titles
                /*
                 * if (titleList.contains(tempPage.getTitle())) { System.out.println("Duplicate: " +
                 * tempPage.getTitle()); } else { titleList.add(tempPage.getTitle()); }
                 */
            }
        }

        // test for duplicate titles
        /*
         * int count = 0; for (String pageTitle: titleList) { count++; System.out.println(count +
         * "--> " + pageTitle); }
         */

        writeToc(location);
    }

