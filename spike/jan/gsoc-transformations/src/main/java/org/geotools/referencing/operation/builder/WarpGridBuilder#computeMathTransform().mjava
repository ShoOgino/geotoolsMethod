	/*
	 * 
	 * (non-Javadoc)
	 * 
	 * @see org.geotools.referencing.operation.builder.MathTransformBuilder#computeMathTransform()
	 */
	protected MathTransform computeMathTransform() throws FactoryException {
		// warpPositions = getWarpPositions();

		/** Add the last parameter - warp positions * */
		gridParameters.setWarpPositions(getWarpPositions());

		/** Use provider and values to get proper transformation * */
		WarpGridTransform2D wt = (WarpGridTransform2D) (new WarpGridTransform2D.Provider())
				.createMathTransform(gridParameters.getWarpGridParameters());

		wt.setWorldtoGridTransform(this.worldToGrid);

		MathTransform trans = null;

		try {
			trans = ConcatenatedTransform.create(ConcatenatedTransform.create(
					this.worldToGrid, wt), this.worldToGrid.inverse());
		} catch (TransformException e) {
			throw new FactoryException(Errors
					.format(ErrorKeys.NONINVERTIBLE_TRANSFORM), e);
		}

		return wt;
	}

