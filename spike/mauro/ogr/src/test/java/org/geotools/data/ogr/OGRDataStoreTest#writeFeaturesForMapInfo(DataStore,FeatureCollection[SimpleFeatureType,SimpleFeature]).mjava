    private void writeFeaturesForMapInfo(DataStore s, FeatureCollection<SimpleFeatureType, SimpleFeature> fc) throws Exception {
        
    	// creates the feature writer using the schema of source feature collection.
    	SimpleFeatureType schema = buildFeatureTypeForMapInfo();
    	
        s.createSchema(schema);
        FeatureWriter fw = s.getFeatureWriter(s.getTypeNames()[0], Transaction.AUTO_COMMIT);
        //FeatureWriter fw = s.getFeatureWriterAppend(s.getTypeNames()[0], Transaction.AUTO_COMMIT);
        
        FeatureIterator it = fc.features();
        while (it.hasNext()) {
            SimpleFeature sf = (SimpleFeature) it.next();
            ((SimpleFeature) fw.next()).setAttributes(sf.getAttributes());
            fw.write();
        }
        it.close();
        fw.close();
    }

