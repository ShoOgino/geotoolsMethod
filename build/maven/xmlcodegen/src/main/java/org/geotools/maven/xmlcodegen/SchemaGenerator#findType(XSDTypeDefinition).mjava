    protected final AttributeType findType(XSDTypeDefinition xsdType) {
        Name name = name(xsdType);

        if (imports != null) {
            for (Schema imported : imports.values()) {
                if (imported.containsKey(name)) {
                    return imported.get(name);
                }
            }
        }

        throw new IllegalStateException("Could not find imported type: " + name);
    }

