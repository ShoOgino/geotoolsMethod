    @Before
    public void setup() {
        indexName = "an_index";
        typeName = "a_type";
        client = ESIntegTestCase.internalCluster().transportClient();
        client.prepareIndex(indexName, typeName, "1").setSource("{\"key\":\"value\"}").execute().actionGet();

        mockSearchResponse = mock(SearchResponse.class);
        mockSearchHits = mock(SearchHits.class);
        hits = new SearchHit[] { mock(SearchHit.class) };
        when(mockSearchResponse.getHits()).thenReturn(mockSearchHits);
        when(mockSearchHits.getHits()).thenReturn(hits);

        response = new TransportElasticResponse(mockSearchResponse);
    }

