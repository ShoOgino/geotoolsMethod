    @Test
    public void compoundFilter() throws CQLException, IOException {
        Filter filter = ECQL.toFilter("time > \"1970-01-01\" and INTERSECTS(\"geom\", LINESTRING(0 0,1 1))");
        RangeQueryBuilder expected1 = QueryBuilders.rangeQuery("time").gt("1970-01-01");
        List<Coordinate> coords = new ArrayList<>();
        coords.add(new Coordinate(0,0));
        coords.add(new Coordinate(1,1));
        LineStringBuilder shape = ShapeBuilders.newLineString(coords);
        GeoShapeQueryBuilder expected2 = QueryBuilders.geoShapeQuery("geom", shape).relation(ShapeRelation.INTERSECTS);
        BoolQueryBuilder expected = QueryBuilders.boolQuery().must(expected1).must(expected2);

        builder.encode(filter);
        assertTrue(builder.createFilterCapabilities().fullySupports(filter));
        assertTrue(builder.getQueryBuilder().toString().equals(expected.toString()));
    }

