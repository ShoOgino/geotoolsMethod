    @Test
    public void testAndWithBbox() throws IOException {
        And filter = ff.and(ff.id(ff.featureId("id1")), ff.bbox("geom", 0., 0., 1., 1., "EPSG:4326"));
        List<Coordinate> coords = new ArrayList<>();
        coords.add(new Coordinate(0,0));
        coords.add(new Coordinate(0,1));
        coords.add(new Coordinate(1,1));
        coords.add(new Coordinate(1,0));
        coords.add(new Coordinate(0,0));
        PolygonBuilder shape = ShapeBuilders.newPolygon(coords);
        BoolQueryBuilder expected = QueryBuilders.boolQuery()
                .must(QueryBuilders.idsQuery().addIds("id1"))
                .must(QueryBuilders.geoShapeQuery("geom", shape).relation(ShapeRelation.INTERSECTS));

        builder.visit(filter, null);
        assertTrue(builder.createFilterCapabilities().fullySupports(filter));
        assertTrue(builder.getQueryBuilder().toString().equals(expected.toString()));
    }

