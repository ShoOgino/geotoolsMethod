    @Test
    public void testFilterViewParam() {
        IdsQueryBuilder idsFilter = QueryBuilders.idsQuery().addIds("id");
        parameters.put("f", idsFilter.toString());
        byte[] encoded = Base64.encodeBase64(idsFilter.toString().getBytes());
        final Pattern expected = Pattern.compile(".*\"wrapper\".*\"query\".*\"" + new String(encoded) + ".*",
                Pattern.MULTILINE | Pattern.DOTALL);

        builder.addViewParams(query);
        assertTrue(expected.matcher(builder.getQueryBuilder().toString()).matches());
        assertTrue(builder.nativeQueryBuilder.toString().equals(QueryBuilders.matchAllQuery().toString()));
    }

