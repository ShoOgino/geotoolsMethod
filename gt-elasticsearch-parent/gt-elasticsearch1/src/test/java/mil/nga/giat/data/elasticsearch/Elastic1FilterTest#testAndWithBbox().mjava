    @Test
    public void testAndWithBbox() {
        And filter = ff.and(ff.id(ff.featureId("id1")), ff.bbox("geom", 0., 0., 1., 1., "EPSG:4326"));
        PolygonBuilder shape = ShapeBuilder.newPolygon().point(0, 0).point(0,1).point(1,1).point(1,0).point(0,0);
        AndFilterBuilder expected = FilterBuilders.andFilter(
                FilterBuilders.idsFilter().addIds("id1"), 
                FilterBuilders.geoShapeFilter("geom", shape, ShapeRelation.INTERSECTS));

        builder.visit(filter, null);
        assertTrue(builder.createFilterCapabilities().fullySupports(filter));
        assertTrue(builder.getFilterBuilder().toString().equals(expected.toString()));
    }

