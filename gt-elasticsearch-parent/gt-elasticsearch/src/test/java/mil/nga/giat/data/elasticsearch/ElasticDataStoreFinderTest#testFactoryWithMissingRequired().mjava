    @Test
    public void testFactoryWithMissingRequired() throws IOException {
        assertTrue(new ElasticDataStoreFactory().isAvailable());
        scanForPlugins();

        Map<String,Serializable> map = new HashMap<>();
        map.put(ElasticDataStoreFactory.HOSTNAME.key, "localhost");
        map.put(ElasticDataStoreFactory.HOSTPORT.key, String.valueOf(9300));
        map.put(ElasticDataStoreFactory.SEARCH_INDICES.key, "sample1,sample2");

        Iterator<DataStoreFactorySpi> ps = getAvailableDataSources();
        ElasticDataStoreFactory fac;
        while (ps.hasNext()) {
            fac = (ElasticDataStoreFactory) ps.next();
            assertTrue(!fac.canProcess(map));
        }

        assertNull(source);
    }

