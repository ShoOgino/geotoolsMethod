    /**
     * Create point geometry given geo_point or geo_shape definition. GeoPoint
     * can be defined by string, geohash, coordinate array or properties map.
     * GeoShape is defined by properties map.
     * @param obj GeoPoint or GeoShape definition
     * @return Geometry
     */
    public Geometry createGeometry(Object obj) {
        final Geometry geometry;
        if (obj instanceof String) {
            // geo_point by string
            final Matcher listMatcher = GEO_POINT_PATTERN.matcher((String) obj);
            if (listMatcher.matches()) {
                // coordinates
                final double y = Double.valueOf(listMatcher.group(1));
                final double x = Double.valueOf(listMatcher.group(2));
                geometry = geometryFactory.createPoint(new Coordinate(x,y));
            } else {
                // try geohash
                GeoPoint geoPoint = ElasticCompatLoader.getCompat(null).decodeGeohash((String) obj);
                if (geoPoint != null) {
                    final double lat = geoPoint.lat();
                    final double lon = geoPoint.lon();
                    geometry = geometryFactory.createPoint(new Coordinate(lon,lat));
                } else {
                    geometry = null;
                }
            }
        } else if (obj instanceof List && ((List<?>) obj).size()==2) {
            // geo_point by coordinate array
            final List<?> values = (List<?>) obj;
            if (Number.class.isAssignableFrom(values.get(0).getClass())) {
                final double x = ((Number) values.get(0)).doubleValue();
                final double y = ((Number) values.get(1)).doubleValue();
                geometry = geometryFactory.createPoint(new Coordinate(x,y));
            } else if (values.get(0) instanceof String) {
                final double x = Double.valueOf((String) values.get(0));
                final double y = Double.valueOf((String) values.get(1));
                geometry = geometryFactory.createPoint(new Coordinate(x,y));
            } else {
                geometry = null;
            }
        } else if (obj instanceof Map) {
            // geo_shape or geo_point by properties
            geometry = createGeometry((Map<String, Object>) obj);
        } else {
            geometry = null;
        }
        return geometry;
    }

