    public ElasticDataStore(String searchHost, Integer hostPort, 
            String indexName, String searchIndices, String clusterName) throws IOException {

        LOGGER.fine("Initializing data store " + searchHost + ":" + hostPort + "/" + indexName);

        this.indexName = indexName;

        if (searchIndices != null) {
            this.searchIndices = searchIndices;
        } else {
            this.searchIndices = indexName;
        }

        if (client == null) {
            managedClient = compat.createClient(searchHost, hostPort, clusterName);
        } else {
            managedClient = null;
        }

        final List<String> types = getClient().getTypes(indexName);
        if (!types.isEmpty()) {
            baseTypeNames = types.stream().map(name -> new NameImpl(name)).collect(Collectors.toList());
        } else {
            baseTypeNames = new ArrayList<>();
        }

        layerConfigurations = new ConcurrentHashMap<>();
        docTypes = new HashMap<>();
    }

