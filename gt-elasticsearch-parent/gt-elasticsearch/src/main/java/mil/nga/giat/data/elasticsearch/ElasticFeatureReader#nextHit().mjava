    private String nextHit() {
        final ElasticHit hit = searchHitIterator.next();
        final SimpleFeatureType type = getFeatureType();
        final Map<String, Object> source = hit.getSource();

        final Float score;
        final Float relativeScore;
        if (!Float.isNaN(hit.getScore()) && maxScore>0) {
            score = hit.getScore();
            relativeScore = score / maxScore;
        } else {
            score = null;
            relativeScore = null;
        }

        for (final AttributeDescriptor descriptor : type.getAttributeDescriptors()) {
            final String name = descriptor.getType().getName().getLocalPart();
            final String sourceName = (String) descriptor.getUserData().get(FULL_NAME);

            List<Object> values = hit.field(sourceName);
            if (values == null && source != null) {
                // read field from source
                values = parserUtil.readField(source, sourceName);
            }

            if (values == null && name.equals("_id")) {
                builder.set(name, hit.getId());
            } else if (values == null && name.equals("_index")) {
                builder.set(name, hit.getIndex());
            } else if (values == null && name.equals("_type")) {
                builder.set(name, hit.getType());
            } else if (values == null && name.equals("_score")) {
                builder.set(name, score);
            } else if (values == null && name.equals("_relative_score")) {
                builder.set(name, relativeScore);
            } else if (values == null) {
                // skip missing attribute
            } else if (Geometry.class.isAssignableFrom(descriptor.getType().getBinding())) {
                if (sourceName.endsWith(".coordinates") && values instanceof List) {
                    builder.set(name, parserUtil.createGeometry(values));                    
                } else {
                    builder.set(name, parserUtil.createGeometry(values.get(0)));
                }
            } else if (Date.class.isAssignableFrom(descriptor.getType().getBinding())) {
                Object dataVal = values.get(0);
                if (dataVal instanceof Double) {
                    builder.set(name, new Date(Math.round((Double) dataVal)));
                } else if (dataVal instanceof Integer) {
                    builder.set(name, new Date((Integer) dataVal));
                } else if (dataVal instanceof Long) {
                    builder.set(name, new Date((long) dataVal));
                } else {
                    final String format = (String) descriptor.getUserData().get(DATE_FORMAT);
                    Date date = ElasticCompatLoader.getCompat(null).parseDateTime((String) dataVal, format);
                    builder.set(name, date);
                }
            } else if (values.size() == 1) {
                builder.set(name, values.get(0));
            } else if (String.class.isAssignableFrom(descriptor.getType().getBinding())) {
                final StringBuilder valueBuilder = new StringBuilder();
                for (final Object value : values) {
                    valueBuilder.append(valueBuilder.length()>0 ? ";" : "");
                    valueBuilder.append(value);
                }
                builder.set(name, valueBuilder.toString());
            } else if (!name.equals("_aggregation")) {
                builder.set(name, values);
            }
        }

        return state.getEntry().getTypeName() + "." + hit.getId();
    }

