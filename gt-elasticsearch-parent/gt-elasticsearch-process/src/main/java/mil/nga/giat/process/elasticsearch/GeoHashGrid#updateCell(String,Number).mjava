    protected boolean updateCell(String geohash, Number value) {
        final boolean valid;
        if (geohash != null && value != null) {
            final LatLong latLon = GeoHash.decodeHash(geohash);
            final double lat = latLon.getLat();
            final double lon = latLon.getLon();
            valid = isValid(lat,lon);
            if (valid) {
                final int row = grid.length-(int) Math.round((lat-envelope.getMinY())/cellHeight)-1;
                final int col = (int) Math.round((lon-envelope.getMinX())/cellWidth);
                grid[Math.min(row,grid.length-1)][Math.min(col,grid[0].length-1)] = value.floatValue();
            }
        } else {
            valid = false;
        }
        return valid;
    }

