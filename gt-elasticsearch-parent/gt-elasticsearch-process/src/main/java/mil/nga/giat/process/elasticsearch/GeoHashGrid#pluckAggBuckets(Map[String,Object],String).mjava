    protected List<Map<String,Object>> pluckAggBuckets(Map<String,Object> parentBucket, String aggKey) {
        if (!parentBucket.containsKey(aggKey)) {
          LOGGER.warning("Unable to pluck aggregation results, parent bucket does not contain required key:" + aggKey);
          throw new IllegalArgumentException();
        }
        Map<String,Object> aggResults = (Map<String,Object>) parentBucket.get(aggKey);
        if (!aggResults.containsKey(BUCKETS_KEY)) {
          LOGGER.warning("Unable to pluck buckets, aggregation results bucket does not contain required key:" + BUCKETS_KEY);
          throw new IllegalArgumentException();
        }
        return (List<Map<String,Object>>) aggResults.get(BUCKETS_KEY);
    }

