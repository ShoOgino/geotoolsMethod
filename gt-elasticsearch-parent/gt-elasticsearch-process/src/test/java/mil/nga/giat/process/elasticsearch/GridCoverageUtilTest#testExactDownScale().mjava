    @Test
    public void testExactDownScale() {
        float[][] grid = new float[][] {{1,1,2,2},{1,1,2,2},{3,3,4,4},{3,3,4,4}};
        final GridCoverageFactory coverageFactory = CoverageFactoryFinder.getGridCoverageFactory(GeoTools.getDefaultHints());
        final GridCoverage2D coverage = coverageFactory.create("geohashGridAgg", grid, new ReferencedEnvelope(0,1,0,1,null));
        GridCoverage2D scaled = GridCoverageUtil.scale(coverage, 2,2);
        final RenderedImage renderedImage = scaled.getRenderedImage();
        assertEquals(2, renderedImage.getWidth());
        assertEquals(2, renderedImage.getHeight());
        float[][] expected = new float[][] {{1,2},{3,4}};
        IntStream.range(0,2).forEach(i->IntStream.range(0, 2).forEach(j -> {
            float actual = scaled.evaluate(new GridCoordinates2D(j,i), new float[1])[0];
            assertEquals(expected[i][j], actual, 1e-10);
        }));
    }

