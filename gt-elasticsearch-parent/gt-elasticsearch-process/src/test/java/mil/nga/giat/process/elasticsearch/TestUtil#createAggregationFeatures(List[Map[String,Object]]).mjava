    public static SimpleFeatureCollection createAggregationFeatures(List<Map<String,Object>> data) {
        final SimpleFeatureTypeBuilder builder = new SimpleFeatureTypeBuilder();
        builder.setName( "testType" );
        builder.add("_aggregation", HashMap.class );
        builder.add("aString", String.class );
        final SimpleFeatureType featureType = builder.buildFeatureType();
        final DefaultFeatureCollection collection = new DefaultFeatureCollection();
        final SimpleFeatureBuilder featureBuilder = new SimpleFeatureBuilder(featureType);
        data.stream().forEach(item -> {
            item.keySet().stream().forEach(key -> {
                featureBuilder.set(key, item.get(key));
            });
            collection.add(featureBuilder.buildFeature(null));
        });
        return collection;
    }

