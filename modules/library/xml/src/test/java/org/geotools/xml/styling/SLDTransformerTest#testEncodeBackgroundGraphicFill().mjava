    @Test
    public void testEncodeBackgroundGraphicFill()
            throws IOException, SAXException, TransformerException, XpathException {
        StyleBuilder sb = new StyleBuilder();
        Style style = sb.createStyle(sb.createLineSymbolizer());
        Fill fill = sb.createFill();
        fill.setColor(null);
        fill.setOpacity(null);
        fill.setGraphicFill(sb.createGraphic(null, sb.createMark("square"), null));
        style.setBackground(fill);

        SLDTransformer st = new SLDTransformer();
        st.setExportDefaultValues(true);
        st.setIndentation(2);
        String styleXML = st.transform(style);

        Document doc = buildTestDocument(styleXML);
        assertXpathEvaluatesTo(
                "square",
                "//sld:UserStyle/sld:Background/sld:GraphicFill/sld:Graphic/sld:Mark/sld:WellKnownName",
                doc);
        assertXpathExists(
                "//sld:UserStyle/sld:Background/sld:GraphicFill/sld:Graphic/sld:Mark/sld:Fill",
                doc);
        assertXpathExists(
                "//sld:UserStyle/sld:Background/sld:GraphicFill/sld:Graphic/sld:Mark/sld:Stroke",
                doc);
    }

