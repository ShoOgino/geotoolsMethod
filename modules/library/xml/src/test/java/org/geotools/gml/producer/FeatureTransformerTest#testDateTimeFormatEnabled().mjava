    /**
     * Checks FeatureTransformer DateTime formatting handling with
     * 'org.geotools.dateTimeFormatHandling' system property on true.
     */
    @Test
    public void testDateTimeFormatEnabled() throws Exception {
        System.setProperty("org.geotools.dateTimeFormatHandling", "true");
        Hints.scanSystemProperties();
        TimeZone defaultTimeZone = TimeZone.getDefault();
        try {
            TimeZone.setDefault(TimeZone.getTimeZone("GMT"));
            SimpleFeatureType ft =
                    DataUtilities.createType("invalidChars", "the_geom:Point,dia:Date");
            Calendar cal = Calendar.getInstance(TimeZone.getTimeZone("GMT"));
            cal.clear();
            cal.set(1982, 11, 3);
            Date dateValue = cal.getTime();
            SimpleFeature feature =
                    SimpleFeatureBuilder.build(
                            ft,
                            new Object[] {new WKTReader().read("POINT(0 0)"), dateValue},
                            "123");
            SimpleFeatureCollection fc = DataUtilities.collection(feature);

            FeatureTransformer tx = new FeatureTransformer();
            tx.setIndentation(2);
            tx.getFeatureTypeNamespaces().declareNamespace(ft, "gt", "http://www.geotools.org");
            ByteArrayOutputStream bos = new ByteArrayOutputStream();
            tx.transform(fc, bos);
            String result = bos.toString();
            Document dom = XMLUnit.buildControlDocument(result);
            assertXpathEvaluatesTo("1", "count(//wfs:FeatureCollection)", dom);
            assertXpathEvaluatesTo("1982-12-03T00:00:00Z", "//gt:dia", dom);
        } finally {
            System.getProperties().remove("org.geotools.dateTimeFormatHandling");
            TimeZone.setDefault(defaultTimeZone);
        }
    }

