    /** SLD --> XML --> SLD */
    public void testSLDTransformer() throws Exception {
        // create an SLD
        StyledLayerDescriptor sld = sf.createStyledLayerDescriptor();
        StyledLayerDescriptor sld2;
        sld.setName("SLD Name");
        sld.setTitle("SLD Title");
        UserLayer layer = sf.createUserLayer();
        layer.setName("UserLayer Name");

        Style style = sf.createStyle();
        style.setName("Style Name");
        style.getDescription().setTitle("Style Title");
        Rule rule1 = sb.createRule(sb.createLineSymbolizer(new Color(0), 2));
        // note: symbolizers containing a fill will likely fail, as the SLD
        // transformation loses a little data (background colour?)
        FeatureTypeStyle fts1 = sf.createFeatureTypeStyle(new Rule[] {rule1});
        fts1.semanticTypeIdentifiers().add(SemanticType.valueOf("generic:geometry"));
        style.featureTypeStyles().add(fts1);
        layer.setUserStyles(new Style[] {style});
        sld.setStyledLayers(new UserLayer[] {layer});

        // convert it to XML
        SLDTransformer aTransformer = new SLDTransformer();
        String xml = aTransformer.transform(sld);

        // back to SLD
        InputStream is = new ByteArrayInputStream(xml.getBytes("UTF-8"));

        SLDParser stylereader = new SLDParser(sf, is);

        sld2 = stylereader.parseSLD();
        // UNCOMMENT FOR DEBUGGING
        //        assertEquals(SLD.rules(SLD.styles(sld)[0]).length,
        // SLD.rules(SLD.styles(sld2)[0]).length);
        //        for (int i = 0; i < SLD.rules(SLD.styles(sld)[0]).length; i++) {
        //            Rule aRule = SLD.rules(SLD.styles(sld)[0])[i];
        //            Rule bRule = SLD.rules(SLD.styles(sld2)[0])[i];
        //            System.out.println(i+":"+aRule);
        //        	Symbolizer[] symb1 = SLD.symbolizers(aRule);
        //        	Symbolizer[] symb2 = SLD.symbolizers(bRule);
        //        	for (int j = 0; j < symb1.length; j++) {
        //        		//symbolizers are equal
        //        		assertTrue(symb1[j].equals(symb2[j]));
        //        	}
        //        	//rules are equal
        //            assertTrue(aRule.equals(bRule));
        //        }
        //        //feature type styles are equal
        //        assertTrue(SLD.featureTypeStyles(sld)[0].equals(SLD.featureTypeStyles(sld2)[0]));
        //        //styles are equal
        //        assertTrue(SLD.styles(sld)[0].equals(SLD.styles(sld2)[0]));
        //        //layers are equal
        //        StyledLayer layer1 = sld.getStyledLayers()[0];
        //        StyledLayer layer2 = sld2.getStyledLayers()[0];
        //        boolean result = layer1.equals(layer2);
        //        assertTrue(result);

        // everything is equal
        assertEquals(sld2, sld);
    }

