    @Test
    public void testNestedNOTHighCompliance() throws Exception {
        FilterFactory2 ff2 = CommonFactoryFinder.getFilterFactory2(null);

        List<String> attrs = new ArrayList<>();
        attrs.add("gm_naam");
        attrs.add("gm_code");

        List<Filter> filters = new ArrayList<>();
        for (String attr : attrs) {
            Filter f = ff2.not(ff2.isNull(ff2.property(attr)));
            filters.add(f);
        }
        And and = ff2.and(filters);
        FilterTransformer transform = new FilterTransformer();
        transform.setIndentation(2);

        String xml = transform.transform(and);
        FilterCompliancePreProcessor compliancePreProcessor =
                new FilterCompliancePreProcessor(XMLHandlerHints.VALUE_FILTER_COMPLIANCE_HIGH);
        and.accept(compliancePreProcessor, null);

        Filter processed = compliancePreProcessor.getFilter();
        String xmlProcessed = transform.transform(processed);
        Assert.assertTrue(xmlProcessed.contains("Not"));
        Assert.assertTrue(xml.contains("Not"));
    }

