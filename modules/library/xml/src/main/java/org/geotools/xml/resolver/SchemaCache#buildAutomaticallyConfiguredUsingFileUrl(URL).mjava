    /**
     * If automatic configuration is enabled, recursively search parent directories of file url for
     * a GeoServer data directory or directory containing an existing cache. If found, use it to
     * create a cache in the "app-schema-cache" subdirectory with downloading enabled.
     *
     * @param url a URL for a file in a GeoServer data directory.
     * @return a cache in the "app-schema-cache" subdirectory or null if not found or automatic
     *     configuration disabled.
     */
    public static SchemaCache buildAutomaticallyConfiguredUsingFileUrl(URL url) {
        if (!automaticConfigurationEnabled) {
            return null;
        }
        // let's check if a specific cache location was provided
        SchemaCache provided = getProvidedSchemaCache();
        if (provided != null) {
            // a specific schema cache location was provided, let's use it
            return provided;
        }
        File file = URLs.urlToFile(url);
        while (true) {
            if (file == null) {
                LOGGER.warning(
                        "Automatic app-schema-cache directory build failed, "
                                + "Geoserver root folder or app-schema-cache folder not found");
                return null;
            }
            if (isSuitableDirectoryToContainCache(file)) {
                return new SchemaCache(
                        new File(file, CACHE_DIRECTORY_NAME), true, DEFAULT_KEEP_QUERY);
            }
            file = file.getParentFile();
        }
    }

