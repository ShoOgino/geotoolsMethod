        private void printXMLNSDecs(Map arg0) throws IOException {
            Schema[] imports = getSchemaOrdering();
            String s = "";
            Map schemaLocs = (Map) ((arg0 == null) ? null : arg0.get(SCHEMA_LOCATION_HINT));
            schemaLocs = (schemaLocs == null) ? new HashMap() : schemaLocs;

            for (Schema anImport : imports) {
                if (anImport != null) {
                    if (anImport == schema) {
                        writer.write(" xmlns=\"" + schema.getTargetNamespace() + "\"");

                        if ((schema.getURI() != null)
                                && !schema.getTargetNamespace().equals(schema.getURI())) {

                            String endResult = schema.getURI().toString();
                            endResult = endResult.replaceAll("&", "&amp;");
                            s = schema.getTargetNamespace() + " " + endResult;
                        }
                    } else {
                        writer.write(
                                " xmlns:"
                                        + anImport.getPrefix()
                                        + "=\""
                                        + anImport.getTargetNamespace()
                                        + "\"");
                    }

                    URI location = anImport.getURI();
                    boolean forced = false;

                    if (schemaLocs.containsKey(anImport.getTargetNamespace())) {
                        location = (URI) schemaLocs.get(anImport.getTargetNamespace());
                        forced = true;
                    }

                    if ((location != null) && location.isAbsolute()) {
                        if (anImport.includesURI(location) || forced) {
                            if ((location != null)
                                    && !location.equals(anImport.getTargetNamespace())) {
                                String endResult = location.toString();
                                endResult = endResult.replaceAll("&", "&amp;");
                                s += (" " + anImport.getTargetNamespace() + " " + endResult);
                            }
                        }
                    }
                }
            }

            s = s.trim();

            if (!"".equals(s)) {
                writer.write(" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"");
                writer.write(" xsi:schemaLocation=\"" + s + "\"");
            }
        }

