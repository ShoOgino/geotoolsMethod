    private static byte[] followRedirect(
            HttpURLConnection connection, int blockSize, int redirectionCount) {
        String redirect = connection.getHeaderField("Location");
        byte[] result = null;
        if (redirect == null) {
            LOGGER.warning("Tried to follow redirect but no url was provided in Location header");
        } else if (redirectionCount <= MAX_FOLLOW_REDIRECT) {
            redirectionCount++;
            try {
                URI redirectURL = new URI(redirect);
                LOGGER.info("Following redirect to " + redirect);
                result = download(redirectURL, blockSize, redirectionCount);
            } catch (URISyntaxException uri) {
                LOGGER.warning(
                        "Tried to follow redirect but invalid url was provided in Location header: "
                                + redirect);
            }
        } else {
            LOGGER.warning(
                    "Max number of follow redirect attempts ("
                            + MAX_FOLLOW_REDIRECT
                            + ") reached. Returning null");
        }
        return result;
    }

