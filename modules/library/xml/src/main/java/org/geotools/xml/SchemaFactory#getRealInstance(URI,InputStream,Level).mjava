    private synchronized Schema getRealInstance(URI targetNamespace2, InputStream is1, Level level)
            throws SAXException {
        URI targetNamespace = targetNamespace2;

        if ((targetNamespace == null) || (schemas.get(targetNamespace) == null)) {
            XSISAXHandler contentHandler = parseSchema(is1, level);

            if ((targetNamespace == null) || "".equals(targetNamespace.toString())) {
                targetNamespace = contentHandler.getSchema().getTargetNamespace();
            }

            Schema schema = contentHandler.getSchema();
            if (schemas.get(targetNamespace) != null) {
                schema = merge(schema, schemas.get(targetNamespace));
            }

            schemas.put(targetNamespace, schema);

        } else {
            Schema sh = schemas.get(targetNamespace);
            XSISAXHandler contentHandler = parseSchema(is1, level);

            sh = merge(sh, contentHandler.getSchema());
            schemas.put(targetNamespace, sh); // over-write
        }
        return schemas.get(targetNamespace);
    }

