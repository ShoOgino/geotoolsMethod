        public void visit(ColorMap colorMap) {
            // The type of the ColorMap is stored in an attribute "type" and may store
            // string-values: "ramp", "intervals" or "values".
            AttributesImpl atts = new AttributesImpl();
            String typeString;
            if (colorMap.getType() == ColorMap.TYPE_INTERVALS) typeString = "intervals";
            else if (colorMap.getType() == ColorMap.TYPE_VALUES) typeString = "values";
            else typeString = "ramp"; // Also the default in the parser
            if (!"ramp".equals(typeString)) {
                atts.addAttribute("", "type", "type", "", typeString);
            }
            final boolean extended = colorMap.getExtendedColors();
            if (extended) {
                atts.addAttribute("", "extended", "extended", "", "" + extended);
            }

            start("ColorMap", atts);
            ColorMapEntry[] mapEntries = colorMap.getColorMapEntries();
            for (ColorMapEntry mapEntry : mapEntries) {
                mapEntry.accept(this);
            }
            end("ColorMap");
        }

