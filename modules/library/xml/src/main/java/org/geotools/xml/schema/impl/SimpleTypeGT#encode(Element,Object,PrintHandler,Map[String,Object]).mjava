    /**
     * @see org.geotools.xml.schema.Type#encode(org.geotools.xml.schema.Element, java.lang.Object,
     *     org.geotools.xml.PrintHandler, java.util.Map)
     */
    public void encode(
            Element element, Object value, PrintHandler output, Map<String, Object> hints)
            throws IOException, OperationNotSupportedException {
        if (value == null) {
            return;
        }

        if (type == UNION) {
            for (SimpleType parent : parents) {
                // finds first that works
                // TODO check that 'equals' works here
                if (parent.equals(element.getType()) && parent.canEncode(element, value, hints)) {
                    parent.encode(element, value, output, hints);
                }

                return;
            }

            parents[0].encode(element, value, output, hints);

            return;
        }

        if (type == LIST) {
            List l = (List) value;
            Iterator i = l.iterator();
            String s = "";

            if (i.hasNext()) {
                Object t =
                        parents[0]
                                .toAttribute(
                                        new AttributeGT(
                                                null,
                                                null,
                                                namespace,
                                                parents[0],
                                                0,
                                                null,
                                                null,
                                                false),
                                        value,
                                        hints)
                                .getValue();
                s = t.toString();

                while (i.hasNext()) {
                    t =
                            parents[0]
                                    .toAttribute(
                                            new AttributeGT(
                                                    null,
                                                    null,
                                                    namespace,
                                                    parents[0],
                                                    0,
                                                    null,
                                                    null,
                                                    false),
                                            value,
                                            hints)
                                    .getValue();
                    s = s + " " + t.toString();
                }
            }

            parents[0].encode(element, s, output, hints);

            return;
        }

        parents[0].encode(element, value, output, hints);
    }

