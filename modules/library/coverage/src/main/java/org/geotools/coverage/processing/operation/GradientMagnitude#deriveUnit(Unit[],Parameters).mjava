    /**
     * Derives the unit of data for a band in the destination image.
     * This method compute {@code sample}/{@code axis} where:
     *
     * <ul>
     *   <li>{@code sample} is the sample unit in source image.</li>
     *   <li>{@code axis} is the coordinate reference system axis unit.</li>
     * </ul>
     */
    protected Unit deriveUnit(final Unit[] units, final Parameters parameters) {
        final CoordinateSystem cs = parameters.crs.getCoordinateSystem();
        if (!DEBUG && units.length==1 && units[0]!=null) {
            final Unit spatialUnit = cs.getAxis(0).getUnit();
            for (int i=Math.min(cs.getDimension(), 2); --i>=0;) {
                if (!spatialUnit.equals(cs.getAxis(i).getUnit())) {
                    return super.deriveUnit(units, parameters);
                }
            }
            try {
                return units[0].divide(spatialUnit);
            } catch (RuntimeException exception) {
                // Can't compute units... We will compute image data
                // anyway, but the result will have no know unit.
                // TODO: Catch a more specific exception.
            }
        }
        return super.deriveUnit(units, parameters);
    }

