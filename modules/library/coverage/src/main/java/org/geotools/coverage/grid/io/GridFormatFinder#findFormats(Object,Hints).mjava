    /**
     * Returns all the {@link Format}s that can read the supplied {@link Object} o.
     *
     * @param o is the object to search a {@link Format} that is able to read
     * @param hints the {@link Hints} to control the format search.
     * @return an unmodifiable {@link Set} comprising all the {@link Format} that can read the
     *     {@link Object} o.
     */
    public static synchronized Set<AbstractGridFormat> findFormats(Object o, Hints hints) {
        final Set<GridFormatFactorySpi> availableFormats = getAvailableFormats();
        final Set<AbstractGridFormat> formats = new HashSet<AbstractGridFormat>();
        final Iterator<GridFormatFactorySpi> it = availableFormats.iterator();
        while (it.hasNext()) {
            // get the factory
            final GridFormatFactorySpi spi = it.next();
            // create a format for it
            final AbstractGridFormat retVal = spi.createFormat();
            // check if we can accept it
            if (retVal instanceof AbstractGridFormat) {
                if (retVal.accepts(o, hints)) formats.add(retVal);
            }
        }

        return Collections.unmodifiableSet(formats);
    }

