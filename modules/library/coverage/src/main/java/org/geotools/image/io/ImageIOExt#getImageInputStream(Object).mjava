    private static ImageInputStream getImageInputStream(Object input) throws IOException {
        if (input instanceof ImageInputStream) {
            return (ImageInputStream) input;
        }
        ImageInputStream stream = ImageIO.createImageInputStream(input);
        if (stream == null) {
            throw new IOException("Can't create an ImageInputStream!");
        }
        return stream;
    }

