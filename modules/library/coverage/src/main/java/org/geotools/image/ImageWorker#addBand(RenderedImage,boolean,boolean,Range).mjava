    /**
     * Perform a BandMerge operation between the underlying image and the provided one.
     * 
     * @param image to merge with the underlying one.
     * @param before <code>true</code> if we want to use first the provided image, <code>false</code> otherwise.
     * @param addAlpha <code>true</code> if we want to set the last image as alpha, <code>false</code> otherwise.
     * 
     * @return this {@link ImageWorker}.
     * 
     */
    public final ImageWorker addBand(RenderedImage image, boolean before, boolean addAlpha, Range nodata2) {
        ParameterBlock pb = new ParameterBlock();
        if (before) {
            pb.setSource(image, 0);
            pb.setSource(this.image, 1);
        } else {
            pb.setSource(this.image, 0);
            pb.setSource(image, 1);
        }
        pb.set(new Range[] { nodata, nodata2 }, 0);
        if (isNoDataNeeded() || nodata2 != null) {
            if (background != null && background.length > 0) {
                double dest = background[0];
                pb.set(dest, 1);
           }
        }
        pb.set(roi, 3);
        pb.set(addAlpha, 4);
        this.image = JAI.create("BandMerge", pb, this.getRenderingHints());
        invalidateStatistics();

        return this;
    }

