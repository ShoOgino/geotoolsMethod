        /**
         * This method creates a new {@link GridGeometry2D} object based on that of the {@link
         * GridCoverage2D} defined by the index.
         */
        private static GridGeometry2D extractFinalGridGeometry(
                GridCoverage2D[] sources, int index) {
            // Select the GridGeometry of the first coverage
            GridGeometry2D gg = sources[index].getGridGeometry();
            MathTransform g2w = gg.getGridToCRS2D(PixelOrientation.UPPER_LEFT);
            // Initial Bounding box
            Envelope2D bbox = gg.getEnvelope2D();
            // Number of the sources to use
            int numSources = sources.length;
            // Cycle on all the GridCoverages in order to create the final Bounding box
            for (int i = 0; i < numSources; i++) {
                bbox.include(sources[i].getEnvelope2D());
            }

            // Creation of a final GridGeometry containing the final Bounding Box
            GridGeometry2D finalGG =
                    new GridGeometry2D(
                            PixelInCell.CELL_CORNER, g2w, bbox, GeoTools.getDefaultHints());
            return finalGG;
        }

