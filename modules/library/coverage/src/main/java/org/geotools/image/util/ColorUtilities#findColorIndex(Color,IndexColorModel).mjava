    /**
     * Looks for the specified color in the color model
     *
     * @param bgColor The color to be searched
     * @param icm The color model to be searched into
     * @return The index of the color in the color model, or -1 if not found
     */
    public static int findColorIndex(Color bgColor, IndexColorModel icm) {
        if (bgColor == null)
            throw new NullPointerException((Errors.format(ErrorKeys.NULL_ARGUMENT_$1, "bgColor")));
        if (icm == null)
            throw new NullPointerException((Errors.format(ErrorKeys.NULL_ARGUMENT_$1, "icm")));

        final int r = bgColor.getRed();
        final int g = bgColor.getGreen();
        final int b = bgColor.getBlue();
        final int a = bgColor.getAlpha();
        final int size = icm.getMapSize();

        for (int i = 0; i < size; i++) {
            if (r == icm.getRed(i)
                    && g == icm.getGreen(i)
                    && b == icm.getBlue(i)
                    && (a == icm.getAlpha(i) || !icm.hasAlpha())) return i;
        }
        return -1;
    }

