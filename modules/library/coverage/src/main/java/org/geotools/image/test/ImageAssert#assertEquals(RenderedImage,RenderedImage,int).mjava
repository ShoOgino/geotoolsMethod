    /** Checks the expected image and the actual image are equals from a human perception p.o.v */
    public static void assertEquals(
            RenderedImage expectedImage, RenderedImage actualImage, int threshold) {
        ImageComparator comparator =
                new ImageComparator(Mode.IgnoreAntialiasing, expectedImage, actualImage);
        if (comparator.getMismatchCount() > threshold) {
            if (INTERACTIVE) {
                CompareImageDialog.show(expectedImage, actualImage, false);
            }
            throw new AssertionError(
                    "Images are visibly different, found "
                            + comparator.getMismatchCount()
                            + " different pixels, against a threshold of "
                            + threshold
                            + "\nYou can add -Dorg.geotools.image.test.interactive=true to show a dialog comparing them (requires GUI support)");
        }
    }

