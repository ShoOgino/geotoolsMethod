    /**
     * Returns a point with the same number of dimensions than the specified coverage.
     * The number of dimensions must be {@link #zDimensions} or {@code zDimensions+1}.
     */
    private final DirectPosition reduce(DirectPosition coord, final Coverage coverage) {
        final CoordinateReferenceSystem targetCRS = coverage.getCoordinateReferenceSystem();
        final int dimension = targetCRS.getCoordinateSystem().getDimension();
        if (dimension == zDimension) {
            if (reducedPosition == null) {
                reducedPosition = new GeneralDirectPosition(zDimension);
            }
            for (int i=0; i<dimension; i++) {
                reducedPosition.ordinates[i] = coord.getOrdinate(i);
            }
            coord = reducedPosition;
        } else {
            assert equalsIgnoreMetadata(crs, targetCRS) : targetCRS;
        }
        return coord;
    }

