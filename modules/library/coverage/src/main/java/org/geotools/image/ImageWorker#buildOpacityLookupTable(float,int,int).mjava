    /**
     * Builds a lookup table that is the identity on all bands but the alpha one, where
     * the opacity is applied
     * @param opacity
     * @param bands
     * @param alphaBand
     * @return
     */
    LookupTableJAI buildOpacityLookupTable(float opacity, final int bands, int alphaBand) {
        byte[][] matrix = new byte[bands][256];
        for (int band = 0; band < matrix.length; band++) {
            if(band == alphaBand) {
                for (int i = 0; i < 256; i++) {
                    matrix[band][i] = (byte) Math.round(i * opacity);
                }
            } else {
                for (int i = 0; i < 256; i++) {
                    matrix[band][i] = (byte) i;
                }
            }
        }
        LookupTableJAI table = new LookupTableJAI(matrix);
        return table;
    }

