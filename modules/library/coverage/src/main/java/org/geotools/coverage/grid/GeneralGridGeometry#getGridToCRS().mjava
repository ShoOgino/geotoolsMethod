    /**
     * Returns the transform from grid coordinates to real world earth coordinates. The transform is
     * often an affine transform. The coordinate reference system of the real world coordinates is
     * given by {@link org.opengis.coverage.Coverage#getCoordinateReferenceSystem}.
     *
     * <p><strong>Note:</strong> OpenGIS requires that the transform maps <em>pixel centers</em> to
     * real world coordinates. This is different from some other systems that map pixel's upper left
     * corner.
     *
     * @return The transform (never {@code null}).
     * @throws InvalidGridGeometryException if this grid geometry has no transform (i.e. <code>
     *     {@linkplain #isDefined isDefined}({@linkplain #GRID_TO_CRS_BITMASK})</code> returned
     *     {@code false}).
     * @see GridGeometry2D#getGridToCRS2D()
     * @since 2.3
     */
    public MathTransform getGridToCRS() throws InvalidGridGeometryException {
        if (gridToCRS != null) {
            assert isDefined(GRID_TO_CRS_BITMASK);
            return gridToCRS;
        }
        assert !isDefined(GRID_TO_CRS_BITMASK);
        throw new InvalidGridGeometryException(ErrorKeys.UNSPECIFIED_TRANSFORM);
    }

