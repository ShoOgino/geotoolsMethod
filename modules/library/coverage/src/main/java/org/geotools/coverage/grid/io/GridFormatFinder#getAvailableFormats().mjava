	/**
	 * Finds all avalaible implementations of {@link GridFormatFactorySpi} which
	 * have registered using the services mechanism, and that have the
	 * appropriate libraries on the classpath.
	 *
	 * @return An unmodifiable {@link Set} of all discovered datastores which
	 *         have registered factories, and whose available method returns
	 *         true.
	 */
	public static synchronized Set<GridFormatFactorySpi> getAvailableFormats() {
		// get all GridFormatFactorySpi implementations
		scanForPlugins();
		final Iterator<GridFormatFactorySpi> it = getServiceRegistry().
			getServiceProviders(GridFormatFactorySpi.class, true);
		final Set<GridFormatFactorySpi> formats= new HashSet<GridFormatFactorySpi>();
		while (it.hasNext()) {
			final GridFormatFactorySpi spi = (GridFormatFactorySpi) it.next();
			if (spi.isAvailable())
				formats.add(spi);

		}
		return Collections.unmodifiableSet(formats);
	}

