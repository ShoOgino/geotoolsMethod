    private ROI mosaicROIs(Vector sources, ROI... roiArray) {
        if(roiArray == null) {
            return null;
        }
        
        // collect all ROIs
        List<ROI> rois = new ArrayList<>(Arrays.asList(roiArray));
        int numSources = sources.size();
        if(roiArray.length < numSources){
            for(int i = roiArray.length; i < numSources; i++){
                RenderedImage img = (RenderedImage) sources.get(i);
                ROI r = new ROIShape(new Rectangle(img.getMinX(), img.getMinY(), img.getWidth(), img.getHeight()));
                rois.add(r);
            }
        }
        
        // bail out for the simple case without creating new objects
        if(rois.size() == 1) {
            return rois.get(0);
        }
        
        // prepare the vector union, take aside a ROIGeometry if possible
        // as it can add both ROIShape and ROIGeometry
        List<ROI> rasterROIs = new ArrayList<>();
        List<ROI> vectorROIs = new ArrayList<>();
        ROI vectorReference = null;
        for (ROI roi : rois) {
            if(roi instanceof ROIShape || roi instanceof ROIGeometry) {
                if(vectorReference == null && roi instanceof ROIGeometry) {
                    vectorReference = (ROIGeometry) roi;
                } else {
                    vectorROIs.add(roi);
                }
            } else {
                rasterROIs.add(roi);
            }
        }
        if(vectorReference == null && vectorROIs.size() > 0) {
            vectorReference = vectorROIs.remove(0);
        }
        // accumulate the vector ROIs, if any
        for (ROI roi : vectorROIs) {
            vectorReference = vectorReference.add(roi);
        }
        
        // do we have raster ones?
        if(rasterROIs.size() == 0) {
            return vectorReference;
        } 
        
        // ok, rasterize the vector one if any and mosaic
        ParameterBlock pb = new ParameterBlock();
        if(vectorReference != null) {
            pb.addSource(vectorReference.getAsImage());
        }
        for (ROI rasterROI : rasterROIs) {
            pb.addSource(rasterROI.getAsImage());
        }
        pb.add(javax.media.jai.operator.MosaicDescriptor.MOSAIC_TYPE_OVERLAY);
        RenderedImage roiMosaic = JAI.create("Mosaic", pb, getRenderingHints());
        return new ROI(roiMosaic);
    }

