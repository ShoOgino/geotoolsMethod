    /**
     * Parses a linear unit for a <code>ProjectedCRS</code>.
     *
     * @todo complete the list of linear unit of measures and clean the exception
     */
    private void parseLinearUnit(
            final ProjectedCRS projectedCRS, GeoTiffIIOMetadataEncoder metadata) {

        // getting the linear unit
        final Unit<?> unit = CRSUtilities.getUnit(projectedCRS.getCoordinateSystem());
        if (unit != null && !SI.METRE.isCompatible(unit)) {
            throw new IllegalArgumentException(Errors.format(ErrorKeys.NON_LINEAR_UNIT_$1, unit));
        }
        @SuppressWarnings("unchecked")
        Unit<Length> linearUnit = (Unit<Length>) unit;
        if (SI.METRE.equals(linearUnit)) {
            metadata.addGeoShortParam(
                    GeoTiffPCSCodes.ProjLinearUnitsGeoKey, GeoTiffUoMCodes.Linear_Meter);
            metadata.addGeoDoubleParam(GeoTiffPCSCodes.ProjLinearUnitSizeGeoKey, 1.0);
        } else if (USCustomary.NAUTICAL_MILE.equals(linearUnit)) {
            metadata.addGeoShortParam(
                    GeoTiffPCSCodes.ProjLinearUnitsGeoKey,
                    GeoTiffUoMCodes.Linear_Mile_International_Nautical);
            metadata.addGeoDoubleParam(
                    GeoTiffPCSCodes.ProjLinearUnitSizeGeoKey,
                    linearUnit.getConverterTo(SI.METRE).convert(1));
        } else if (USCustomary.FOOT.equals(linearUnit)) {
            metadata.addGeoShortParam(
                    GeoTiffPCSCodes.ProjLinearUnitsGeoKey, GeoTiffUoMCodes.Linear_Foot);
            metadata.addGeoDoubleParam(
                    GeoTiffPCSCodes.ProjLinearUnitSizeGeoKey,
                    linearUnit.getConverterTo(SI.METRE).convert(1));
        } else if (USCustomary.YARD.equals(linearUnit)) {
            metadata.addGeoShortParam(
                    GeoTiffPCSCodes.ProjLinearUnitsGeoKey, GeoTiffUoMCodes.Linear_Yard_Sears); // ??
            metadata.addGeoDoubleParam(
                    GeoTiffPCSCodes.ProjLinearUnitSizeGeoKey,
                    linearUnit.getConverterTo(SI.METRE).convert(1));
        } else if (USCustomary.FOOT_SURVEY.equals(linearUnit)) {
            metadata.addGeoShortParam(
                    GeoTiffPCSCodes.ProjLinearUnitsGeoKey,
                    GeoTiffUoMCodes.Linear_Foot_US_Survey); // ??
            metadata.addGeoDoubleParam(
                    GeoTiffPCSCodes.ProjLinearUnitSizeGeoKey,
                    linearUnit.getConverterTo(SI.METRE).convert(1));
        }
    }

