    /**
     * Returns a sub-coordinate reference system for the specified dimension range. This method is
     * for internal use by {@link #resampleToCommonGeometry}.
     *
     * @param crs The coordinate reference system to decompose.
     * @param lower The first dimension to keep, inclusive.
     * @param upper The last dimension to keep, exclusive.
     * @return The sub-coordinate system, or {@code null} if {@code lower} is equals to {@code
     *     upper}.
     * @throws InvalidGridGeometryException if the CRS can't be separated.
     */
    private static CoordinateReferenceSystem getSubCRS(
            final CoordinateReferenceSystem crs, final int lower, final int upper)
            throws InvalidGridGeometryException {
        if (lower == upper) {
            return null;
        }
        final CoordinateReferenceSystem candidate = CRSUtilities.getSubCRS(crs, lower, upper);
        if (candidate == null) {
            throw new InvalidGridGeometryException("Unsupported CRS: " + crs.getName().getCode());
        }
        return candidate;
    }

