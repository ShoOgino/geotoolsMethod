    /**
     * Construct a new {@code ColorModelFactory}. This object will actually be used as a key in a
     * {@link Map}, so this is not really a {@code ColorModelFactory} but a kind of "{@code
     * ColorModelKey}" instead. However, since this constructor is private, user doesn't need to
     * know that.
     */
    private ColorModelFactory(
            final Category[] categories,
            final int type,
            final int visibleBand,
            final int numBands) {
        this.categories = categories;
        this.visibleBand = visibleBand;
        this.numBands = numBands;
        this.type = type;
        if (visibleBand < 0 || visibleBand >= numBands) {
            throw new IllegalArgumentException(
                    Errors.format(ErrorKeys.BAD_BAND_NUMBER_$1, visibleBand));
        }
    }

