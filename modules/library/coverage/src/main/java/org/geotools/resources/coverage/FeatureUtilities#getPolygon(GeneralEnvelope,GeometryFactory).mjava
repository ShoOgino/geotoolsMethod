	/**
	 * Convert the crop envelope into a polygon and the use the
	 * world-to-grid transform to get a ROI for the source coverage.
	 */
	public static Polygon getPolygon(final GeneralEnvelope env, final GeometryFactory gf) throws IllegalStateException, MismatchedDimensionException {
	    final Rectangle2D rect = env.toRectangle2D();
	    final Coordinate[] coord = new Coordinate[]{
	        new Coordinate(rect.getMinX(), rect.getMinY()),
	        new Coordinate(rect.getMinX(), rect.getMaxY()),
	        new Coordinate(rect.getMaxX(), rect.getMaxY()),
	        new Coordinate(rect.getMaxX(), rect.getMinY()),
	        new Coordinate(rect.getMinX(), rect.getMinY())};
	    final LinearRing ring = gf.createLinearRing(coord);
	    final Polygon modelSpaceROI = new Polygon(ring, null, gf);
	    // check that we have the same thing here
	    assert modelSpaceROI.getEnvelopeInternal().equals(new ReferencedEnvelope(rect, env.getCoordinateReferenceSystem()));
	    return modelSpaceROI;
	}

