    /**
     * Returns the two-dimensional part of this grid geometry CRS. If the {@linkplain
     * #getCoordinateReferenceSystem complete CRS} is two-dimensional, then this method returns the
     * same CRS. Otherwise it returns a CRS for ({@link #axisDimensionX}, {@link #axisDimensionY})
     * axis. Note that those axis are garanteed to appears in the same order than in the complete
     * CRS.
     *
     * @return The coordinate reference system (never {@code null}).
     * @throws InvalidGridGeometryException if this grid geometry has no CRS (i.e. <code>
     *     {@linkplain #isDefined isDefined}({@linkplain #CRS CRS})</code> returned {@code false}).
     * @see #getCoordinateReferenceSystem
     * @since 2.2
     */
    public CoordinateReferenceSystem getCoordinateReferenceSystem2D()
            throws InvalidGridGeometryException {
        if (crs2D != null) {
            assert isDefined(CRS_BITMASK);
            return crs2D;
        }
        assert !isDefined(CRS_BITMASK);
        throw new InvalidGridGeometryException(ErrorKeys.UNSPECIFIED_CRS);
    }

