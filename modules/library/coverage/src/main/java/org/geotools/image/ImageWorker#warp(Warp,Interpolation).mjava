    /**
     * Warps the underlying raster using the provided Warp object.
     */
    public ImageWorker warp(Warp warp,  Interpolation interp) {
        ParameterBlock pb = new ParameterBlock();
        pb.setSource(image, 0); // The source image.
        pb.set(warp, 0);
        pb.set(interp, 1);
        pb.set(roi, 3);
        pb.set(nodata, 4);
        pb.set(background, 2);
        if (isNoDataNeeded()) {
            if (background != null && background.length > 0) {
                // We must set the new NoData value
                setNoData(RangeFactory.create(background[0], background[0]));
            }
        }
        image = JAI.create("Warp", pb, getRenderingHints());
        // getting the new ROI property
        PropertyGenerator gen = getOperationDescriptor("Warp").getPropertyGenerators(RenderedRegistryMode.MODE_NAME)[0];
        Object prop = gen.getProperty("roi", image);
        if(prop != null && prop instanceof ROI){
            setROI((ROI) prop);
        }  else {
            setROI(null);
        }

        return this;
    }

