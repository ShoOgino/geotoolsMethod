    /**
     * Returns the math transform for the two specified dimensions of the specified transform.
     *
     * @param transform The transform.
     * @param mtFactory The factory to use for extracting the sub-transform.
     * @param sourceGG The grid geometry which is the source of the <strong>transform</strong>. This
     *     is {@code targetGG} in the {@link #reproject} method, because the later computes a
     *     transform from target to source grid geometry.
     * @return The {@link MathTransform2D} part of {@code transform}.
     * @throws FactoryException If {@code transform} is not separable.
     */
    private static MathTransform2D toMathTransform2D(
            final MathTransform transform,
            final MathTransformFactory mtFactory,
            final GridGeometry2D sourceGG)
            throws FactoryException {
        final DimensionFilter filter = new DimensionFilter(mtFactory);
        filter.addSourceDimension(sourceGG.axisDimensionX);
        filter.addSourceDimension(sourceGG.axisDimensionY);
        MathTransform candidate = filter.separate(transform);
        if (candidate instanceof MathTransform2D) {
            return (MathTransform2D) candidate;
        }
        filter.addTargetDimension(sourceGG.axisDimensionX);
        filter.addTargetDimension(sourceGG.axisDimensionY);
        candidate = filter.separate(transform);
        if (candidate instanceof MathTransform2D) {
            return (MathTransform2D) candidate;
        }
        throw new FactoryException(Errors.format(ErrorKeys.NO_TRANSFORM2D_AVAILABLE));
    }

