    /**
     * Returns the quantitative category for a single {@linkplain GridSampleDimension sample
     * dimension} in the target {@linkplain GridCoverage2D grid coverage}. This method is invoked
     * automatically by the {@link #deriveSampleDimension deriveSampleDimension} method for each
     * band in the target image. The default implementation creates a default category from the
     * target range of values returned by {@link #deriveRange deriveRange}.
     *
     * @param categories The quantitative categories from every sources. For unary operations like,
     *     this array has a length of 1. For binary operations like {@code "add"} and {@code
     *     "multiply"}, this array has a length of 2.
     * @param parameters Parameters, rendering hints and coordinate reference system to use.
     * @return The quantitative category to use in the destination image, or {@code null} if
     *     unknown.
     */
    protected Category deriveCategory(final Category[] categories, final Parameters parameters) {
        final NumberRange[] ranges = new NumberRange[categories.length];
        for (int i = 0; i < ranges.length; i++) {
            if (categories[i] == null) {
                continue;
            }
            ranges[i] = categories[i].getRange();
        }
        final NumberRange range = deriveRange(ranges, parameters);
        if (range != null) {
            final Category category = categories[PRIMARY_SOURCE_INDEX];
            return new Category(category.getName(), category.getColors(), range, true);
        }
        return null;
    }

