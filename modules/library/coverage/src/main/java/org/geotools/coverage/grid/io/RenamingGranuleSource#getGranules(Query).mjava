    @Override
    public SimpleFeatureCollection getGranules(Query q) throws IOException {
        Query renamed = renameQuery(q);
        SimpleFeatureCollection granules = delegate.getGranules(renamed);
        SimpleFeatureType targetSchema = this.schema;
        if (q.getPropertyNames() != Query.ALL_NAMES) {
            targetSchema = SimpleFeatureTypeBuilder.retype(schema, q.getPropertyNames());
        }
        return new ReTypingFeatureCollection(granules, targetSchema);
    }

