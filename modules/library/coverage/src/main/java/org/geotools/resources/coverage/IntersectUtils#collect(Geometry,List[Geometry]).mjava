    /**
     * Adds into the <TT>collector</TT> the Geometry <TT>g</TT>, or, if
     * <TT>g</TT> is a GeometryCollection, every geometry in it.
     *
     * @param g the Geometry (or GeometryCollection to unroll)
     * @param collector the Collection where the Geometries will be added into
     */
    private static void collect(Geometry g, List<Geometry> collector) {
        if(g instanceof GeometryCollection) {
            GeometryCollection gc = (GeometryCollection)g;
            for (int i = 0; i < gc.getNumGeometries(); i++) {
                Geometry loop = gc.getGeometryN(i);
                if(! loop.isEmpty())
                    collector.add(loop);
            }
        } else {
            if(! g.isEmpty())
                collector.add(g);
        }
    }

