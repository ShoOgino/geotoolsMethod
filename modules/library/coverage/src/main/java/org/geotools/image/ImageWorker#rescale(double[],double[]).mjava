    /** Apply a rescale operation on the underlying image. */
    public ImageWorker rescale(double[] scale, double[] offset) {
        ParameterBlock pb = new ParameterBlock();
        pb.setSource(image, 0); // The source image.
        pb.set(scale, 0); // The per-band constants to multiply by.
        pb.set(offset, 1); // The per-band offsets to be added.
        pb.set(roi, 2); // ROI
        pb.set(nodata, 3); // NoData range

        double destNodata = Double.NaN;
        if (isNoDataNeeded()) {
            if (background != null && background.length > 0) {
                destNodata = background[0];
            } else if (nodata != null) {
                // preserve nodata to avoid the destination nodata fall
                // in the range of valid values
                destNodata = nodata.getMin().doubleValue();
            }
        }

        if (!Double.isNaN(destNodata)) {
            pb.set(destNodata, 5);
        }
        image = JAI.create("Rescale", pb, getRenderingHints());
        if (!Double.isNaN(destNodata)) {
            setNoData(RangeFactory.create((byte) destNodata, (byte) destNodata));
        }
        return this;
    }

