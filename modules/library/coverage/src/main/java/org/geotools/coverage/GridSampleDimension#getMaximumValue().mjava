    /**
     * Returns the maximum value occurring in this sample dimension (inclusive). The default
     * implementation fetch this value from the categories supplied at construction time. If the
     * maximum value can't be computed, then this method returns {@link Double#POSITIVE_INFINITY}.
     *
     * @see #getRange
     */
    public double getMaximumValue() {
        if (categories != null && !categories.isEmpty()) {
            for (int i = categories.size(); --i >= 0; ) {
                Category cat = categories.get(i);
                if (!Category.NODATA.getName().equals(cat.getName())) {
                    // Exclude the value of the NODATA category
                    // which can be retrieved with getNoDataValues
                    final double value = cat.maximum;
                    if (!Double.isNaN(value)) {
                        return value;
                    }
                }
            }
        }
        return Double.POSITIVE_INFINITY;
    }

