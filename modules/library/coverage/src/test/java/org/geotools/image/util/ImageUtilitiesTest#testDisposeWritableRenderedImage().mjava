    @Test
    public void testDisposeWritableRenderedImage()
            throws NoSuchFieldException, SecurityException, IllegalArgumentException,
                    IllegalAccessException {
        BufferedImage bi = new BufferedImage(256, 256, BufferedImage.TYPE_BYTE_GRAY);
        WritableRenderedImageAdapter wria = new WritableRenderedImageAdapter(bi);
        ImageUtilities.disposeSinglePlanarImage(wria);
        // Without the fix, both fields would have been NOT null
        Class<? extends Object> theClass = wria.getClass();
        Field f = theClass.getSuperclass().getDeclaredField("theImage");
        f.setAccessible(true);
        Object image = f.get(wria);
        assertNull(image);
        f = theClass.getDeclaredField("theWritableImage");
        f.setAccessible(true);
        image = f.get(wria);
        assertNull(image);
    }

