    @Test
    public void testLookupROI() {
        // Getting input Palette image
        ImageWorker w = new ImageWorker(chlImage);
        // Forcing component colormodel
        w.forceComponentColorModel();
        // Applying a lookup table
        byte[] data = new byte[256];
        // Setting all the values to 50
        Arrays.fill(data, (byte) 50);
        LookupTable table = LookupTableFactory.create(data);
        // Add a ROI
        ROI roi =
                new ROIShape(
                        new Rectangle(
                                chlImage.getMinX(),
                                chlImage.getMinY(),
                                chlImage.getWidth() / 2,
                                chlImage.getHeight() / 2));
        w.setROI(roi);
        // Setting Background to 0
        w.setBackground(new double[] {0});
        // Appliyng lookup
        w.lookup(table);
        // Removing NoData and ROI and calculate the statistics on the whole image
        w.setNoData(null);
        w.setROI(null);
        // Calculating the minimum and maximum
        double min = w.getMinimums()[0];
        double max = w.getMaximums()[0];

        // Ensuring minimum is 0 and maximum 50
        assertEquals(min, 0, 1E-7);
        assertEquals(max, 50, 1E-7);

        assertNoData(w.getRenderedImage(), null);
    }

