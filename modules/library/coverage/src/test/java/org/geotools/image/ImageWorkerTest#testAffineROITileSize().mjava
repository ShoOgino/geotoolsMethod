    @Test
    public void testAffineROITileSize() {
        assertTrue("Assertions should be enabled.", ImageWorker.class.desiredAssertionStatus());
        ImageWorker worker = new ImageWorker(gray);
        ROIShape roiShape = new ROIShape(new Rectangle(0, 0, gray.getWidth(), gray.getHeight()));
        ROI roi = new ROI(roiShape.getAsImage());
        worker.setROI(roi);
        RenderedImage image = worker.getRenderedImage();
        assertNotEquals(java.awt.Image.UndefinedProperty, image.getProperty("ROI"));

        ImageWorker iw = new ImageWorker(image);
        iw.affine(
                AffineTransform.getScaleInstance(0.5, 0.5),
                Interpolation.getInstance(Interpolation.INTERP_NEAREST),
                null);
        RenderedImage scaled = iw.getRenderedImage();

        assertNotEquals(java.awt.Image.UndefinedProperty, scaled.getProperty("ROI"));
        ROI scaledROI = (ROI) scaled.getProperty("ROI");
        assertEquals(ROI.class, scaledROI.getClass());
        assertEquals(scaled.getTileWidth(), scaledROI.getAsImage().getTileWidth());
        assertEquals(scaled.getTileHeight(), scaledROI.getAsImage().getTileHeight());
    }

