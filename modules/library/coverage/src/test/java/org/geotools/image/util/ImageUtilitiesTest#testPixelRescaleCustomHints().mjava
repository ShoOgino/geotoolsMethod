    @Test
    public void testPixelRescaleCustomHints() throws Exception {
        BufferedImage bi = new BufferedImage(100, 100, BufferedImage.TYPE_BYTE_GRAY);
        bi.getRaster().getDataBuffer().setElemDouble(0, 0, 10);
        ImageLayout layout = new ImageLayout(bi);
        layout.setTileHeight(50);
        layout.setTileWidth(50);
        RenderedImage result =
                ImageUtilities.applyRescaling(
                        new Double[] {10d},
                        new Double[] {1d},
                        bi,
                        new Hints(JAI.KEY_IMAGE_LAYOUT, layout));
        assertEquals(DataBuffer.TYPE_DOUBLE, result.getSampleModel().getDataType());
        assertEquals(50, result.getTileWidth());
        assertEquals(50, result.getTileHeight());
        assertThat(result.getColorModel(), CoreMatchers.instanceOf(ComponentColorModel.class));
        double[] pixel = new double[1];
        result.getData().getPixel(0, 0, pixel);
        assertEquals(101, pixel[0], 0d);
    }

