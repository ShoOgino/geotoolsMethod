    private GridCoverage2D getCoverageWithROI(GridCoverage2D coverage, ROI roi) {
        Map<String, Object> properties =
                new HashMap<>(
                        (coverage.getProperties() != null)
                                ? coverage.getProperties()
                                : Collections.emptyMap());
        CoverageUtilities.setROIProperty(properties, roi);
        GridCoverage2D coverageWithRoi =
                GRID_COVERAGE_FACTORY.create(
                        coverage.getName(),
                        coverage.getRenderedImage(),
                        coverage.getEnvelope(),
                        coverage.getSampleDimensions(),
                        null,
                        properties);
        return coverageWithRoi;
    }

