    @Test
    public void testPaletted() throws IOException {
        ParameterValueGroup param = processor.getOperation("Mosaic").getParameters();

        // Creation of a List of the input Sources
        List<GridCoverage2D> sources = new ArrayList<GridCoverage2D>(2);
        GridCoverage2D world = readWorldPaletted();
        sources.add(world);
        ReferencedEnvelope reShifted =
                new ReferencedEnvelope(-360, -180, -90, 90, DefaultGeographicCRS.WGS84);
        GridCoverage2D shifted =
                new GridCoverageFactory()
                        .create(world.getName(), world.getRenderedImage(), reShifted);
        sources.add(shifted);
        param.parameter("Sources").setValue(sources);
        // Mosaic simulating a hints set that contains index color model expansion
        Hints hints = new Hints(JAI.KEY_REPLACE_INDEX_COLOR_MODEL, Boolean.TRUE);
        GridCoverage2D mosaic = (GridCoverage2D) processor.doOperation(param, hints);
        assertNotNull(mosaic);
        assertEquals(3, mosaic.getRenderedImage().getSampleModel().getNumBands());
    }

