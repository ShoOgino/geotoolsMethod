    /**
     * Rotates the given coverage by the given angle. This method replaces the coverage CRS by a
     * derived one containing the rotated axes.
     *
     * @param coverage The coverage to rotate.
     * @param angle The rotation angle, in degrees.
     * @return The rotated coverage.
     */
    protected static GridCoverage2D rotate(final GridCoverage2D coverage, final double angle) {
        final AffineTransform atr = AffineTransform.getRotateInstance(Math.toRadians(angle));
        atr.concatenate(getAffineTransform(coverage));
        final MathTransform tr = ProjectiveTransform.create(atr);
        CoordinateReferenceSystem crs = coverage.getCoordinateReferenceSystem();
        crs = new DefaultDerivedCRS("Rotation " + angle + "Â°", crs, tr, crs.getCoordinateSystem());
        return project(coverage, crs, null, null);
    }

