    public void assertWarpROI() throws IOException, TransformException {
        ImageWorker worker = new ImageWorker(gray);
        // ROI covers just 1/4th
        ROIShape roiShape = new ROIShape(
                new Rectangle(0, 0, gray.getWidth() / 2, gray.getHeight() / 2));
        ROI roi = new ROI(roiShape.getAsImage());
        worker.setROI(roi);

        Warp warp = new WarpBuilder(0.3).buildWarp(
                new AffineTransform2D(AffineTransform.getScaleInstance(2, 2)),
                new Rectangle(gray.getWidth(), gray.getHeight()));
        worker.warp(warp, Interpolation.getInstance(Interpolation.INTERP_NEAREST));

        RenderedImage ri = worker.getRenderedImage();
        final Object roiValue = ri.getProperty("ROI");
        assertNotEquals(java.awt.Image.UndefinedProperty, roiValue);
        ROI warpedROI = (ROI) roiValue;
        PlanarImage warpedROIImage = warpedROI.getAsImage();
        // check it's not solid white (happens if the wrong warp is used)
        ImageWorker warpedROIWorker = new ImageWorker(warpedROIImage);
        assertEquals(1, warpedROIWorker.getMaximums()[0], 0d);
        assertEquals(0, warpedROIWorker.getMinimums()[0], 0d);
    }

