    /**
     * Applies the specified operation to the given coverages.
     *
     * @param coverage0 The coverage to scale.
     * @param interp The interpolation to use.
     * @throws IOException
     */
    private GridCoverage2D doOp(
            final String operationName,
            final GridCoverage2D coverage0,
            final GridCoverage2D coverage1)
            throws IOException {

        // Getting parameters for doing a scale.
        final ParameterValueGroup param = processor.getOperation(operationName).getParameters();
        if (JAIExt.isJAIExtOperation(JAIExt.getOperationName(operationName))) {
            List<GridCoverage2D> sources = new ArrayList<>();
            sources.add(coverage0);
            sources.add(coverage1);
            param.parameter("Sources").setValue(sources);
        } else {
            param.parameter("Source0").setValue(coverage0);
            param.parameter("Source1").setValue(coverage1);
        }

        // Doing a first scale.
        GridCoverage2D result = (GridCoverage2D) processor.doOperation(param);
        assertEnvelopeEquals(coverage0, result);
        return result;
    }

