        public FromPreviousIntegral(
                JDBCDataStore ds, Connection cx, PrimaryKey key, PrimaryKeyColumn col)
                throws SQLException {
            super(ds, col);
            StringBuffer sql = new StringBuffer();
            sql.append("SELECT MAX(");
            ds.getSQLDialect().encodeColumnName(null, col.getName(), sql);
            sql.append(") + 1 FROM ");
            ds.encodeTableName(key.getTableName(), sql, null);

            Statement st = cx.createStatement();
            try {
                ResultSet rs = st.executeQuery(sql.toString());
                try {
                    if (rs.next()) {
                        next = rs.getObject(1);
                    } else {
                        next = 1;
                    }
                    if (next == null) {
                        // this probably means there was no data in the table, set to 1
                        // TODO: probably better to do a count to check... but if this
                        // value already exists the db will throw an error when it tries
                        // to insert
                        next = 1;
                    }
                } finally {
                    rs.close();
                }
            } finally {
                st.close();
            }
        }

