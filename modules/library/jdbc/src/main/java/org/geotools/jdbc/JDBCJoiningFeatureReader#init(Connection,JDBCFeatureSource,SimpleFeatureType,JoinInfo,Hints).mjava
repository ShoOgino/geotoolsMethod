    void init(Connection cx, JDBCFeatureSource featureSource, SimpleFeatureType featureType, 
        JoinInfo join, Hints hints) throws SQLException, IOException {
        joinReaders = new ArrayList<JDBCFeatureReader>();
        int offset = featureType.getAttributeCount() + getPrimaryKey().getColumns().size();

        for (JoinPart part : join.getParts()) {
            SimpleFeatureType ft = part.getQueryFeatureType();
            joinReaders.add(new JDBCFeatureReader(rs, cx, offset,
                featureSource.getDataStore().getAbsoluteFeatureSource(ft.getTypeName()), ft, hints)); 
        }

        //builder for the final joined feature
        joinFeatureBuilder = new SimpleFeatureBuilder(retype(featureType, join));
    }

