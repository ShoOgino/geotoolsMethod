    /**
     * Checks for sorting support in the given sort order for a specific attribute type, given by a
     * PropertyName expression.
     *
     * <p>This default implementation assumes both orders are supported as long as the property name
     * corresponds to the name of one of the attribute types in the complete FeatureType, and that
     * the attribute is not a geometry.
     *
     * @param propertyName the expression holding the property name to check for sortability support
     * @param sortOrder the order, ascending or descending, to check for sortability support over
     *     the given property name.
     * @return true if propertyName refers to one of the FeatureType attributes
     */
    protected boolean supportsPropertySorting(PropertyName propertyName, SortOrder sortOrder) {
        AttributeDescriptor descriptor =
                (AttributeDescriptor) propertyName.evaluate(source.getSchema());
        if (descriptor == null) {
            String attName = propertyName.getPropertyName();
            descriptor = source.getSchema().getDescriptor(attName);
        }
        return descriptor != null
                && !(Geometry.class.isAssignableFrom(descriptor.getType().getBinding()));
    }

