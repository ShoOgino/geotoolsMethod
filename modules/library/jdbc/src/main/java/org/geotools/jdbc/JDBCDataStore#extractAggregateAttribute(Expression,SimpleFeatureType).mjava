    /**
     * Helper method that extract the attribute that will be used by the aggregate function.
     *
     * @param visitor     the feature visitor
     * @param featureType the feature type
     * @return the aggregate attribute or NULL if the visitor don't contains an aggregate attribute
     */
    protected AttributeDescriptor extractAggregateAttribute(Expression expression, SimpleFeatureType featureType) {
        if (expression == null) {
            return null;
        }
        FilterAttributeExtractor extractor = new FilterAttributeExtractor(featureType);
        expression.accept(extractor, null);
        if (extractor.getPropertyNameSet().isEmpty()) {
            return null;
        }
        PropertyName pName = extractor.getPropertyNameSet().iterator().next();
        return (AttributeDescriptor)pName.evaluate(featureType);
    }

