    /**
     * Encodes a feature id from a primary key and result set values.
     * <p>
     * <tt>offset</tt> specifies where in the result set to start from when reading values for the 
     * primary key.
     * </p>
     */
    protected String encodeFID( PrimaryKey pkey, ResultSet rs, int offset ) throws SQLException, IOException {
        // no pk columns
        if(pkey.getColumns().isEmpty()) {
            return SimpleFeatureBuilder.createDefaultFeatureId();
        } 
        
        // just one, no need to build support structures
        if(pkey.getColumns().size() == 1)
            return rs.getString(offset+1);

        // more than one
        List<Object> keyValues = new ArrayList<Object>();
        for(int i = 0; i < pkey.getColumns().size(); i++) {
            String o = rs.getString(offset+i+1);
            keyValues.add( o );
        }
        return encodeFID( keyValues );
    }

