    protected PreparedStatement selectAggregateSQLPS(String function, AttributeDescriptor att, List<AttributeDescriptor> groupByAttributes,
                                                     SimpleFeatureType featureType, Query query, LimitingVisitor visitor, Connection cx)
        throws SQLException, IOException {
        
        StringBuffer sql = new StringBuffer();
        List<FilterToSQL> toSQL = doSelectAggregateSQL(function, att, groupByAttributes, featureType, query, visitor, sql);
        
        LOGGER.fine( sql.toString() );
          
        PreparedStatement ps = cx.prepareStatement(sql.toString(), ResultSet.TYPE_FORWARD_ONLY, ResultSet.CONCUR_READ_ONLY);
        ps.setFetchSize(fetchSize);
        
        setPreparedFilterValues(ps, toSQL, cx);

        return ps;
    }

