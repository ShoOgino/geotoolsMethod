    /**
     * Retreives the FeatureTypeInfo object for a SimpleFeatureType.
     * 
     * <p>
     * This allows subclasses to get access to the information about a feature type, this includes
     * the schema and the fidColumnName.
     * </p>
     *
     * @param featureTypeName The name of the feature type to get the info for.
     *
     * @return The FeatureTypeInfo object for the named feature type or null if the feature type
     *         does not exist.
     *
     * @throws IOException If an error occurs creating the FeatureTypeInfo.
     */
    public FeatureTypeInfo getFeatureTypeInfo(String featureTypeName)
        throws IOException {
        long now = System.currentTimeMillis();
        Long ftInfoTime = (Long) featureTypeTimeoutMap.get(featureTypeName);

        FeatureTypeInfo info = (FeatureTypeInfo) featureTypeMap.get(featureTypeName);

        // If the feature type info is not there or is outdated, load it from the
        // datastore and put it in the cache
        if ((ftInfoTime == null) || ((now - ftInfoTime.longValue()) > cacheTimeOut)) {
            // make sure table exists
            FIDMapper mapper = getFIDMapper(featureTypeName);
            SimpleFeatureType schema = dataStore.buildSchema(featureTypeName, mapper);
            info = new FeatureTypeInfo(featureTypeName, schema, mapper);

            // get srdid for each geometry
            for (AttributeDescriptor ad : schema.getAttributeDescriptors()) {
                if (ad instanceof GeometryDescriptor ) {
                    int srid = dataStore.determineSRID(featureTypeName, ad.getLocalName());
                    info.putSRID(ad.getLocalName(), srid);
                }
            }

            // put the infos in the feature type info cache, but only if the caching
            // is allowed, no point in continously overwriting it otherwise
            if (cacheTimeOut > 0) {
                featureTypeMap.put(featureTypeName, info);
                featureTypeTimeoutMap.put(featureTypeName, new Long(now));
            }
        }

        return info;
    }

