    public JDBCFeatureReader(
            String sql,
            Connection cx,
            JDBCFeatureSource featureSource,
            SimpleFeatureType featureType,
            Query query)
            throws SQLException {
        init(featureSource, featureType, query);

        // create the result set
        this.cx = cx;
        st = cx.createStatement(ResultSet.TYPE_FORWARD_ONLY, ResultSet.CONCUR_READ_ONLY);
        st.setFetchSize(featureSource.getDataStore().getFetchSize());

        SQLDialect sqlDialect = featureSource.getDataStore().getSQLDialect();
        if (sqlDialect instanceof BasicSQLDialect) {
            ((BasicSQLDialect) sqlDialect).onSelect(st, cx, featureType);
        } else if (sqlDialect instanceof PreparedStatementSQLDialect
                && st instanceof PreparedStatement) {
            ((PreparedStatementSQLDialect) sqlDialect)
                    .onSelect((PreparedStatement) st, cx, featureType);
        }

        runQuery(() -> st.executeQuery(sql), st);
    }

