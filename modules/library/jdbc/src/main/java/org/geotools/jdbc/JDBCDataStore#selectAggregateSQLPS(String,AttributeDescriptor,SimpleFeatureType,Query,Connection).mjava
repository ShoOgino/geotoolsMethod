    /**
     * Generates a 'SELECT <function>() FROM' prepared statement.
     */
    protected PreparedStatement selectAggregateSQLPS(String function, AttributeDescriptor att, SimpleFeatureType featureType, Query query, Connection cx)
        throws SQLException, IOException {
        
        StringBuffer sql = new StringBuffer();
        List<FilterToSQL> toSQL = doSelectAggregateSQL(function, att, featureType, query, sql);
        
        LOGGER.fine( sql.toString() );
          
        PreparedStatement ps = cx.prepareStatement(sql.toString(), ResultSet.TYPE_FORWARD_ONLY, ResultSet.CONCUR_READ_ONLY);
        ps.setFetchSize(fetchSize);
        
        setPreparedFilterValues(ps, toSQL, cx);

        return ps;
    }

