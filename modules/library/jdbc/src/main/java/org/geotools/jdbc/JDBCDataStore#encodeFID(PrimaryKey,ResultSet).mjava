    /**
     * Encodes a feature id from a primary key and result set values. 
     */
    protected String encodeFID( PrimaryKey pkey, ResultSet rs ) throws SQLException, IOException {
        // no pk columns
        if(pkey.getColumns().isEmpty()) {
            return SimpleFeatureBuilder.createDefaultFeatureId();
        } 
        
        // just one, no need to build support structures
        if(pkey.getColumns().size() == 1)
            return rs.getString(1);

        // more than one
        List<Object> keyValues = new ArrayList<Object>();
        for(int i = 0; i < pkey.getColumns().size(); i++) {
            String o = rs.getString(i+1);
            keyValues.add( o );
        }
        return encodeFID( keyValues );
    }

