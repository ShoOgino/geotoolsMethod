    public boolean hasNext() throws IOException {
        ensureOpen();
        
        if (next == null) {
            try {
                callback.beforeNext(rs);
                next = Boolean.valueOf(rs.next());
                callback.afterNext(rs, next);

                if (!next) {
                    callback.finish(this);
                }
            } catch (SQLException e) {
                callback.rowError(e);
                throw new RuntimeException(e);
            }
        }

        return next.booleanValue();
    }

