    public boolean hasNext() throws IOException {
        ensureOpen();

        if (next == null) {
            try {
                while (nextFeature == null && !Boolean.FALSE.equals(next)) {
                    callback.beforeNext(rs);
                    next = Boolean.valueOf(rs.next());
                    callback.afterNext(rs, next);

                    if (next) {
                        nextFeature = readNextFeature();
                    }
                }

                if (!next) {
                    callback.finish(this);
                }
            } catch (SQLException e) {
                callback.rowError(e);
                throw new RuntimeException(e);
            }
        }

        return next.booleanValue();
    }

