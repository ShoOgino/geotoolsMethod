    /**
     * Surrounds a name with the SQL escape string.
     *
     * <p>If the name contains the SQL escape string, the SQL escape string is duplicated.
     */
    public String escapeName(String name) {
        if (sqlNameEscape.isEmpty()) return name;
        StringBuilder sb = new StringBuilder();
        sb.append(sqlNameEscape);
        int offset = 0;
        int escapeOffset;
        while ((escapeOffset = name.indexOf(sqlNameEscape, offset)) != -1) {
            sb.append(name.substring(offset, escapeOffset));
            sb.append(sqlNameEscape);
            sb.append(sqlNameEscape);
            offset = escapeOffset + sqlNameEscape.length();
        }
        sb.append(name.substring(offset));
        sb.append(sqlNameEscape);
        return sb.toString();
    }

