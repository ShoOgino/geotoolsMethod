    /**
     * Helper method for getting the expression from a visitor
     * TODO: Remove this method when there is an interface for aggregate visitors.
     * See GEOT-2325 for details.
     */
    Expression getExpression(FeatureVisitor visitor) {
        if (visitor instanceof CountVisitor) {
            return null;
        }
        try {
            Method g = visitor.getClass().getMethod( "getExpression", null );
            if ( g != null ) {
                Object result = g.invoke( visitor, null );
                if ( result instanceof Expression ) {
                    return (Expression) result;
                }
            }
        }
        catch( Exception e ) {
            //ignore for now
        }
        
        return null;
    }

