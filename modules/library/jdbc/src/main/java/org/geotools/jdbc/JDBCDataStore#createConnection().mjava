    /**
     * Creates a new connection.
     * <p>
     * Callers of this method should close the connection when done with it.
     * </p>.
     *
     */
    protected final Connection createConnection() {
        try {
            LOGGER.fine( "CREATE CONNECTION");
            Connection cx = getDataSource().getConnection();
            // isolation level is not set in the datastore, see 
            // http://jira.codehaus.org/browse/GEOT-2021 

            //call dialect callback to initialize the connection
            dialect.initializeConnection( cx );
            return cx;
        } catch (SQLException e) {
            throw new RuntimeException("Unable to obtain connection: " + e.getMessage(), e);
        }
    }

