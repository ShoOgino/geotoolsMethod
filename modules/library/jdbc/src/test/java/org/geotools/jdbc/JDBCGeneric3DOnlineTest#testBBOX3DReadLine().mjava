    public void testBBOX3DReadLine() throws Exception {
        BBOX3D bbox3d = FF.bbox("", new ReferencedEnvelope3D(2, 3, 1, 2, 0, 1, crs));
        SimpleFeatureCollection fc =
                dataStore.getFeatureSource(tname(getLine3d())).getFeatures(bbox3d);
        try (SimpleFeatureIterator fr = fc.features()) {
            assertTrue(fr.hasNext());
            LineString ls = (LineString) fr.next().getDefaultGeometry();
            // 1 1 0, 2 2 0, 4 2 1, 5 1 1
            assertEquals(4, ls.getCoordinates().length);
            assertTrue(new Coordinate(1, 1, 0).equals3D(ls.getCoordinateN(0)));
            assertTrue(new Coordinate(2, 2, 0).equals3D(ls.getCoordinateN(1)));
            assertTrue(new Coordinate(4, 2, 1).equals3D(ls.getCoordinateN(2)));
            assertTrue(new Coordinate(5, 1, 1).equals3D(ls.getCoordinateN(3)));
        }
    }

