    @Test
    public void testSetTransactionNullWithExternalConnection() throws Exception {
        JDBCTransactionState state = new JDBCTransactionState(mockConnection, dataStore, true);
        // init state
        state.setTransaction(mockTransaction);

        // clear state
        state.setTransaction(null);

        // make sure connection is closed
        verify(mockConnection, times(0)).close();
        testLogWarnings(state);
    }

