    /**
     * Tests if connection gets closed on internally managed connections and creation of log
     * statements.
     */
    @Test
    public void testSetTransactionNullWithInternalConnection() throws IOException, SQLException {
        JDBCTransactionState state = new JDBCTransactionState(mockConnection, dataStore);
        // init state
        state.setTransaction(mockTransaction);

        // clear state
        state.setTransaction(null);

        // make sure connection is closed
        verify(mockConnection, times(1)).close();
        testLogWarnings(state);
    }

