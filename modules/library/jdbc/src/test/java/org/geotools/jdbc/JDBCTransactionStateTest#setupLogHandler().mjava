    /**
     * Setup a log handler counting {@link LogRecord} having {@link Level#WARNING}.
     */
    @Before
    public void setupLogHandler() {
        dataStore.getLogger().addHandler(mockLogHandler);
        // when(mockLogHandler.publish(any(LogRecord.class)));
        doAnswer(new Answer<Object>() {
            public Object answer(InvocationOnMock invocation) {
                Object[] arguments = invocation.getArguments();
                LogRecord logRecord = (LogRecord) arguments[0];
                if (logRecord.getLevel() == Level.WARNING) {
                    warningsCount++;
                }
                return null;
            }
        }).when(mockLogHandler).publish(any(LogRecord.class));
    }

