    @Test
    public void testSegregateSimple() throws Exception {
        SimpleFeatureType featureType = buildType();
        Collection<SimpleFeature> features = new ArrayList<>();
        features.add(createFeature(featureType, "toto", createLineString(), createPolygon()));
        features.add(createFeature(featureType, "tutu", createLineString(), createPolygon()));
        Map<InsertionClassifier, Collection<SimpleFeature>> actual =
                InsertionClassifier.classify(featureType, features);
        Assert.assertEquals(1, actual.size());
        for (InsertionClassifier kind : actual.keySet()) {
            Assert.assertFalse(kind.useExisting);
            Assert.assertEquals(2, kind.geometryTypes.size());
            Assert.assertEquals(LineString.class, kind.geometryTypes.get("geom1"));
            Assert.assertEquals(Polygon.class, kind.geometryTypes.get("geom2"));
            Assert.assertEquals(2, actual.get(kind).size());
        }
    }

