    /** Helper method that dets the features of the provided table that match the provided query. */
    private List<SimpleFeature> getFeatures(String tableName, Query query) {
        try {
            ContentFeatureSource featureSource = dataStore.getFeatureSource(tname(tableName));
            SimpleFeatureCollection collection = featureSource.getFeatures(query);
            return getFeatures(collection);
        } catch (Exception exception) {
            // something bad happen, let's abort
            throw new RuntimeException(
                    String.format(
                            "Error reading features from table '%s' using query '%s'.",
                            tableName, query.toString()),
                    exception);
        }
    }

