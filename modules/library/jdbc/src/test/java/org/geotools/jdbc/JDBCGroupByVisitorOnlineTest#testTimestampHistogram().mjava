    public void testTimestampHistogram() throws Exception {
        // buckets with a size of one day, the function returns an integer from 0 onwards, which
        // is a zero based bucket number in the bucket sequence
        FilterFactory ff = dataStore.getFilterFactory();
        PropertyName pn = ff.property(aname("last_update"));
        Date baseDate = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse("2016-06-03 00:00:00");
        Expression difference = ff.function("dateDifference", pn, ff.literal(baseDate));
        int dayInMs = 1000 * 60 * 60 * 24;
        Expression expression = ff.function("floor", ff.divide(difference, ff.literal(dayInMs)));

        FilterCapabilities capabilities = dataStore.getFilterCapabilities();
        boolean expectOptimized =
                capabilities.supports(FilterFunction_floor.class)
                        && capabilities.supports(DateDifferenceFunction.class);
        List<Object[]> value =
                genericGroupByTestTest(Query.ALL, Aggregate.COUNT, expectOptimized, expression);
        assertNotNull(value);

        assertEquals(5, value.size());
        checkValueContains(value, "0", "3"); // 2016-06-03
        checkValueContains(value, "2", "1"); // 2016-06-05
        checkValueContains(value, "3", "2"); // 2016-06-06
        checkValueContains(value, "4", "3"); // 2016-06-07
        checkValueContains(value, "12", "3"); // 2016-06-15
    }

