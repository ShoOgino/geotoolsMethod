    public void testGetFeaturesWithQuery() throws Exception {
        FilterFactory ff = dataStore.getFilterFactory();
        PropertyIsEqualTo filter =
                ff.equals(ff.property(aname("stringProperty")), ff.literal("one"));

        Query query = new Query();
        query.setPropertyNames(aname("doubleProperty"), aname("intProperty"));
        query.setFilter(filter);

        SimpleFeatureCollection features = featureSource.getFeatures(query);
        assertEquals(1, features.size());

        try (SimpleFeatureIterator iterator = features.features()) {
            assertTrue(iterator.hasNext());

            SimpleFeature feature = iterator.next();
            assertEquals(2, feature.getAttributeCount());

            assertEquals(Double.valueOf(1.1), feature.getAttribute(aname("doubleProperty")));
            assertNotNull(feature.getAttribute(aname("intProperty")));
        }
    }

