    /**
     * Creates a data source by reading properties from a file called 'db.properties', located
     * paralell to the test setup instance.
     */
    protected DataSource createDataSource() throws IOException {
        Properties db = fixture;

        BasicDataSource dataSource = new BasicDataSource();

        dataSource.setDriverClassName(db.getProperty("driver"));
        dataSource.setUrl(db.getProperty("url"));

        if (db.containsKey("user")) {
            dataSource.setUsername(db.getProperty("user"));
        } else if (db.containsKey("username")) {
            dataSource.setUsername(db.getProperty("username"));
        }
        if (db.containsKey("password")) {
            dataSource.setPassword(db.getProperty("password"));
        }

        dataSource.setPoolPreparedStatements(true);
        dataSource.setAccessToUnderlyingConnectionAllowed(true);
        dataSource.setMinIdle(1);
        dataSource.setMaxActive(4);
        // if we cannot get a connection within 5 seconds give up
        dataSource.setMaxWait(5000);

        initializeDataSource(dataSource, db);

        // return a closeable data source (DisposableDataSource interface)
        // so that the connection pool will be tore down on datastore dispose
        return new DBCPDataSource(dataSource);
    }

