    protected Set<String> collectFeatureIds(SimpleFeatureCollection fc) {
        Set<String> identifiers = new TreeSet<>(String.CASE_INSENSITIVE_ORDER);
        try(SimpleFeatureIterator fi = fc.features()) {
            while(fi.hasNext()) {
                SimpleFeature sf = fi.next();
                identifiers.add(sf.getID());
            }
        }
        return identifiers;
    }

