    public void testGetFeatureReaderMutability() throws IOException, IllegalAttributeException {
        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader = reader(tname("road"))) {
            while (reader.hasNext()) {
                SimpleFeature feature = reader.next();
                feature.setAttribute(aname("name"), null);
            }
        }

        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader = reader(tname("road"))) {
            while (reader.hasNext()) {
                SimpleFeature feature = reader.next();
                assertNotNull(feature.getAttribute(aname("name")));
            }

            // close early to check next() after it
            reader.close();

            reader.next();
            fail("next should fail with an IOException");
        } catch (Exception expected) {
            // fine, it's expected
        }
    }

