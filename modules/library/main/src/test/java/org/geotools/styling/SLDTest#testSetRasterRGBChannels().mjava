    /**
     * Test to ensure that updating the channels duplicates the raster sybmolizer with the new rgb
     * channels
     */
    @Test
    public void testSetRasterRGBChannels() {
        RasterSymbolizer rs = sb.createRasterSymbolizer();
        Style s = sb.createStyle(rs);

        SelectedChannelType red =
                sf.createSelectedChannelType("red", sf.createContrastEnhancement(ff.literal(0.2)));
        SelectedChannelType green =
                sf.createSelectedChannelType(
                        "green", sf.createContrastEnhancement(ff.literal(0.4)));
        SelectedChannelType blue =
                sf.createSelectedChannelType("blue", sf.createContrastEnhancement(ff.literal(0.7)));

        SLD.setChannelSelection(s, new SelectedChannelType[] {red, green, blue}, null);

        assertNull(SLD.rasterSymbolizer(s).getChannelSelection().getGrayChannel());
        assertNotNull(SLD.rasterSymbolizer(s).getChannelSelection().getRGBChannels());
        SelectedChannelType[] selectedChannels =
                SLD.rasterSymbolizer(s).getChannelSelection().getRGBChannels();

        assertEquals("red", selectedChannels[0].getChannelName().evaluate(null, String.class));
        assertEquals("green", selectedChannels[1].getChannelName().evaluate(null, String.class));
        assertEquals("blue", selectedChannels[2].getChannelName().evaluate(null, String.class));

        assertNotSame(SLD.rasterSymbolizer(s), rs);
    }

