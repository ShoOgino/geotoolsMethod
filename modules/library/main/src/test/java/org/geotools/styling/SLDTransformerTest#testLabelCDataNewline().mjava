    @Test
    public void testLabelCDataNewline() throws Exception {
        StyleBuilder sb = new StyleBuilder();
        TextSymbolizer ts = sb.createTextSymbolizer();
        ts.setLabel(ff.function("strConcat", ff.literal("a \n bc"), ff.property("myProperty")));
        StyledLayerDescriptor sld = buildSLDAroundSymbolizer(ts);

        String xml = transformer.transform(sld);
        Document doc = buildTestDocument(xml);

        assertXpathEvaluatesTo("a bc", "normalize-space(//sld:Label/text()[1])", doc);
        assertXpathEvaluatesTo("myProperty", "//sld:Label/ogc:PropertyName", doc);

        // normalize-space() strips indentation, but also CDATA whitespace, so we resort to string
        // comparisons here
        assertTrue(xml.contains("<![CDATA[a " + NEWLINE + " bc]]>"));
    }

