    @Test
    public void testGetFeatureReaderFilterAutoCommit() throws NoSuchElementException, IOException {
        SimpleFeatureType type = data.getSchema("road");
        FeatureReader<SimpleFeatureType, SimpleFeature> reader;

        reader = data.getFeatureReader(new Query("road"), Transaction.AUTO_COMMIT);
        assertFalse(reader instanceof FilteringFeatureReader);
        Assert.assertEquals(type, reader.getFeatureType());
        Assert.assertEquals(roadFeatures.length, count(reader));

        reader = data.getFeatureReader(new Query("road", Filter.EXCLUDE), Transaction.AUTO_COMMIT);

        Assert.assertEquals(type, reader.getFeatureType());
        Assert.assertEquals(0, count(reader));

        reader = data.getFeatureReader(new Query("road", rd1Filter), Transaction.AUTO_COMMIT);
        assertTrue(reader instanceof FilteringFeatureReader);
        Assert.assertEquals(type, reader.getFeatureType());
        Assert.assertEquals(1, count(reader));
    }

