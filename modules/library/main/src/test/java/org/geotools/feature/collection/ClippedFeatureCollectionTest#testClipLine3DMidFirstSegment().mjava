    @Test
    public void testClipLine3DMidFirstSegment() throws Exception {
        Geometry clip =
                new WKTReader().read("POLYGON((-10 -10, -10 10, 5000 10, 5000 -10, -10 -10))");
        ClippedFeatureCollection collection =
                new ClippedFeatureCollection(delegateLineZ, clip, true);
        assertEquals(1, collection.size());
        try (SimpleFeatureIterator fi = collection.features()) {
            // check the first polygon
            SimpleFeature f = fi.next();
            MultiLineString ml = (MultiLineString) f.getDefaultGeometry();
            assertEquals(1, ml.getNumGeometries());
            LineString ls = (LineString) ml.getGeometryN(0);
            CoordinateSequence cs = ls.getCoordinateSequence();
            assertEquals(2, cs.size());
            assertOrdinates(0, 0, 0, cs, 0);
            assertOrdinates(5000, 0, 0.5, cs, 1);
        }
    }

