    /**
     * Helper method that construct the group by visitor and visit the given feature collection. The visitor result
     * is also checked against the expected result.
     */
    private GroupByVisitor executeVisitor(FeatureCollection featureCollection, String aggregateAttribute,
                                          String aggregateVisitor, String[] groupByAttributes) throws Exception {
        GroupByVisitorBuilder visitorBuilder = new GroupByVisitorBuilder()
                .withAggregateAttribute(aggregateAttribute, buildingType)
                .withAggregateVisitor(aggregateVisitor);
        for (String groupByAttribute : groupByAttributes) {
            visitorBuilder.withGroupByAttribute(groupByAttribute, buildingType);
        }
        GroupByVisitor visitor = visitorBuilder.build();
        featureCollection.accepts(visitor, new NullProgressListener());
        return visitor;
    }

