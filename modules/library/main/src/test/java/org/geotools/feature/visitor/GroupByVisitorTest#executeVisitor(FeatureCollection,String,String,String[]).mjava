    /**
     * Helper method that construct the group by visitor and visit the given feature collection. The visitor result
     * is also checked against the expected result.
     */
    private GroupByVisitor executeVisitor(FeatureCollection featureCollection, String aggregateAttribute,
                                          String aggregateVisitor, String[] groupByAttributes) throws Exception {
        GroupByVisitor visitor = buildVisitor(aggregateAttribute, aggregateVisitor,
                groupByAttributes);
        featureCollection.accepts(visitor, new NullProgressListener());
        return visitor;
    }

