    @Test
    public void testCreateSubType() throws Exception {
        SimpleFeatureType before =
                DataUtilities.createType("cities", "the_geom:Point:srid=4326,name:String");
        SimpleFeatureType after = DataUtilities.createSubType(before, new String[] {"the_geom"});
        Assert.assertEquals(1, after.getAttributeCount());

        before =
                DataUtilities.createType(
                        "cities", "the_geom:Point:srid=4326,name:String,population:Integer");
        URI here = new URI("http://localhost/");
        after =
                DataUtilities.createSubType(
                        before, new String[] {"the_geom"}, DefaultGeographicCRS.WGS84, "now", here);
        Assert.assertEquals(here.toString(), after.getName().getNamespaceURI());
        Assert.assertEquals("now", after.getName().getLocalPart());
        Assert.assertEquals(DefaultGeographicCRS.WGS84, after.getCoordinateReferenceSystem());
        Assert.assertEquals(1, after.getAttributeCount());
        Assert.assertEquals("the_geom", after.getDescriptor(0).getLocalName());
        assertNotNull(after.getGeometryDescriptor());

        // check that subtyping does not cause the geometry attribute structure to change
        before =
                DataUtilities.createType(
                        "cities", "the_geom:Point:srid=4326,name:String,population:Integer");
        after = DataUtilities.createSubType(before, new String[] {"the_geom"});
        Assert.assertEquals(before.getGeometryDescriptor(), after.getGeometryDescriptor());

        // check that subtyping does not cause the geometry attribute structure to change
        before =
                DataUtilities.createType(
                        "cities", "the_geom:Point:srid=4326,name:String,population:Integer");
        after = DataUtilities.createSubType(before, new String[] {"the_geom"});
        Assert.assertEquals(before.getGeometryDescriptor(), after.getGeometryDescriptor());
    }

