    void assertContents(
            SimpleFeature expected[], FeatureReader<SimpleFeatureType, SimpleFeature> reader)
            throws IOException {
        assertNotNull(reader);
        assertNotNull(expected);
        SimpleFeature feature;
        int count = 0;
        try {
            for (SimpleFeature simpleFeature : expected) {
                assertTrue(reader.hasNext());
                feature = reader.next();
                assertNotNull(feature);
                assertEquals(simpleFeature, feature);
                count++;
            }
            assertFalse(reader.hasNext());
        } catch (NoSuchElementException e) {
            // bad dog!
            throw new DataSourceException("hasNext() lied to me at:" + count, e);
        } catch (IllegalAttributeException e) {
            throw new DataSourceException("next() could not understand feature at:" + count, e);
        } finally {
            reader.close();
        }
    }

