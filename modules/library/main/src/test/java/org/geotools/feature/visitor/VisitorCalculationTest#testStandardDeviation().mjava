    public void testStandardDeviation() throws Exception {
        FilterFactory factory = CommonFactoryFinder.getFilterFactory(null);
        Expression expr = factory.property(ft3.getDescriptor(0).getLocalName());
        // first do it the old fashioned way to ensure backwards compatibility
        AverageVisitor visit1 = new AverageVisitor(expr);
        fc3.accepts(visit1, null);
        CalcResult result = visit1.getResult();
        double average = result.toDouble();

        StandardDeviationVisitor visit2 = new StandardDeviationVisitor(expr, average);
        fc3.accepts(visit2, null);
        assertEquals(28.86, visit2.getResult().toDouble(), 0.01);
        // then do it single pass
        StandardDeviationVisitor visit3 = new StandardDeviationVisitor(expr);
        fc3.accepts(visit3, null);
        assertEquals(28.86, visit3.getResult().toDouble(), 0.01);
        // test empty collection
        StandardDeviationVisitor emptyVisitor = new StandardDeviationVisitor(expr, average);
        empty.accepts(emptyVisitor, null);
        assertEquals(CalcResult.NULL_RESULT, emptyVisitor.getResult());
        // test merge
        assertSame(result, emptyVisitor.getResult().merge(result));
        assertSame(result, result.merge(emptyVisitor.getResult()));
    }

