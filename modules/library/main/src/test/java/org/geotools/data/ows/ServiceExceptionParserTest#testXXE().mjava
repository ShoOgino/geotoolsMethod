    @Test
    public void testXXE() throws Exception {
        URL resource = ServiceExceptionParserTest.class.getResource("secret.txt");
        ServiceException exception = ServiceExceptionParser.parse(
                mockStream(
                          "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n"
                        + "<!DOCTYPE foo [ <!ELEMENT ServiceExceptionReport ANY ><!ENTITY xxe SYSTEM \""+resource+"\" >]>"
                        + "<ServiceExceptionReport>\n"
                        + "  <ServiceException code=\"42\">&xxe;</ServiceException>\n"
                        + "</ServiceExceptionReport>"));
        
        Assert.assertThat(exception, 
                hasProperty("message", not(containsString("Top secret information that shouldn't appear in an error message."))));
        Assert.assertThat(exception.getNext(),
                nullValue());
    }

