    @Test
    public void testDelegateVisitor() throws IOException {
        FilterFactory2 ff = CommonFactoryFinder.getFilterFactory2();
        UniqueVisitor visitor = new UniqueVisitor(ff.property("test"));

        FeatureCollection mock = EasyMock.createMock(FeatureCollection.class);
        mock.accepts(visitor, null);
        EasyMock.expectLastCall();
        EasyMock.replay(mock);

        DecoratingFeatureCollection decorator =
                new DecoratingFeatureCollection<FeatureType, Feature>(mock) {
                    @Override
                    protected boolean canDelegate(FeatureVisitor visitor) {
                        return true;
                    }
                };
        decorator.accepts(visitor, null);
        EasyMock.verify(mock);
    }

