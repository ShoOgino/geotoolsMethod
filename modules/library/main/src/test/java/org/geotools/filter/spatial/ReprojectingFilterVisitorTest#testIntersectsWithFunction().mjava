    @Test
    public void testIntersectsWithFunction() throws Exception {
        Function function = new GeometryFunction();

        // see if coordinates gets flipped, urn forces lat/lon interpretation
        Intersects original = ff.intersects(ff.property("geom"), function);
        Filter clone = (Filter) original.accept(reprojector, null);
        Assert.assertNotSame(original, clone);
        Intersects isClone = (Intersects) clone;
        assertEquals(isClone.getExpression1(), original.getExpression1());
        LineString clonedLs = (LineString) isClone.getExpression2().evaluate(null);
        assertEquals(15d, clonedLs.getCoordinateN(0).x, 0d);
        assertEquals(10d, clonedLs.getCoordinateN(0).y, 0d);
        assertEquals(25d, clonedLs.getCoordinateN(1).x, 0d);
        assertEquals(20d, clonedLs.getCoordinateN(1).y, 0d);
        assertEquals(CRS.decode("EPSG:4326"), clonedLs.getUserData());
    }

