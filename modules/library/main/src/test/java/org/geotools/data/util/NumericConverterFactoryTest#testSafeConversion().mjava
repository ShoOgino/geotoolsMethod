    @Test
    public void testSafeConversion() throws Exception {
        // byte
        Assert.assertEquals(
                Byte.valueOf((byte) 127), convertSafe(Byte.valueOf((byte) 127), Byte.class));
        Assert.assertNull(convertSafe(Short.valueOf((short) 128), Byte.class));
        Assert.assertNull(convertSafe(Integer.valueOf(128), Byte.class));
        Assert.assertNull(convertSafe(Long.valueOf(128), Byte.class));
        Assert.assertNull(convertSafe(BigInteger.valueOf(128), Byte.class));
        Assert.assertNull(convertSafe(Double.valueOf(128.1), Byte.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Byte.class));
        Assert.assertNull(convertSafe(Float.valueOf(128.1f), Byte.class));

        // short
        Assert.assertEquals(
                Short.valueOf((short) 127), convertSafe(Byte.valueOf((byte) 127), Short.class));
        Assert.assertEquals(
                Short.valueOf((short) 1111), convertSafe(Short.valueOf((short) 1111), Short.class));
        Assert.assertNull(convertSafe(Integer.valueOf(128), Short.class));
        Assert.assertNull(convertSafe(Long.valueOf(128), Short.class));
        Assert.assertNull(convertSafe(BigInteger.valueOf(128), Short.class));
        Assert.assertNull(convertSafe(Double.valueOf(128.1), Short.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Short.class));
        Assert.assertNull(convertSafe(Float.valueOf(128.1f), Short.class));

        // integer
        Assert.assertEquals(
                Integer.valueOf(127), convertSafe(Byte.valueOf((byte) 127), Integer.class));
        Assert.assertEquals(
                Integer.valueOf(1111), convertSafe(Short.valueOf((short) 1111), Integer.class));
        Assert.assertEquals(
                Integer.valueOf(12345), convertSafe(Integer.valueOf(12345), Integer.class));
        Assert.assertNull(convertSafe(Long.valueOf(128), Integer.class));
        Assert.assertNull(convertSafe(BigInteger.valueOf(128), Integer.class));
        Assert.assertNull(convertSafe(Double.valueOf(128.1), Integer.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Integer.class));
        Assert.assertNull(convertSafe(Float.valueOf(128.1f), Integer.class));

        // long
        Assert.assertEquals(Long.valueOf(127), convertSafe(Byte.valueOf((byte) 127), Long.class));
        Assert.assertEquals(
                Long.valueOf(1111), convertSafe(Short.valueOf((short) 1111), Long.class));
        Assert.assertEquals(Long.valueOf(12345), convertSafe(Integer.valueOf(12345), Long.class));
        Assert.assertEquals(
                Long.valueOf(1234567), convertSafe(Integer.valueOf(1234567), Long.class));
        Assert.assertNull(convertSafe(BigInteger.valueOf(128), Long.class));
        Assert.assertNull(convertSafe(Double.valueOf(128.1), Long.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Long.class));
        Assert.assertNull(convertSafe(Float.valueOf(128.1f), Long.class));

        // big integer
        Assert.assertEquals(
                BigInteger.valueOf(127), convertSafe(Byte.valueOf((byte) 127), BigInteger.class));
        Assert.assertEquals(
                BigInteger.valueOf(1111),
                convertSafe(Short.valueOf((short) 1111), BigInteger.class));
        Assert.assertEquals(
                BigInteger.valueOf(12345), convertSafe(Integer.valueOf(12345), BigInteger.class));
        Assert.assertEquals(
                BigInteger.valueOf(1234567),
                convertSafe(Integer.valueOf(1234567), BigInteger.class));
        Assert.assertEquals(
                BigInteger.valueOf(12345678),
                convertSafe(BigInteger.valueOf(12345678), BigInteger.class));
        Assert.assertNull(convertSafe(Double.valueOf(128.1), Long.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Long.class));
        Assert.assertNull(convertSafe(Float.valueOf(128.1f), Long.class));

        // double
        Assert.assertEquals(
                Double.valueOf(127), convertSafe(Byte.valueOf((byte) 127), Double.class));
        Assert.assertEquals(
                Double.valueOf(1111), convertSafe(Short.valueOf((short) 1111), Double.class));
        Assert.assertEquals(
                Double.valueOf(12345), convertSafe(Integer.valueOf(12345), Double.class));
        Assert.assertEquals(
                Double.valueOf(1234567), convertSafe(Integer.valueOf(1234567), Double.class));
        // assertEquals(Double.valueOf(12345678), convertSafe(BigInteger.valueOf(12345678),
        // Double.class));
        Assert.assertEquals(
                Double.valueOf(12.123456), convertSafe(Double.valueOf(12.123456), Double.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Long.class));
        Assert.assertEquals(
                Double.valueOf(12.12), convertSafe(Float.valueOf(12.12f), Double.class));

        // float
        Assert.assertEquals(Float.valueOf(127), convertSafe(Byte.valueOf((byte) 127), Float.class));
        Assert.assertEquals(
                Float.valueOf(1111), convertSafe(Short.valueOf((short) 1111), Float.class));
        Assert.assertEquals(Float.valueOf(12345), convertSafe(Integer.valueOf(12345), Float.class));
        Assert.assertEquals(
                Float.valueOf(1234567), convertSafe(Integer.valueOf(1234567), Float.class));
        Assert.assertNull(convertSafe(BigInteger.valueOf(12345678), Float.class));
        Assert.assertNull(convertSafe(Double.valueOf(128.1), Float.class));
        Assert.assertNull(convertSafe(BigDecimal.valueOf(128.1), Float.class));
        Assert.assertEquals(Float.valueOf(12.12f), convertSafe(Float.valueOf(12.12f), Float.class));

        // Big Decimal
        Assert.assertEquals(
                BigDecimal.valueOf(127), convertSafe(Byte.valueOf((byte) 127), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(1111),
                convertSafe(Short.valueOf((short) 1111), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(12345), convertSafe(Integer.valueOf(12345), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(1234567),
                convertSafe(Integer.valueOf(1234567), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(12345678),
                convertSafe(BigInteger.valueOf(12345678), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(12.123456),
                convertSafe(Double.valueOf(12.123456), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(128.1),
                convertSafe(BigDecimal.valueOf(128.1), BigDecimal.class));
        Assert.assertEquals(
                BigDecimal.valueOf(12.12d), convertSafe(Float.valueOf(12.12f), BigDecimal.class));

        // test strings
        Assert.assertEquals(BigDecimal.valueOf(127), convertSafe("127", BigDecimal.class));
        Assert.assertNull(convertSafe("127f", BigDecimal.class));
        Assert.assertEquals(Double.valueOf(127.123), convertSafe("127.123", Double.class));
        Assert.assertNull(convertSafe("123.456.456", Double.class));
        Assert.assertEquals(Float.valueOf(127.123f), convertSafe("127.123", Float.class));
        Assert.assertNull(convertSafe("123.456.456", Float.class));
        Assert.assertEquals(BigInteger.valueOf(1234567), convertSafe("1234567", BigInteger.class));
        Assert.assertNull(convertSafe("123.456", BigInteger.class));
        Assert.assertEquals(Long.valueOf(54), convertSafe("54", Long.class));
        Assert.assertNull(convertSafe("123.6", Long.class));
        Assert.assertEquals(Integer.valueOf(54), convertSafe("54", Integer.class));
        Assert.assertNull(convertSafe("123.6", Integer.class));
        Assert.assertEquals(Short.valueOf((short) 54), convertSafe("54", Short.class));
        Assert.assertNull(convertSafe("123.6", Short.class));
        Assert.assertEquals(Byte.valueOf("1"), convertSafe("1", Byte.class));
        Assert.assertNull(convertSafe("123.6", Byte.class));
    }

