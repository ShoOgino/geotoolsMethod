        @Override
        public <T> T convert(Object source, Class<T> target) throws Exception {
            if (source == null) {
                throw new IllegalArgumentException("source must not be null");
            }
            Blob blob = (Blob) source;
            byte[] data;
            try {
                // We try to fetch the full blob in one go, but that might not be supported by
                // the JDBC driver, e.g. if the size of the blob is not known yet. In such a
                // case we fallback to fetching the blob chunkwise.
                data = fullFetch(blob);
            } catch (SQLFeatureNotSupportedException e) {
                data = chunkwiseFetch(blob);
            }
            return target.cast(data);
        }

