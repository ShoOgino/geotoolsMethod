    /**
     * Copies an existing feature, retyping it in the process.
     *
     * <p>Be warned, this method will create its own SimpleFeatureBuilder, which will trigger a scan
     * of the SPI looking for the current default feature factory, which is expensive and has
     * scalability issues.
     *
     * <p>If you need good performance consider using {@link
     * SimpleFeatureBuilder#retype(SimpleFeature, SimpleFeatureBuilder)} instead.
     *
     * <p>If the feature type contains attributes in which the original feature does not have a
     * value for, the value in the resulting feature is set to <code>null</code>.
     *
     * @param feature The original feature.
     * @param featureType The target feature type.
     * @return The copied feature, with a new type.
     */
    public static SimpleFeature retype(SimpleFeature feature, SimpleFeatureType featureType) {
        SimpleFeatureBuilder builder = new SimpleFeatureBuilder(featureType);
        for (AttributeDescriptor att : featureType.getAttributeDescriptors()) {
            Object value = feature.getAttribute(att.getName());
            builder.set(att.getName(), value);
        }
        return builder.buildFeature(feature.getID());
    }

