    protected Color mix(Color color1, Color color2, double weight) {
        // adjust weight based on alpha
        double da = color1.getAlpha() - color2.getAlpha();
        double w = weight * 2 - 1;
        double w1 = (((w * da == -1) ? w : (w + da) / (1 + w * da)) + 1) / 2.0;
        double w2 = 1 - w1;

        // mix colors
        int red = (int) Math.round(color1.getRed() * w1 + color2.getRed() * w2);
        int green = (int) Math.round(color1.getGreen() * w1 + color2.getGreen() * w2);
        int blue = (int) Math.round(color1.getBlue() * w1 + color2.getBlue() * w2);
        int alpha = 255;

        if (color1.getAlpha() < 255 || color2.getAlpha() < 255) {
            alpha = (int) Math.round(color1.getAlpha() * weight + color2.getAlpha() * (1 - weight));
        }
        return new Color(red, green, blue, alpha);
    }

