    /**
     * Utility method to create a ReferencedEnvelope from an JTS Envelope class, supporting 2d as
     * well as 3d envelopes (returning the right class).
     *
     * @param env The JTS Envelope object
     * @return ReferencedEnvelope, ReferencedEnvelope3D if it is 3d,<br>
     *     results in a null/an empty envelope, if input envelope was a null/an empty envelope
     */
    public static ReferencedEnvelope create(Envelope env, CoordinateReferenceSystem crs) {
        if (env == null) {
            return null;
        }
        if (crs != null && crs.getCoordinateSystem().getDimension() >= 3) {
            if (env.isNull()) {
                return new ReferencedEnvelope3D(crs);
            } else {
                return new ReferencedEnvelope3D(
                        env.getMinX(),
                        env.getMaxX(),
                        env.getMinY(),
                        env.getMaxY(),
                        Double.NaN,
                        Double.NaN,
                        crs);
            }
        }

        if (env.isNull()) {
            return new ReferencedEnvelope(crs);
        } else {
            return new ReferencedEnvelope(env, crs);
        }
    }

