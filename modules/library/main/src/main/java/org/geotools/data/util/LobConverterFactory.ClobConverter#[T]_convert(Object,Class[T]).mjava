        @Override
        public <T> T convert(Object source, Class<T> target) throws Exception {
            if (source == null) {
                throw new IllegalArgumentException("source must not be null");
            }
            Clob clob = (Clob) source;
            String s;
            try {
                // We try to fetch the full clob in one go, but that might not be supported by
                // the JDBC driver, e.g. if the size of the clob is not known yet. In such a
                // case we fallback to fetching the clob chunkwise.
                s = fullFetch(clob);
            } catch (SQLFeatureNotSupportedException e) {
                s = chunkwiseFetch(clob);
            }
            return target.cast(s);
        }

