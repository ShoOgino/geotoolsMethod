    /** @see org.geotools.data.FeatureReader#next() */
    public SimpleFeature next()
            throws IOException, IllegalAttributeException, NoSuchElementException {
        if (reader == null) {
            throw new IllegalStateException("Reader has already been closed");
        }

        SimpleFeature next = reader.next();
        if (builder == null) return next;

        return SimpleFeatureBuilder.retype(next, builder);
    }

