    public BBOX bbox(
            Expression e,
            double minx,
            double miny,
            double maxx,
            double maxy,
            String srs,
            MatchAction matchAction) {

        BBOXImpl box = null;
        try {
            CoordinateReferenceSystem crs;
            if (srs == null || srs.isEmpty()) {
                crs = null;
            } else {
                try {
                    crs = CRS.decode(srs);
                } catch (MismatchedDimensionException ex) {
                    throw new RuntimeException(ex);
                } catch (NoSuchAuthorityCodeException ex) {
                    crs = CRS.parseWKT(srs);
                }
            }
            box = bbox2d(e, new ReferencedEnvelope(minx, maxx, miny, maxy, crs), matchAction);
        } catch (FactoryException e1) {
            throw new RuntimeException("Failed to setup bbox SRS", e1);
        }

        return box;
    }

