    public SimpleFeatureCollection collection() throws IOException {
        try {
            DefaultFeatureCollection collection = new DefaultFeatureCollection(null, null);

            try (FeatureReader<SimpleFeatureType, SimpleFeature> reader = reader()) {
                while (reader.hasNext()) {
                    collection.add(reader.next());
                }
            }

            return collection;
        } catch (org.opengis.feature.IllegalAttributeException e) {
            throw new DataSourceException("Could not read feature ", e);
        }
    }

