        private double getRadius(CoordinateReferenceSystem crs, Point2D.Double center)
                throws TransformException, FactoryException {
            final double lon1 = center.x;
            final double lon2 = (lon1 + 180) % 360;
            final double lat1 = center.y;
            final double lat2 = -center.y;
            final double[] line = new double[] {lon1, lat1, lon2, lat2};
            CRS.findMathTransform(DefaultGeographicCRS.WGS84, crs).transform(line, 0, line, 0, 2);
            final double dx = line[2] - line[0];
            final double dy = line[3] - line[1];
            return Math.sqrt(dx * dx + dy * dy);
        }

