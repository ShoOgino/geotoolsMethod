    /**
     * Split the provided text using | charater as a seperator.
     *
     * <p>This method respects the used of \ to "escape" a | character allowing representations such
     * as the following:
     *
     * <pre>
     * String example="text|example of escaped \\| character|text";
     *
     * // represents: "text|example of escaped \| character|text"
     * String split=splitIntoText( example );</pre>
     *
     * @param data Origional raw text as stored
     * @return data split using | as seperator
     * @throws DataSourceException if the information stored is inconsistent with the headered
     *     provided
     */
    private static String[] splitIntoText(String data, SimpleFeatureType type) {
        // return data.split("|", -1); // use -1 as a limit to include empty trailing spaces
        // return data.split("[.-^\\\\]\\|",-1); //use -1 as limit to include empty trailing spaces

        String[] text = new String[type.getAttributeCount()];
        int i = 0;
        StringBuilder item = new StringBuilder();
        for (String str : data.split("\\|", -1)) {
            if (i == type.getAttributeCount()) {
                // limit reached
                throw new IllegalArgumentException(
                        "format error: expected "
                                + text.length
                                + " attributes, stopped after finding "
                                + i
                                + ". ["
                                + data
                                + "] split into "
                                + Arrays.asList(text));
            }
            if (str.endsWith("\\")) {
                item.append(str);
                item.append("|");
            } else {
                item.append(str);
                text[i] = item.toString();
                i++;
                item = new StringBuilder();
            }
        }
        if (i < type.getAttributeCount()) {
            throw new IllegalArgumentException(
                    "createFeature format error: expected "
                            + type.getAttributeCount()
                            + " attributes, but only found "
                            + i
                            + ". ["
                            + data
                            + "] split into "
                            + Arrays.asList(text));
        }
        return text;
    }

