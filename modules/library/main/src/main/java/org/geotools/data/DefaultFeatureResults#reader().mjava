    /**
     * Retrieve a FeatureReader<SimpleFeatureType, SimpleFeature> for this Query
     *
     * @return FeatureReader<SimpleFeatureType, SimpleFeature> for this Query
     * @throws IOException If results could not be obtained
     */
    @Override
    @SuppressWarnings("PMD.CloseResource") // returned, the caller will close
    public FeatureReader<SimpleFeatureType, SimpleFeature> reader() throws IOException {
        FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                ((DataStore) featureSource.getDataStore())
                        .getFeatureReader(query, getTransaction());

        int maxFeatures = query.getMaxFeatures();
        if (maxFeatures != Integer.MAX_VALUE) {
            reader = new MaxFeatureReader<>(reader, maxFeatures);
        }
        if (transform != null) {
            reader = new ReprojectFeatureReader(reader, getSchema(), transform);
        }
        return reader;
    }

