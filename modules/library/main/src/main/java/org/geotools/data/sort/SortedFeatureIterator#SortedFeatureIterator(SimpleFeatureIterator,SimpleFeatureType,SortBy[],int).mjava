    /**
     * Builds a new sorting feature iterator
     *
     * @param iterator The iterator to be sorted
     * @param schema The iterator schema
     * @param sortBy The sorting directives
     * @param maxFeatures The maximum number of features to keep in memory, or a negative number to
     *     use the system default
     * @throws IOException
     */
    public SortedFeatureIterator(
            SimpleFeatureIterator iterator,
            SimpleFeatureType schema,
            SortBy[] sortBy,
            int maxFeatures)
            throws IOException {
        DelegateSimpleFeatureReader reader = new DelegateSimpleFeatureReader(schema, iterator);
        SimpleFeatureReader sorted = new SortedFeatureReader(reader, sortBy, maxFeatures);
        this.delegate = new FeatureReaderFeatureIterator(sorted);
    }

