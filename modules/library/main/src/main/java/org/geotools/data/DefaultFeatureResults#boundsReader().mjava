    /**
     * Retrieve a FeatureReader<SimpleFeatureType, SimpleFeature> for the geometry attributes only,
     * designed for bounds computation
     */
    protected FeatureReader<SimpleFeatureType, SimpleFeature> boundsReader() throws IOException {
        List<String> attributes = new ArrayList<>();
        SimpleFeatureType schema = featureSource.getSchema();
        for (int i = 0; i < schema.getAttributeCount(); i++) {
            AttributeDescriptor at = schema.getDescriptor(i);
            if (at instanceof GeometryDescriptorImpl) attributes.add(at.getLocalName());
        }

        Query q = new Query(query);
        q.setPropertyNames(attributes);
        FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                ((DataStore) featureSource.getDataStore()).getFeatureReader(q, getTransaction());
        int maxFeatures = query.getMaxFeatures();

        if (maxFeatures == Integer.MAX_VALUE) {
            return reader;
        } else {
            return new MaxFeatureReader<>(reader, maxFeatures);
        }
    }

