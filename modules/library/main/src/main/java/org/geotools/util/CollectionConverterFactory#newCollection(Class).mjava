    protected static Collection newCollection(Class target) throws Exception {
        if (target.isInterface()) {
            // try the common ones
            if (List.class.isAssignableFrom(target)) {
                return new ArrayList();
            }
            if (SortedSet.class.isAssignableFrom(target)) {
                return new TreeSet();
            } else if (Set.class.isAssignableFrom(target)) {
                return new HashSet();
            }

            // could not figure out
            return null;
        } else {
            // instantiate directly
            return (Collection) target.newInstance();
        }
    }

