    /**
     * Wrap up an array of features as a FeatureSource.
     * 
     * @param featureArray
     *            Array of features
     * @return FeatureSource
     * 
     * @throws IOException
     * @throws RuntimeException
     */
    public static SimpleFeatureSource source(final SimpleFeature[] featureArray) {
        final SimpleFeatureType featureType;

        if ((featureArray == null) || (featureArray.length == 0)) {
            featureType = FeatureTypes.EMPTY;
        } else {
            featureType = featureArray[0].getFeatureType();
        }

        DataStore arrayStore = new ArrayDataStore(featureArray);

        String typeName = featureType.getTypeName();
        try {
            return arrayStore.getFeatureSource(typeName);
        } catch (IOException e) {
            throw new IllegalStateException("Unable to find "+typeName+" ArrayDataStore in an inconsistent" +
            		"state", e);
        }
    }

