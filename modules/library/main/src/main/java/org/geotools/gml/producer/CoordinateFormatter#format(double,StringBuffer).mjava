    /**
     * Formats a number with the configured number of decimals
     *
     * @param x
     * @param sb
     */
    public StringBuffer format(double x, StringBuffer sb) {
        String formatted;
        if ((Math.abs(x) >= DECIMAL_MIN && x < DECIMAL_MAX) || x == 0) {
            x = truncate(x);
            long lx = (long) x;
            if (lx == x) {
                formatted = lx + "";
            } else {
                formatted = x + "";
            }
        } else {
            if (forcedDecimal) {
                StringBuffer temp = new StringBuffer();
                coordFormatter.format(x, temp, ZERO);
                formatted = temp.toString();
            } else {
                formatted = truncate(x) + "";
            }
        }
        return sb.append(zeroPad(formatted));
    }

