    /**
     * Retrieve the opacity value of an Expression.
     *
     * @param opacity Expression object
     * @returna double value or 1.0 if unavailable.
     */
    private static double opacity(Expression opacity) {
        if (opacity == null) {
            return 1.0;
        }
        double value = Filters.asDouble(opacity);
        return (Double.isNaN(value) ? 1.0 : value);
    }

