    private double[] getPercentages(FeatureCollection collection, Set[] values) throws IOException {
        Expression prop = getParameters().get(0);
        GroupByVisitor groupBy =
                new GroupByVisitor(Aggregate.COUNT, prop, Arrays.asList(prop), null);
        collection.accepts(groupBy, null);
        @SuppressWarnings("unchecked")
        Map<List, Integer> result = groupBy.getResult().toMap();
        return computePercentages(result, collection.size(), values);
    }

