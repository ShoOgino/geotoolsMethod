    /**
     * Constructor.
     *
     * <p>Note that the {@link MathTransform} must be a 2D affine transform.
     *
     * @param outLocation where to create the world file.
     * @param transform the transformation that we want to write out.
     * @param buffSize size of the buffer to use.
     * @throws IOException in case something bad happens.
     */
    public WorldFileWriter(final File outLocation, final MathTransform transform, int buffSize)
            throws IOException {
        if (outLocation == null)
            throw new NullPointerException(
                    Errors.format(ErrorKeys.NULL_ARGUMENT_$1, "outLocation"));
        checkMathTransform(transform);
        if (transform.getSourceDimensions() != 2 || transform.getTargetDimensions() != 2)
            throw new IllegalArgumentException(
                    Errors.format(
                            ErrorKeys.MISMATCHED_DIMENSION_$3,
                            "transform",
                            transform.getSourceDimensions(),
                            2));
        if (!outLocation.exists())
            if (!outLocation.createNewFile())
                throw new IOException(
                        Errors.format(
                                ErrorKeys.ILLEGAL_ARGUMENT_$1,
                                "Unable to create file " + outLocation));
        if (!outLocation.canWrite() || !outLocation.isFile())
            throw new IllegalArgumentException(
                    Errors.format(ErrorKeys.FILE_DOES_NOT_EXIST_$1, outLocation));
        // create a writer
        write(new BufferedWriter(new FileWriter(outLocation), buffSize), transform);
    }

