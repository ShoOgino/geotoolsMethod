    /**
     * Creates a new GeoServerFeatureSource object.
     *
     * <p>Grabs the following from query:
     *
     * <ul>
     *   <li>typeName - only used if client does not supply
     *   <li>cs - only used if client does not supply
     *   <li>csForce - only used if client does not supply
     *   <li>filter - combined with client filter
     *   <li>propertyNames - combined with client filter (indicate property names that *must* be
     *       included)
     * </ul>
     *
     * Schema is generated based on this information.
     *
     * @param source a FeatureSource
     * @param query Filter used to limit results
     */
    public DefaultView(SimpleFeatureSource source, Query query) throws SchemaException {
        this.source = source;
        this.constraintQuery = query;

        SimpleFeatureType origionalType = source.getSchema();

        CoordinateReferenceSystem cs = null;
        if (query.getCoordinateSystemReproject() != null) {
            cs = query.getCoordinateSystemReproject();
        } else if (query.getCoordinateSystem() != null) {
            cs = query.getCoordinateSystem();
        }
        schema =
                DataUtilities.createSubType(
                        origionalType, query.getPropertyNames(), cs, query.getTypeName(), null);
    }

