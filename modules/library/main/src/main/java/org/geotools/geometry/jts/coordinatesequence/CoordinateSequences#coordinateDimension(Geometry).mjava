    /**
     * Gets the dimension of the coordinates in a {@link Geometry}, by reading it from a component
     * {@link CoordinateSequence}. This will be usually either 2 or 3.
     *
     * @param g a Geometry
     * @return the dimension of the coordinates in the Geometry
     */
    public static int coordinateDimension(Geometry g) {
        // common fast cases
        if (g instanceof CurvedGeometry<?>) {
            return ((CurvedGeometry<?>) g).getCoordinatesDimension();
        }
        if (g instanceof Point) return coordinateDimension(((Point) g).getCoordinateSequence());
        if (g instanceof LineString)
            return coordinateDimension(((LineString) g).getCoordinateSequence());
        if (g instanceof Polygon)
            return coordinateDimension(((Polygon) g).getExteriorRing().getCoordinateSequence());

        // dig down to find a CS
        CoordinateSequence cs = CoordinateSequenceFinder.find(g);
        return coordinateDimension(cs);
    }

