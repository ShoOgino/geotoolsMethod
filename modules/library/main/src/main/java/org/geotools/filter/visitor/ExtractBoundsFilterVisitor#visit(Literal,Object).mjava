    /**
     * Please note we are only visiting literals involved in spatial operations.
     *
     * @param expression a literal expression, hopefully a Geometry or Envelope
     * @param data Incoming BoundingBox (or Envelope or CRS)
     * @return ReferencedEnvelope updated to reflect literal
     */
    @Override
    public Object visit(Literal expression, Object data) {
        ReferencedEnvelope bbox = bbox(data);

        Object value = expression.getValue();
        if (value instanceof Geometry) {

            Geometry geometry = (Geometry) value;
            Envelope bounds = geometry.getEnvelopeInternal();

            if (bbox != null) {
                bbox.expandToInclude(bounds);
                return bbox;
            } else {
                return bbox(bounds);
            }
        } else {
            LOGGER.finer("LiteralExpression ignored!");
        }
        return bbox;
    }

