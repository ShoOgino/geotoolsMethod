    /**
     * Helper method for subclasses to reduce null checks and automatically unpack values from
     * attributes and collections
     *
     * @param expression
     * @param object
     * @return value or null
     */
    @SuppressWarnings("unchecked")
    protected Object eval(org.opengis.filter.expression.Expression expression, Object object) {
        if (expression == null) return null;
        Object value = expression.evaluate(object);

        if (value instanceof Collection) {
            // unpack all elements
            List<Object> list = new ArrayList<Object>();
            for (Object member : (Collection<Object>) value) {
                list.add(Filters.unpack(member));
            }
            return list;
        }

        return Filters.unpack(value);
    }

