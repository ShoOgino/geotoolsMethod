    Expression reproject(
            final Expression expression,
            final CoordinateReferenceSystem propertyCrs,
            boolean forceReprojection) {
        // check for case of section filter being a function
        if (expression instanceof Function) {
            // wrap the function in one that will transform the result
            final Function delegate = (Function) expression;
            return new FunctionReprojector(propertyCrs, delegate);
        } else if (expression instanceof Literal) {
            // second expression is a geometry literal
            Object value = ((Literal) expression).getValue();
            return ff.literal(reproject(value, propertyCrs));
        } else if (forceReprojection) {
            throw new IllegalArgumentException(
                    "Binary geometry filter, but second expression "
                            + "is not a literal or function? (it's a "
                            + expression.getClass()
                            + ")");
        } else {
            // we were not forced to reproject, then return the original expression
            return null;
        }
    }

