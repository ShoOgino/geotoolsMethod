    @Override
    public Object visit(And filter, Object extraData) {
        // drill down and flatten
        List<Filter> filters = collect(filter, And.class, extraData, new ArrayList<>());

        filters = basicAndSimplification(filters);

        filters = extraAndSimplification(extraData, filters);

        // we might end up with an empty list
        if (filters.size() == 0) {
            return Filter.INCLUDE;
        }

        // remove the logic we have only one filter
        if (filters.size() == 1) {
            return filters.get(0);
        }

        return getFactory(extraData).and(filters);
    }

