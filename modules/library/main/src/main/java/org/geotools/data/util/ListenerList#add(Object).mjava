    /**
     * Adds the given listener to this list. Has no effect if an identical listener is already
     * registered.
     *
     * @param listener the listener
     */
    public void add(Object listener) {
        assert listener != null;
        if (size == 0) {
            listeners = new Object[capacity];
        } else {
            // check for duplicates using identity
            for (int i = 0; i < size; ++i) {
                if (listeners[i] == listener) {
                    return;
                }
            }
            // grow array if necessary
            if (size == listeners.length) {
                System.arraycopy(listeners, 0, listeners = new Object[size * 2 + 1], 0, size);
            }
        }

        listeners[size] = listener;
        size++;
    }

