    @SuppressWarnings("rawtypes")
    private int classify(Comparable<?> val) {
        Comparable<?> value = val;
        if (val instanceof Integer) { // convert to double as java is stupid
            value = new Double(((Integer) val).intValue());
        }
        // check each slot and see if: min <= value < max
        int last = min.length - 1;
        for (int i = 0; i <= last; i++) {
            Comparable localMin = this.min[i];
            Comparable localMax = this.max[i];

            if ((localMin == null || localMin.compareTo(value) < 1)
                    && (localMax == null || localMax.compareTo(value) > 0)) {
                return i;
            }
        }
        if (compareTo(max[last], value) == 0) { // if value = max, put it in the last slot
            return last;
        }
        return -1; // value does not fit into any of the provided categories
    }

