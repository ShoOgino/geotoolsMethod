    /**
     * Factory that make the correct decorator for the provided featureSource.
     * 
     * <p>
     * This factory method is public and will be used to create all required
     * subclasses. By comparison the constructors for this class have package
     * visibiliy.
     * </p>
     * 
     * TODO: revisit this - I am not sure I want write access to views
     * (especially if they do reprojection).
     * 
     * @param source
     * @param query
     * 
     * @return @throws
     *         SchemaException
     */
    public static SimpleFeatureSource create(
            SimpleFeatureSource source, Query query)
            throws SchemaException {
        if (source instanceof FeatureLocking) {
            //  return new GeoServerFeatureLocking((FeatureLocking<SimpleFeatureType, SimpleFeature>) source,
            // schema, definitionQuery);
        } else if (source instanceof FeatureStore) {
            //return new GeoServerFeatureStore((SimpleFeatureStore) source, schema,
            // definitionQuery);
        }
        return new DefaultView(source, query);
    }

