    @Override
    public Object visit(Ends ends, Object extraData) {
        Expression expr1 = optimizeTime(ends.getExpression1(), extraData);
        Expression expr2 = optimizeTime(ends.getExpression2(), extraData);

        return getFactory(extraData).ends(expr1, expr2, ends.getMatchAction());
    }

