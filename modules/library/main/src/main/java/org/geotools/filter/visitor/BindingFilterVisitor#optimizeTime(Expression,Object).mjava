    protected Expression optimizeTime(Expression expression, Object extraData) {
        if (expression instanceof Literal) {
            // time based operators try period first,
            Object converted = expression.evaluate(null, Period.class);
            if (converted != null) {
                return ff.literal(converted);
            }

            // ideally this would be Istant, but there is very little
            // in the GT codebase able to deal with instants, so we
            // convert to date, and accept a little overhead to convert from Date to Instant
            // (simple object wrapping, no complex parsing)
            converted = expression.evaluate(null, Date.class);
            if (converted != null) {
                return ff.literal(converted);
            }
        }

        // in case we could not optimize, just duplicate
        return visit(expression, extraData);
    }

