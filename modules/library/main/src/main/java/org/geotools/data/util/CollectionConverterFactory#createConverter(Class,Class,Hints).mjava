    public Converter createConverter(Class source, Class target, Hints hints) {
        if ((Collection.class.isAssignableFrom(source) || source.isArray())
                && (Collection.class.isAssignableFrom(target) || target.isArray())) {

            // both collections?
            if (Collection.class.isAssignableFrom(source)
                    && Collection.class.isAssignableFrom(target)) {
                return CollectionToCollection;
            }

            // both arrays?
            if (source.isArray() && target.isArray()) {
                return ArrayToArray;
            }

            // collection to array?
            if (Collection.class.isAssignableFrom(source) && target.isArray()) {
                return CollectionToArray;
            }

            // array to collection?
            if (source.isArray() && Collection.class.isAssignableFrom(target)) {
                return ArrayToCollection;
            }
        }

        return null;
    }

