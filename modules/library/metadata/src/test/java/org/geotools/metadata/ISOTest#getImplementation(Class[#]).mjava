    /**
     * Returns the implementation class for the specified interface class,
     * or {@code null} if none.
     */
    private static Class<?> getImplementation(final Class<?> type) {
        if (!CodeList.class.isAssignableFrom(type)) {
            String name = type.getName();
            if (name.startsWith(INTERFACE_PACKAGE)) {
                name = IMPLEMENTATION_PACKAGE +
                        name.substring(INTERFACE_PACKAGE.length()) + IMPLEMENTATION_SUFFIX;
                try {
                    return Class.forName(name);
                } catch (ClassNotFoundException e) {
                    /*
                     * Found a class which is not implemented. Before to report an error,
                     * check if it is part of the list of known unimplemented interfaces.
                     */
                    if (isImplemented(type)) {
                        fail(e.toString());
                    }
                }
            }
        }
        return null;
    }

