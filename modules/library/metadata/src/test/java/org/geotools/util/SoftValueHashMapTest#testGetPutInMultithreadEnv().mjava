    /**
     * Tests the {@link SoftValueHashMap} with threads performing a sequence of put and get
     * operations on the cache.
     */
    @Test
    public void testGetPutInMultithreadEnv() throws InterruptedException {
        final Random random = getRandom();
        SoftValueHashMap<Integer, Integer> cache = new SoftValueHashMap<>();

        // create threads
        ExecutorService executor = Executors.newFixedThreadPool(NUMTHREADS);

        for (int iter = 0; iter < TEST_CYCLES; iter++) {
            final CountDownLatch latch = new CountDownLatch(NUMTHREADS);
            for (int i = 0; i < NUMTHREADS; i++) {
                Runnable th = new CacheTestThreadGetPut(cache, random, latch);
                executor.execute(th);
            }
            latch.await();
        }

        executor.shutdown();
        executor.awaitTermination(3, TimeUnit.SECONDS);
    }

