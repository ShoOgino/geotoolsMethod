	/**
	 * Deregisters all instances with the same type as the specified one from all categories.
	 *
	 * @param instance The instance to deregister.
	 */
	@SuppressWarnings("unchecked")
	public <T> void deregisterInstance(final T instance) {
		ensureArgumentNonNull("instance", instance);
		streamCategories()
				.filter(category -> category.isAssignableFrom(instance.getClass()))
				// the cast is correct because the filter above only leaves categories that are supertypes of `instance`
				.map(category -> (InstanceRegistry<? super T>) instanceRegistry(category))
				.forEach(registry -> registry.deregister(instance));
	}

