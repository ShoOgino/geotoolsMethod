    /**
     * Helper method for the above.
     */
    private <T> boolean setOrUnsetOrdering(final Class<T> category, final boolean set,
                                           final Predicate<? super T> filter1, final Predicate<? super T> filter2)
    {
        boolean done = false;
        T impl1 = null;
        T impl2 = null;
        Iterable<T> factories = getFactories(category, false)::iterator;
        for (final T factory : factories) {
            if (filter1.test(factory)) impl1 = factory;
            if (filter2.test(factory)) impl2 = factory;
            if (impl1!=null && impl2!=null && impl1!=impl2) {
                if (set) done |=   setOrdering(category, impl1, impl2);
                else     done |= unsetOrdering(category, impl1, impl2);
            }
        }
        return done;
    }

