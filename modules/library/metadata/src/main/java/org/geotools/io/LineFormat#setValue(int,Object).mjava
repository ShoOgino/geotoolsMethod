    /**
     * Sets or adds a value to current line. The index should be in the range 0 to {@link
     * #getValueCount} inclusively. If the index is equals to {@link #getValueCount}, then {@code
     * value} will be appended as a new column after existing data.
     *
     * @param index Index of the value to add or modify.
     * @param value The new value.
     * @throws ArrayIndexOutOfBoundsException If the index is outside the expected range.
     */
    public void setValue(final int index, final Object value)
            throws ArrayIndexOutOfBoundsException {
        if (index > count) {
            throw new ArrayIndexOutOfBoundsException(index);
        }
        if (value == null) {
            throw new IllegalArgumentException(Errors.format(ErrorKeys.NULL_ARGUMENT_$1, "value"));
        }
        if (index == count) {
            if (index == data.length) {
                data = XArray.resize(data, index + Math.min(index, 256));
            }
            count++;
        }
        data[index] = value;
    }

