    /**
     * Writes the specified character.
     *
     * @throws IOException If an I/O error occurs.
     */
    private void doWrite(final int c) throws IOException {
        assert Thread.holdsLock(lock);
        if (newLine && (c != '\n' || !waitLF)) {
            beginNewLine();
        }
        out.write(c);
        if ((newLine = (c == '\r' || c == '\n')) == true) {
            waitLF = (c == '\r');
        }
    }

