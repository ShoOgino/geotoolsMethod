    /**
     * Returns {@code true} if all elements in the specified array are in increasing order. Since
     * {@code NaN} values are unordered, they may appears anywhere in the array; they will be
     * ignored. This method is usefull in assertions.
     */
    public static boolean isSorted(final double[] array) {
        int previous = 0;
        for (int i = 1; i < array.length; i++) {
            final double value = array[i];
            if (value < array[previous]) {
                return false;
            }
            if (!Double.isNaN(value)) {
                previous = i;
            }
        }
        return true;
    }

