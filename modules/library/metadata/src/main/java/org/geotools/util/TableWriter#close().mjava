    /**
     * Flushs the table content and close the underlying stream.
     *
     * @throws IOException if an output operation failed.
     */
    @Override
    public void close() throws IOException {
        synchronized (lock) {
            flush();
            out.close();
        }
    }

