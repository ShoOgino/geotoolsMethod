    /**
     * Returns the content of this set as an array.
     *
     * @param  <T> The type of the array elements.
     * @param array The array where to copy the elements.
     * @return The elements in the given array, or in a new array if the given array doesn't have a
     *     sufficient capacity.
     */
    @Override
    @SuppressWarnings("unchecked")
    public <T> T[] toArray(T[] array) {
        ensureSorted();
        if (array.length < sorted.length) {
            array = (T[]) Array.newInstance(array.getClass().getComponentType(), sorted.length);
        }
        System.arraycopy(sorted, 0, array, 0, sorted.length);
        return array;
    }

