    /**
     * Creates a new metadata source.
     *
     * @param connection The connection to the database.
     */
    public MetadataSource(final Connection connection) {
        this.connection = connection;
        try {
            try (InputStream in = MetaData.class.getResourceAsStream("GeoAPI_to_ISO.properties")) {

                geoApiToIso.load(in);
            }
            try (InputStream in =
                    MetaData.class.getResourceAsStream("CollectionTypes.properties")) {
                // TODO: remove the (!= null) check after the next geoapi update.
                if (in != null) {
                    collectionTypes.load(in);
                }
            }
        } catch (IOException exception) {
            /*
             * Note: we do not expose the checked IOException because in a future
             *       version (when we will be allowed to use J2SE 1.5), it should
             *       disaspear. This is because a J2SE 1.5 enabled version should
             *       use method's annotations instead.
             */
            throw new MetadataException("Can't read resources.", exception); // TODO: localize
        }
        loader = getClass().getClassLoader();
    }

