    /** Tries to avoid insertion of multiple time values. */
    private static void addPeriod(Collection<Object> result, DateRange newRange) {
        for (Iterator it = result.iterator(); it.hasNext(); ) {
            final Object element = it.next();
            if (element instanceof Date) {
                // convert
                final Date local = (Date) element;
                if (newRange.contains(local)) {
                    it.remove();
                }
            } else {
                // convert
                final DateRange local = (DateRange) element;
                if (local.contains(newRange)) return;
                if (newRange.contains(local)) it.remove();
            }
        }
        result.add(newRange);
    }

