    /**
     * Constructs a metadata result from the specified connection.
     *
     * @param connection The connection to the database.
     * @param query The SQL query. The first question mark will be replaced by the table name.
     * @param tableName The table name.
     * @throws SQLException if the statement can't be created.
     */
    public MetadataResult(final Connection connection, final String query, final String tableName)
            throws SQLException {
        this.tableName = tableName;
        final int index = query.indexOf('?');
        if (index < 0) {
            // TODO: localize
            throw new SQLException("Invalid query");
        }
        final StringBuilder buffer = new StringBuilder(query);
        buffer.replace(index, index + 1, tableName);
        statement = connection.prepareStatement(buffer.toString());
    }

