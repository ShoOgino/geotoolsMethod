    // TODO: document that returns true if this establishes new ordering
    private boolean createDirectedEdge(DirectedGraphNode source, DirectedGraphNode target) {
        removeDirectedEdge(target, source);
        boolean sourceNew = source.outgoings.add(target);
        boolean targetNew = target.ingoings.add(source);
        if (sourceNew != targetNew) {
            String message =  MessageFormat
                    .format("Inconsistent edge encountered from [source: {0}] to [target: {1}]:", source, target);
            throw new IllegalStateException(message);
        }
        return targetNew;
    }

