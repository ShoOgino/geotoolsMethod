    /**
     * Checks if the given filename exposes a zip slip vulnerability when it would be extracted to
     * the given path.
     *
     * @param file name of the destination file to check, this should include the directories
     * @param destinationDir directory that the file would be unzipped to
     * @throws java.io.IOException if the given {@code fileName} is found to be vulnerable to zip
     *     slip with respect to the {@code destinationDir}
     */
    public static final void assertNotZipSlipVulnarable(File file, Path destinationDir)
            throws IOException {

        if (!file.toPath().normalize().startsWith(destinationDir)) {
            throw new IOException(
                    String.format(
                            "Bad zip entry: ZipSlip extracting %s to %s", file, destinationDir));
        }
    }

