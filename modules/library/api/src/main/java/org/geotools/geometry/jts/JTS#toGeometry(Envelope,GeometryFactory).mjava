    /**
     * Converts an envelope to a JTS polygon using the given JTS geometry factory.
     * <p>
     * The resulting polygon contains an outer ring with vertices:
     * (x1,y1),(x2,y1),(x2,y2),(x1,y2),(x1,y1)
     *
     * @param envelope The original envelope.
     * @return The envelope as a polygon.
     *
     * @since 2.8
     * @throws IllegalArgumentException if either {@code env} or {@code factory} 
     *         is {@code null}
     */
    public static Polygon toGeometry(final Envelope env, final GeometryFactory factory) {
        ensureNonNull("env", env);
        ensureNonNull("factory", factory);
        
        return factory.createPolygon(factory.createLinearRing(
                new Coordinate[]{
                    new Coordinate(env.getMinX(), env.getMinY()),
                    new Coordinate(env.getMaxX(), env.getMinY()),
                    new Coordinate(env.getMaxX(), env.getMaxY()),
                    new Coordinate(env.getMinX(), env.getMaxY()),
                    new Coordinate(env.getMinX(), env.getMinY())
                }), null);
    }

