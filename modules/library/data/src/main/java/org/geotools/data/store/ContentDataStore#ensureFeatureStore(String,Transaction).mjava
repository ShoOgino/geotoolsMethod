    /**
     * Helper method which gets a feature source ensuring that it is a feature 
     * store as well. If not it throws an IOException.
     * 
     * @param typeName The name of the feature source.
     * @param tx A transaction handle.
     * 
     * @throws IOException If the feature source is not a store.
     *
     */
    protected final ContentFeatureStore ensureFeatureStore(String typeName, Transaction tx) 
        throws IOException {
        
        ContentFeatureSource featureSource = getFeatureSource(typeName,tx);
        if ( !( featureSource instanceof ContentFeatureStore)) {
            throw new IOException(typeName + " is read only" );
        }

        return (ContentFeatureStore) featureSource;
    }

