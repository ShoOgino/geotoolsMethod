    public MemoryFeatureReader(ContentState state, Query query) throws IOException {
        this.state = state;
        featureType = state.getFeatureType();
        String typeName = getFeatureType().getTypeName();
        MemoryDataStore store = (MemoryDataStore) state.getEntry().getDataStore();
        iterator = store.features(typeName).values().iterator();
    }

