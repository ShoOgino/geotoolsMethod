    /**
     * Adds support for a new featureType to MemoryDataStore.
     * 
     * <p>
     * FeatureTypes are stored by typeName, an IOException will be thrown if the requested typeName
     * is already in use.
     * </p>
     *
     * @param featureType SimpleFeatureType to be added
     *
     * @throws IOException If featureType already exists
     *
     * @see org.geotools.data.DataStore#createSchema(org.geotools.feature.SimpleFeatureType)
     */
    public void createSchema(SimpleFeatureType featureType) throws IOException {
        String typeName = featureType.getTypeName();

        Map<String, SimpleFeature> synchedFeatureMap = getFeatureMapSync(typeName);
        
        if (synchedFeatureMap != null) {
            // we have a conflict
            throw new IOException(typeName + " already exists");
        }
            // insertion order preserving map
        ConcurrentSkipListMap<String,SimpleFeature> featureMap = new ConcurrentSkipListMap<String,SimpleFeature>();
        putSchemaAndFeaturesSync(typeName, featureType, featureMap);
    }

