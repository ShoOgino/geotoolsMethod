        @Override
        public int size() {
            try {
                return getCount(query);
            } catch (Exception e) {
                throw new RuntimeException("Failed to count features", e);
            }
        }

