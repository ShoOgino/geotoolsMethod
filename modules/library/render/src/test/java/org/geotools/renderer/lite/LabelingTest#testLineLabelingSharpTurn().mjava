    /**
     * Checks we won't label a feature with a sharp U turn, when using a large font
     *
     * @throws Exception
     */
    public void testLineLabelingSharpTurn() throws Exception {
        FeatureCollection collection = createTightUTurnLineCollection();
        Style style = loadStyle("LineStyleLarge.sld");
        assertNotNull(style);
        MapContext map = new DefaultMapContext(DefaultGeographicCRS.WGS84);
        map.addLayer(collection, style);

        StreamingRenderer renderer = new StreamingRenderer();
        renderer.setContext(map);
        int boundary = 2;
        ReferencedEnvelope env = map.getLayerBounds();
        env =
                new ReferencedEnvelope(
                        env.getMinX() - boundary,
                        env.getMaxX() + boundary,
                        env.getMinY() - boundary,
                        env.getMaxY() + boundary,
                        null);

        BufferedImage image = RendererBaseTest.showRender("U turn label", renderer, 1000, env);
        String refPath =
                "./src/test/resources/org/geotools/renderer/lite/test-data/lineLabelSharpTurn.png";
        // small tolerance
        ImageAssert.assertEquals(new File(refPath), image, 100);
    }

