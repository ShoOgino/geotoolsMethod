    BufferedImage render(FeatureSource[] sources, Style[] styles) throws Exception {
        MapContent map = new MapContent();

        ReferencedEnvelope env = sources[0].getBounds();
        for (int i = 1; i < sources.length; i++) {
            env.expandToInclude(sources[i].getBounds());
        }
        map.getViewport().setBounds(env);
        for (int i = 0; i < sources.length; i++) {
            if (styles[i] != null) {
                map.addLayer(new FeatureLayer(sources[i], styles[i]));
            }
        }

        try {
            StreamingRenderer r = new StreamingRenderer();
            r.setJava2DHints(new RenderingHints(KEY_ANTIALIASING, VALUE_ANTIALIAS_ON));
            r.setMapContent(map);

            return RendererBaseTest.showRender("testPointLabeling", r, 5000, env);
        } finally {
            map.dispose();
        }
    }

