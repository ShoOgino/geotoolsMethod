    @Test
    public void testPolarStereo() throws FactoryException, TransformException {
        CoordinateReferenceSystem polar = CRS.decode("EPSG:3031", true);
        Rectangle screen = new Rectangle(0, 0, 512, 512);
        assertRowCols(
                new ReferencedEnvelope(-10, 10, -90, -85, WGS84),
                polar,
                screen,
                new int[] {16, 16});
        assertRowCols(
                new ReferencedEnvelope(-10, 10, -90, -70, WGS84),
                polar,
                screen,
                new int[] {32, 16});
        assertRowCols(
                new ReferencedEnvelope(-10, 10, -90, -45, WGS84), polar, screen, new int[] {64, 8});
        assertRowCols(
                new ReferencedEnvelope(-10, 10, -90, 0, WGS84), polar, screen, new int[] {128, 8});
        assertRowCols(
                new ReferencedEnvelope(80, 110, -90, 0, WGS84), polar, screen, new int[] {32, 32});
        assertRowCols(
                new ReferencedEnvelope(-110, -80, -90, 0, WGS84),
                polar,
                screen,
                new int[] {32, 32});
    }

