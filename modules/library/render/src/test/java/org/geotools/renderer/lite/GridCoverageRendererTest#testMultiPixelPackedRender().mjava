    @Test
    public void testMultiPixelPackedRender() throws Exception {
        GridCoverage2D coverage = multiPixelPacked.read(null);
        RenderedImage image = coverage.getRenderedImage();
        ReferencedEnvelope mapExtent = ReferencedEnvelope.reference(coverage.getEnvelope2D());
        Rectangle screenSize =
                new Rectangle(
                        image.getMinX(), image.getMinY(), image.getWidth(), image.getHeight());
        AffineTransform w2s = RendererUtilities.worldToScreenTransform(mapExtent, screenSize);
        GridCoverageRenderer renderer =
                new GridCoverageRenderer(
                        coverage.getCoordinateReferenceSystem(), mapExtent, screenSize, w2s);

        Style style = RendererBaseTest.loadStyle(this, "landWaterRaster.sld");
        RasterSymbolizer rasterSymbolizer =
                (RasterSymbolizer)
                        style.featureTypeStyles().get(0).rules().get(0).symbolizers().get(0);
        RenderedImage rendered =
                renderer.renderImage(
                        coverage,
                        rasterSymbolizer,
                        Interpolation.getInstance(Interpolation.INTERP_NEAREST),
                        Color.RED,
                        256,
                        256);

        File reference =
                new File(
                        "src/test/resources/org/geotools/renderer/lite/gridcoverage2d/multiPixelPacked.png");
        ImageAssert.assertEquals(reference, rendered, 0);

        coverage.dispose(true);
    }

