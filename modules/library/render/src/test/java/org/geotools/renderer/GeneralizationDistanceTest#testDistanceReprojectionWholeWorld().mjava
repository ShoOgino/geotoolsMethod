    @Test
    public void testDistanceReprojectionWholeWorld() throws Exception {
        // when APH is disabled the calculation will fail, disabling generalization
        assertDistanceWholeWorldRendering(Collections.emptyMap(), 0);

        // before the fix we would have gotten zero with APH enabled too (failure to compute the
        // distance), but no more, it's using a valid distance for a envelope spanning the planet
        assertDistanceWholeWorldRendering(
                Collections.singletonMap(
                        StreamingRenderer.ADVANCED_PROJECTION_HANDLING_KEY, Boolean.TRUE),
                160300);
    }

