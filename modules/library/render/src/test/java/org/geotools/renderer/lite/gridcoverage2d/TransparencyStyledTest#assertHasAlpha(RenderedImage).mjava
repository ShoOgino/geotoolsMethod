    private void assertHasAlpha(RenderedImage ri) {
        ColorModel cm = ri.getColorModel();
        assertTrue(cm.hasAlpha());
        int numComponents = cm.getNumComponents();
        assertEquals(4, numComponents);

        // Make sure the topleft pixel is transparent
        Raster raster = ri.getTile(0, 0);
        if (cm instanceof ComponentColorModel) {
            // Get the value of the alpha component
            assertEquals(0, raster.getSample(0, 0, numComponents - 1));
        } else if (cm instanceof IndexColorModel) {
            int transparentPixel = ((IndexColorModel) cm).getTransparentPixel();
            assertEquals(transparentPixel, raster.getSample(0, 0, 0));
        }
    }

