    @Test
    public void testCreateDynamicExternalGraphicsVector() throws Exception {
        URL url = StreamingRenderer.class.getResource("test-data/");
        PointSymbolizer symb = sf.createPointSymbolizer();
        ExternalGraphic eg = sf.createExternalGraphic(url + "${icon}", "image/png");
        symb.getGraphic().graphicalSymbols().add(eg);
        sld.setVectorRenderingEnabled(true);

        GraphicStyle2D gs = (GraphicStyle2D) sld.createStyle(feature, symb, range);
        // make sure the style has been recognized as dynamic
        SymbolizerKey key = new SymbolizerKey(symb, range);
        Assert.assertTrue(sld.dynamicSymbolizers.containsKey(key));

        BufferedImage expected =
                ImageIO.read(StreamingRenderer.class.getResource("test-data/draw.png"));
        Assert.assertEquals(expected.getHeight(), gs.getImage().getHeight());
        Assert.assertEquals(expected.getWidth(), gs.getImage().getWidth());
    }

