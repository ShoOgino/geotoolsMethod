    @Test
    public void testFontRangeWithUnrenderableCompositeCharAtStart() {
        Font font = FontCache.getDefaultInstance().getFont("Bitstream Vera Sans");
        Font fallbackFont = FontCache.getDefaultInstance().getFont("Droid Sans Fallback");

        String compositeChar = "\ud859\ude26";
        String remainingChars = "\u5b57\u5b57\u5b57\u5b57\u5b57\u5b57\u5b57\u5b57";

        LabelSplitter splitter = new LabelSplitter();
        String text = compositeChar + remainingChars;
        Font[] fonts = {font, font, font, font, font, fallbackFont};

        List<FontRange> ranges = splitter.buildFontRanges(text, fonts);
        assertEquals(2, ranges.size());

        FontRange startRange = ranges.get(0);
        assertEquals(0, startRange.startChar);
        assertEquals(2, startRange.endChar);
        assertEquals(font, startRange.font);
        assertEquals(compositeChar, startRange.text);

        FontRange endRange = ranges.get(1);
        assertEquals(2, endRange.startChar);
        assertEquals(10, endRange.endChar);
        assertEquals(fallbackFont, endRange.font);
        assertEquals(remainingChars, endRange.text);
    }

