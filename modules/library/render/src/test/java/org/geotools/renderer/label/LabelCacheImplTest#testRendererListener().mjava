    @Test
    public void testRendererListener() throws Exception {
        TextSymbolizer ts = sb.createTextSymbolizer(Color.BLACK, (Font) null, "name");

        AtomicReference<Exception> exception = new AtomicReference<Exception>(null);
        RenderListener listener =
                new RenderListener() {

                    @Override
                    public void featureRenderer(SimpleFeature feature) {
                        // TODO Auto-generated method stub

                    }

                    @Override
                    public void errorOccurred(Exception e) {
                        exception.set(e);
                    }
                };
        cache.addRenderListener(listener);
        SimpleFeature f1 = createFeature("label1", L1);
        cache.put(
                LAYER_ID,
                ts,
                f1,
                new LiteShape2((Geometry) f1.getDefaultGeometry(), null, null, false),
                ALL_SCALES);
        cache.endLayer("layerId", null, null);
        TestGraphics testGraphics = new TestGraphics();
        testGraphics.setRenderingHints(Collections.emptyMap());
        cache.end(testGraphics, new Rectangle(0, 0, 10, 10));
        // got here, did we get the exception
        assertNotNull(exception.get());
    }

