    /** Test painting a request outside the valid area */
    @Test
    public void testPaintOutsideValidArea() throws Exception {

        StyleBuilder sb = new StyleBuilder();
        Style style = sb.createStyle(sb.createRasterSymbolizer());
        final MapContent content = new MapContent();
        content.addLayer(new GridReaderLayer(worldReader, style));

        final StreamingRenderer renderer = new StreamingRenderer();
        CountingRenderListener counter = new CountingRenderListener();
        renderer.addRenderListener(counter);
        renderer.setMapContent(content);
        Map<Object, Object> rendererParams = new HashMap<Object, Object>();
        rendererParams.put(StreamingRenderer.ADVANCED_PROJECTION_HANDLING_KEY, true);
        renderer.setRendererHints(rendererParams);
        BufferedImage image = new BufferedImage(256, 256, BufferedImage.TYPE_4BYTE_ABGR);
        Graphics2D g2d = (Graphics2D) image.getGraphics();
        CoordinateReferenceSystem crs = CRS.decode("EPSG:3572", true);
        ReferencedEnvelope envelope =
                new ReferencedEnvelope(
                        -38207011.656556, -12735670.552185, 12735670.552186, 38207011.656556, crs);
        renderer.paint(g2d, new Rectangle(0, 0, 256, 256), envelope);
        g2d.dispose();
        content.dispose();
        // make sure no errors and no features
        assertEquals(0, counter.errors);
        assertEquals(0, counter.features);
    }

