    /**
     * responsible for actually rendering.
     * 
     * @param obj
     *            Rendering implementation being tested, usually GTRenderer
     * @param g
     *            graphics used
     * @param rect
     *            image area
     * @param bounds
     *            world area
     * @param rendererListener
     *            optional rendererListener, may be null
     */
    private static void render(Object renderingImplementation, Graphics g, Rectangle rect,
            ReferencedEnvelope bounds, RenderListener rendererListener) {
        if (renderingImplementation instanceof GTRenderer) {
            GTRenderer renderer = (GTRenderer) renderingImplementation;
            try {

                if (rendererListener != null) {
                    renderer.addRenderListener(rendererListener);
                }

                if (bounds == null) {
                    renderer.paint((Graphics2D) g, rect, new AffineTransform());
                } else {
                    renderer.paint((Graphics2D) g, rect, bounds);
                }
            } finally {
                if (rendererListener != null) {
                    renderer.removeRenderListener(rendererListener);
                }
            }
        }
    }

