    private void testCoverageStyle(Style style, String styleName) throws IOException {
        GridCoverage2D coverage = createCoverage();
        StreamingRenderer renderer = new StreamingRenderer();

        MapContent context = new MapContent();
        context.addLayer(new GridCoverageLayer(coverage, style));
        renderer.setMapContent(context);

        RenderListener listener =
                new RenderListener() {
                    @Override
                    public void featureRenderer(SimpleFeature feature) {}

                    @Override
                    public void errorOccurred(Exception e) {
                        java.util.logging.Logger.getGlobal()
                                .log(java.util.logging.Level.INFO, "", e);
                        fail("Failed to render coverage");
                    }
                };
        BufferedImage image = RendererBaseTest.renderImage(renderer, env, listener);

        File reference =
                new File(
                        "./src/test/resources/org/geotools/renderer/lite/gridcoverage2d/"
                                + styleName
                                + ".png");

        ImageAssert.assertEquals(reference, image, 0);
    }

