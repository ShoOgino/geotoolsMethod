    @Test
    public void testDefinitionQuerySLDProcessing() throws Exception {
        // final SimpleFeatureCollection ft = createTestDefQueryFeatureCollection();
        // final Style style = createDefQueryTestStyle();
        // FeatureResults results;
        // Envelope envelope = ft.getBounds();
        //
        // // we'll use this as the definition query for the layer
        // Query layerQuery;
        //
        // MapLayer layer = new DefaultMapLayer(ft, style);
        // MapContent map = new DefaultMapContent(new MapLayer[] { layer });
        // map.setAreaOfInterest(envelope);
        // StreamingRenderer renderer = new StreamingRenderer();
        // renderer.setMapContent(map);
        // renderer.setRendererHints(rendererHints);
        //
        // // this is the reader that StreamingRenderer obtains after applying
        // // the mixed filter to a given layer.
        //  FeatureReader<SimpleFeatureType, SimpleFeature> reader;
        // Filter filter = Filter.INCLUDE;
        // FilterFactory ffac = FilterFactoryFinder.createFilterFactory();
        //
        // // test maxFeatures, render just the first 2 features
        // layerQuery = new Query("querytest", filter);
        // layer.setQuery(layerQuery);
        //
        // ArrayList rules = new ArrayList();
        // ArrayList elseRules = new ArrayList();
        // StyleBuilder builder = new StyleBuilder();
        // Rule rule = builder.createRule(builder.createLineSymbolizer());
        // rules.add(rule);
        // rule.setFilter(
        // // JD: remove this null parameter
        // new AbstractFilterImpl(null) {
        // int i = 0;
        //
        // public boolean evaluate(Feature feature) {
        // i++;
        // return i < 3;
        // }
        //
        // // public void accept(FilterVisitor visitor) {
        // // visitor.visit(this);
        // // }
        // public Object accept(
        // org.opengis.filter.FilterVisitor visitor,
        // Object extraData) {
        // return extraData;
        // }
        // });
        // LiteFeatureTypeStyle fts = new LiteFeatureTypeStyle(null, rules,
        // elseRules);
        //
        // results = renderer.queryLayer(layer,
        // new LiteFeatureTypeStyle[] { fts }, envelope,
        // DefaultGeographicCRS.WGS84);
        // assertEquals(2, results.getCount());
        //
        // elseRules.add(rule);
        //
        // fts = new LiteFeatureTypeStyle(null, rules, elseRules);
        // results = renderer.queryLayer(layer,
        // new LiteFeatureTypeStyle[] { fts }, envelope,
        // DefaultGeographicCRS.WGS84);
        // assertEquals(3, results.getCount());

    }

