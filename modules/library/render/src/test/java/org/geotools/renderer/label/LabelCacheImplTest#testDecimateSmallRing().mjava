    @Test
    public void testDecimateSmallRing() throws Exception {
        Font font = sb.createFont("Bitstream Vera Sans", 12);
        TextSymbolizer ts = sb.createTextSymbolizer(Color.BLACK, font, "name");
        ts.getOptions().put(TextSymbolizer.FOLLOW_LINE_KEY, "true");

        AtomicReference<Exception> exception = new AtomicReference<Exception>(null);
        RenderListener listener = new RenderListener() {

            @Override
            public void featureRenderer(SimpleFeature feature) {
                // TODO Auto-generated method stub

            }

            @Override
            public void errorOccurred(Exception e) {
                exception.set(e);
            }
        };
        cache.addRenderListener(listener);
        SimpleFeature f1 = createFeature("label1", L4);
        cache.put(LAYER_ID, ts, f1, new LiteShape2((Geometry) f1.getDefaultGeometry(), null, null,
                false), ALL_SCALES);
        cache.endLayer("layerId", null, null);
        BufferedImage bi = new BufferedImage(10, 10, BufferedImage.TYPE_4BYTE_ABGR);
        Graphics2D graphics = bi.createGraphics();
        cache.end(graphics, new Rectangle(0, 0, 10, 10));
        // got here, no exception
        assertNull(exception.get());
    }

