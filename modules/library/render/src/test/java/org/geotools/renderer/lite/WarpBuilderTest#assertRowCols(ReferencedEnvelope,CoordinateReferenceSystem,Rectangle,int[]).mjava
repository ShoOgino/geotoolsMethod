    private void assertRowCols(
            ReferencedEnvelope sourceEnvelope,
            CoordinateReferenceSystem targetCRS,
            Rectangle screen,
            int[] expectedSplit)
            throws TransformException, FactoryException {
        ReferencedEnvelope targetEnvelope = sourceEnvelope.transform(targetCRS, true);
        AffineTransform at = RendererUtilities.worldToScreenTransform(targetEnvelope, screen);
        MathTransform2D crsTransform =
                (MathTransform2D)
                        CRS.findMathTransform(
                                CRS.getHorizontalCRS(sourceEnvelope.getCoordinateReferenceSystem()),
                                CRS.getHorizontalCRS(targetCRS));
        MathTransform2D screenTransform = new AffineTransform2D(at);
        MathTransform2D fullTranform =
                (MathTransform2D) ConcatenatedTransform.create(crsTransform, screenTransform);
        Rectangle2D.Double sourceDomain =
                new Rectangle2D.Double(
                        sourceEnvelope.getMinX(),
                        sourceEnvelope.getMinY(),
                        sourceEnvelope.getWidth(),
                        sourceEnvelope.getHeight());
        WarpBuilder wb = new WarpBuilder(0.8);
        int[] actualSplit = wb.getRowColsSplit(fullTranform, sourceDomain);
        Assert.assertArrayEquals(expectedSplit, actualSplit);
    }

