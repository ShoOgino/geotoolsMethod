    protected ReferencedEnvelope transformEnvelope(
            ReferencedEnvelope envelope, CoordinateReferenceSystem crs)
            throws TransformException, FactoryException {
        try {
            ProjectionHandler projectionHandler =
                    ProjectionHandlerFinder.getHandler(envelope, crs, isMapWrappingEnabled());
            if (projectionHandler != null) {
                return projectionHandler.getProjectedEnvelope(envelope, crs);
            } else {
                return envelope.transform(crs, true);
            }
        } catch (FactoryException e) {
            return envelope.transform(crs, true);
        }
    }

