    protected double getDouble(Expression ex) {
        if (isConstant(ex) || sample != null) {
            Double result = ex.evaluate(sample, Double.class);
            if (result != null) {
                return result;
            } else {
                return -1;
            }
        } else {
            return -1;
        }
    }

