    /**
     * @param preResample
     * @param doReprojection 
     * @param bkgValues 
     * @return
     * @throws FactoryException 
     */
    private GridCoverage2D reproject(GridCoverage2D preResample, boolean doReprojection, double[] bkgValues) throws FactoryException {
        GridCoverage2D afterReprojection=null;
        try {
            if (doReprojection) {
                // always have a ROI to account for pixels outside the image
                preResample = addRoiIfMissing(preResample);
                afterReprojection = GridCoverageRendererUtilities.reproject(
                        preResample, 
                        destinationCRS,
                        interpolation, 
                        destinationEnvelope,
                        bkgValues,
                        hints);
                if (LOGGER.isLoggable(Level.FINE))
                    LOGGER.fine("Reprojecting to crs " + destinationCRS.toString());
            } else{
                afterReprojection = preResample;
            }
            return afterReprojection;
        }finally{
            if (DEBUG) {
                if(afterReprojection!=null){
                    writeRenderedImage(afterReprojection.getRenderedImage(), "afterReprojection");
                }
            }
        }
    }

