    /**
     * After reprojection or displacement we could have some coverage that are completely out of the
     * destination area (due to numerical issues their source bbox was interesting the request area,
     * but their reprojected version does not). Cleanup the ones completely out.
     */
    public static void removeNotIntersecting(
            List<GridCoverage2D> coverages, GeneralEnvelope destinationEnvelope) {
        for (Iterator<GridCoverage2D> it = coverages.iterator(); it.hasNext(); ) {
            GridCoverage2D coverage = it.next();
            ReferencedEnvelope re = ReferencedEnvelope.reference(coverage.getEnvelope2D());
            if (!destinationEnvelope.intersects(re, false)) {
                it.remove();
            }
        }
    }

