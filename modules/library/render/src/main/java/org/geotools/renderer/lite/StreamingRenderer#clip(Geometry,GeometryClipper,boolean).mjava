    private Geometry clip(Geometry geometry, final GeometryClipper clipper,
            boolean preserveTopology) {
        try {
            return clipper.clip(geometry, !preserveTopology);
        } catch(TopologyException e) {
            // go down to single pixel precision
            GeometryPrecisionReducer reducer = new GeometryPrecisionReducer(new PrecisionModel(1));
            Geometry reduced = reducer.reduce(geometry);
            try {
                return clipper.clip(reduced, !preserveTopology);
            } catch (Exception e2) {
                return geometry;
            }
        }
    }

