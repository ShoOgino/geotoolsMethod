    private GridCoverage2D symbolize(final GridCoverage2D coverage,
            final RasterSymbolizer symbolizer, final double[] bkgValues) {
        // ///////////////////////////////////////////////////////////////////
        //
        // FINAL AFFINE
        //
        // ///////////////////////////////////////////////////////////////////
        final GridCoverage2D preSymbolizer = affine(coverage, bkgValues);
        if (preSymbolizer == null) {
            return null;
        }

        // In case of high oversampling the preSymbolizer image might be huge,
        // consider that case and crop if needed
        GridCoverage2D sanitized = preSymbolizer;
        RenderedImage preSymbolizerImage = preSymbolizer.getRenderedImage();
        RenderedImage preAffineImage = coverage.getRenderedImage();
        if(preSymbolizerImage.getWidth() > (preAffineImage.getWidth() * 2)
                || preSymbolizerImage.getHeight() > (preAffineImage.getHeight() * 2)) {
            sanitized = crop(preSymbolizer, destinationEnvelope, false, bkgValues);
        }
        
        // ///////////////////////////////////////////////////////////////////
        //
        // RASTERSYMBOLIZER
        //
        // ///////////////////////////////////////////////////////////////////
        final GridCoverage2D symbolizerGC;
        if (symbolizer != null) {
            if (LOGGER.isLoggable(Level.FINE)) {
                LOGGER.fine("Applying Raster Symbolizer ");
            }
            final RasterSymbolizerHelper rsp = new RasterSymbolizerHelper(sanitized, this.hints);
            rsp.visit(symbolizer);
            symbolizerGC = (GridCoverage2D) rsp.getOutput();
        } else {
            symbolizerGC = preSymbolizer;
        }
        if (DEBUG) {
            writeRenderedImage( symbolizerGC.getRenderedImage(),"postSymbolizer");
        }
        return symbolizerGC;
    }            	

