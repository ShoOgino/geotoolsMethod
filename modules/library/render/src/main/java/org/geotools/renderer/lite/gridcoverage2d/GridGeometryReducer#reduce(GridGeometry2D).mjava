    /**
     * Reduces the given grid geometry by at most one pixel on each side, in an attempt to make it
     * fit the
     */
    public GridGeometry2D reduce(GridGeometry2D gg) {
        if (gg.getEnvelope().getMaximum(1) > validArea.getMaximum(1)) {
            gg = reduceGridGeometrySide(gg, Side.TOP);
        }
        if (gg.getEnvelope().getMaximum(0) > validArea.getMaximum(0)) {
            gg = reduceGridGeometrySide(gg, Side.RIGHT);
        }
        if (gg.getEnvelope().getMinimum(1) < validArea.getMinimum(1)) {
            gg = reduceGridGeometrySide(gg, Side.BOTTOM);
        }
        if (gg.getEnvelope().getMinimum(0) < validArea.getMinimum(0)) {
            gg = reduceGridGeometrySide(gg, Side.LEFT);
        }

        return gg;
    }

