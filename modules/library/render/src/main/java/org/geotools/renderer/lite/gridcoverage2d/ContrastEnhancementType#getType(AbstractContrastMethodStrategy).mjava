    /**
     * Return a proper {@link ContrastEnhancementType} instance depending on the provided {@link
     * AbstractContrastMethodStrategy}.
     *
     * @param method
     * @return
     */
    public static ContrastEnhancementType getType(AbstractContrastMethodStrategy method) {
        if (method instanceof NormalizeContrastMethodStrategy) {
            String algorithmType = parseAlgorithm(method.getAlgorithm());
            if (algorithmType == null) {
                return NORMALIZE_DEFAULT;
            } else if (NORMALIZE_STRETCH_TO_MINMAX_NAME.equals(algorithmType)) {
                return NORMALIZE_STRETCH_TO_MINMAX;
            } else if (NORMALIZE_CLIP_TO_MINMAX_NAME.equals(algorithmType)) {
                return NORMALIZE_CLIP_TO_MINMAX;
            } else if (NORMALIZE_CLIP_TO_ZERO_NAME.equals(algorithmType)) {
                return NORMALIZE_CLIP_TO_ZERO;
            }
            throw new IllegalArgumentException(
                    Errors.format(ErrorKeys.UNSUPPORTED_ALGORITHM_$1, algorithmType));
        } else if (method instanceof LogarithmicContrastMethodStrategy) {
            return LOGARITHMIC;
        } else if (method instanceof ExponentialContrastMethodStrategy) {
            return EXPONENTIAL;
        } else if (method instanceof org.geotools.styling.HistogramContrastMethodStrategy) {
            return HISTOGRAM;
        } else {
            throw new IllegalArgumentException(
                    Errors.format(ErrorKeys.UNSUPPORTED_METHOD_$1, method));
        }
    }

