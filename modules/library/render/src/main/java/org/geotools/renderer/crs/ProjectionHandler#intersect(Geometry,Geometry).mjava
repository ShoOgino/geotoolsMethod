    private Geometry intersect(Geometry geometry, Geometry mask) {
        // this seems to cause issues to JTS, reduce to
        // single geometry when possible (http://jira.codehaus.org/browse/GEOS-6570)
        if (geometry instanceof GeometryCollection && geometry.getNumGeometries() == 1) {
            geometry = geometry.getGeometryN(0);
        }
        Geometry result;
        try {
            result = geometry.intersection(mask);
        } catch(Exception e1) {
            try {
                result = EnhancedPrecisionOp.intersection(geometry, mask);
            } catch(Exception e2) {
                result = geometry;
            }
        }
        
        // workaround for a JTS bug, sometimes it returns empty results
        // even if the two geometries are indeed intersecting
        if (result.isEmpty() && geometry.intersects(mask)) {
            try {
                result = EnhancedPrecisionOp.intersection(geometry, mask);
            } catch (Exception e2) {
                result = geometry;
            }
        }

        // handle in special way empty intersections
        if (result.isEmpty()) {
            return null;
        } else {
            return result;
        }
    }

