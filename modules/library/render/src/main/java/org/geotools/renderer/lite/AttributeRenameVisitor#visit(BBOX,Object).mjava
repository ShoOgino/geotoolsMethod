    @Override
    public Object visit(BBOX filter, Object extraData) {
        // rename if necessary
        Expression e1 = filter.getExpression1();
        if (e1 instanceof PropertyName) {
            PropertyName pname = (PropertyName) e1;
            String name = pname.getPropertyName();
            if (name != null && name.equals(source)) {
                e1 = ff.property(target);
            }
        }

        // duplicate preserving fast bbox filters
        if (filter instanceof FastBBOX && e1 instanceof PropertyName) {
            FastBBOX fbox = (FastBBOX) filter;
            return new FastBBOX((PropertyName) e1, fbox.getEnvelope(), getFactory(extraData));
        } else {
            double minx = filter.getMinX();
            double miny = filter.getMinY();
            double maxx = filter.getMaxX();
            double maxy = filter.getMaxY();
            String srs = filter.getSRS();
            return getFactory(extraData).bbox(e1, minx, miny, maxx, maxy, srs);
        }
    }

