    /**
     * Checks if two doubles are equal with a small tolerance
     *
     * @param d1
     * @param d2
     * @return
     */
    private static boolean equals(double d1, double d2) {
        return Math.abs(d1 - d2) < 1e-3;
    }

