    private void applyOffset(CoordinateSequence cs, double offset) {
        double lastX = cs.getX(0);
        for (int i = 0; i < cs.size(); i++) {
            double x = cs.getX(i);
            final double distance = Math.abs(x - lastX);
            // heuristic: an object crossing the dateline is not as big as the world, if it
            // is, it's probably something like Antarctica that does not need coordinate rewrapping
            if (distance > wrapLimit && distance < wrapLimit * 1.9) {
                if (offset != 0)
                    offset = 0;
                else
                    offset = wrapLimit * 2;
            }
            if (offset != 0)
                cs.setOrdinate(i, 0, x + offset);
            lastX = x;
        }
    }

