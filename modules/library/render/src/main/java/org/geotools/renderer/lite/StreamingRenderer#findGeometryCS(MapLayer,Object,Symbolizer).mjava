    /**
     * Finds the geometric attribute coordinate reference system.
     * @param drawMe2 
     * 
     * @param f The feature
     * @param s The symbolizer
     * @return The geometry requested in the symbolizer, or the default geometry if none is specified
     */
    private org.opengis.referencing.crs.CoordinateReferenceSystem findGeometryCS(
            MapLayer currLayer, Object drawMe, Symbolizer s) {


        if( drawMe instanceof Feature) {
            Feature f = (Feature) drawMe;
            FeatureType schema = f.getType();

            Expression geometry = s.getGeometry();

            String geomName = null;
            if(geometry instanceof PropertyName) {
                return getAttributeCRS((PropertyName) geometry, schema);
            } else if(geometry == null) {
                return getAttributeCRS(null, schema);
            } else {
                StyleAttributeExtractor attExtractor = new StyleAttributeExtractor();
                geometry.accept(attExtractor, null);
                for(PropertyName name : attExtractor.getAttributes()) {
                    if(name.evaluate(schema) instanceof GeometryDescriptor) {
                        return getAttributeCRS(name, schema);
                    }
                }
            }


        } else if ( currLayer.getSource() != null ) {
            return currLayer.getSource().getCRS();
        }

        return null;
    }

