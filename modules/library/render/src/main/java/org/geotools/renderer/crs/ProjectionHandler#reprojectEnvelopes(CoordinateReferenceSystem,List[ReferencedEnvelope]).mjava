    private void reprojectEnvelopes(CoordinateReferenceSystem queryCRS,
            List<ReferencedEnvelope> envelopes) throws TransformException, FactoryException {
        // reproject the surviving envelopes
        for (int i = 0; i < envelopes.size(); i++) {
            envelopes.set(i, transformEnvelope(envelopes.get(i), queryCRS));
        }
    }

