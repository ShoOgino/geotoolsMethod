    /**
     * Removes initial and final "'" from string. If some "''" is found it will be changed by a
     * single quote "'".
     *
     * @return string without initial and final quote, and "''" replaced by "'".
     */
    protected String removeQuotes(final String source) {

        // checks if it has initial an final quote
        final String quote = "'";
        if (!(source.startsWith(quote) && source.endsWith(quote))) {
            return source;
        }

        int length = source.length();

        // removes the first and last quote
        String result = source.substring(1, length - 1);
        // removes internal quotes
        result = result.replaceAll("''", "'");

        return result;
    }

