    /**
     * Create an AND filter with property between dates of period. 
     * (firstDate<= property <= lastDate)
     * 
     * @return And filter
     * 
     * @throws CQLException
     */
    public And buildPropertyBetweenDates() throws CQLException {
        
        // retrieves date and duration of expression
        Result node = this.resultStack.popResult();
        PeriodNode period = (PeriodNode) node.getBuilt();

        Literal begin = period.getBeginning();
        Literal end = period.getEnding();

        // creates and filter firstDate<= property <= lastDate
        Expression property = this.resultStack.popExpression();

        And filter = filterFactory.and(filterFactory.lessOrEqual(begin,
                property), filterFactory.lessOrEqual(property, end));

        return filter;
    }

