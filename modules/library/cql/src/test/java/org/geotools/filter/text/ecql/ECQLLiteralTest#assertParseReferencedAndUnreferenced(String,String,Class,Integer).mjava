    private void assertParseReferencedAndUnreferenced(
            String wkt, String expectedWkt, Class expectedGeometryClass, Integer srid)
            throws Exception {
        String sridPrefix = srid != null ? ("SRID=" + srid + ";") : "";
        Expression expression = CompilerUtil.parseExpression(language, sridPrefix + wkt);

        assertThat(expression, instanceOf(Literal.class));
        Literal literal = (Literal) expression;
        Object actualGeometry = literal.getValue();
        assertThat(actualGeometry, instanceOf(expectedGeometryClass));

        if (srid != null) {
            assertEqualsReferencedGeometries(expectedWkt, (Geometry) actualGeometry, WGS84);
        } else {
            assertEqualsGeometries(expectedWkt, (Geometry) actualGeometry);
        }
    }

