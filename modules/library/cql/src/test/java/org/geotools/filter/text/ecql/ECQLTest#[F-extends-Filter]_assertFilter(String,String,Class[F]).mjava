    private <F extends Filter> F assertFilter(String ecql, String expected, Class<F> type)
            throws CQLException {
        Filter filter = ECQL.toFilter(ecql);
        Assert.assertEquals(ecql, expected, ECQL.toCQL(filter));

        return type.cast(filter);
    }

