    @Test
    public void testPolarStereo()
            throws FactoryException, TransformException, NoninvertibleTransformException {
        CoordinateReferenceSystem polar =
                CRS.parseWKT(
                        "PROJCS[\"WGS 84 / Antarctic Polar Stereographic\",   GEOGCS[\"WGS 84\",     DATUM[\"World Geodetic System 1984\",       SPHEROID[\"WGS 84\", 6378137.0, 298.257223563, AUTHORITY[\"EPSG\",\"7030\"]],       AUTHORITY[\"EPSG\",\"6326\"]],     PRIMEM[\"Greenwich\", 0.0, AUTHORITY[\"EPSG\",\"8901\"]],     UNIT[\"degree\", 0.017453292519943295],     AXIS[\"Geodetic longitude\", EAST],     AXIS[\"Geodetic latitude\", NORTH],     AUTHORITY[\"EPSG\",\"4326\"]],   PROJECTION[\"Polar Stereographic (variant B)\", AUTHORITY[\"EPSG\",\"9829\"]],   PARAMETER[\"central_meridian\", 0.0],   PARAMETER[\"Standard_Parallel_1\", -71.0],   PARAMETER[\"false_easting\", 0.0],   PARAMETER[\"false_northing\", 0.0],   UNIT[\"m\", 1.0],   AXIS[\"Easting\", \"North along 90 deg East\"],   AXIS[\"Northing\", \"North along 0 deg\"],   AUTHORITY[\"EPSG\",\"3031\"]]");
        Rectangle screen = new Rectangle(0, 0, 512, 512);
        GeneralEnvelope env = new GeneralEnvelope(new double[] {-10, -90}, new double[] {10, -85});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, polar, screen, new int[] {16, 16}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {-10, -90}, new double[] {10, -70});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, polar, screen, new int[] {32, 16}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {-10, -90}, new double[] {10, -45});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, polar, screen, new int[] {64, 8}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {-10, -90}, new double[] {10, 0});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, polar, screen, new int[] {128, 8}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {80, -90}, new double[] {110, 0});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, polar, screen, new int[] {32, 32}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {-110, -90}, new double[] {-80, 0});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, polar, screen, new int[] {32, 32}, new boolean[] {false, true});
    }

