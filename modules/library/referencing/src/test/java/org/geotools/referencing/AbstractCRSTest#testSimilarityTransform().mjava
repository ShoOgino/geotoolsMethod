    /**
     * Tests similarity transform on the example provided in the EPSG projection guide, page 140
     *
     * @throws Exception
     */
    public void testSimilarityTransform() throws Exception {
        // ED50 / UTM zone 31N
        CoordinateReferenceSystem tombak = CRS.decode("EPSG:23031", true);
        // ETRS89 / UTM zone 31N
        CoordinateReferenceSystem ng39 = CRS.decode("EPSG:25831", true);

        // forward
        double[] src = new double[] {300000, 4500000};
        double[] dst = new double[2];
        MathTransform mt = CRS.findMathTransform(tombak, ng39);
        mt.transform(src, 0, dst, 0, 1);

        assertEquals(299905.060, dst[0], 0.001);
        assertEquals(4499796.515, dst[1], 0.001);

        // and back
        mt.inverse().transform(dst, 0, src, 0, 1);
        assertEquals(300000, src[0], 0.001);
        assertEquals(4500000, src[1], 0.001);
    }

