    @Test
    public void testUTM32N()
            throws FactoryException, TransformException, NoninvertibleTransformException {

        CoordinateReferenceSystem utm32n =
                CRS.parseWKT(
                        "PROJCS[\"WGS 84 / UTM zone 32N\",   GEOGCS[\"WGS 84\",     DATUM[\"World Geodetic System 1984\",       SPHEROID[\"WGS 84\", 6378137.0, 298.257223563, AUTHORITY[\"EPSG\",\"7030\"]],       AUTHORITY[\"EPSG\",\"6326\"]],     PRIMEM[\"Greenwich\", 0.0, AUTHORITY[\"EPSG\",\"8901\"]],     UNIT[\"degree\", 0.017453292519943295],     AXIS[\"Geodetic longitude\", EAST],     AXIS[\"Geodetic latitude\", NORTH],     AUTHORITY[\"EPSG\",\"4326\"]],   PROJECTION[\"Transverse_Mercator\", AUTHORITY[\"EPSG\",\"9807\"]],   PARAMETER[\"central_meridian\", 9.0],   PARAMETER[\"latitude_of_origin\", 0.0],   PARAMETER[\"scale_factor\", 0.9996],   PARAMETER[\"false_easting\", 500000.0],   PARAMETER[\"false_northing\", 0.0],   UNIT[\"m\", 1.0],   AXIS[\"Easting\", EAST],   AXIS[\"Northing\", NORTH],   AUTHORITY[\"EPSG\",\"32632\"]]");
        Rectangle screen = new Rectangle(0, 0, 512, 512);
        GeneralEnvelope env = new GeneralEnvelope(new double[] {9 - 40, 0}, new double[] {9, 40});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, utm32n, screen, new int[] {32, 32}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {9 - 20, 0}, new double[] {9, 20});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, utm32n, screen, new int[] {8, 16}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {9 - 10, 0}, new double[] {9, 10});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, utm32n, screen, new int[] {4, 8}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {9 - 5, 0}, new double[] {9, 5});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(env, WGS84, utm32n, screen, new int[] {2, 2}, new boolean[] {false, true});
        env = new GeneralEnvelope(new double[] {9 - 5, 0}, new double[] {9, 5});
        env.setCoordinateReferenceSystem(WGS84);
        assertRowCols(
                new GeneralEnvelope(new double[] {9 - 2, 0}, new double[] {9, 2}),
                WGS84,
                utm32n,
                screen,
                new int[] {1, 1},
                new boolean[] {false, true});
    }

