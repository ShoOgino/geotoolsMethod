    /** Tests transformation from 2D to 3D with Z above the ellipsoid. */
    @Test
    public void test2D_to_3D() throws Exception {
        final CoordinateReferenceSystem sourceCRS = crsFactory.createFromWKT(WKT.NAD27);
        final CoordinateReferenceSystem targetCRS = crsFactory.createFromWKT(WGS84_Z);
        final CoordinateOperation op = opFactory.createOperation(sourceCRS, targetCRS);
        final MathTransform mt = op.getMathTransform();
        if (usingDefaultFactory) {
            assertSame(sourceCRS, op.getSourceCRS());
            assertNotSame(targetCRS, op.getTargetCRS());
        }
        assertFalse(mt.isIdentity());
        assertInterfaced(mt);
        // Note: Expected values below were computed with Geotools (not an external library).
        //       However, it was tested with both Molodenski and Geocentric transformations.
        assertTransformEquals2_3(
                mt, 0, 0, 0.001654978796746043, 0.0012755944235822696, 66.4042236590758);
        assertTransformEquals2_3(
                mt, 5, 8, 5.001262960018587, 8.001271733843957, 100.27929787896574);
    }

