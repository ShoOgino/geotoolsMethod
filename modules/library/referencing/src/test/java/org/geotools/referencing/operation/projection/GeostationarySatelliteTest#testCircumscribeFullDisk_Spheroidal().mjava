    @Test
    public void testCircumscribeFullDisk_Spheroidal() throws TransformException, FactoryException {

        final Envelope2D circumscribed =
                GeostationarySatellite.circumscribeFullDisk(sphericalGeosCRS);
        assertThat(circumscribed, is(notNullValue()));

        final DirectPosition2D p = new DirectPosition2D();

        p.setLocation(circumscribed.getCenterX(), circumscribed.getMaxY());
        sphericalGeosToGeog.transform(p, p);
        assertThat(p, is(notNullValue()));
        geogToSphericalGeos.transform(p, p);
        assertThat(p, is(notNullValue()));

        p.setLocation(circumscribed.getCenterX(), circumscribed.getMinY());
        sphericalGeosToGeog.transform(p, p);
        assertThat(p, is(notNullValue()));
        geogToSphericalGeos.transform(p, p);
        assertThat(p, is(notNullValue()));

        p.setLocation(circumscribed.getMaxX(), circumscribed.getCenterY());
        sphericalGeosToGeog.transform(p, p);
        assertThat(p, is(notNullValue()));
        geogToSphericalGeos.transform(p, p);
        assertThat(p, is(notNullValue()));

        p.setLocation(circumscribed.getMinX(), circumscribed.getCenterY());
        sphericalGeosToGeog.transform(p, p);
        assertThat(p, is(notNullValue()));
        geogToSphericalGeos.transform(p, p);
        assertThat(p, is(notNullValue()));

        // show that bounds of rectangle circumscribing full disk image is not
        // transformable stepping 1 meter outside the X and Y extents along the
        // orthogonal center axes
        final double tickle = 1;
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getCenterX(), circumscribed.getMaxY() + tickle);
                    sphericalGeosToGeog.transform(p, p);
                });
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getCenterX(), circumscribed.getMinY() - tickle);
                    sphericalGeosToGeog.transform(p, p);
                });
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getMinX() - tickle, circumscribed.getCenterY());
                    sphericalGeosToGeog.transform(p, p);
                });
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getMaxX() + tickle, circumscribed.getCenterY());
                    sphericalGeosToGeog.transform(p, p);
                });

        // show that bounds of rectangle circumscribing full disk image is not transformable
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getMaxX(), circumscribed.getMaxY());
                    sphericalGeosToGeog.transform(p, p);
                });
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getMaxX(), circumscribed.getMinY());
                    sphericalGeosToGeog.transform(p, p);
                });
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getMinX(), circumscribed.getMaxY());
                    sphericalGeosToGeog.transform(p, p);
                });
        expectProjectionException(
                () -> {
                    p.setLocation(circumscribed.getMinX(), circumscribed.getMinY());
                    sphericalGeosToGeog.transform(p, p);
                });
    }

