    private GeneralEnvelope transformEnvelope(
            GeneralEnvelope env, CoordinateReferenceSystem targetCRS)
            throws TransformException, OperationNotFoundException, FactoryException {
        CoordinateOperationFactory coordinateOperationFactory =
                CRS.getCoordinateOperationFactory(true);

        final CoordinateOperation operation =
                coordinateOperationFactory.createOperation(WGS84, targetCRS);
        final GeneralEnvelope transformed = CRS.transform(operation, env);
        transformed.setCoordinateReferenceSystem(targetCRS);
        final MathTransform transform = operation.getMathTransform();
        GeneralEnvelope target = new GeneralEnvelope(transformed);
        transform(env, target, transform, 5);
        return target;
    }

