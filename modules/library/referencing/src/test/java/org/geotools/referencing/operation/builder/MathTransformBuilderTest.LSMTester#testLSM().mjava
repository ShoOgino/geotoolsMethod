        public void testLSM() {
            // fill Matrix by calculateLSM()
            this.calculateLSM();

            GeneralMatrix AT = A.clone();
            AT.transpose();

            GeneralMatrix ATP = new GeneralMatrix(AT.getNumRow(), P.getNumCol());
            GeneralMatrix ATPA = new GeneralMatrix(AT.getNumRow(), A.getNumCol());
            GeneralMatrix ATPX = new GeneralMatrix(AT.getNumRow(), 1);
            GeneralMatrix x = new GeneralMatrix(A.getNumCol(), 1);
            ATP.mul(AT, P); // ATP
            ATPA.mul(ATP, A); // ATPA
            ATPX.mul(ATP, X); // ATPX

            GeneralMatrix ATPAI = ATPA.clone();
            ATPAI.invert();

            x.mul(ATPAI, ATPX);

            // assert the ATPAx + ATPX should be 0;.
            x.mul(ATPA, x);
            x.sub(ATPX);

            double[] tx = new double[x.getNumRow()];
            x.getColumn(0, tx);

            for (double v : tx) {
                assertTrue(v < 0.001);
            }
        }

