    /**
     * Returns a single code.
     */
    private ResultSet getSingle(final Object code) throws SQLException {
        assert Thread.holdsLock(this);
        if (querySingle == null || !factory.isConnectionValid(querySingle.getConnection())) {
            querySingle = factory.getConnection().prepareStatement(sqlSingle);
        }
        querySingle.setString(1, code.toString());
        return querySingle.executeQuery();
    }

