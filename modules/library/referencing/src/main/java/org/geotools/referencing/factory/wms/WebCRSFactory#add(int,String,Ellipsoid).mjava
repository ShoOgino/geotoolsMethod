    /**
     * Adds a geographic CRS from the specified parameters.
     *
     * @param code The CRS code.
     * @param name The CRS and datum name.
     * @param ellipsoid The ellipsoid.
     * @throws FactoryException if factories failed to creates the CRS.
     */
    private void add(final int code, final String name, final Ellipsoid ellipsoid)
            throws FactoryException {
        assert Thread.holdsLock(this);
        final Map properties = new HashMap();
        final Citation authority = getAuthority();
        final String text = String.valueOf(code);
        properties.put(IdentifiedObject.NAME_KEY, name);
        properties.put(Identifier.AUTHORITY_KEY, authority);
        final GeodeticDatum datum =
                factories
                        .getDatumFactory()
                        .createGeodeticDatum(properties, ellipsoid, DefaultPrimeMeridian.GREENWICH);

        properties.put(
                IdentifiedObject.IDENTIFIERS_KEY,
                new NamedIdentifier[] {
                    new NamedIdentifier(authority, text),
                    new NamedIdentifier(authority, PREFIX + text)
                });
        final CoordinateReferenceSystem crs =
                factories
                        .getCRSFactory()
                        .createGeographicCRS(properties, datum, DefaultEllipsoidalCS.GEODETIC_2D);
        if (crsMap.put(code, crs) != null) {
            throw new IllegalArgumentException(text);
        }
    }

