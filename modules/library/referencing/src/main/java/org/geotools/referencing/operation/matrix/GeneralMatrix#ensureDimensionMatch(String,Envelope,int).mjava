    /**
     * Convenience method for checking object dimension validity. This method is usually invoked for
     * argument checking.
     *
     * @param name The name of the argument to check.
     * @param envelope The envelope to check.
     * @param dimension The expected dimension for the object.
     * @throws MismatchedDimensionException if the envelope doesn't have the expected dimension.
     */
    private static void ensureDimensionMatch(
            final String name, final Envelope envelope, final int dimension)
            throws MismatchedDimensionException {
        final int dim = envelope.getDimension();
        if (dimension != dim) {
            throw new MismatchedDimensionException(
                    Errors.format(ErrorKeys.MISMATCHED_DIMENSION_$3, name, dim, dimension));
        }
    }

