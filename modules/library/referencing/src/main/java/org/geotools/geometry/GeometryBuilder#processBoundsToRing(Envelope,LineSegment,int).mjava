    private Ring processBoundsToRing(Envelope bounds, LineSegment segment, final int D) {
        DirectPosition one =
                getPositionFactory().createDirectPosition(segment.getStartPoint().getCoordinate());
        one.setOrdinate(D, bounds.getMinimum(D));

        DirectPosition two =
                getPositionFactory().createDirectPosition(segment.getEndPoint().getCoordinate());
        two.setOrdinate(D, bounds.getMinimum(D));

        DirectPosition three = getPositionFactory().createDirectPosition(two.getCoordinate());
        three.setOrdinate(D, bounds.getMaximum(D));

        DirectPosition four = getPositionFactory().createDirectPosition(one.getCoordinate());
        four.setOrdinate(D, bounds.getMaximum(D));

        LineSegment edge1 = getGeometryFactory().createLineSegment(one, two);
        LineSegment edge2 = getGeometryFactory().createLineSegment(two, three);
        LineSegment edge3 = getGeometryFactory().createLineSegment(three, four);
        LineSegment edge4 = getGeometryFactory().createLineSegment(four, one);

        List<OrientableCurve> edges = new ArrayList<>();
        edges.add(createCurve(Collections.singletonList(edge1)));
        edges.add(createCurve(Collections.singletonList(edge2)));
        edges.add(createCurve(Collections.singletonList(edge3)));
        edges.add(createCurve(Collections.singletonList(edge4)));
        return createRing(edges);
    }

