    /**
     * Returns the ordered list of single coordinate reference systems for the specified CRS. The
     * specified CRS doesn't need to be a Geotools implementation.
     *
     * @param crs The coordinate reference system.
     * @return The single coordinate reference systems.
     * @throws ClassCastException if a CRS is neither a {@link SingleCRS} or a {@link CompoundCRS}.
     */
    public static List<SingleCRS> getSingleCRS(final CoordinateReferenceSystem crs) {
        final List<SingleCRS> singles;
        if (crs instanceof DefaultCompoundCRS) {
            singles = ((DefaultCompoundCRS) crs).getSingleCRS();
        } else if (crs instanceof CompoundCRS) {
            final List<CoordinateReferenceSystem> elements =
                    ((CompoundCRS) crs).getCoordinateReferenceSystems();
            singles = new ArrayList<SingleCRS>(elements.size());
            getSingleCRS(elements, singles);
        } else {
            singles = Collections.singletonList((SingleCRS) crs);
        }
        return singles;
    }

