    /**
     * Returns the orthodromic distance between the two specified points using a spherical
     * approximation. This is used for assertions only.
     */
    private double orthodromicDistance(final Point2D source, final Point2D target) {
        final double y1 = toRadians(source.getY());
        final double y2 = toRadians(target.getY());
        final double dx = toRadians(abs(target.getX() - source.getX()) % 360);
        double rho = sin(y1)*sin(y2) + cos(y1)*cos(y2)*cos(dx);
        if (rho > +1) {assert rho <= +(1+EPSILON) : rho; rho = +1;}
        if (rho < -1) {assert rho >= -(1+EPSILON) : rho; rho = -1;}
        return acos(rho) * semiMajor;
    }

