    /** Print the distance between two points using the specified CRS. */
    private void printDistance(
            final CoordinateReferenceSystem crs,
            final DirectPosition position1,
            final DirectPosition position2,
            final TableWriter table)
            throws IOException {
        if (position1 == null) {
            // Note: 'position2' is checked below, *after* blank columns insertion.
            return;
        }
        for (int i = crs.getCoordinateSystem().getDimension(); --i >= 0; ) {
            table.nextColumn();
        }
        if (position2 != null) {
            if (crs instanceof AbstractCRS)
                try {
                    final Measure distance =
                            ((AbstractCRS) crs)
                                    .distance(position1.getCoordinate(), position2.getCoordinate());
                    table.setAlignment(TableWriter.ALIGN_RIGHT);
                    table.write(numberFormat.format(distance.doubleValue()));
                    table.write("  ");
                    table.nextColumn();
                    table.write(String.valueOf(distance.getUnit()));
                    table.setAlignment(TableWriter.ALIGN_LEFT);
                    return;
                } catch (UnsupportedOperationException ignore) {
                    /*
                     * Underlying CRS do not supports distance computation.
                     * Left the column blank.
                     */
                }
        }
        table.nextColumn();
    }

