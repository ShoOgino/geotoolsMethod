    /**
     * Returns the matrix of parameters for Projective transformation. This method should by
     * override for the special cases like affine or similar transformation. The M matrix looks like
     * this:
     *
     * <pre>
     *
     *  [  m00  m01  m02  ]
     *  [  m10  m11  m12  ]
     *  [  m20  m21   1   ]
     * </pre>
     *
     * @return Matrix M
     */
    protected GeneralMatrix getProjectiveMatrix() {
        GeneralMatrix M = new GeneralMatrix(3, 3);

        // double[] param = generateMMatrix();
        double[] param = calculateLSM();
        double[] m0 = {param[0], param[1], param[2]};
        double[] m1 = {param[3], param[4], param[5]};
        double[] m2 = {param[6], param[7], 1};
        M.setRow(0, m0);
        M.setRow(1, m1);
        M.setRow(2, m2);

        return M;
    }

