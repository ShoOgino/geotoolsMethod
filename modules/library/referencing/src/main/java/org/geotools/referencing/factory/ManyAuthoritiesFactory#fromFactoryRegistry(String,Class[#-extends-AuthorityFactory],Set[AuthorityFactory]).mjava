    /**
     * Same as {@link #fromFactoryRegistry(String, Class)}, but returns every factories that fit the
     * given type. The factories are added to the specified set.
     */
    final void fromFactoryRegistry(
            final String authority,
            final Class<? extends AuthorityFactory> type,
            final Set<AuthorityFactory> addTo) {
        for (int i = 0; i < OBJECT_TYPES.length; i++) {
            if (OBJECT_TYPES[i].isAssignableFrom(type)) {
                final AuthorityFactory factory;
                try {
                    factory = fromFactoryRegistry(authority, FACTORY_TYPES[i]);
                } catch (FactoryRegistryException e) {
                    // No factory for the given authority. It may be normal.
                    continue;
                }
                if (!exclude(factory)) {
                    addTo.add(factory);
                }
            }
        }
    }

