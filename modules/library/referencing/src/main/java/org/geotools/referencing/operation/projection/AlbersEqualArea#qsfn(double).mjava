    /**
     * Calculates q, Snyder equation (3-12)
     *
     * @param sinphi sin of the latitude q is calculated for
     * @return q from Snyder equation (3-12)
     */
    private double qsfn(final double sinphi) {
        final double one_es = 1 - excentricitySquared;
        if (excentricity >= EPSILON) {
            final double con = excentricity * sinphi;
            return (one_es
                    * (sinphi / (1. - con * con)
                            - (0.5 / excentricity) * log((1. - con) / (1. + con))));
        } else {
            return sinphi + sinphi;
        }
    }

