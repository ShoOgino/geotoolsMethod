    /**
     * Calculate the difference between true solar time and mean. The "equation of time" is a term
     * accounting for changes in the time of solar noon for a given location over the course of a
     * year. Earth's elliptical orbit and Kepler's law of equal areas in equal times are the
     * culprits behind this phenomenon. See the <A
     * HREF="http://www.analemma.com/Pages/framesPage.html">Analemma page</A>. Below is a plot of
     * the equation of time versus the day of the year.
     *
     * <P align="center"><img src="doc-files/EquationOfTime.png">
     *
     * @param t number of Julian centuries since J2000.
     * @return Equation of time in minutes of time.
     */
    private static double equationOfTime(final double t) {
        double eps = Math.toRadians(obliquityCorrected(t));
        double l0 = Math.toRadians(sunGeometricMeanLongitude(t));
        double m = Math.toRadians(sunGeometricMeanAnomaly(t));
        double e = eccentricityEarthOrbit(t);
        double y = Math.tan(eps / 2);
        y *= y;

        double sin2l0 = Math.sin(2 * l0);
        double cos2l0 = Math.cos(2 * l0);
        double sin4l0 = Math.sin(4 * l0);
        double sin1m = Math.sin(m);
        double sin2m = Math.sin(2 * m);

        double etime =
                y * sin2l0
                        - 2 * e * sin1m
                        + 4 * e * y * sin1m * cos2l0
                        - 0.5 * y * y * sin4l0
                        - 1.25 * e * e * sin2m;

        return Math.toDegrees(etime) * 4.0;
    }

