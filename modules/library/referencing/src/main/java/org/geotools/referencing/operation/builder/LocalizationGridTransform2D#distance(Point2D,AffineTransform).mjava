    /**
     * Transform a point using the localization grid, transform it back using the inverse of the
     * specified affine transform, and returns the distance between the source and the resulting
     * point. This is used for assertions only.
     *
     * @param index The source point to test.
     * @param tr The affine transform to test.
     * @return The distance in grid coordinate. Should be close to 0.
     */
    private double distance(final Point2D index, final AffineTransform tr) {
        try {
            Point2D geoCoord = transform(index, null);
            geoCoord = tr.inverseTransform(geoCoord, geoCoord);
            return geoCoord.distance(index);
        } catch (TransformException | NoninvertibleTransformException exception) {
            // Should not happen
            throw new AssertionError(exception);
        } // Not impossible. What should we do? Open question...
    }

