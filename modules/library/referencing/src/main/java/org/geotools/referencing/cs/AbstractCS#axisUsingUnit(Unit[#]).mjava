    /**
     * Returns all axis in the specified unit. This method is used for implementation of {@code
     * usingUnit} methods in subclasses.
     *
     * @param unit The unit for the new axis.
     * @return New axis using the specified unit, or {@code null} if current axis fits.
     * @throws IllegalArgumentException If the specified unit is incompatible with the expected one.
     * @see DefaultCartesianCS#usingUnit
     * @see DefaultEllipsoidalCS#usingUnit
     */
    final CoordinateSystemAxis[] axisUsingUnit(final Unit<?> unit) throws IllegalArgumentException {
        CoordinateSystemAxis[] newAxis = null;
        for (int i = 0; i < axis.length; i++) {
            CoordinateSystemAxis a = axis[i];
            if (!unit.equals(a.getUnit())) {
                DefaultCoordinateSystemAxis converted;
                if (a instanceof DefaultCoordinateSystemAxis) {
                    converted = (DefaultCoordinateSystemAxis) a;
                } else {
                    converted = new DefaultCoordinateSystemAxis(a);
                    a = converted; // For detecting changes.
                }
                converted = converted.usingUnit(unit);
                if (converted != a) {
                    if (newAxis == null) {
                        newAxis = new CoordinateSystemAxis[axis.length];
                        System.arraycopy(axis, 0, newAxis, 0, i);
                    }
                    newAxis[i] = converted;
                }
            }
        }
        return newAxis;
    }

