    /**
     * Computes the refraction correction angle. The effects of the atmosphere vary with atmospheric
     * pressure, humidity and other variables. Therefore the calculation is approximate. Errors can
     * be expected to increase the further away you are from the equator, because the sun rises and
     * sets at a very shallow angle. Small variations in the atmosphere can have a larger effect.
     *
     * @param zenith The sun zenith angle in degrees.
     * @return The refraction correction in degrees.
     */
    private static double refractionCorrection(final double zenith) {
        final double exoatmElevation = 90 - zenith;
        if (exoatmElevation > 85) {
            return 0;
        }
        final double refractionCorrection; // In minute of degrees
        final double te = Math.tan(Math.toRadians(exoatmElevation));
        if (exoatmElevation > 5.0) {
            refractionCorrection =
                    58.1 / te - 0.07 / (te * te * te) + 0.000086 / (te * te * te * te * te);
        } else {
            if (exoatmElevation > -0.575) {
                refractionCorrection =
                        1735.0
                                + exoatmElevation
                                        * (-518.2
                                                + exoatmElevation
                                                        * (103.4
                                                                + exoatmElevation
                                                                        * (-12.79
                                                                                + exoatmElevation
                                                                                        * 0.711)));
            } else {
                refractionCorrection = -20.774 / te;
            }
        }
        return refractionCorrection / 3600;
    }

