    /**
     * Returns {@code true} if the {@linkplain CoordinateOperation coordinate operation} for the
     * specified code is a {@linkplain Projection projection}. The caller must have ensured that the
     * designed operation is a {@linkplain Conversion conversion} before to invoke this method.
     */
    final synchronized boolean isProjection(final String code) throws SQLException {
        final PreparedStatement stmt;
        Boolean projection = (Boolean) codeProjection.get(code);
        if (projection == null) {
            stmt =
                    prepareStatement(
                            "isProjection",
                            "SELECT COORD_REF_SYS_CODE"
                                    + " FROM [Coordinate Reference System]"
                                    + " WHERE PROJECTION_CONV_CODE = ?"
                                    + " AND COORD_REF_SYS_KIND LIKE 'projected%'");
            stmt.setString(1, code);
            try (ResultSet result = stmt.executeQuery()) {
                final boolean found = result.next();
                projection = Boolean.valueOf(found);
                codeProjection.put(code, projection);
            }
        }
        return projection.booleanValue();
    }

