    /**
     * Process instructions from the {@linkplain #in input stream} specified at construction time.
     * All lines are read until the end of stream ({@code [Ctrl-Z]} for input from the keyboard), or
     * until {@link #stop()} is invoked. Non-empty and non-comment lines are given to the {@link
     * #execute} method. Errors are catched and printed to the {@linkplain #err error stream}.
     */
    public void run() {
        try {
            while (!stop) {
                if (prompt != null) {
                    out.write(prompt);
                }
                out.flush();
                line = readLine(in);
                if (line == null) {
                    break;
                }
                try {
                    execute(line);
                } catch (Exception exception) {
                    reportError(exception);
                }
            }
            out.flush();
            stop = false;
        } catch (IOException exception) {
            reportError(exception);
        }
    }

