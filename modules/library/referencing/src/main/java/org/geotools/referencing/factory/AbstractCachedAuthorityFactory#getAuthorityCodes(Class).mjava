    @Override
    public Set<String> getAuthorityCodes(Class type) throws FactoryException {
        @SuppressWarnings("unchecked")
        Set<String> codes = (Set) cache.get(type);
        if (codes == null) {
            try {
                cache.writeLock(type);
                @SuppressWarnings("unchecked")
                Set<String> peek = (Set) cache.peek(type);
                codes = peek;
                if (codes == null) {
                    codes = generateAuthorityCodes(type);
                    cache.put(type, codes);
                }
            } finally {
                cache.writeUnLock(type);
            }
        }
        return codes;
    }

