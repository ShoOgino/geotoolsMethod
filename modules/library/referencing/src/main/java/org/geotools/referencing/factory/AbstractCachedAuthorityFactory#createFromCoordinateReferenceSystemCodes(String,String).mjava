    @Override
    @SuppressWarnings("unchecked")
    public synchronized Set<CoordinateOperation> createFromCoordinateReferenceSystemCodes(
            final String sourceCode, final String targetCode) throws FactoryException {

        final Object key = ObjectCaches.toKey(getAuthority(), sourceCode, targetCode);
        Set operations = (Set) cache.get(key);
        if (operations == null) {
            try {
                cache.writeLock(key);
                operations = (Set) cache.peek(key);
                if (operations == null) {
                    operations = generateFromCoordinateReferenceSystemCodes(sourceCode, targetCode);
                    // can we not trust operationAuthority to return us an unmodifiableSet ?
                    // operations = Collections.unmodifiableSet( operations );

                    cache.put(key, operations);
                }
            } finally {
                cache.writeUnLock(key);
            }
        }
        return operations;
    }

