        public static double qsfn(double sinphi, double e, double one_es) {
                double con;

                if (e >= 1.0e-7) {
                        con = e * sinphi;
                        return (one_es * (sinphi / (1. - con * con) -
                           (.5 / e) * Math.log ((1. - con) / (1. + con))));
                } else
                        return (sinphi + sinphi);
        }

