    /**
     * Constructs affine transform from GCPs and approximate values for calculation. This
     * constructor should be used when the default calculation is divergating.
     *
     * @param vectors GCPs
     * @param affineTrans approximate affine transformation
     */
    public AdvancedAffineBuilder(final List<MappedPosition> vectors, AffineTransform2D affineTrans)
            throws IllegalArgumentException, MismatchedDimensionException,
                    MismatchedReferenceSystemException, FactoryException {
        super.setMappedPositions(vectors);

        /** sets approximate values */
        this.affineTrans = affineTrans;

        AffineToGeometric a2g = new AffineToGeometric(affineTrans);

        sx = a2g.getXScale();
        sy = a2g.getYScale();

        phix = a2g.getXRotation();
        phiy = a2g.getYRotation();
        tx = a2g.getXTranslate();
        ty = a2g.getYTranslate();
    }

