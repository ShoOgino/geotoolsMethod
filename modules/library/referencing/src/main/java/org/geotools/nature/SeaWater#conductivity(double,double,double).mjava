    /**
     * Computes conductivity as a function of salinity, temperature and pressure.
     *
     * @param S Salinity PSS-78 (0 to 42)
     * @param T Temperature ITS-68 (-2 to 40Â°C)
     * @param P Pressure (0 to 10<sup>5</sup> dbar), not including atmospheric pressure.
     * @return Conductivity in mS/cm.
     */
    public static double conductivity(final double S, final double T, final double P) {
        if (!(S < 0.02)) { // use '!' in order to accept NaN
            double XT = T - 15.0;
            double RT = Math.sqrt(S / 35.0); // First approximation
            double SI = sal(RT, XT);
            for (int n = 0; n < 10; n++) { // Iteration loop begin here with a maximum of 10 cycles
                RT += (S - SI) / dsal(RT, XT);
                SI = sal(RT, XT);
                if (Math.abs(SI - S) < 1E-4) break;
            }
            double RTT = polynome(T, PSS78_C) * (RT * RT);
            double AT = PSS78_D[3] * T + PSS78_D[2];
            double BT = (PSS78_D[1] * T + PSS78_D[0]) * T + 1.0;
            double CP = RTT * (BT + polynome(P, PSS78_E) * P);
            BT -= RTT * AT;
            // Solve quadratic equation for C = RT35*RT*(1+C/AR+b)
            double cnd = 0.5 * (Math.sqrt(Math.abs((BT * BT) + 4.0 * AT * CP)) - BT) / AT;
            return cnd * STANDARD_CONDUCTIVITY;
        } else {
            return 0; // Zero salinity trap
        }
    }

