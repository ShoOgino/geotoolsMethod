    /**
     * Computes density as a function of salinity, temperature and pressure.
     *
     * @param S Salinity PSS-78 (0 to 42)
     * @param T Temperature ITS-68 (-2 to 40°C)
     * @param P Pressure in decibars (0 to 10<sup>5</sup> dbar), not including atmospheric pressure.
     * @return Density (kg/m³).
     */
    public static double density(final double S, final double T, double P) {
        P /= 10.0;

        // Pure water density at atmospheric pressure
        final double RHO_0_T_0 = polynome(T, EOS80_At);

        // Sea water density at atmospheric pressure
        final double SR = Math.sqrt(S);
        final double RHO_S_T_0 =
                (EOS80_D * S + polynome(T, EOS80_C) * SR + polynome(T, EOS80_B)) * S + RHO_0_T_0;

        // Compression terms
        final double K_S_T_0 =
                (polynome(T, EOS80_F) + polynome(T, EOS80_G) * SR) * S + polynome(T, EOS80_Et);
        final double K_S_T_P =
                K_S_T_0
                        + ((EOS80_J * SR + polynome(T, EOS80_I)) * S
                                        + polynome(T, EOS80_Ht)
                                        + (polynome(T, EOS80_Kt) + polynome(T, EOS80_M) * S) * P)
                                * P;
        return RHO_S_T_0 / (1.0 - P / K_S_T_P);
    }

