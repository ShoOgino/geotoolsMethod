    /**
     * Suggests a low-level factory group. If {@code crs} is {@code true}, then this method will try
     * to fetch the factory group from the CRS authority factory. Otherwise it will try to fetch the
     * factory group from the CS authority factory. This is used by subclasses like {@link
     * TransformedAuthorityFactory} that need low-level access to factories. Do not change this
     * method into a public one; we would need a better API before to do such thing.
     */
    final ReferencingFactoryContainer getFactoryContainer(final boolean crs) {
        final AuthorityFactory factory;
        if (crs) {
            factory = crsFactory;
        } else {
            factory = csFactory;
        }
        if (factory instanceof DirectAuthorityFactory) {
            return ((DirectAuthorityFactory) factory).factories;
        }
        // No predefined factory group. Create one.
        if (factories == null) {
            factories = ReferencingFactoryContainer.instance(hints());
        }
        return factories;
    }

