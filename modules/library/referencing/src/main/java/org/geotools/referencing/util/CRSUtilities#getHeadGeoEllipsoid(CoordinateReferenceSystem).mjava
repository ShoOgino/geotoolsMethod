    /**
     * Returns the ellipsoid used by the specified coordinate reference system, providing that the
     * two first dimensions use an instance of {@link GeographicCRS}. Otherwise (i.e. if the two
     * first dimensions are not geographic), returns {@code null}.
     *
     * @param crs The coordinate reference system for which to get the ellipsoid.
     * @return The ellipsoid in the given CRS, or {@code null} if none.
     */
    public static Ellipsoid getHeadGeoEllipsoid(CoordinateReferenceSystem crs) {
        while (!(crs instanceof GeographicCRS)) {
            final List<CoordinateReferenceSystem> c = getComponents(crs);
            if (c == null) {
                return null;
            }
            crs = c.get(0);
        }
        return ((GeographicCRS) crs).getDatum().getEllipsoid();
    }

