    /**
     * Fills P matrix for m = (A<sup>T</sup>PA)<sup>-1</sup> A<sup>T</sup>Px' equation
     *
     * @throws MissingInfoException if accuracy is not defined.
     */
    protected void fillPMatrix() throws MissingInfoException {
        this.P =
                new GeneralMatrix(getMappedPositions().size() * 2, getMappedPositions().size() * 2);

        for (int i = 0; i < getMappedPositions().size(); i = i + 2) {
            if (Double.compare((getMappedPositions().get(i).getAccuracy()), Double.NaN) == 0) {
                throw new MissingInfoException("Accuracy has to be defined for all points");
            }

            // weight for x
            P.setElement(i, i, 1 / getMappedPositions().get(i).getAccuracy());
            // weight for y
            P.setElement(i + 1, i + 1, 1 / getMappedPositions().get(i).getAccuracy());
        }
    }

