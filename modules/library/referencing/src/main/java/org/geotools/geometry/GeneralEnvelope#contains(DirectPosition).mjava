    /**
     * Tests if a specified coordinate is inside the boundary of this envelope.
     *
     * <p>This method assumes that the specified point uses the same CRS than this envelope. For
     * performance reason, it will no be verified unless J2SE assertions are enabled.
     *
     * @param position The point to text.
     * @return {@code true} if the specified coordinates are inside the boundary of this envelope;
     *     {@code false} otherwise.
     * @throws MismatchedDimensionException if the specified point doesn't have the expected
     *     dimension.
     */
    public boolean contains(final DirectPosition position) throws MismatchedDimensionException {
        ensureNonNull("position", position);
        final int dim = ordinates.length / 2;
        AbstractDirectPosition.ensureDimensionMatch("point", position.getDimension(), dim);
        assert equalsIgnoreMetadata(crs, position.getCoordinateReferenceSystem()) : position;
        for (int i = 0; i < dim; i++) {
            final double value = position.getOrdinate(i);
            if (!(value >= ordinates[i])) return false;
            if (!(value <= ordinates[i + dim])) return false;
            // Use '!' in order to take 'NaN' in account.
        }
        return true;
    }

