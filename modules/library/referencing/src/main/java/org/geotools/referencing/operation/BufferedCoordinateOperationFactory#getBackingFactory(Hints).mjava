    /** Returns a backing factory from the specified hints. */
    private static CoordinateOperationFactory getBackingFactory(final Hints hints) {
        for (final CoordinateOperationFactory candidate :
                ReferencingFactoryFinder.getCoordinateOperationFactories(hints)) {
            if (!(candidate instanceof BufferedCoordinateOperationFactory)) {
                return candidate;
            }
        }
        // The following is likely to thrown a FactoryNotFoundException,
        // which is the intended behavior.
        return ReferencingFactoryFinder.getCoordinateOperationFactory(hints);
    }

