    private URL getRESTurl(String baseUrl, TileIdentifier tileIdentifier) throws RuntimeException {
        String tileMatrix = service.getTileMatrix(tileIdentifier.getZ()).getIdentifier();

        baseUrl = baseUrl.replace("{TileMatrixSet}", service.getTileMatrixSetName());
        baseUrl = baseUrl.replace("{TileMatrix}", "" + tileMatrix);
        baseUrl = baseUrl.replace("{TileCol}", "" + tileIdentifier.getX());
        baseUrl = baseUrl.replace("{TileRow}", "" + tileIdentifier.getY());

        baseUrl = replaceToken(baseUrl, "time",
                service.getDimensions().get(WMTSTileService.DIMENSION_TIME));

        LOGGER.fine("Requesting tile " + tileIdentifier.getCode());

        try {
            return new URL(baseUrl);
        } catch (MalformedURLException e) {
            // I'm pretty sure this never happens!
            throw new RuntimeException(e);
        }
    }

