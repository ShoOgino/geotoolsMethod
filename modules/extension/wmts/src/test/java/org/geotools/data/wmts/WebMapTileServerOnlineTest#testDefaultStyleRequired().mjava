    /*
     * ESRI ArcGis Servers require that the style is named and not left blank. Sadly the WMTS specification agrees with them.
     * See GEOT-6017
     */
    @Test
    public void testDefaultStyleRequired() throws Exception {
        URL test = esriWMTS;
        WebMapTileServer wmts = new WebMapTileServer(test);
        wmts.setType(WMTSServiceType.KVP);
        WMTSCapabilities capabilities = wmts.getCapabilities();
        WMTSLayer wmtsLayer = capabilities.getLayer("Toronto");

        TileMatrixSet matrixSet = capabilities.getMatrixSet("default028mm");
        WMTSTileService service =
                new WMTSTileService(
                        test.toExternalForm(), WMTSServiceType.KVP, wmtsLayer, null, matrixSet);

        GetTileRequest request = wmts.createGetTileRequest();
        request.setLayer(wmtsLayer);
        request.setRequestedBBox(service.getBounds());
        request.setRequestedWidth(256);
        request.setRequestedHeight(256);
        request.setCRS(DefaultGeographicCRS.WGS84);
        Set<Tile> tiles = request.getTiles();
        for (Tile tile : tiles) {
            assertTrue(tile.getUrl().toString().contains("style=default"));
        }
    }

