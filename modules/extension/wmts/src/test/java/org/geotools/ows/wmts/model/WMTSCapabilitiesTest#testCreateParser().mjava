    @Test
    public void testCreateParser() throws Exception {
        WMTSCapabilities capabilities =
                createCapabilities("GeoServer_2.2.x/1.0.0/GetCapabilities.xml");
        try {
            Assert.assertEquals("1.0.0", capabilities.getVersion());
            Assert.assertEquals("OGC WMTS", capabilities.getService().getName());
            Assert.assertEquals(
                    "Web Map Tile Service - GeoWebCache", capabilities.getService().getTitle());

            for (int i = 0; i < capabilities.getService().getKeywordList().length; i++) {
                Assert.assertEquals(
                        capabilities.getService().getKeywordList()[i],
                        "OpenGIS WMS Web Map Server".split(" ")[i]);
            }

            WMTSRequest request = capabilities.getRequest();

            OperationType getTile = request.getGetTile();
            Assert.assertNotNull(getTile);

            Assert.assertEquals(110, capabilities.getLayerList().size());

            List<WMTSLayer> layers = capabilities.getLayerList();
            WMTSLayer l0 = layers.get(0);

            Assert.assertEquals("OML_Foreshore", l0.getTitle());
            Assert.assertNull(l0.getParent());
            Assert.assertTrue(
                    l0.getSrs().contains("urn:ogc:def:crs:EPSG::4326")); // case should not matter
            Assert.assertEquals(4, l0.getBoundingBoxes().size());

            Assert.assertEquals(2, l0.getTileMatrixLinks().size());
            TileMatrixSetLink tmsl0 = l0.getTileMatrixLinks().get("EPSG:4326");
            Assert.assertNotNull(tmsl0);
            Assert.assertEquals("EPSG:4326", tmsl0.getIdentifier());
            List<TileMatrixLimits> tmLimits = tmsl0.getLimits();
            Assert.assertNotNull(tmLimits);
            Assert.assertEquals("Bad size: TileMatrixLimits", 22, tmLimits.size());
            TileMatrixLimits tml3 = tmLimits.get(3);
            Assert.assertEquals(1, tml3.getMinrow());
            Assert.assertEquals(1, tml3.getMaxrow());
            Assert.assertEquals(7, tml3.getMincol());
            Assert.assertEquals(7, tml3.getMaxcol());

            Assert.assertEquals("b_road", layers.get(1).getTitle());
            Assert.assertEquals("meridian:b_road", layers.get(1).getName());
            Assert.assertEquals("b_road_polyline", layers.get(20).getTitle());
            Assert.assertEquals("meridian:b_road_polyline", layers.get(20).getName());

            CRSEnvelope bbox = layers.get(1).getBoundingBoxes().get("EPSG:4326");
            Assert.assertNotNull(bbox);
        } catch (Exception e) {
            java.util.logging.Logger.getGlobal().log(java.util.logging.Level.INFO, "", e);
            if ((e.getMessage() != null) && e.getMessage().indexOf("timed out") > 0) {
                // System.err.println("Unable to test - timed out: " + e);
            } else {
                throw (e);
            }
        }
    }

