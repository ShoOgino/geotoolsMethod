    /**
     * Helper method to round ordinate values up or down to a specified resolution. The returned
     * value will be a multiple of the specified resolution.
     *
     * <pre><code>
     * double ordinate = 1234.56;
     * double resolution = 100;
     * double rounded;
     *
     * // this will return 1200
     * rounded = roundOrdinate(ordinate, resolution, false);
     *
     * // this will return 1300
     * rounded = roundOrdinate(ordinate, resolution, true);
     * </code></pre>
     *
     * @param ordinate the ordinate to round up or down.
     * @param resolution the desired resolution
     * @param roundUp true to round up; false to round down
     * @return the rounded ordinate value
     */
    private static double roundOrdinate(double ordinate, double resolution, boolean roundUp) {
        double unsigned = Math.abs(ordinate);
        boolean negative = ordinate < 0.0;
        if (negative) {
            roundUp = !roundUp;
        }
        double rounded;
        if (roundUp) {
            double x = unsigned / resolution;
            int up = (x - (long) x) > EPS ? 1 : 0;
            rounded = resolution * (up + (long) x);
        } else {
            rounded = resolution * (long) (unsigned / resolution);
        }
        return negative ? -rounded : rounded;
    }

