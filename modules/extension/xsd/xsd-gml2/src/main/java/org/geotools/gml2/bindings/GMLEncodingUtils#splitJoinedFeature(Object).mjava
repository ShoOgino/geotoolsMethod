    /** Splits a joined feature into its components */
    public static SimpleFeature[] splitJoinedFeature(Object obj) {
        SimpleFeature feature = (SimpleFeature) obj;
        List<SimpleFeature> features = new ArrayList<>();
        features.add(feature);
        for (int i = 0; i < feature.getAttributeCount(); i++) {
            Object att = feature.getAttribute(i);
            if (att != null && att instanceof SimpleFeature) {
                features.add((SimpleFeature) att);

                // TODO: come up with a better approcach user, use user data or something to mark
                // the attribute as encoded
                feature.setAttribute(i, null);
            }
        }

        return features.toArray(new SimpleFeature[features.size()]);
    }

