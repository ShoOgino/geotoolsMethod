    @Test
    public void testWithCorrectSchemaLocation() throws Exception {
        File schemaFile = File.createTempFile("test", "xsd");
        schemaFile.deleteOnExit();
        try (InputStream in = getClass().getResourceAsStream("feature.xml")) {
            DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
            factory.setNamespaceAware(true);

            Document document = factory.newDocumentBuilder().parse(in);

            // update hte schema location
            String schemaLocation = getClass().getResource("test.xsd").toString();
            document.getDocumentElement()
                    .setAttribute("xsi:schemaLocation", TEST.NAMESPACE + " " + schemaLocation);

            // reserialize the document
            Transformer tx = TransformerFactory.newInstance().newTransformer();
            tx.transform(new DOMSource(document), new StreamResult(schemaFile));
        }
        try (InputStream in = new FileInputStream(schemaFile)) {

            StreamingParser parser =
                    new StreamingParser(new GMLConfiguration(), in, "//TestFeature");

            for (int i = 0; i < 3; i++) {
                SimpleFeature f = (SimpleFeature) parser.parse();
                Assert.assertNotNull(f);

                Assert.assertEquals(i + "", f.getID());
                Assert.assertEquals(i, ((Point) f.getDefaultGeometry()).getX(), 0d);
                Assert.assertEquals(i, ((Point) f.getDefaultGeometry()).getY(), 0d);
                Assert.assertEquals(i, ((Integer) f.getAttribute("count")).intValue());
            }

            Assert.assertNull(parser.parse());
        }
    }

