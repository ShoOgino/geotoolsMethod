    public void endElement(String uri, String localName, String qName)
        throws SAXException {
        //pop the last handler off of the stack
        ElementHandler handler = (ElementHandler) handlers.pop();

        //create a qName object from the string
        String prefix = namespaces.getPrefix(uri);
        QName qualifiedName = prefix != null ? new QName(uri, localName, prefix) : 
            new QName(uri, localName);
        
        handler.endElement(qualifiedName);

        endElementInternal(handler);

        //if the upper most delegating handler, then end the document
        if ( handler instanceof DelegatingHandler && 
                !handlers.isEmpty() && !(handlers.peek() instanceof DelegatingHandler) ) {
            DelegatingHandler dh = (DelegatingHandler) handler;
            dh.endDocument();
            
            //grabbed the parsed value
            dh.getParseNode().setValue(dh.delegate.getParsedObject());
        }
        
        //pop namespace context
        namespaces.popContext();
    }

