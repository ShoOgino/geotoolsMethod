    /**
     * Returns a list of all top level elements that are of a type derived from the type of the
     * specified element.
     *
     * @param element The element.
     * @return All elements which are of a type derived from the type of the specified element.
     */
    public static final List<XSDElementDeclaration> getDerivedElementDeclarations(
            XSDElementDeclaration element) {
        List<XSDElementDeclaration> elements = element.getSchema().getElementDeclarations();
        List<XSDElementDeclaration> derived = new ArrayList<>();

        for (XSDElementDeclaration derivee : elements) {
            if (derivee.equals(element)) {
                continue; // same element
            }

            XSDTypeDefinition type = derivee.getType();

            while (true) {
                if (type.equals(element.getType())) {
                    derived.add(derivee);

                    break;
                }

                if (type.equals(type.getBaseType())) {
                    break;
                }

                type = type.getBaseType();
            }
        }

        return derived;
    }

