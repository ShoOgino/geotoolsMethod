    private URL resolveLocationToResource(String location) {
        // try to resolve it directly
        URL url = xsd.getClass().getResource(location);

        if (url == null) {
            // strip off the filename and do a resource lookup
            String fileName = new File(location).getName();
            url = xsd.getClass().getResource(fileName);
        }

        if (url == null) {
            // try resolving relative to lookupDirectories
            if (lookupDirectories != null) {
                for (String lookup : lookupDirectories) {
                    if (lookup.endsWith("/")) {
                        lookup = lookup.substring(0, lookup.length() - 1);
                    }
                    url = xsd.getClass().getResource(lookup + "/" + location);
                }
            }
        }

        return url;
    }

