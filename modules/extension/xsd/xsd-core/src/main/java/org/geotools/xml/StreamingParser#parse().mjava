    /**
     * Streams the parser to the next element in the instance document which matches the xpath query
     * specified in the contstructor. This method returns null when there are no more objects to
     * stream.
     *
     * @return The next object in the stream, or null if no such object is available.
     */
    public Object parse() {
        if (thread == null) {
            Runnable runnable =
                    new Runnable() {
                        public void run() {
                            try {
                                parser.parse(input, handler);
                            } catch (Exception e) {
                                // close the buffer
                                handler.getBuffer().close();
                                throw new RuntimeException(e);
                            }
                        };
                    };

            thread = new Thread(runnable);
            thread.start();
        }

        return handler.getBuffer().get();
    }

