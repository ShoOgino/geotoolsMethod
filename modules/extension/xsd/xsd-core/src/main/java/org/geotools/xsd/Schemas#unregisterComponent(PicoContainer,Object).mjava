    /**
     * Unregisters a component in the container and all parent containers.
     *
     * @param container The container.
     * @param key The key of the component.
     */
    public static void unregisterComponent(PicoContainer container, final Object key) {
        // go to the top of the hierachy
        while (container.getParent() != null) {
            container = container.getParent();
        }

        container.accept(
                new PicoVisitor() {
                    @Override
                    public Object traverse(Object node) {
                        return null;
                    }

                    @Override
                    public void visitContainer(PicoContainer container) {
                        if (container instanceof MutablePicoContainer) {
                            ((MutablePicoContainer) container).unregisterComponent(key);
                        }
                    }

                    @Override
                    public void visitComponentAdapter(ComponentAdapter adapter) {}

                    @Override
                    public void visitParameter(Parameter parameter) {}
                });
    }

