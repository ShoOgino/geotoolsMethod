    /**
     * Returns a list of all child element declarations of the specified type, no order is
     * guaranteed.
     *
     * <p>The <code>includeParents</code> flag controls if this method should returns those elements
     * defined on parent types.
     *
     * @param type The type
     * @param includeParents flag indicating if parent types should be processed
     * @return A list of @link XSDElementDeclaration objects, one for each child element.
     */
    public static final List getChildElementDeclarations(
            XSDTypeDefinition type, boolean includeParents) {
        List particles = getChildElementParticles(type, includeParents);
        List elements = new ArrayList();

        for (Iterator p = particles.iterator(); p.hasNext(); ) {
            XSDParticle particle = (XSDParticle) p.next();
            XSDElementDeclaration decl = (XSDElementDeclaration) particle.getContent();

            if (decl.isElementDeclarationReference()) {
                decl = decl.getResolvedElementDeclaration();
            }

            elements.add(decl);
        }

        return elements;
    }

