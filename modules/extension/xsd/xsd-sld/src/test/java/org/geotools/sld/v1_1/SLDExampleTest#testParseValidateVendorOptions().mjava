    @Test
    public void testParseValidateVendorOptions() throws Exception {
        String file = "example-sld-vendor-option.xml";
        StyledLayerDescriptor sld = (StyledLayerDescriptor) parse(file);

        // basic drill down
        Assert.assertEquals(1, sld.getStyledLayers().length);
        NamedLayer layer = (NamedLayer) sld.getStyledLayers()[0];
        Assert.assertEquals(1, layer.getStyles().length);
        Style style = layer.getStyles()[0];
        Assert.assertEquals(1, style.featureTypeStyles().size());
        FeatureTypeStyle fts = style.featureTypeStyles().get(0);
        Assert.assertEquals(1, fts.rules().size());
        Rule rule = fts.rules().get(0);
        Assert.assertEquals(4, rule.symbolizers().size());

        // every symbolizer has the vendor option
        PolygonSymbolizer poly = (PolygonSymbolizer) rule.symbolizers().get(0);
        Assert.assertEquals(1, poly.getOptions().size());
        Assert.assertEquals("true", poly.getOptions().get("labelObstacle"));

        LineSymbolizer line = (LineSymbolizer) rule.symbolizers().get(1);
        Assert.assertEquals(1, line.getOptions().size());
        Assert.assertEquals("true", line.getOptions().get("labelObstacle"));

        PointSymbolizer point = (PointSymbolizer) rule.symbolizers().get(2);
        Assert.assertEquals(1, point.getOptions().size());
        Assert.assertEquals("true", point.getOptions().get("labelObstacle"));

        TextSymbolizer text = (TextSymbolizer) rule.symbolizers().get(3);
        Assert.assertEquals(1, text.getOptions().size());
        Assert.assertEquals("100", text.getOptions().get("repeat"));

        // check it passes validation
        List errors = validate(file);
        Assert.assertEquals(0, errors.size());
    }

