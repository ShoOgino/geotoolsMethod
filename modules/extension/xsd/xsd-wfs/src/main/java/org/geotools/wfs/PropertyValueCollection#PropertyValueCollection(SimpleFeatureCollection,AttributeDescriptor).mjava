    public PropertyValueCollection(SimpleFeatureCollection delegate, AttributeDescriptor descriptor) {
        super(null); // we will create the schema later
        this.delegate = delegate;
        this.descriptor = descriptor;

        this.typeMappingProfiles.add(XS.getInstance().getTypeMappingProfile());
        this.typeMappingProfiles.add(GML.getInstance().getTypeMappingProfile());

        // create a new descriptor based on the xml type
        Class<?> binding = descriptor.getType().getBinding();
        AttributeType xmlType = findType(binding);
        if (xmlType == null) {
            throw new RuntimeException("Unable to map attribute " + descriptor.getName()
                    + " to xml type");
        }
        // because simple features don't carry around their namespace, create a descriptor name
        // that actually used the feature type schema namespace
        SimpleFeatureType origionalSchema = delegate.getSchema();

        Name name = new NameImpl(origionalSchema.getName().getNamespaceURI(),
                descriptor.getLocalName());
        AttributeDescriptor newDescriptor = typeFactory.createAttributeDescriptor(xmlType, name,
                descriptor.getMinOccurs(), descriptor.getMaxOccurs(), descriptor.isNillable(),
                descriptor.getDefaultValue());

        SimpleFeatureTypeBuilder builder = new SimpleFeatureTypeBuilder(typeFactory);
        builder.setName(origionalSchema.getName());
        builder.add(newDescriptor);

        this.schema = builder.buildFeatureType();
    }

