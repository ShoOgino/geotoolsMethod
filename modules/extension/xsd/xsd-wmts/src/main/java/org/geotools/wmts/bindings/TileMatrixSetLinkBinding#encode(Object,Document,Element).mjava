    @Override
    public Element encode(Object object, Document document, Element value) throws Exception {
        // This needs its own encode method because otherwise the EMF encoder will mistake
        // the contained wmts:TileMatrixSet for a TileMatrixSetType and try to encode it that
        // way, ending up with an empty element in the document

        Element e = super.encode(object, document, value);

        TileMatrixSetLinkType matrixLink = (TileMatrixSetLinkType) object;

        Element tileMatrixNode = document.createElementNS(WMTS.NAMESPACE, "TileMatrixSet");
        tileMatrixNode.setTextContent(matrixLink.getTileMatrixSet());
        e.appendChild(tileMatrixNode);

        if (matrixLink.getTileMatrixSetLimits() != null) {

            TileMatrixSetLimitsBinding tileMatrixSetLimitsBinding =
                    new TileMatrixSetLimitsBinding(factory);
            e = tileMatrixSetLimitsBinding.encode(matrixLink.getTileMatrixSetLimits(), document, e);
        }

        return e;
    }

