    Object toColorOrNull(Expression expr) {
        Object obj;
        if (expr instanceof Literal) {
            obj = ((Literal) expr).getValue();
            if (obj instanceof Color) {
                return obj;
            }
        }
        obj = toObjOrNull(expr, false);
        if (obj instanceof String && expr instanceof Literal) {
            String str = Util.stripQuotes(obj.toString());
            obj = makeColorIfPossible(str);
        }
        return obj;
    }

