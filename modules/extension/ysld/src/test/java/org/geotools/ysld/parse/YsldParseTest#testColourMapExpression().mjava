    @Test
    public void testColourMapExpression() throws Exception {
        String yaml =
                "raster: \n"
                        + "  color-map:\n"
                        + "    type: values\n"
                        + "    entries:\n"
                        + "    - "
                        + tuple("#ff0000", "1.0", "0", "start")
                        + "\n"
                        + "    - "
                        + tuple("#00ff00", "1.0", "500", "middle")
                        + "\n"
                        + "    - "
                        + tuple("#0000ff", "'${pow(0.75, 1.2)}'", "1000", "end")
                        + "\n"
                        + // Expression containing comma needs to be quoted
                        "";

        StyledLayerDescriptor sld = Ysld.parse(yaml);
        FeatureTypeStyle fs = SLD.defaultStyle(sld).featureTypeStyles().get(0);
        RasterSymbolizer symb = (RasterSymbolizer) fs.rules().get(0).symbolizers().get(0);

        // need to use the geotools.styling interface as it provides the accessors for the entries.
        ColorMap map = (ColorMap) symb.getColorMap();

        assertThat(
                map.getColorMapEntry(2).getOpacity(), function("pow", literal(0.75), literal(1.2)));
    }

