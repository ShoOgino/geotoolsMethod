    /**
     * <q>Converts a pixel from pixel XY coordinates at a specified level of detail [i.e. zoom
     * level] into latitude/longitude WGS-84 coordinates (in degrees).</q>
     *
     * <p>Note that the X and Y coordinates of a "virtual image" that contains all tiles of a given
     * level. They are not the coordinates of a given column or row.
     *
     * @param pixelX X coordinate of the point, in pixels.
     * @param pixelY Y coordinates of the point, in pixels.
     * @param zoomLevel zoom level or "Level of detail", from 1 (lowest detail) to 23 (highest
     *     detail)
     */
    public static double[] pixelXYToLonLat(int pixelX, int pixelY, int zoomLevel) {
        double mapSize = mapSize(zoomLevel);
        double x = (clip(pixelX, 0, mapSize - 1) / mapSize) - 0.5;
        double y = 0.5 - (clip(pixelY, 0, mapSize - 1) / mapSize);

        double latitude = 90 - 360 * Math.atan(Math.exp(-y * 2 * Math.PI)) / Math.PI;
        double longitude = 360 * x;

        return new double[] {longitude, latitude};
    }

