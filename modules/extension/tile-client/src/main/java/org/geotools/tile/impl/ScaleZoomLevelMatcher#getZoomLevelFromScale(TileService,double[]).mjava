    /** Finds out the best fitting zoom-level for a given map-scale. */
    public int getZoomLevelFromScale(TileService service, double[] tempScaleList) {
        double[] scaleList = service.getScaleList();

        // Start with the most detailed zoom-level and search the best-fitting
        // one
        int zoomLevel = scaleList.length - 1;
        getOptimumScaleFromZoomLevel(zoomLevel, service, tempScaleList);

        for (int i = scaleList.length - 2; i >= 0; i--) {
            if (Double.isNaN(scaleList[i])) {
                break;
            }

            if (getScale() > getOptimumScaleFromZoomLevel(i + 1, service, tempScaleList)) {
                zoomLevel = i;
            }
        }

        return zoomLevel;
    }

