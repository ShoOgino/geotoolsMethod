    protected void relate(Node node) {
        Polygon polygon = (Polygon) node.getObject();
        List close = index.query(polygon.getEnvelopeInternal());

        for (Object o : close) {
            Node n = (Node) o;
            Polygon p = (Polygon) n.getObject();

            if (!rel.equal(polygon, p) && rel.related(polygon, p)) {
                Edge edge = builder.buildEdge(node, n);
                builder.addEdge(edge);
                builder.addEdge(edge);
            }
        }
    }

