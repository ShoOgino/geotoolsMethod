    public static Object[] buildPerfectBinaryTree(OptDirectedGraphBuilder builder, int levels) {
        OptDirectedNode root = (OptDirectedNode) builder.buildNode();
        root.setInDegree(0);
        root.setOutDegree(2);
        builder.addNode(root);

        Queue<Graphable> queue = new ArrayDeque<>((int) Math.pow(2, levels + 1));
        queue.add(root);

        // build a complete binary tree
        // number of nodes = 2^(n+1) - 1
        int level = 0;
        while (level < levels) {
            int nnodes = (int) Math.pow(2, level);
            for (int i = 0; i < nnodes; i++) {
                Node n = (Node) queue.remove();

                OptDirectedNode ln = (OptDirectedNode) builder.buildNode();
                if (level < levels - 1) {
                    ln.setInDegree(1);
                    ln.setOutDegree(2);
                } else {
                    ln.setInDegree(1);
                    ln.setOutDegree(0);
                }

                OptDirectedNode rn = (OptDirectedNode) builder.buildNode();
                if (level < levels - 1) {
                    rn.setInDegree(1);
                    rn.setOutDegree(2);
                } else {
                    rn.setInDegree(1);
                    rn.setOutDegree(0);
                }

                Edge le = builder.buildEdge(n, ln);
                Edge re = builder.buildEdge(n, rn);

                builder.addNode(ln);
                builder.addNode(rn);
                builder.addEdge(le);
                builder.addEdge(re);

                queue.add(ln);
                queue.add(rn);
            }
            level++;
        }

        return (new Object[] {root});
    }

