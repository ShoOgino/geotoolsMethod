    /**
     * Create a balanced binary tree and do a normal traversal starting at root. <br>
     * <br>
     * Expected: 1. Every node should be visited. 2. For each level in the tree, each node in the
     * level should be visited before any node in a lower level
     */
    public void test_3() {
        int k = 4;
        Object[] obj = GraphTestUtil.buildPerfectBinaryTree(builder(), k);
        Node root = (Node) obj[0];
        final Map obj2node = (Map) obj[1];

        GraphVisitor initializer =
                new GraphVisitor() {
                    public int visit(Graphable component) {
                        component.setCount(-1);
                        return 0;
                    }
                };

        CountingWalker walker =
                new CountingWalker() {
                    public int visit(Graphable element, GraphTraversal traversal) {
                        element.setCount(getCount());
                        return super.visit(element, traversal);
                    }
                };

        BreadthFirstIterator iterator = createIterator();
        BasicGraphTraversal traversal =
                new BasicGraphTraversal(builder().getGraph(), walker, iterator);
        traversal.init();

        iterator.setSource(root);
        traversal.traverse();

        GraphVisitor visitor =
                new GraphVisitor() {
                    public int visit(Graphable component) {
                        // ensure component visited
                        assertTrue(component.isVisited());

                        int level = component.getObject().toString().length();

                        // check all nodes that are at a lower level in the tree
                        for (Node other : builder().getGraph().getNodes()) {
                            if (other.getObject().toString().length() > level)
                                assertTrue(other.getCount() > component.getCount());
                        }
                        return 0;
                    }
                };

        builder().getGraph().visitNodes(visitor);

        // ensure nodes visited once
        assertTrue(walker.getCount() == Math.pow(2, k + 1) - 1);
    }

