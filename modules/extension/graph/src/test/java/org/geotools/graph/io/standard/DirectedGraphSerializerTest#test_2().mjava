    /**
     * Create a simple graph and disconnect two nodes (remove all edges) then serialize and
     * deserialize. <br>
     * <br>
     * Exepcted: 1. Same graph structure.
     */
    @Test
    public void test_2() {
        final int nnodes = 100;
        Node[] ends = GraphTestUtil.buildNoBifurcations(builder(), nnodes);

        Set<Edge> toRemove = new HashSet<>();
        toRemove.addAll(ends[0].getEdges());
        toRemove.addAll(ends[1].getEdges());

        // disconnect end nodes
        builder().removeEdges(toRemove);

        assertEquals(builder().getGraph().getNodes().size(), nnodes);
        assertEquals(builder().getGraph().getEdges().size(), nnodes - 3);

        try {
            File victim = File.createTempFile("graph", null);
            victim.deleteOnExit();

            serializer().setProperty(SerializedReaderWriter.FILENAME, victim.getAbsolutePath());

            serializer().write(builder().getGraph());

            Graph before = builder().getGraph();
            Graph after = serializer().read();

            // ensure same number of nodes and edges
            assertEquals(before.getNodes().size(), after.getNodes().size());
            assertEquals(before.getEdges().size(), after.getEdges().size());

            GraphVisitor visitor =
                    component -> {
                        Node n = (Node) component;
                        if (n.getID() == 0 || n.getID() == nnodes - 1)
                            assertEquals(0, n.getDegree());
                        else if (n.getID() == 1 || n.getID() == nnodes - 2)
                            assertEquals(1, n.getDegree());
                        else assertEquals(2, n.getDegree());

                        return (0);
                    };
            after.visitNodes(visitor);
        } catch (Exception e) {
            java.util.logging.Logger.getGlobal().log(java.util.logging.Level.INFO, "", e);
            fail();
        }
    }

