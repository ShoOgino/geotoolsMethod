    protected Object visitNestedFilter(Filter filter, Object extraData, String xpath) {
        try {
            FeatureChainedAttributeVisitor nestedMappingsExtractor =
                    new FeatureChainedAttributeVisitor(rootMapping);
            nestedMappingsExtractor.visit(ff.property(xpath), null);
            List<FeatureChainedAttributeDescriptor> attributes =
                    nestedMappingsExtractor.getFeatureChainedAttributes();
            if (attributes.size() >= 1) {
                out.write("(");
                boolean first = true;
                for (FeatureChainedAttributeDescriptor nestedAttrDescr : attributes) {
                    if (first) first = false;
                    else out.write(" OR ");
                    encodeChainedAttribute(filter, xpath, nestedAttrDescr);
                }
                out.write(")");
            }
            return extraData;

        } catch (java.io.IOException ioe) {
            throw new RuntimeException("Problem writing filter: ", ioe);
        } catch (SQLException e) {
            throw new RuntimeException("Problem writing filter: ", e);
        } catch (FilterToSQLException e) {
            throw new RuntimeException("Problem writing filter: ", e);
        }
    }

