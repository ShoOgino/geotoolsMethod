    /**
     * Only used for Joining, to make sure that rows with different foreign id's
     * aren't interpreted as one feature and merged.
     */
    public List<Object> getIdValues(Object source) {   
        List<Object> ids = new ArrayList<Object>();
        FilterAttributeExtractor extractor = new FilterAttributeExtractor();
        mapping.getFeatureIdExpression().accept(extractor, null);
        for (String att : extractor.getAttributeNameSet()) {
            ids.add(peekValue(source, CommonFactoryFinder.getFilterFactory2(null).property( att)));
        }
        
        if (foreignIds != null) {
            ids.addAll(getForeignIdValues(source));
        }
        return ids;
    }

