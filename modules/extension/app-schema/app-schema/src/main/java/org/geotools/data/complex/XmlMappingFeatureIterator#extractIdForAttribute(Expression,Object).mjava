    @Override
    protected String extractIdForAttribute(final Expression idExpression, Object sourceInstance) {
        try {
            if (idExpression instanceof Function) {
                // special handling for functions
                XmlXpathFilterData data =
                        new XmlXpathFilterData(
                                namespaces,
                                xmlResponse.getDoc(),
                                -1,
                                XmlMappingFeatureIterator.createIndexedItemXpathString(
                                        (XmlFeatureTypeMapping) mapping,
                                        xmlResponse,
                                        indexCounter));
                Object value = idExpression.evaluate(data);
                return (value == null ? "" : value.toString());
            } else {
                return XmlXpathUtilites.getSingleXPathValue(
                        mapping.getNamespaces(),
                        createIndexedItemXpathString(
                                        (XmlFeatureTypeMapping) mapping, xmlResponse, indexCounter)
                                + XPATH_SEPARATOR
                                + idXpath,
                        xmlResponse.getDoc());
            }
        } catch (RuntimeException e) {
            if (e.getCause() instanceof JXPathException) {
                // only log info since id is not always compulsory
                LOGGER.info(
                        "Feature id is not mapped for: " + mapping.getTargetFeature().getName());
            } else {
                throw e;
            }
        }
        return null;
    }

