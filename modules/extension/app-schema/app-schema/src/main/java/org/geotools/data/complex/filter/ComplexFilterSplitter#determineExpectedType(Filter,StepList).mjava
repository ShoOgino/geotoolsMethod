    private Class<?> determineExpectedType(Filter filter, StepList xpath) {
        Class<?> expectedType = AttributeDescriptor.class;

        if (filter instanceof BinarySpatialOperator) {
            expectedType = GeometryDescriptor.class;
        } else {
            if (xpath.size() > 0) {
                boolean isXmlAttr = xpath.get(xpath.size() - 1).isXmlAttribute();
                expectedType = (isXmlAttr) ? Name.class : AttributeDescriptor.class;
            }
        }

        return expectedType;
    }

