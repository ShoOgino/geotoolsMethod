    protected SortBy[] unrollSortBy(SortBy[] sortArray) {
        if (sortArray == null) return null;
        ArrayList<SortBy> unrolledSorts = new ArrayList<>();
        FilterFactory2 ff = CommonFactoryFinder.getFilterFactory2(GeoTools.getDefaultHints());
        for (SortBy aSort : sortArray) {
            SortBy newSort =
                    ff.sort(
                            unrollIndex(aSort.getPropertyName(), mapping).getPropertyName(),
                            aSort.getSortOrder());
            unrolledSorts.add(newSort);
        }
        return unrolledSorts.toArray(new SortBy[] {});
    }

