    private AttributeDescriptor getTargetDescriptor(TypeMapping dto, CoordinateReferenceSystem crs)
            throws IOException {
        String prefixedTargetName = dto.getTargetElementName();
        Name targetNodeName = Types.degloseName(prefixedTargetName, namespaces);

        AttributeDescriptor targetDescriptor = typeRegistry.getDescriptor(targetNodeName, crs);
        if (targetDescriptor == null) {
            throw new NoSuchElementException(
                    "descriptor " + targetNodeName + " not found in parsed schema");
        }

        // check if default geometry was set in FeatureTypeMapping
        // NOTE: if a default geometry is already set, it will be overridden
        String defaultGeomXPath = dto.getDefaultGeometryXPath();
        if (defaultGeomXPath != null && !defaultGeomXPath.isEmpty()) {
            targetDescriptor = retypeAddingDefaultGeometry(targetDescriptor, defaultGeomXPath);
        }

        return targetDescriptor;
    }

