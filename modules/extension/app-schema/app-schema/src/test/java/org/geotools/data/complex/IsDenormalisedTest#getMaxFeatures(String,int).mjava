    private int[] getMaxFeatures(String mappingFile, int queryMaxFeatures) throws Exception {


        int dataMaxFeatures = 0;
        int requestMaxFeatures = 0;

        Map<String, Serializable> params = new HashMap<String, Serializable>();
        params.put("dbtype", "app-schema");
        URL url = getClass().getResource(TEST_DATA + mappingFile);
        Assert.assertNotNull(url);
        params.put("url", url.toExternalForm());
        DataAccess<FeatureType, Feature> dataAccess = null;
        try {
            dataAccess = DataAccessFinder.getDataStore(params);
            Assert.assertNotNull(dataAccess);
            FeatureType mappedFeatureType = dataAccess.getSchema(MAPPED_FEATURE);
            Assert.assertNotNull(mappedFeatureType);
            FeatureSource<FeatureType, Feature> source = dataAccess
                    .getFeatureSource(MAPPED_FEATURE);
            FeatureCollection<FeatureType, Feature> features = source.getFeatures();

            MappingFeatureCollection mfc = (MappingFeatureCollection) features;

            // set the requested filter limit
            Query query = mfc.getQuery();
            query.setMaxFeatures(queryMaxFeatures);

            // run the query...
            AbstractMappingFeatureIterator iterator = (AbstractMappingFeatureIterator) features.features();

            // see what the values are after runnign the search
            dataMaxFeatures = iterator.getDataMaxFeatures();
            requestMaxFeatures = iterator.getRequestMaxFeatures();

           


        } finally {
            if (dataAccess != null) {
                dataAccess.dispose();
            }
        }
        return new int[] {requestMaxFeatures, dataMaxFeatures};
    }

