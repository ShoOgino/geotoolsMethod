    /**
     * copies a mapping file and changes some parameters to test absolute paths to data files
     *
     * @param filePathIn the original mapping file
     * @param filePathOut the new mapping file
     */
    private String copyRelativeToAbsolute(String filePathIn, String filePathOut) throws Exception {

        String relativePath;
        String absolutePath = null;

        try (BufferedReader reader = new BufferedReader(new FileReader(filePathIn));
                PrintWriter writer = new PrintWriter(new FileWriter(filePathOut))) {
            String line;
            while ((line = reader.readLine()) != null) {
                // change the file path from relative to absolute
                if (line.trim().startsWith("<value>file:")) {
                    relativePath = line.split("<value>file:|</value>")[1];
                    String resolvedPath = extendFilename(testDir.getPath(), relativePath);
                    absolutePath = (new File(resolvedPath)).getAbsolutePath();
                    line = line.replace(relativePath, absolutePath);
                }
                // in shapefile test, chosen target feature doesn't allow null entry, so we'll take
                // the conditional out
                if (line.trim().startsWith("<OCQL>")) {
                    line =
                            line.replace(
                                    "if_then_else(equalTo(CAT_DESC, 'No Name'), "
                                            + "Expression.Nil , CAT_DESC)",
                                    "CAT_DESC");
                }
                writer.println(line);
            }
        }
        return absolutePath;
    }

