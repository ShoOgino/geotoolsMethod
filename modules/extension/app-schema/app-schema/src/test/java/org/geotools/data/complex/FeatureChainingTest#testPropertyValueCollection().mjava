    @Test
    public void testPropertyValueCollection() {
        // test that the Attribute return from a PropertyValueCollection iteration,
        // when a PropertyName points to a SimpleAttribute in a ComplexFeature,
        // doesn't throws a ClassCastException on getType method

        PropertyName pn = ff.property("gsml:specification/gsml:GeologicUnit/gsml:purpose");

        PropertyDescriptor descriptor = pn.evaluate(mfFeatures.getSchema(), null);

        PropertyValueCollection propertyValueCollection =
                new PropertyValueCollection(mfFeatures, (AttributeDescriptor) descriptor, pn);
        Iterator it = propertyValueCollection.iterator();
        while (it.hasNext()) {
            Attribute attribute = (Attribute) it.next();
            // attribute.getType() was causing Class cast exception to ComplexType
            assertFalse(attribute.getType() instanceof ComplexType);
        }
    }

