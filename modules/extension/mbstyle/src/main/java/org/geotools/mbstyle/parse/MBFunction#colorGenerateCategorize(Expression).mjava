    /**
     * Generates a color expression for the output of this {@link MBFunction} (as a {@link
     * MBFunction.FunctionType#CATEGORICAL} function), based on the provided input Expression.
     *
     * @param expression The expression for the function input
     * @return The expression for the output of this function (as a {@link
     *     MBFunction.FunctionType#CATEGORICAL} function)
     */
    private Expression colorGenerateCategorize(Expression expression) {
        return generateCategorize(
                expression,
                (value, stop) -> {
                    Expression color = parse.color((String) value);
                    if (color == null) {
                        throw new MBFormatException(
                                "Could not convert stop "
                                        + stop
                                        + " color "
                                        + value
                                        + " into a color");
                    }
                    return color;
                });
    }

