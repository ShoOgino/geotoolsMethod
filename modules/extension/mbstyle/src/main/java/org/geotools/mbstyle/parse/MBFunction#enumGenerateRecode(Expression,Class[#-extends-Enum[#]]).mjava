    /**
     * Generates an expression (based on a mapbox enumeration property) for the output of this
     * {@link MBFunction} (as a {@link MBFunction.FunctionType#CATEGORICAL} function), based on the
     * provided input Expression.
     *
     * <p>Note: A mapbox "categorical" function is implemented as a GeoTools "recode" function,
     * hence the name of this method.
     *
     * @param input The expression for the function input
     * @param enumeration The type of the enumeration for the mapbox style property
     * @return The expression for the output of this function (as a {@link
     *     MBFunction.FunctionType#CATEGORICAL} function)
     */
    private Expression enumGenerateRecode(Expression input, Class<? extends Enum<?>> enumeration) {
        List<Expression> parameters = new ArrayList<>();
        parameters.add(input);
        for (Object obj : getStops()) {
            JSONArray entry = parse.jsonArray(obj);
            Object stop = entry.get(0);
            Object value = entry.get(1);
            parameters.add(ff.literal(stop));
            parameters.add(parse.constant(value, enumeration));
        }

        return withFallback(
                ff.function("Recode", parameters.toArray(new Expression[parameters.size()])));
    }

