    @Test
    public void testTextFont() {
        // check the json
        MBLayer fontLayer = fontStyle.layer("text-font");
        assertEquals(
                true, ((JSONObject) fontLayer.getLayout().get("text-font")).containsKey("stops"));
        JSONArray stops =
                (JSONArray) ((JSONObject) fontLayer.getLayout().get("text-font")).get("stops");
        assertEquals("Apple-Chancery", ((JSONArray) ((JSONArray) stops.get(0)).get(1)).get(0));

        // check the SLD
        List<FeatureTypeStyle> featureTypeFont = fontLayer.transformInternal(fontStyle);
        TextSymbolizer text =
                (TextSymbolizer) featureTypeFont.get(0).rules().get(0).symbolizers().get(0);
        Font font = text.fonts().get(0);
        Expression family = font.getFamily().get(0);
        assertThat(family, instanceOf(FontAlternativesFunction.class));
        FontAlternativesFunction fontAlternatives = (FontAlternativesFunction) family;
        assertThat(
                firstParameter(fontAlternatives, MapBoxFontBaseNameFunction.class),
                instanceOf(MapBoxFontBaseNameFunction.class));
        MapBoxFontBaseNameFunction baseNameFunction =
                firstParameter(fontAlternatives, MapBoxFontBaseNameFunction.class);
        assertEquals(
                "Apple-Chancery",
                firstParameter(baseNameFunction, CategorizeFunction.class)
                        .getParameters()
                        .get(1)
                        .toString());
        // weight
        Expression weight = font.getWeight();
        assertThat(weight, instanceOf(MapBoxFontWeightFunction.class));
        MapBoxFontWeightFunction fontWeight = (MapBoxFontWeightFunction) weight;
        assertEquals(
                "Apple-Chancery",
                firstParameter(fontWeight, CategorizeFunction.class)
                        .getParameters()
                        .get(1)
                        .toString());
        // style
        Expression style = font.getStyle();
        assertThat(style, instanceOf(MapBoxFontStyleFunction.class));

        assertEquals(
                "Apple-Chancery",
                firstParameter(fontWeight, CategorizeFunction.class)
                        .getParameters()
                        .get(1)
                        .toString());
    }

