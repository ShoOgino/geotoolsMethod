    /**
     * Returns the first style associated to the layer at <code>layerIndex</code>. An exception will
     * be thrown if the layer is neither a {@link UserLayer} nor a {@link NamedLayer}.
     *
     * @param sld The full SLD style
     * @param layerIndex The layer to be considered for style extraction
     * @return The first associated style
     */
    public static Style getStyle(StyledLayerDescriptor sld, int layerIndex) {
        StyledLayer styledLayer = sld.layers().get(layerIndex);
        if (styledLayer instanceof UserLayer) {
            return ((UserLayer) styledLayer).getUserStyles()[0];
        } else if (styledLayer instanceof NamedLayer) {
            return ((NamedLayer) styledLayer).getStyles()[0];
        } else {
            throw new RuntimeException("Layer is neither a user layer nor a named layer");
        }
    }

