    /** Test ENV Expression evaluation on channelName, with default and assigned value. */
    @Test
    public void testRGBChannelSelectionExpression() {
        final RasterSymbolizerBuilder rsb = new RasterSymbolizerBuilder();
        final ChannelSelectionBuilder cs = rsb.channelSelection();
        cs.red().channelName(ff.function("env", ff.literal("B1"), ff.literal("BAND1")));
        cs.green().channelName("BAND3");
        cs.blue().channelName("BAND5");
        Style style = rsb.buildStyle();

        StyleCollector collector = new StyleCollector();
        style.accept(collector);
        assertSimpleStyle(collector);

        // check the symbolizer
        RasterSymbolizer rs = (RasterSymbolizer) collector.symbolizers.get(0);
        final SelectedChannelType[] rgbChannels = rs.getChannelSelection().getRGBChannels();

        // check default value: BAND1
        EnvFunction.removeLocalValue("B1");
        assertEquals("BAND1", rgbChannels[0].getChannelName().evaluate(null, String.class));
        // check env variable value B1:BAND33
        EnvFunction.setLocalValue("B1", "BAND33");
        assertEquals("BAND33", rgbChannels[0].getChannelName().evaluate(null, String.class));
        EnvFunction.removeLocalValue("B1");

        assertEquals("BAND3", rgbChannels[1].getChannelName().evaluate(null, String.class));
        assertEquals("BAND5", rgbChannels[2].getChannelName().evaluate(null, String.class));
        assertNull(rs.getChannelSelection().getGrayChannel());
    }

