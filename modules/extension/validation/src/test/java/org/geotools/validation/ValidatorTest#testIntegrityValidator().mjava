    @Test
    public void testIntegrityValidator() throws Exception {
        Validator validator = new Validator(fixture.repository, fixture.processor);

        DefaultFeatureResults results = new DefaultFeatureResults();
        Set<Name> set = fixture.repository.getNames();
        Map<Name, SimpleFeatureSource> map = new HashMap<>();

        for (Name name : set) {
            DataStore store = fixture.repository.dataStore(name);
            for (String typeName : store.getTypeNames()) {
                Name typeRef = new NameImpl(name.toString(), typeName);
                // String typeRef = name.toString()+":"+typeName;
                map.put(typeRef, fixture.repository.source(name.toString(), typeName));
            }
        }
        validator.integrityValidation(map, null, results);
        Assert.assertEquals("integrity test", 0, results.error.size());
    }

