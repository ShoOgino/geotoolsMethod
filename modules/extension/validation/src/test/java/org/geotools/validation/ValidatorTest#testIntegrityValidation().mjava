    @Test
    public void testIntegrityValidation() throws Exception {
        DefaultFeatureResults results = new DefaultFeatureResults();
        Set<Name> set = fixture.repository.getNames();

        Map<String, SimpleFeatureSource> map = new HashMap<>();

        for (Name name : set) {
            DataStore store = fixture.repository.dataStore(name);
            for (String typeName : store.getTypeNames()) {
                String typeRef = name.toString() + ":" + typeName;
                map.put(typeRef, fixture.repository.source(name.toString(), typeName));
            }
        }
        fixture.processor.runIntegrityTests(set, map, null, results);
        Assert.assertEquals("integrity test", 0, results.error.size());
    }

