        @Override
        public SimpleFeatureCollection getFeatures(Query query) throws IOException {
            return new TransformFeatureCollection(this, transformer, query) {
                public void accepts(
                        org.opengis.feature.FeatureVisitor visitor,
                        org.opengis.util.ProgressListener progress)
                        throws IOException {
                    if (isTypeCompatible(visitor, transformer.getSchema())) {
                        passedDown = true;
                    } else {
                        passedDown = false;
                    }
                    super.accepts(visitor, progress);
                }
            };
        }

