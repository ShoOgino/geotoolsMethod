    @Test
    public void testDeleteOnSelection() throws Exception {
        Filter f = CQL.toFilter("state_name = 'Delaware'");
        SimpleFeatureStore transformed = (SimpleFeatureStore) transformWithSelection();
        transformed.removeFeatures(f);

        // check it has been deleted
        int size = STATES.getCount(Query.ALL);
        assertEquals(9, size);

        // check it's not possible to get at it anymore
        assertEquals(0, STATES.getFeatures(f).size());
        assertEquals(0, transformed.getFeatures(f).size());
    }

