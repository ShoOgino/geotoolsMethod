    @Test
    public void testVisitorWithCalc() throws Exception {
        SimpleFeatureSource transformed = transformWithExpressions();

        CountVisitor countVisitor = new CountVisitor();
        MinVisitor minVisitor = new MinVisitor("total");
        MaxVisitor maxVisitor = new MaxVisitor("total");
        UniqueVisitor uniqueVisitor = new UniqueVisitor("fips");
        BoundsVisitor boundsVisitor = new BoundsVisitor();

        FeatureCalc[] visitors = {
            countVisitor, minVisitor, maxVisitor, uniqueVisitor, boundsVisitor
        };
        boolean[] expectedPass = {true, true, true, true, false};
        Object[] expectedResult = {
            10,
            606900d,
            1.1430602E7,
            new HashSet<>(
                    Arrays.asList("11", "24", "17", "29", "08", "51", "20", "10", "54", "21")),
            new ReferencedEnvelope(
                    -110.04782099895442,
                    -74.04752638847438,
                    34.98970859966714,
                    43.50933565139621,
                    CRS.decode("EPSG:4326"))
        };

        checkVisitorApplication(transformed, visitors, expectedPass, expectedResult);
    }

