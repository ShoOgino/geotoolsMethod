    @Override
    public ReferencedEnvelope getBounds(Query query) throws IOException {
        // get the geom properties, if any is really computed we return null,
        // otherwise if they are just renamed we pass down the bounds request
        List<String> geometryNames = transformer.getGeometryPropertyNames();
        List<String> filtered = getSelectedAttributes(geometryNames, query);

        // if no geometry, no bounds
        if (filtered.isEmpty()) {
            LOGGER.log(Level.FINE, "No geometry properties in query {0}", query);
            return null;
        }

        // collect the original attribute names
        List<String> originalNames = transformer.getOriginalNames(filtered);
        if (originalNames.size() < filtered.size()) {
            if (LOGGER.isLoggable(Level.FINE)) {
                LOGGER.log(
                        Level.FINE,
                        "Some of the geometry attributes is the result of a general transformation "
                                + "(not a rename), can't compute the bbox quickly");
            }

            return null;
        }

        // re-shape the query
        Query txQuery = transformer.transformQuery(query);
        txQuery.setPropertyNames(originalNames);

        // let the world know
        if (LOGGER.isLoggable(Level.FINE)) {
            LOGGER.log(
                    Level.FINE,
                    "The original query for bounds computation{0} has been tranformed to {1}",
                    new Object[] {query, txQuery});
        }

        return source.getBounds(txQuery);
    }

