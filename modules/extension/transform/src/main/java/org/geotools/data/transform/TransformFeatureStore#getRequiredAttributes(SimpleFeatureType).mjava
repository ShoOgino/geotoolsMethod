    private List<String> getRequiredAttributes(SimpleFeatureType schema) {
        List<String> result = new ArrayList<>();
        for (AttributeDescriptor ad : schema.getAttributeDescriptors()) {
            if (ad.getMinOccurs() > 0) {
                result.add(ad.getLocalName());
            }
        }

        return result;
    }

