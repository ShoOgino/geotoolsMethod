    public Transformer(
            SimpleFeatureSource source,
            Name name,
            List<Definition> definitions,
            SimpleFeatureType targetSchema)
            throws IOException {
        this.source = source;
        this.name = name;
        this.definitions = definitions;
        this.expressions = new HashMap<>();
        for (Definition property : definitions) {
            expressions.put(property.getName(), property.getExpression());
        }

        if (targetSchema == null) {
            this.schema = computeTargetSchema(name, definitions);
        } else {
            this.schema = targetSchema;
        }
    }

