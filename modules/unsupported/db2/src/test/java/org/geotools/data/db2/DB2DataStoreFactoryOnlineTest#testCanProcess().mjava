    public void testCanProcess() {
        Map<String, String> params;

        // Make sure it succeeds for all good parameters
        params = getParams();
        assertTrue("all parameters valid - should have succeeded",
            factory.canProcess(params));

        // Should fail if "database" parameter is missing
        params = getParams();
        params.remove("database");
        assertFalse("database parameter is required", factory.canProcess(params));

        // Should fail if "dbtype" parameter is not "db2"
        params = getParams();
        params.put("dbtype", "nodb");
        assertFalse("dbtype parameter is required", factory.canProcess(params));

        // Should succeed if "dbname" parameter is not lowercase
        params = getParams();
        params.put("dbtype", "DB2");
        assertTrue("should succeed with uppercase DB2 as dbtype",
            factory.canProcess(params));

        // Should fail if "host" parameter is missing
        params = getParams();
        params.remove("host");
        assertFalse("host parameter is required", factory.canProcess(params));

        // Should fail if "port" parameter is missing
        params = getParams();
        params.remove("port");
        assertFalse("port parameter is required", factory.canProcess(params));

        // Should succeed if "user" parameter is missing - not sure if it should be mandatory
        params = getParams();
        params.remove("user");
        assertTrue("user parameter should be optional",
            factory.canProcess(params));

        // Should succeed if "passwd" parameter is missing - not sure if it should be mandatory
        params = getParams();
        params.remove("passwd");
        assertTrue("passwd parameter should be optional",
            factory.canProcess(params));

        // Should fail if "user" parameter is missing - not sure if it should be mandatory
        params = getParams();
        params.remove("tabschema");
        assertTrue("tabschema parameter should be optional",
            factory.canProcess(params));
    }

