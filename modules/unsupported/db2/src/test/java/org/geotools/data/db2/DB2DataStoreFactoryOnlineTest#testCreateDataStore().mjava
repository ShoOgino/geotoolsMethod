    public void testCreateDataStore() {
        // Should succeed
        try {
            @SuppressWarnings("unused")
			DB2DataStore dataStore = (DB2DataStore) factory.createDataStore(getParams());
            dataStore.dispose();
        } catch (IOException e) {
            fail("createDataStore failed:" + e);
        }
        

        // Should fail if dbtype is not "DB2"
        try {
            Map<String, String> params = getParams();  // always returns a new copy
            params.put("dbtype", "nodb");

            @SuppressWarnings("unused")
			DB2DataStore dataStore = (DB2DataStore) factory.createDataStore(params);
            fail("createDataStore succeeded with invalid dbtype parameter");
        } catch (IOException e) {
            // We should come here as a result
        }
        // Should default schema to the user if schema is null
        try {
            Map<String, String> params = getParams();
            params.put("tabschema", null);

            DB2DataStore dataStore = (DB2DataStore) factory.createDataStore(params);
            dataStore.dispose();
            String schema = dataStore.getTableSchema();
            assertEquals("DB2ADMIN", schema);
        } catch (IOException e) {
            fail("createDataStore failed:" + e);
        }       

    // Should default schema to the user if schema is blank
    try {
        Map<String, String> params = getParams();
        params.put("tabschema", "");

        DB2DataStore dataStore = (DB2DataStore) factory.createDataStore(params);
        dataStore.dispose();
        String schema = dataStore.getTableSchema();
        assertEquals("DB2ADMIN", schema);
    } catch (IOException e) {
        fail("createDataStore failed:" + e);
    }  
    // Should convert schema to uppercase
    try {
        Map<String, String> params = getParams();
        params.put("tabschema", "sde");

        DB2DataStore dataStore = (DB2DataStore) factory.createDataStore(params);
        dataStore.dispose();
        String schema = dataStore.getTableSchema();
        assertEquals("SDE", schema);
    } catch (IOException e) {
        fail("createDataStore failed:" + e);
    }
    // Should leave schema in mixed case
    try {
        Map<String, String> params = getParams();
        params.put("tabschema", "\"Test\"");

        DB2DataStore dataStore = (DB2DataStore) factory.createDataStore(params);
        dataStore.dispose();
        String schema = dataStore.getTableSchema();
        assertEquals("Test", schema);
    } catch (IOException e) {
        fail("createDataStore failed:" + e);
    }
}

