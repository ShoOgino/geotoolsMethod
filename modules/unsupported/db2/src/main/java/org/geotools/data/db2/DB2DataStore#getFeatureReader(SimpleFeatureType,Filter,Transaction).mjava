	/**
	 * This is a public entry point to the DataStore.
	 * 
	 * <p>
	 * We have given some though to changing this api to be based on query.
	 * </p>
	 * 
	 * <p>
	 * Currently the is is the only way to retype your features to different
	 * name spaces.
	 * </p>
	 * (non-Javadoc)
	 * 
	 * @see org.geotools.data.DataStore#getFeatureReader(org.geotools.feature.FeatureType,
	 *      Filter, org.geotools.data.Transaction)
	 */
	public  FeatureReader<SimpleFeatureType, SimpleFeature> getFeatureReader(final SimpleFeatureType requestType,
			final Filter filter, final Transaction transaction)
			throws IOException {
		String typeName = requestType.getTypeName();
		SimpleFeatureType schemaType = getSchema(typeName);
        LOGGER.fine("requestType: " + requestType);
        LOGGER.fine("schemaType: " + schemaType);

		int compare = DataUtilities.compare(requestType, schemaType);

		Query query;

		if (compare == 0) {
			// they are the same type
			//
			query = new DefaultQuery(typeName, filter);
		} else if (compare == 1) {
			// featureType is a proper subset and will require reTyping
			//
			String[] names = attributeNames(requestType, filter);
			query = new DefaultQuery(typeName, filter, Query.DEFAULT_MAX,
					names, "getFeatureReader");
		} else {
			// featureType is not compatiable
			//
			throw new IOException("Type " + typeName + " does match request");
		}

		if ((filter == Filter.INCLUDE) || filter.equals(Filter.INCLUDE)) {
			return new EmptyFeatureReader(requestType);
		}

		FeatureReader<SimpleFeatureType, SimpleFeature> reader = getFeatureReader(query, transaction);

		if (compare == 1) {
			reader = new ReTypeFeatureReader(reader, requestType);
		}

		return reader;
	}

