    /**
     * Gets the DB2-specific SQL builder object.
     *
     * @param typeName Name of the type to build the SQL for.
     *
     * @return DB2SQLBuilder
     *
     * @throws IOException
     */
    public SQLBuilder getSqlBuilder(String typeName) throws IOException {
        FeatureTypeInfo info = this.typeHandler.getFeatureTypeInfo(typeName);
        int srid = 0;
        SQLEncoderDB2 encoder = new SQLEncoderDB2();
        encoder.setSqlNameEscape("\"");
        FIDMapper mapper = getFIDMapper(typeName);
        encoder.setFIDMapper(mapper);

        if (info.getSchema().getGeometryDescriptor() != null) {
            String geom = info.getSchema().getGeometryDescriptor().getLocalName();
            srid = this.catalog.getSRID(getTableSchema(), typeName, geom);
        }

        encoder.setSRID(srid);

        // We should probably get the table schema name from the feature type
        // information - not sure that it exists there.
        return new DB2SQLBuilder((FilterToSQL) encoder, getTableSchema(), info.getSchema(), mapper);
    }

