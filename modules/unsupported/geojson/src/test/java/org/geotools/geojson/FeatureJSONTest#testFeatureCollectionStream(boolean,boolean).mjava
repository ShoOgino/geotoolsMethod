    void testFeatureCollectionStream(boolean withBounds, boolean withCRS) throws Exception {
        try (FeatureIterator<SimpleFeature> features =
                fjson.streamFeatureCollection(reader(strip(collectionText(withBounds, withCRS))))) {

            FeatureCollection expected = collection();
            try (FeatureIterator e = expected.features()) {

                while (e.hasNext()) {
                    features.hasNext(); // ensure that hasNext() does not skip features
                    assertTrue(features.hasNext());
                    assertEqualsLax((SimpleFeature) e.next(), features.next());
                }
            }
        }
    }

