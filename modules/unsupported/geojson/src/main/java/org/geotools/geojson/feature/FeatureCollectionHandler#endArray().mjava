    @Override
    public boolean endArray() throws ParseException, IOException {
        // are we handling a feature collection? stack is null otherwise
        if (stack != null) {
            if (stack.isEmpty()) {
                // end of features array, clear the delegate
                delegate = NULL;
                return true;
            }

            stack.remove(0);
        }
        return super.endArray();
    }

