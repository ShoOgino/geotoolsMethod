    @Override
    protected FeatureReader<SimpleFeatureType, SimpleFeature> getReaderInternal(Query query)
            throws IOException {
        try {
            long z = getTargetZLevel(query);
            RectangleLong tileBounds = getTileBoundsFor(query, z);
            MBTilesFile.TileIterator tiles =
                    mbtiles.tiles(
                            z,
                            tileBounds.getMinX(),
                            tileBounds.getMinY(),
                            tileBounds.getMaxX(),
                            tileBounds.getMaxY());
            return new MBTilesFeatureReader(tiles, getSchema(), tileCache);
        } catch (SQLException e) {
            throw new IOException(e);
        }
    }

