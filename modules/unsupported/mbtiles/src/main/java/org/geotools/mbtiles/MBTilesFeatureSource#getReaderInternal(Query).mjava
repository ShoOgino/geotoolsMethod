    @Override
    protected FeatureReader<SimpleFeatureType, SimpleFeature> getReaderInternal(Query query)
            throws IOException {
        try {
            long z = getTargetZLevel(query);
            List<RectangleLong> tileBounds = getTileBoundsFor(query, z);
            List<ReaderSupplier> suppliers =
                    tileBounds
                            .stream()
                            .flatMap(tb -> getReaderSuppliersFor(z, tb).stream())
                            .collect(Collectors.toList());

            if (suppliers.isEmpty()) {
                return new EmptyFeatureReader<>(getSchema());
            }

            return new CompositeSimpleFeatureReader(getSchema(), suppliers);
        } catch (SQLException e) {
            throw new IOException(e);
        }
    }

