    /**
     * Creates a MbTilesFile from an existing file specifying database credentials.
     */
    public MBTilesFile(File file, String user, String passwd) throws IOException {
        this.file = file;

        Map params = new HashMap();
        if (user != null) {
            params.put(MBTilesDataStoreFactory.USER.key, user);
        }
        if (passwd != null) {
            params.put(MBTilesDataStoreFactory.PASSWD.key, passwd);
        }

        params.put(MBTilesDataStoreFactory.DATABASE.key, file.getPath());
        params.put(MBTilesDataStoreFactory.DBTYPE.key, MBTilesDataStoreFactory.DBTYPE.sample);

        this.connPool = new MBTilesDataStoreFactory().createDataSource(params);
    }

