    @Test
    public void testFactory() throws IOException {
        String namespaceURI = "http://geotools.org/mbtiles";
        File file =
                URLs.urlToFile(MBTilesFileVectorTileTest.class.getResource("datatypes.mbtiles"));
        Map<String, Serializable> params = new HashMap<>();
        params.put(MBTilesDataStoreFactory.DBTYPE.key, "mbtiles");
        params.put(MBTilesDataStoreFactory.DATABASE.key, file);
        params.put(JDBCDataStoreFactory.NAMESPACE.key, namespaceURI);
        DataStore store = DataStoreFinder.getDataStore(params);
        assertNotNull(store);
        assertThat(store, Matchers.instanceOf(MBTilesDataStore.class));
        assertThat(store.getTypeNames(), arrayContaining("datatypes"));
        SimpleFeatureType schema = store.getSchema("datatypes");
        NameImpl qualifiedName = new NameImpl(namespaceURI, "datatypes");
        assertThat(schema.getName(), equalTo(qualifiedName));
        SimpleFeatureType schemaFromQualified = store.getSchema(qualifiedName);
        assertThat(schema, equalTo(schemaFromQualified));
    }

