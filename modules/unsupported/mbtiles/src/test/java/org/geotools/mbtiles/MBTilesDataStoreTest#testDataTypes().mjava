    @Test
    public void testDataTypes() throws IOException, FactoryException {
        File file = URLs.urlToFile(this.getClass().getResource("datatypes.mbtiles"));
        MBTilesDataStore store = new MBTilesDataStore(new MBTilesFile(file));
        assertThat(store.getTypeNames(), arrayContaining("datatypes"));

        ContentFeatureSource fs = store.getFeatureSource(DATATYPES);
        assertNotNull(fs);

        // check the schema
        SimpleFeatureType schema = fs.getSchema();
        assertThat(schema.getTypeName(), equalTo(DATATYPES));

        // the default geometry
        GeometryDescriptor geom = schema.getGeometryDescriptor();
        assertThat(geom.getLocalName(), equalTo("the_geom"));
        assertThat(geom.getCoordinateReferenceSystem(), equalTo(CRS.decode("EPSG:3857", true)));

        // check boolean
        AttributeDescriptor bd = schema.getDescriptor("bool_true");
        assertThat(bd.getType().getBinding(), equalTo(Boolean.class));

        // check number (there is no distinction of subtypes, everything is "Number"
        AttributeDescriptor fd = schema.getDescriptor("float_value");
        assertThat(fd.getType().getBinding(), equalTo(Number.class));

        AttributeDescriptor sd = schema.getDescriptor("string_value");
        assertThat(sd.getType().getBinding(), equalTo(String.class));
    }

