    /**
     * Called when a new map layer has been added. Sets the layer as selected (for queries) and, if
     * the layer table is being used, adds the new layer to the table.
     */
    public void layerAdded(MapLayerListEvent event) {
        Layer layer = event.getElement();
        if (layerTable != null) {
            layerTable.onAddLayer(layer);
        }
        layer.setSelected(true);
        redrawBaseImage = true;

        boolean atFullExtent = equalsFullExtent(getDisplayArea());
        boolean firstLayer = content.layers().size() == 1;
        if (firstLayer || atFullExtent) {
            reset();
            if (firstLayer) {
                setCrs(layer.getBounds().getCoordinateReferenceSystem());
                return;
            }
        }
        if (!isDisposed()) redraw();
    }

