    public Mode determineMode(SimpleFeatureType schema, boolean askUser) {
        if (schema == null) {
            return Mode.NONE;
        } else if (SLDs.isLine(schema)) {
            return Mode.LINE;
        } else if (SLDs.isPolygon(schema)) {
            return Mode.POLYGON;
        } else if (SLDs.isPoint(schema)) {
            return Mode.POINT;
        } else {
            // we must be Geometry?
            if (askUser) {
                // could not figure it out from the schema
                // try trusting the user?
                if (polyMode.getSelection()) {
                    return Mode.POLYGON;
                } else if (lineMode.getSelection()) {
                    return Mode.LINE;
                } else if (pointMode.getSelection()) {
                    return Mode.POINT;
                }
            }
            return Mode.ALL; // we are a generic geometry
        }
    }

