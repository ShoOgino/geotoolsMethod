	/**
	 * Looks up the set of "sqlView.N.typeName" and "sqlView.N.sqlQuery" keys
	 * in <code>params</code> and returns a cleaned up map of typeName/query.
	 * 
	 * @param params
	 * @return
	 */
	public static Map cleanUpViewDefinitions(Map params) {
		Map cleanedUpViews = new HashMap();
		for (Iterator it = params.keySet().iterator(); it.hasNext();) {
			String key = (String) it.next();
			if (!key.startsWith("sqlView.")) {
				continue;
			}
			if (!key.endsWith(".typeName")) {
				continue;
			}

			String typeName = (String) params.get(key);

			String viewId = key.substring("sqlView.".length(), key
					.indexOf(".typeName"));

			String queryKey = "sqlView." + viewId + ".sqlQuery";

			String query = (String) params.get(queryKey);
			if (query == null) {
				throw new IllegalArgumentException(
						"No SQL query definition provided for type name "
								+ typeName);
			}
			cleanedUpViews.put(typeName, query);
		}
		return cleanedUpViews;
	}

