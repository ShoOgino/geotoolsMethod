	/**
	 * Registers the sql views provided in <code>params</code> on the
	 * SqlDataStore <code>dataStore</code>
	 * 
	 * @param dataStore
	 * @param params
	 * @throws IOException
	 */
	public static void registerSqlViews(SqlDataStore dataStore, Map params)
			throws IOException {
		Map cleanedUp = cleanUpViewDefinitions(params);
		for (Iterator it = cleanedUp.entrySet().iterator(); it.hasNext();) {
			Map.Entry entry = (Map.Entry) it.next();
			String typeName = (String) entry.getKey();
			String sqlQuery = (String) entry.getValue();
			
			LOGGER.finer("registering view " + typeName);
			LOGGER.finest("sql query is '" + sqlQuery + "'");

			SelectBody selectBody = SqlParser.parse(sqlQuery);
			if(selectBody instanceof Union){
				dataStore.registerView(typeName, (Union)selectBody);
			}else if(selectBody instanceof PlainSelect){
				dataStore.registerView(typeName, (PlainSelect)selectBody);
			}else{
				throw new IllegalStateException(selectBody.getClass().getName());
			}
			
			//dataStore.registerView(typeName, sqlQuery);

		}
	}

