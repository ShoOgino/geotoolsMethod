    /**
     * Performs a geometry distance filter, must be either a dwithin or a 
     * a beyond filter.  Uses the SDO_WITHIN_DISTANCE function, dwithin matches
     * for true, beyond for false.  
     * 
     * @param geomFilter the filter to use, must be a dwithin or beyond
     */
    private void doSdoDistance(GeometryDistanceFilter geomFilter)
        throws IOException {
       //  String mask = (String) SDO_RELATE_MASK_MAP.get(new Short(
       //             geomFilter.getFilterType()));
        //TODO: don't assume left and right are correct order, see doSdoRelate
        Expression left = geomFilter.getLeftGeometry();
        Expression right = geomFilter.getRightGeometry();
        double distance = geomFilter.getDistance();
	//only dwithin and beyond, dwithin matches true for sdo_within_distance
        boolean isDWithin = geomFilter.getFilterType() == 
            AbstractFilter.GEOMETRY_DWITHIN;
	String boolValue = isDWithin ? "TRUE" : "FALSE";

        if ((left != null) && (right != null)) {
            inGeomFilter = true;
            out.write("SDO_WITHIN_DISTANCE(");
            left.accept(this);
            out.write(",");
            right.accept(this);
            out.write(",'distance=" + distance + "') = '" + boolValue + "' ");
            inGeomFilter = false;
        } else {
            LOGGER.warning("Invalid filter for DWithin. Cannot have a Geometry filter "
                + "with only one expression.");
        }
    }

