    private ImageOutputStream getImageOutputStream(
            Object dest, RenderedImage image, String fullName) throws IOException {
        if (dest instanceof File) {
            final File file = new File((File) dest, fullName);
            return ImageIOExt.createImageOutputStream(image, file);
        } else {
            @SuppressWarnings("PMD.CloseResource") // not managed here
            final ZipOutputStream outZ = (ZipOutputStream) dest;
            final ZipEntry e = new ZipEntry(fullName);
            outZ.putNextEntry(e);

            return ImageIOExt.createImageOutputStream(image, outZ);
        }
    }

