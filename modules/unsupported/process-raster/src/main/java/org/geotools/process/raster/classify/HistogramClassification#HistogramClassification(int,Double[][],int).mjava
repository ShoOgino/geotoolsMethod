    public HistogramClassification(int numBands, Double[][] extrema, int numBins) {
        super(null, numBands);
        if (extrema == null) {
            throw new IllegalArgumentException(
                    "Histogram based classification methods need to be provided with the extrema parameter");
        }
        checkExtremaArray(numBands, extrema, 0, "min");
        checkExtremaArray(numBands, extrema, 1, "max");
        for (int b = 0; b < numBands; b++) {
            setMin(b, extrema[0][b]);
            setMax(b, extrema[1][b]);
        }
        this.minimums = Arrays.stream(extrema[0]).mapToDouble(d -> d).toArray();
        this.maximums = Arrays.stream(extrema[1]).mapToDouble(d -> d).toArray();
        this.bucketSize = new double[numBands];
        for (int b = 0; b < numBands; b++) {
            bucketSize[b] = (extrema[1][b] - extrema[0][b]) / numBins;
        }
        bucketCounts = new int[numBands][numBins];
        bucketAverages = new double[numBands][numBins];
        bucketSingleValue = new boolean[numBands][numBins];
        for (int b = 0; b < numBands; b++) {
            Arrays.fill(bucketSingleValue[b], true);
        }
    }

