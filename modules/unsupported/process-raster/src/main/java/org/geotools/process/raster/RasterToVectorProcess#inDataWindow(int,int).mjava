    /**
     * Check the position of the data window with regard to the grid coverage
     * boundaries. We do this because a virtual, single-cell-width border is
     * placed around the input data.
     *
     * @param row index of the image row in the top left cell of the data window
     * @param col index of the image col in the top left cell of the data window
     * @return an array of four boolean values to be indexed with the TL, TR, BL
     * and BR constants.
     */
    private boolean[] inDataWindow(int row, int col) {
        boolean[] ok = new boolean[4];

        int rowflag = (row < imageBounds.y ? -1 : (row >= imageBounds.y + imageBounds.height - 1 ? 1 : 0));
        int colflag = (col < imageBounds.x ? -1 : (col >= imageBounds.x + imageBounds.width - 1 ? 1 : 0));

        ok[TL] = rowflag >= 0 && colflag >= 0;
        ok[TR] = rowflag >= 0 && colflag < 1;
        ok[BL] = rowflag < 1 && colflag >= 0;
        ok[BR] = rowflag < 1 && colflag < 1;

        return ok;
    }

