    /**
     * Utility method for ensuring that all the Input Coverages have the same CRS
     *
     * @param coverages
     * @throws ProcessException
     */
    public static void checkCompatibleCoveragesForMerge(Collection<GridCoverage2D> coverages)
            throws ProcessException {
        if (coverages == null || coverages.isEmpty()) {
            throw new ProcessException(
                    Errors.format(ErrorKeys.NULL_ARGUMENT_$1, "Input coverage List"));
        }

        //
        // checking same CRS
        //

        // CRS which must be equal for all
        CoordinateReferenceSystem crs = null;

        // Iterator on all the coverages
        Iterator<GridCoverage2D> it = coverages.iterator();

        while (it.hasNext()) {
            // Selection of the coverage
            GridCoverage2D coverage = it.next();
            // Get the CRS associated
            if (crs == null) {
                crs = coverage.getCoordinateReferenceSystem();
            } else {
                CoordinateReferenceSystem crs1 = coverage.getCoordinateReferenceSystem();
                // Check that the CRS are the same
                checkCompatibleCRS(crs, crs1);
            }
        }
    }

