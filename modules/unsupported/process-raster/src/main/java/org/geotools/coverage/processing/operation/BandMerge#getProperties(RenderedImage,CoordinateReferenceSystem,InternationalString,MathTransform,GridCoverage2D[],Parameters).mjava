    protected Map getProperties(RenderedImage data, CoordinateReferenceSystem crs,
            InternationalString name, MathTransform toCRS, GridCoverage2D[] sources,
            Parameters parameters) {
        // Check the property names of the created image
        String[] propNames = data.getPropertyNames();
        // If no property is present then the null is returned
        if (propNames == null || propNames.length == 0) {
            return null;
        } else {
            // Else a property map is returned
            Map properties = new HashMap();
            // All the image properties are stored inside a map
            for (String key : propNames) {
                properties.put(key, data.getProperty(key));
            }

            return properties;
        }
    }

