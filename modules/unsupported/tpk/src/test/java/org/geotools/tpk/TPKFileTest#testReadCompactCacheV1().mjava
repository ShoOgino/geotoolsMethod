    @Test
    public void testReadCompactCacheV1() {
        Map<Long, TPKZoomLevel> zoomLevelMap = new HashMap<>();
        File theTpk = URLs.urlToFile(getClass().getResource("sample_v1.tpk"));
        TPKFile theTPKFile = new TPKFile(theTpk, zoomLevelMap);
        assertEquals(2, zoomLevelMap.size());
        assertEquals(1, theTPKFile.getMinZoomLevel());
        assertEquals(2, theTPKFile.getMaxZoomLevel());

        // get the bounds computed from highest zoom level coverage
        Envelope bounds = theTPKFile.getBounds();

        // minimum longitude
        assertEquals(-180.0, bounds.getMinimum(0), 0.000001);
        // maximum longitude
        assertEquals(180.0, bounds.getMaximum(0), 0.000001);

        // min latitude
        assertEquals(-85.05112, bounds.getMinimum(1), 0.00001);
        // max latitude
        assertEquals(85.05112, bounds.getMaximum(1), 0.00001);

        // sample uses png tiles
        String imageFormat = theTPKFile.getImageFormat();
        assertEquals("JPEG", imageFormat);

        // zoom level 1
        assertEquals(0, theTPKFile.getMinColumn(1));
        assertEquals(1, theTPKFile.getMaxColumn(1));
        assertEquals(0, theTPKFile.getMinRow(1));
        assertEquals(1, theTPKFile.getMaxRow(1));

        // zoomlevel 2
        assertEquals(0, theTPKFile.getMinColumn(2));
        assertEquals(3, theTPKFile.getMaxColumn(2));
        assertEquals(0, theTPKFile.getMinRow(2));
        assertEquals(3, theTPKFile.getMaxRow(2));

        List<TPKTile> tiles1 = theTPKFile.getTiles(2, 3, 0, 0, 3, imageFormat);
        assertNotNull(tiles1);
        assertEquals(16, tiles1.size());

        // release held resources
        theTPKFile.close();

        // try our "restart" constructor
        TPKFile newTPKFile = new TPKFile(theTpk, zoomLevelMap, bounds, imageFormat);
        assertNotNull(newTPKFile);

        List<TPKTile> tiles = newTPKFile.getTiles(1, 0, 0, 0, 0, imageFormat);
        assertNotNull(tiles);
        assertEquals(1, tiles.size());

        TPKTile tile = tiles.get(0);
        assertEquals(0, tile.col);
        assertEquals(0, tile.row);
        assertNotNull(tile.tileData);
    }

