    /**
     * Constructor -- used for first open of a TPK file, parses the conf.xml file and builds the
     * zoomLevelMap
     *
     * @param theFile -- the TPK file in question
     * @param zoomLevelMap -- reference to an empty hashmap object that we will populate
     */
    public TPKFile(File theFile, Map<Long, TPKZoomLevel> zoomLevelMap) {

        // open the file and build the zipEntryMap
        openTPK(theFile);

        // the zoom level map is "owned" by the caller and will be initialized by this
        // constructor so it can be re-used over and over
        this.zoomLevelMap = zoomLevelMap;

        // find the "conf.xml" file
        String xmlConf =
                zipEntryMap
                        .keySet()
                        .stream()
                        .filter(s -> s.endsWith(CONFIGURATION_FILE))
                        .findFirst()
                        .orElse(null);

        // extract metadata we need from the conf.xml file of the TPK
        parseConfigurationFile(zipEntryMap.get(xmlConf));

        // create a TPKZoomLevel object for each zoom level
        loadZoomLevels();
    }

