    @Before
    public void setUp() throws Exception {
        factory = new BeanProcessFactory();

        // check SPI will see the factory if we register it using an iterator
        // provider
        GeoTools.addFactoryIteratorProvider(
                new FactoryIteratorProvider() {

                    public <T> Iterator<T> iterator(Class<T> category) {
                        if (ProcessFactory.class.isAssignableFrom(category)) {
                            @SuppressWarnings("unchecked")
                            Iterator<T> result =
                                    (Iterator<T>) Collections.singletonList(factory).iterator();
                            return result;
                        } else {
                            return null;
                        }
                    }
                });
    }

