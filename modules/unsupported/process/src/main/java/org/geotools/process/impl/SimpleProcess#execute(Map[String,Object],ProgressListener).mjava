    public final Map<String, Object> execute(Map<String, Object> input, ProgressListener monitor) {
        if (started) throw new IllegalStateException("Process can only be run once");
        started = true;

        if (monitor == null) monitor = new NullProgressListener();
        try {
            if (monitor.isCanceled()) return null; // respect isCanceled
            this.input = input;
            result = new HashMap<>();

            process();

            return result;
        } catch (Throwable eek) {
            monitor.exceptionOccurred(eek);
            return null;
        } finally {
            monitor.complete();
        }
    }

