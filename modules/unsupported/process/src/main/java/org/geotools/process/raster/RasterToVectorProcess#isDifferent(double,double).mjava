    /**
     * Test if two double values are different. Uses an absolute tolerance and
     * checks for NaN values.
     *
     * @param a first value
     * @param b second value
     * @return true if the values are different; false otherwise
     */
    private boolean isDifferent(double a, double b) {
        if (Double.isNaN(a) ^ Double.isNaN(b)) {
            return true;
        } else if (Double.isNaN(a) && Double.isNaN(b)) {
            return false;
        }

        if (Math.abs(a - b) > EPSILON) {
            return true;
        } else {
            return false;
        }
    }

