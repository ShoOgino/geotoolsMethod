    /**
     * Creates a data store.
     * @param params A <code>Map</code> of parameters which must be verified and 
     * @throws IOException
     */
    private DataStore create(Map params) throws IOException {
        DataStore result = null;
        File file = getLhtFile(params);
        //CH I'd like to check existence here, so that geoserver can get
        //a better error message, but I've spent way too long on this, so
        //I'm giving up for now.  Ideally canProcess just figures out if
        //the params are valid, and doesn't throw the not existing error, but
        //since we need a directory, not the actual file, it's hard to check
        //for anything.
        if (!file.exists() || !file.canRead()) {
            throw new IOException(
                "File either doesn't exist or is unreadable : " + file);
        }
        URI namespace = (URI) NAMESPACEP.lookUp(params); //null if not exist
        LOGGER.finer("creating new vpf datastore with params: " + params);
            try {
                result = new VPFLibrary( file, namespace );
            } catch (SchemaException exc) {
                throw new IOException("There was a problem making one of " +
                		      "the feature classes as a FeatureType.");
            }
            
        return result;
    }

