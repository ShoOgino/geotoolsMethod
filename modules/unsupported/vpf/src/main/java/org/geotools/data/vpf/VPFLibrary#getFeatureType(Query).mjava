    public VPFFeatureType getFeatureType(Query query) throws IOException {
        if (query.equals(Query.ALL)) {
            String typeNames[] = this.getTypeNames();
            if (typeNames.length > 0) {
                return (VPFFeatureType) this.getTypeSchema(typeNames[0]);
            } else return null;
        } else {
            String typeName = query.getTypeName();
            return (VPFFeatureType) this.getTypeSchema(typeName);
        }
    }

