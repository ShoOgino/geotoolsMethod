    public synchronized SimpleFeature readNext(SimpleFeatureType featureType) {

        SimpleFeature nextFeature = null;
        if (this.enableFeatureCache && this.featureCache.isEmpty()) {
            this.reset();
            while (this.internalHasNext()) {
                SimpleFeature feature = joinRows(featureType);

                this.featureCache.add(feature);
            }
            if (!this.featureCache.isEmpty()) {
                this.closeFiles();
            }
        }
        if (this.enableFeatureCache) {
            if (this.cacheRow < this.featureCache.size()) {
                nextFeature = this.featureCache.get(this.cacheRow);
                this.cacheRow++;
            } else {
                nextFeature = null;
            }
        } else nextFeature = joinRows(featureType);

        return nextFeature;
    }

