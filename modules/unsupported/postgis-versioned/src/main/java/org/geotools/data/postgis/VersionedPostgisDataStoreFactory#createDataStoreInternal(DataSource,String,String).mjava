    protected VersionedPostgisDataStore createDataStoreInternal(DataSource dataSource,
            String namespace, String schema) throws IOException {

        if (schema == null && namespace == null)
            return new VersionedPostgisDataStore(dataSource);

        if (schema == null && namespace != null) {
            return new VersionedPostgisDataStore(dataSource, namespace);
        }

        return new VersionedPostgisDataStore(dataSource, schema, namespace);
    }

