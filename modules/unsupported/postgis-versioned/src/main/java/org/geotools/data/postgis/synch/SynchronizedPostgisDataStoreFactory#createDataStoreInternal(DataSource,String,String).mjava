    protected SynchronizedPostgisDataStore createDataStoreInternal(DataSource dataSource,
            String namespace, String schema) throws IOException {

        if (schema == null && namespace == null)
            return new SynchronizedPostgisDataStore(dataSource);

        if (schema == null && namespace != null) {
            return new SynchronizedPostgisDataStore(dataSource, namespace);
        }

        return new SynchronizedPostgisDataStore(dataSource, schema, namespace);
    }

