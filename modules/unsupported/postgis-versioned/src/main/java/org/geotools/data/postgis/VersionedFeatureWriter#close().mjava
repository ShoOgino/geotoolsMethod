    public void close() throws IOException {
        if (updateWriter != null)
            updateWriter.close();
        appendWriter.close();

        // double check, state.getTransaction() will return null if the transaction
        // has already been closed
        if (autoCommit && state.getTransaction() != null) {
            state.getTransaction().commit();
            state.getTransaction().close();
        }
    }

