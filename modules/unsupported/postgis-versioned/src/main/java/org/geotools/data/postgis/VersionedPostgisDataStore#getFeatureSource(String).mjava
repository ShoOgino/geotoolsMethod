    public SimpleFeatureSource getFeatureSource(String typeName) throws IOException {
        if (isVersioned(typeName))
            return new VersionedPostgisFeatureStore(getSchema(typeName), this);

        SimpleFeatureSource source = wrapped.getFeatureSource(typeName);
        
        // changesets should be read only for the outside world
        if(TBL_CHANGESETS.equals(typeName))
            return new WrappingPostgisFeatureSource(source, this);
        
        // for the others, wrap so that we don't report the wrong owning datastore
        if(source instanceof SimpleFeatureLocking)
            return new WrappingPostgisFeatureLocking((SimpleFeatureLocking) source, this);
        else if(source instanceof SimpleFeatureStore)
            return new WrappingPostgisFeatureStore((SimpleFeatureStore) source, this);
        else 
            return new WrappingPostgisFeatureSource((SimpleFeatureSource) source, this);
    }

