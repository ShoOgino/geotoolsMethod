    /**
     * Reads the next FeatureDifference
     * 
     * @return The next FeatureDifference
     * 
     * @throws IOException
     *             If an error occurs reading the FeatureDifference.
     * @throws NoSuchElementException
     *             If there are no more Features in the Reader.
     */
    public FeatureDiffImpl next() throws IOException, NoSuchElementException {
        // check we have something, and force reader mantainance as well, so that
        // we make sure finished ones are nullified
        if (!hasNext())
            throw new NoSuchElementException("No more diffs in this reader");
        if (createdReader != null) {
            return new FeatureDiffImpl(null, gatherNextUnversionedFeature(createdReader));
        } else if (deletedReader != null) {
            return new FeatureDiffImpl(gatherNextUnversionedFeature(deletedReader), null);
        } else {
            FeatureDiffImpl diff = lastDiff;
            lastDiff = null;
            return diff;
        }

    }

