    /**
     * Turns a versioned feature into the extenal equivalent, with modified fid and without the
     * versioning columns
     * 
     * @param f
     * @return
     */
    private SimpleFeature gatherNextUnversionedFeature(
            final FeatureReader<SimpleFeatureType, SimpleFeature> fr) throws IOException {
        final SimpleFeature f = fr.next();
        final Object[] attributes = new Object[externalFeatureType.getAttributeCount()];
        for (int i = 0; i < externalFeatureType.getAttributeCount(); i++) {
            attributes[i] = f.getAttribute(externalFeatureType.getDescriptor(i).getLocalName());
        }
        String id = mapper.getUnversionedFid(f.getID());
        return SimpleFeatureBuilder.build(externalFeatureType, attributes, id);
    }

