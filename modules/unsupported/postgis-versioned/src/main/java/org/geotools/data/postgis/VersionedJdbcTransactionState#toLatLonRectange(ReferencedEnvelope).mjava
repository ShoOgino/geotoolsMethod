    /**
     * Takes a referenced envelope and turns it into a lat/lon Polygon
     * 
     * @param envelope
     * @return
     * @throws TransformException
     */
    Geometry toLatLonRectange(final ReferencedEnvelope env) throws IOException {
        ReferencedEnvelope envelope = new ReferencedEnvelope(env);
        try {
            // since we cannot work with a null geometry in commits to
            // changesets, let's return a very small envelope...
            // an empty envelope gets turned into a point
            if (envelope == null || envelope.isEmpty()) {
                envelope = new ReferencedEnvelope(new Envelope(0, EPS , 0, EPS),
                        DefaultGeographicCRS.WGS84);
            } else {
                envelope = envelope.transform(DefaultGeographicCRS.WGS84, true);
                if(envelope.getHeight() == 0.0 || envelope.getWidth() == 0.0)
                    envelope.expandBy(EPS);
            }
                

            GeometryFactory gf = new GeometryFactory();
            return gf.toGeometry(envelope);
        } catch (Exception e) {
            throw new DataSourceException("An error occurred while trying to builds a "
                    + "lat/lon polygon equivalent to " + envelope, e);
        }
    }

