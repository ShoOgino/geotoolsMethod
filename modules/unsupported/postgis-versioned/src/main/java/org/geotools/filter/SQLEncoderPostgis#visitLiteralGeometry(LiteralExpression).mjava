    /**
     * Checks to see if the literal is a geometry, and encodes it if it is, if
     * not just sends to the parent class.
     * 
     * @param expression
     *            the expression to visit and encode.
     * 
     * @throws IOException
     *             for IO exception (need a better error)
     */
    public void visitLiteralGeometry(LiteralExpression expression)
        throws IOException {
        Geometry bbox = (Geometry) expression.evaluate( null, Geometry.class );
        String geomText = null;
        if ( bbox instanceof LinearRing ) {
        	//postgis does not handle linear rings, convert to just a line string
        	LineString lineString = new LineString( 
    			((LinearRing)bbox).getCoordinateSequence(), bbox.getFactory()
			);
        	geomText = wkt.write( lineString );
        }
        else {
        	geomText = wkt.write(bbox);	
        }
        
        out.write("GeometryFromText('" + geomText + "', " + srid + ")");
    }

