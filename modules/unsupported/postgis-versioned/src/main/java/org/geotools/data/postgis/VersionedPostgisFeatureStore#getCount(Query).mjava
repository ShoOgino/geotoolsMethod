    public int getCount(Query query) throws IOException {
        DefaultQuery versionedQuery = store.buildVersionedQuery(getTypedQuery(query));
        return locking.getCount(versionedQuery);
    }

