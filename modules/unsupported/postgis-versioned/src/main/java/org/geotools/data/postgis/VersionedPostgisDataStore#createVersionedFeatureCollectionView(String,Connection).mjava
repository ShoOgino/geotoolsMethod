    /**
     * Creates the <TABLE>_VFC_VIEW for the specified feature type
     * @param conn
     * @param typeName
     */
    private void createVersionedFeatureCollectionView(String typeName, Connection conn) throws IOException {
        Statement st = null;
        try {
            st = conn.createStatement();
            
            String viewName = getVFCViewName(typeName);
            st.execute("CREATE VIEW " + viewName + "\n " 
                    + "AS SELECT "
                    + "cr.revision as \"creationVersion\", cr.author as \"createdBy\", "
                    + "cr.date as \"creationDate\", cr.message as \"creationMessage\",  "
                    + "lu.revision as \"lastUpdateVersion\", lu.author as \"lastUpdatedBy\", "
                    + "lu.date as \"lastUpdateDate\", lu.message as \"lastUpdateMessage\"," 
                    + typeName + ".*\n"
                    + "FROM " + typeName + " inner join " + " changesets lu on " + typeName 
                    + ".revision = lu.revision " +
                    " inner join changesets cr on " + typeName + ".created = cr.revision");
            
            // make sure there is no other row for this view (one might have remained
            // due to errors, and we would end up with a primary key violation)
            st.execute("DELETE FROM geometry_columns " +
            		   "WHERE f_table_schema = current_schema()" +
            		   "AND f_table_name = '" + viewName + "'");
            
            st.execute("INSERT INTO geometry_columns \n" +
                       "SELECT '', current_schema(), '" + viewName + "', " +
                       "       gc.f_geometry_column, gc.coord_dimension, gc.srid, gc.type\n" +
                       "FROM geometry_columns as gc\n" +
                       "WHERE gc.f_table_name = '" + typeName + "'");
        } catch(SQLException e) {
            throw new DataSourceException("Issues creating versioned feature collection view for " 
                    + typeName, e);
        }finally {
            JDBCUtils.close(st);
        }
    }

