    /**
     * Builds a new feature writer
     * 
     * @param updateWriter
     * @param appendWriter
     * @param featureType
     *            the outside visible feature type
     * @param mapper
     * @param autoCommit
     *            if true, the transaction need to be committed once the writer is closed
     */
    public VersionedFeatureWriter(FeatureWriter<SimpleFeatureType, SimpleFeature> updateWriter,
            FeatureWriter<SimpleFeatureType, SimpleFeature> appendWriter,
            SimpleFeatureType featureType, VersionedJdbcTransactionState state,
            VersionedFIDMapper mapper, boolean autoCommit) {
        this.updateWriter = updateWriter;
        this.appendWriter = appendWriter;
        this.featureType = featureType;
        this.state = state;
        this.mapper = mapper;
        this.autoCommit = autoCommit;
    }

