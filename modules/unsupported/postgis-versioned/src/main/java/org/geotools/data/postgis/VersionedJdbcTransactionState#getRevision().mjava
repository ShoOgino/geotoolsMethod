    /**
     * Returns the revision currently created during the transaction, eventually creating the
     * changesets record if not available
     * 
     * @throws IOException
     */
    public long getRevision() throws IOException {
        if (revision == Long.MIN_VALUE) {
            revision = writeRevision(transaction, bbox);
            transaction.putProperty(VersionedPostgisDataStore.REVISION, new Long(revision));
            transaction.putProperty(VersionedPostgisDataStore.VERSION, String.valueOf(revision));
        }
        return revision;
    }

