    public void setTransaction(Transaction transaction) {
        super.setTransaction(transaction);
        this.transaction = transaction;
        if (transaction == null) {
            // setup for fail fast if anyone tries to keep using this state
            // object
            // afer the transaction has been closed
            bbox = null;
            dirtyTypes = null;
        }
    }

