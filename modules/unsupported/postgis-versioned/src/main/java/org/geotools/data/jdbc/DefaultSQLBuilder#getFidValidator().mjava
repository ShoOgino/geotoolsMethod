    /**
     * Returns a fid validator to filter out the invalid fids from a Filter
     * 
     * @return a fid validator wrapping the {@link SQLEncoder encoder}'s
     *         {@link FIDMapper#isValid(String)}
     * @see #splitFilter(Filter)
     */
    protected SimplifyingFilterVisitor.FIDValidator getFidValidator() {
        final FIDMapper mapper = this.encoder.getFIDMapper();
        SimplifyingFilterVisitor.FIDValidator validator;
        if (mapper == null) {
            validator = SimplifyingFilterVisitor.ANY_FID_VALID;
        } else {
            validator = new SimplifyingFilterVisitor.FIDValidator() {
                public boolean isValid(String fid) {
                    return mapper.isValid(fid);
                }
            };
        }
        return validator;
    }

