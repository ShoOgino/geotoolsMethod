    public void testRollbackAll() throws IOException, IllegalAttributeException {
        VersionedPostgisDataStore ds = getDataStore();
        buildRiverHistory();

        // try to rollback to revision 3, that is, rollback last deletion and
        // creation
        Transaction t = createTransaction("Mambo", "Gimbo, what did you do? "
                + "Now I have to rollback your changes!");
        VersionedPostgisFeatureStore fs = (VersionedPostgisFeatureStore) ds
                .getFeatureSource("river");
        fs.setTransaction(t);
        fs.rollback("1", Filter.INCLUDE, null);
        t.commit();

        // now check river features are just like at the beginning
        SimpleFeatureCollection fc = fs.getFeatures();
        assertEquals(riverFeatures.length, fc.size());
        for (int i = 0; i < riverFeatures.length; i++) {
            assertTrue(fc.contains(riverFeatures[i]));
        }
        t.close();
    }

