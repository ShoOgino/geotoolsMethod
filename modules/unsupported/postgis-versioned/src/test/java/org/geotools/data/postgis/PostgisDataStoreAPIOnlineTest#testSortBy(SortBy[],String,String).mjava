    /**
     * Fetches the features from the river test data using the provided sort order and asserts
     * the "river" property matches the <code>riverAtt1</code> and <code>riverAtt2</code> values,
     * in that order.
     */
    private void testSortBy(final SortBy[]sortBy, final String riverAtt1, final String riverAtt2) throws IOException {

        SimpleFeatureSource river = data.getFeatureSource("river");
        
        Query query = new Query(riverType.getTypeName());
        query.setSortBy(sortBy);
        
        SimpleFeatureCollection features;
        SimpleFeature f1;
        SimpleFeature f2;
        
        features = river.getFeatures(query);
        SimpleFeatureIterator iterator = features.features();
        try{
            f1 = iterator.next();
            f2 = iterator.next();
            assertEquals(riverAtt1, f1.getAttribute("river"));
            assertEquals(riverAtt2, f2.getAttribute("river"));
        } finally {
           iterator.close();
        }
    }

