    public void testMissingVersionedCollection() throws Exception {
        VersionedPostgisDataStore ds = getDataStore();
        buildRiverHistory();
        
        // drop the versioning collection view to make the db in the
        // same condition as an old db
        Connection conn = null;
        Statement st = null;
        try {
            conn = pool.getConnection();
            st = conn.createStatement();
            st.execute("drop view river_vfc_view");
        } catch(Exception e) {
            
        }
        
        VersioningFeatureSource fs = (VersioningFeatureSource) ds.getFeatureSource("river");
        // now, will the datastore create the view on the fly?
        SimpleFeatureCollection vfc = fs.getVersionedFeatures();
        SimpleFeatureCollection fc = fs.getFeatures();
        assertEquals(vfc.size(), fc.size());
        assertEquals(vfc.getSchema().getGeometryDescriptor(), fc.getSchema().getGeometryDescriptor());
    }

