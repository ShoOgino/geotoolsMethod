    /**
     * The datastore used to choke on single point changes because the change bbox would be an
     * invalid polygon. Plus the feature collection seems to ignore the version set in the query
     * used to gather it
     * 
     * @throws Exception
     */
    public void testFeatureSourceBounds() throws Exception {
        VersionedPostgisDataStore ds = getDataStore();

        // version enable tree
        ds.setVersioned("tree", true, "gimbo", "versioning trees");

        // now create one feature
        FeatureWriter<SimpleFeatureType, SimpleFeature> fw = ds.getFeatureWriter("tree", Transaction.AUTO_COMMIT);
        assertTrue(fw.hasNext());
        SimpleFeature f = fw.next();
        ReferencedEnvelope oldBounds = ReferencedEnvelope.reference(f.getBounds());
        f.setAttribute(0, gf.createPoint(new Coordinate(50, 50)));
        fw.write();
        fw.close();

        // try to gather an old snapshot and check the bounds are really the old
        // ones
        DefaultQuery q = new DefaultQuery();
        q.setVersion("1");
        ReferencedEnvelope e = ds.getFeatureSource("tree").getBounds(q);
        assertEquals(oldBounds, e);
    }

