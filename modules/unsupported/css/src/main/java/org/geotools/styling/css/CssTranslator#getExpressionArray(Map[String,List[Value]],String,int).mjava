    /**
     * Returns the i-th value of the specified property, as a array of expressions
     * 
     * @param valueMap
     * @param name
     * @param i
     * @return
     */
    private Expression[] getExpressionArray(Map<String, List<Value>> valueMap, String name, int i) {
        Value v = getValue(valueMap, name, i);
        if (v == null) {
            return null;
        }
        if (v instanceof MultiValue) {
            MultiValue m = (MultiValue) v;
            if (m.values.size() == 0) {
                return null;
            }
            Expression[] result = new Expression[m.values.size()];
            for (int j = 0; j < m.values.size(); j++) {
                result[j] = m.values.get(j).toExpression();
            }
            return result;

        } else {
            return new Expression[] { v.toExpression() };
        }
    }

