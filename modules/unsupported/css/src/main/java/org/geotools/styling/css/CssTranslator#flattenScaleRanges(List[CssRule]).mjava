    /**
     * SLD rules can have two or more selectors in OR using different scale ranges, however the SLD
     * model does not allow for that. Flatten them into N different rules, with the same properties,
     * but different selectors
     *
     * @param rules
     * @return
     */
    private List<CssRule> flattenScaleRanges(List<CssRule> rules) {
        List<CssRule> result = new ArrayList<>();
        for (CssRule rule : rules) {
            if (rule.getSelector() instanceof Or) {
                Or or = (Or) rule.getSelector();
                List<Selector> others = new ArrayList<>();
                for (Selector child : or.getChildren()) {
                    ScaleRangeExtractor extractor = new ScaleRangeExtractor();
                    Range<Double> range = extractor.getScaleRange(child);
                    if (range == null) {
                        others.add(child);
                    } else {
                        result.add(new CssRule(child, rule.getProperties(), rule.getComment()));
                    }
                }
                if (others.size() == 1) {
                    result.add(new CssRule(others.get(0), rule.getProperties(), rule.getComment()));
                } else if (others.size() > 0) {
                    result.add(
                            new CssRule(new Or(others), rule.getProperties(), rule.getComment()));
                }
            } else {
                result.add(rule);
            }
        }

        return result;
    }

