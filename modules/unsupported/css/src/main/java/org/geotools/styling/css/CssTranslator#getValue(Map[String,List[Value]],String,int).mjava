    /**
     * Returns the i-th value of the specified property
     * 
     * @param valueMap
     * @param name
     * @param i
     * @return
     */
    private Value getValue(Map<String, List<Value>> valueMap, String name, int i) {
        List<Value> values = valueMap.get(name);
        if (values == null || values.isEmpty()) {
            return null;
        }

        if (values.size() == 1) {
            return values.get(0);
        } else if (i > values.size()) {
            return null;
        } else {
            return values.get(i);
        }
    }

