    @Test
    public void testDynamicColorMapEntryFromCss() throws Exception {
        String css =
                "* { raster-channels: 'auto'; "
                        + "raster-color-map-type: values; "
                        + "raster-color-map: color-map-entry("
                        + "[env('color','#FF0000')], "
                        + "[env('min', 1) + 2 * (env('max',10) - env('min',1)) / 3],"
                        + "[env('customOpacity', 1)])  ;}";
        LinearColorMap colorMap = buildColorMapFromCss(css);
        assertColorMap(colorMap, 255, 0, 0, 7, 255);

        EnvFunction.setGlobalValue("min", 10);
        EnvFunction.setGlobalValue("max", 40);
        EnvFunction.setGlobalValue("customOpacity", 0.5);
        EnvFunction.setGlobalValue("color", "#0000FF");

        colorMap = buildColorMapFromCss(css);
        assertColorMap(colorMap, 0, 0, 255, 30, 128);
    }

