    private LineString parseLineString(
            int dimension, CoordinateReferenceSystem crs, final boolean isSegment)
            throws XMLStreamException, IOException, NoSuchAuthorityCodeException, FactoryException {

        final QName lineStringElement = isSegment ? GML.LineStringSegment : GML.LineString;

        reader.require(START_ELEMENT, GML.NAMESPACE, lineStringElement.getLocalPart());

        crs = crs(crs);
        Coordinate[] coordinates = parseLineStringInternal(dimension, crs);

        reader.require(END_ELEMENT, GML.NAMESPACE, lineStringElement.getLocalPart());

        LineString geom = geomFac.createLineString(coordinates);
        geom.setUserData(crs);
        return geom;
    }

