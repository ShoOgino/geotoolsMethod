    private LinearRing parseRing(final int dimension, CoordinateReferenceSystem crs)
            throws XMLStreamException, IOException, NoSuchAuthorityCodeException, FactoryException {

        String name = reader.getLocalName();

        if (GML.LinearRing.equals(name)) {
            return parseLinearRing(dimension, crs);
        }

        reader.require(START_ELEMENT, this.gmlNamespace, GML.Ring);

        List<LineString> components = new ArrayList<>();

        reader.nextTag();
        while (true) {
            reader.require(START_ELEMENT, this.gmlNamespace, GML.curveMember);
            reader.nextTag();

            name = reader.getLocalName();
            reader.require(START_ELEMENT, this.gmlNamespace, null);
            if (GML.LineString.equals(name)) {
                components.add(parseLineString(dimension, crs));
            } else {
                components.add(parseCurve(dimension, crs));
            }

            reader.nextTag();
            reader.require(END_ELEMENT, this.gmlNamespace, GML.curveMember);
            reader.nextTag();
            if (END_ELEMENT == reader.getEventType() && GML.Ring.equals(reader.getLocalName())) {
                // we're done
                break;
            }
        }
        // createCurvedGeometry() will create a CompoundRing which extends LinearRing
        LinearRing linearRing =
                (LinearRing) this.curvedGeometryFactory.createCurvedGeometry(components);
        linearRing.setUserData(crs);
        return linearRing;
    }

