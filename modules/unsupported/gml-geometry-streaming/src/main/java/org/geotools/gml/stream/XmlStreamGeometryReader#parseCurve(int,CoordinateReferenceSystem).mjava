    private LineString parseCurve(final int dimension, CoordinateReferenceSystem crs)
            throws XMLStreamException, IOException, NoSuchAuthorityCodeException, FactoryException {

        reader.require(START_ELEMENT, GML.NAMESPACE, GML.Curve.getLocalPart());

        List<LineString> lines = new ArrayList<>(2);

        reader.nextTag();
        reader.require(START_ELEMENT, GML.NAMESPACE, GML.segments.getLocalPart());

        reader.nextTag();
        while (true) {
            reader.require(START_ELEMENT, GML.NAMESPACE, null);

            final QName name = reader.getName();

            if (GML.LineStringSegment.equals(name)) {
                lines.add(parseLineStringSegment(dimension, crs));
            } else if (GML.Arc.equals(name)) {
                lines.add(parseArc(dimension, crs));
            } else {
                throw new UnsupportedOperationException(
                        "Curve segment " + name.getLocalPart() + " is not supported yet");
            }

            reader.nextTag();

            if (END_ELEMENT == reader.getEventType()
                    && GML.segments.getLocalPart().equals(reader.getLocalName())) {
                // we're done
                break;
            }
        }

        reader.nextTag();
        reader.require(END_ELEMENT, GML.NAMESPACE, GML.Curve.getLocalPart());

        LineString geom = curvedGeometryFactory.createCurvedGeometry(lines);
        geom.setUserData(crs);
        return geom;
    }

