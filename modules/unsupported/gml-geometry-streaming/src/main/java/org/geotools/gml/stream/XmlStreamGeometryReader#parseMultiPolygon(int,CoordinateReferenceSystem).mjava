    private Geometry parseMultiPolygon(int dimension, CoordinateReferenceSystem crs)
            throws XMLStreamException, IOException, NoSuchAuthorityCodeException, FactoryException {

        reader.require(START_ELEMENT, this.gmlNamespace, GML.MultiPolygon);

        List<Polygon> polygons = new ArrayList<>(2);
        reader.nextTag();
        while (true) {
            reader.require(START_ELEMENT, this.gmlNamespace, GML.polygonMember);
            reader.nextTag();
            reader.require(START_ELEMENT, this.gmlNamespace, GML.Polygon);
            Polygon p = parsePolygon(dimension, crs);
            polygons.add(p);
            reader.nextTag();
            reader.require(END_ELEMENT, this.gmlNamespace, GML.polygonMember);
            reader.nextTag();
            if (END_ELEMENT == reader.getEventType()
                    && GML.MultiPolygon.equals(reader.getLocalName())) {
                // we're done
                break;
            }
        }
        reader.require(END_ELEMENT, this.gmlNamespace, GML.MultiPolygon);

        return geomFac.createMultiPolygon(polygons.toArray(new Polygon[0]));
    }

