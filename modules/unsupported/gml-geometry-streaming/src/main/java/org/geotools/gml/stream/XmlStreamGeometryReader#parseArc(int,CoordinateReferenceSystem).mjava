    private LineString parseArc(int dimension, CoordinateReferenceSystem crs)
            throws XMLStreamException, IOException, NoSuchAuthorityCodeException, FactoryException {
        reader.require(START_ELEMENT, GML.NAMESPACE, GML.Arc.getLocalPart());

        crs = crs(crs);

        reader.nextTag();
        // This could also be: gml:coordinates (deprecated) or three gml:pos or gml:Point elements
        reader.require(START_ELEMENT, GML.NAMESPACE, GML.posList.getLocalPart());

        Coordinate[] coordinates = parseCoordList(dimension, crs);
        reader.nextTag();
        reader.require(END_ELEMENT, GML.NAMESPACE, GML.Arc.getLocalPart());

        if (coordinates.length != 3) {
            throw new IllegalStateException("Arc must have 3 control points");
        }
        LineString geom =
                curvedGeometryFactory.createCircularString(
                        dimension,
                        coordinates[0].getX(),
                        coordinates[0].getY(),
                        coordinates[1].getX(),
                        coordinates[1].getY(),
                        coordinates[2].getX(),
                        coordinates[2].getY());
        geom.setUserData(crs);
        return geom;
    }

