    @Test
    public void testUnsafeXMLStreamReader() throws Exception {
        XMLInputFactory f = XMLInputFactory.newInstance();
        // DTD support allows XXE and XML bombs
        f.setProperty(XMLInputFactory.SUPPORT_DTD, Boolean.TRUE);
        XMLStreamReader r = f.createXMLStreamReader(new StringReader("<root></root>"));
        XmlStreamGeometryReader geometryReader =
                new XmlStreamGeometryReader(r, new GeometryFactory());
        r.nextTag();
        Exception exception =
                assertThrows(IllegalStateException.class, geometryReader::readGeometry);
        assertTrue(exception.getMessage().contains("XMLStreamReader allows DTDs"));
    }

