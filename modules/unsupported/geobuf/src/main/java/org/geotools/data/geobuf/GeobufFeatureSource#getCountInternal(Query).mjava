    @Override
    protected int getCountInternal(Query query) throws IOException {
        try (InputStream in = new FileInputStream(getDataStore().getFile())) {
            GeobufFeatureCollection geobufFeatureCollection = new GeobufFeatureCollection();
            return geobufFeatureCollection.countFeatures(in);
        }
    }

