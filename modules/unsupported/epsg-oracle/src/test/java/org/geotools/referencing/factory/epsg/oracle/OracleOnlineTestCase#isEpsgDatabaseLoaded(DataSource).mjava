    /**
     * Confirm that the EPSG Database tables are present and accounted for.
     *
     * <p>This method is used as part of connect to ensure the EPSG tables have been loaded
     * correctly.
     *
     * @return true if source is non null and tables are present
     */
    public boolean isEpsgDatabaseLoaded(DataSource source) throws Exception {
        if (source == null) return false;
        Connection connection = source.getConnection();
        try {
            DatabaseMetaData metaData = connection.getMetaData();
            String user = fixture.getProperty("user").toUpperCase();
            ResultSet epsgTables = metaData.getTables(null, user, "EPSG%", null);
            List list = new ArrayList();
            while (epsgTables.next()) {
                list.add(epsgTables.getObject(3));
            }
            if (list.isEmpty()) {
                throw new SQLException("Could not find EPSG tables");
            }
            return true;
        } finally {
            connection.close();
        }
    }

