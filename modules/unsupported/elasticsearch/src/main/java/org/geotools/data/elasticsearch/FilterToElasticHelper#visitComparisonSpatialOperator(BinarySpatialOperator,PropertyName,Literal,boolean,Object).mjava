    private void visitComparisonSpatialOperator(
            BinarySpatialOperator filter,
            PropertyName property,
            Literal geometry,
            boolean swapped,
            Object extraData) {

        // if geography case, sanitize geometry first
        Literal geometry1 = clipToWorld(geometry);

        //noinspection RedundantCast
        visitBinarySpatialOperator(
                filter, (Expression) property, (Expression) geometry1, swapped, extraData);

        // if geography case, sanitize geometry first
        if (isWorld(geometry1)) {
            // nothing to filter in this case
            delegate.queryBuilder = MATCH_ALL;
            return;
        } else if (isEmpty(geometry1)) {
            if (!(filter instanceof Disjoint)) {
                delegate.queryBuilder =
                        ImmutableMap.of("bool", ImmutableMap.of("must_not", MATCH_ALL));
            } else {
                delegate.queryBuilder = MATCH_ALL;
            }
            return;
        }

        //noinspection RedundantCast
        visitBinarySpatialOperator(
                filter, (Expression) property, (Expression) geometry1, swapped, extraData);
    }

