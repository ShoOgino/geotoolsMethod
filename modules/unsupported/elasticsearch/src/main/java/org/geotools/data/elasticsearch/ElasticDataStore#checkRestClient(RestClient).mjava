    private static void checkRestClient(RestClient client) throws IOException {
        final Response response = client.performRequest(new Request("GET", "/"));
        final int status = response.getStatusLine().getStatusCode();
        if (status >= 400) {
            final String reason = response.getStatusLine().getReasonPhrase();
            throw new IOException(
                    String.format("Unexpected response from Elasticsearch: %d %s", status, reason));
        }
    }

