    private Envelope computeEnvelope(ReferencedEnvelope outEnvelope, int precision) {
        final String minHash =
                GeoHash.encodeHash(
                        Math.max(-90, outEnvelope.getMinY()), outEnvelope.getMinX(), precision);
        final LatLong minLatLon = GeoHash.decodeHash(minHash);
        final double minLon = minLatLon.getLon() + lonOffset;

        final double width = Math.ceil(outEnvelope.getWidth() / cellWidth) * cellWidth;
        final double maxLon = minLon + width - cellWidth;
        final String maxHash =
                GeoHash.encodeHash(Math.min(90, outEnvelope.getMaxY()), maxLon, precision);
        final LatLong maxLatLon = GeoHash.decodeHash(maxHash);

        return new Envelope(minLon, maxLon, minLatLon.getLat(), maxLatLon.getLat());
    }

