    void visitDistanceSpatialOperator(DistanceBufferOperator filter, PropertyName property, Literal geometry,
            boolean swapped, Object extraData) throws IOException {

        property.accept(delegate, extraData);
        final String key = (String) delegate.field;
        geometry.accept(delegate, extraData);
        final Geometry geo = delegate.currentGeometry;
        final double lat = geo.getCentroid().getY();
        final double lon = geo.getCentroid().getX();
        final double inputDistance = filter.getDistance();
        final String inputUnits = filter.getDistanceUnits();
        final double distance;
        distance = Double.valueOf(toMeters(inputDistance, inputUnits));

        delegate.filterBuilder = QueryBuilders.geoDistanceQuery(key).lat(lat).lon(lon).distance(distance,
                DistanceUnit.METERS);
        // delegate.filterBuilder = FilterBuilders.geoDistanceFilter(key)
        // .lat(lat)
        // .lon(lon)
        // .distance(distance, DistanceUnit.METERS);

        if ((filter instanceof DWithin && swapped) || (filter instanceof Beyond && !swapped)) {
            delegate.filterBuilder = QueryBuilders.boolQuery().mustNot(delegate.filterBuilder);
            // delegate.filterBuilder =
            // FilterBuilders.notFilter(delegate.filterBuilder);
        }
    }

