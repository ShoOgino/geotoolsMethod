    void visitComparisonSpatialOperator(BinarySpatialOperator filter, PropertyName property, Literal geometry,
            boolean swapped, Object extraData) throws IOException {

        // if geography case, sanitize geometry first
        this.geometry = geometry;
        if(isCurrentGeography()) {
            this.geometry = clipToWorld(geometry);
        }

        visitBinarySpatialOperator(filter, (Expression)property, (Expression)this.geometry, swapped, extraData);

        // if geography case, sanitize geometry first
        if(isCurrentGeography()) {
            if(isWorld(this.geometry)) {
                // nothing to filter in this case
                delegate.queryBuilder = MATCH_ALL;
                return;
            } else if(isEmpty(this.geometry)) {
                if(!(filter instanceof Disjoint)) {
                    delegate.queryBuilder = ImmutableMap.of("bool", ImmutableMap.of("must_not", MATCH_ALL));
                } else {
                    delegate.queryBuilder = MATCH_ALL;
                }
                return;
            }
        }

        visitBinarySpatialOperator(filter, (Expression)property, (Expression)this.geometry, swapped, extraData);
    }

