    Number pluckMetricValue(Map<String, Object> bucket, String metricKey, String valueKey) {
        Number value;
        if (null == metricKey || metricKey.trim().length() == 0) {
            value = pluckDocCount(bucket);
        } else {
            if (!bucket.containsKey(metricKey)) {
                LOGGER.warning("Unable to pluck metric, bucket does not contain required key:" + metricKey);
                throw new IllegalArgumentException();
            }
            @SuppressWarnings("unchecked")
            Map<String,Object> metric = (Map<String,Object>) bucket.get(metricKey);
            if (!metric.containsKey(valueKey)) {
                LOGGER.warning("Unable to pluck value, metric does not contain required key:" + valueKey);
                throw new IllegalArgumentException();
            }
            value = (Number) metric.get(valueKey);
        }
        return value;
    }

