    /**
     * Get the digest key of the type and host, port and users.
     * 
     * @param type String
     * @param params Map of String to Serializable
     * @return String
     * @throws IOException when needed params can't be read.
     */
    private static String key(String type, Map<String, Serializable> params) throws IOException {
        final MessageDigest md;
        try {
            md = MessageDigest.getInstance("MD5");
        } catch (NoSuchAlgorithmException e) {
            throw new IOException("Could not get MD5 Digest!", e);
        }

        md.update(type.getBytes(UTF8));
        String host = getValue(HOSTNAME, params);
        md.update(host.getBytes(UTF8));
        Integer port = getValue(HOSTPORT, params);
        md.update(port.byteValue());
        String admin = getValue(ADMIN_USER, params);
        md.update(admin.getBytes(UTF8));
        String proxy = getValue(PROXY_USER, params);
        md.update(proxy.getBytes(UTF8));

        return new Base32().encodeAsString(md.digest());
    }

