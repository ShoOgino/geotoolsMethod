    @Override
    public DataStore createDataStore(Map<String, Serializable> params) throws IOException {
        final String searchHost = (String) getValue(HOSTNAME, params);
        final Integer hostPort = (Integer) getValue(HOSTPORT, params);
        final String indexName = (String) INDEX_NAME.lookUp(params);
        final String searchIndices = (String) SEARCH_INDICES.lookUp(params);
        final String clusterName = (String) getValue(CLUSTERNAME, params);
        final Boolean storeData = (Boolean) getValue(STORE_DATA, params);
        final Boolean localNode = (Boolean) getValue(LOCAL_NODE, params);
        final String dataPath = (String) getValue(DATA_PATH, params);
        final Long scrollSize;
        if (getValue(SCROLL_SIZE, params) instanceof Integer) {
        	scrollSize = ((Integer)getValue(SCROLL_SIZE, params)).longValue();
        } else {
        	scrollSize = (Long)getValue(SCROLL_SIZE, params);
        }        
        final Boolean scrollEnabled = (Boolean)getValue(SCROLL_ENABLED, params);
        
        final Integer scrollTime = (Integer)getValue(SCROLL_TIME_SECONDS, params);
        
        return new ElasticDataStore(searchHost, hostPort, indexName, searchIndices, 
                clusterName, localNode, storeData, dataPath, scrollSize, scrollTime,
                scrollEnabled);
    }

