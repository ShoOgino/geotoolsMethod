    @Override
    public DataStore createDataStore(Map<String, Serializable> params) throws IOException {
        final String searchHost = (String) getValue(HOSTNAME, params);
        final Integer hostPort = (Integer) getValue(HOSTPORT, params);
        final String indexName = (String) INDEX_NAME.lookUp(params);
        final String searchIndices = (String) SEARCH_INDICES.lookUp(params);
        final String clusterName = (String) getValue(CLUSTERNAME, params);
        final Boolean storeData = (Boolean) getValue(STORE_DATA, params);
        final Boolean localNode = (Boolean) getValue(LOCAL_NODE, params);
        final String dataPath = (String) getValue(DATA_PATH, params);
        return new ElasticDataStore(searchHost, hostPort, indexName, searchIndices, 
                clusterName, localNode, storeData, dataPath);
    }

