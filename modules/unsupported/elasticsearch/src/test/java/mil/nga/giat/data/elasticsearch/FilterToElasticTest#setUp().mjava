	@Before
	public void setUp() {
		ff = CommonFactoryFinder.getFilterFactory2();

		SimpleFeatureTypeBuilder typeBuilder = new SimpleFeatureTypeBuilder();
		typeBuilder.setName("test");
		typeBuilder.add("stringAttr", String.class);
		typeBuilder.add("integerAttr", Integer.class);
		typeBuilder.add("longAttr", Long.class);
		typeBuilder.add("booleanAttr", Boolean.class);
		typeBuilder.add("doubleAttr", Double.class);
		typeBuilder.add("floatAttr", Float.class);
		typeBuilder.add("dateAttr", Date.class);

		AttributeDescriptor dateAtt = null;
		AttributeTypeBuilder dateAttBuilder = new AttributeTypeBuilder();
		dateAttBuilder.setName("dateAttr2");
		dateAttBuilder.setBinding(Date.class);
		dateAtt = dateAttBuilder.buildDescriptor("dateAttr2", dateAttBuilder.buildType());
		dateAtt.getUserData().put(DATE_FORMAT, "yyyy-MM-dd");
		typeBuilder.add(dateAtt);

		AttributeDescriptor geoPointAtt = null;
		AttributeTypeBuilder geoPointAttBuilder = new AttributeTypeBuilder();
		geoPointAttBuilder.setName("geo_point");
		geoPointAttBuilder.setBinding(Point.class);
		geoPointAtt = geoPointAttBuilder.buildDescriptor("geo_point", geoPointAttBuilder.buildType());
		geoPointAtt.getUserData().put(GEOMETRY_TYPE, ElasticGeometryType.GEO_POINT);
		typeBuilder.add(geoPointAtt);

		AttributeDescriptor geoShapeAtt = null;
		AttributeTypeBuilder geoShapeAttBuilder = new AttributeTypeBuilder();
		geoShapeAttBuilder.setName("geom");
		geoShapeAttBuilder.setBinding(Geometry.class);
		geoShapeAtt = geoShapeAttBuilder.buildDescriptor("geom", geoShapeAttBuilder.buildType());
		geoShapeAtt.getUserData().put(GEOMETRY_TYPE, ElasticGeometryType.GEO_SHAPE);
		typeBuilder.add(geoShapeAtt);

		AttributeDescriptor analyzedAtt = null;
		AttributeTypeBuilder analyzedAttBuilder = new AttributeTypeBuilder();
		analyzedAttBuilder.setName("analyzed");
		analyzedAttBuilder.setBinding(String.class);
		analyzedAtt = analyzedAttBuilder.buildDescriptor("analyzed", analyzedAttBuilder.buildType());
		analyzedAtt.getUserData().put(ANALYZED, true);
		typeBuilder.add(analyzedAtt);

		featureType = typeBuilder.buildFeatureType();
		setFilterBuilder();

		parameters = new HashMap<>();
		final Hints hints = new Hints();
		hints.put(Hints.VIRTUAL_TABLE_PARAMETERS, parameters);
		query = new Query();
		query.setHints(hints);

		dateFormat = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss.SSS");
		dateFormat.setTimeZone(TimeZone.getTimeZone("UTC"));
	}

