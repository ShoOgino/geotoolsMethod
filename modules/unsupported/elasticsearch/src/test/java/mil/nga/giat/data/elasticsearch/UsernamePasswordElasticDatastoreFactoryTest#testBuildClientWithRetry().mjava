    @Test
    public void testBuildClientWithRetry() throws IOException {
        when(statusLine.getStatusCode()).thenReturn(400).thenReturn(200);
        assertNotNull(dataStoreFactory.createDataStore(params));
        assertEquals(2, dataStoreFactory.getClients().size());
        verify(clientBuilder, times(3)).build();
        verify(restClient, times(1)).close();
    }

