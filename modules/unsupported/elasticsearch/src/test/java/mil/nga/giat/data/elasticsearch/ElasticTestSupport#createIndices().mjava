    private void createIndices() throws IOException {
        // create index and add mappings
        Map<String,Object> settings = new HashMap<>();
        settings.put("settings", ImmutableMap.of("number_of_shards", numShards, "number_of_replicas", numReplicas));
        final String filename;
        if (client.getVersion() < 5) {
            filename = LEGACY_ACTIVE_MAPPINGS_FILE;
        } else if (client.getVersion() > 6.1) {
            filename = NG_ACTIVE_MAPPINGS_FILE;
        } else {
            filename = ACTIVE_MAPPINGS_FILE;
        }
        final InputStream resource = ClassLoader.getSystemResourceAsStream(filename);
        if (resource != null) {
            try (Scanner s = new Scanner(resource)) {
                s.useDelimiter("\\A");
                Map<String, Object> source = mapReader.readValue(s.next());
                if (client.getVersion() < 7) {
                    Map<String,Object> mappings = new HashMap<>();
                    mappings.put(TYPE_NAME, source);
                    settings.put("mappings", mappings);
                } else {
                    settings.put("mappings", source);
                }
            }
        }
        performRequest("PUT", "/" + indexName, settings);

        // add alias
        Map<String,Object> aliases = ImmutableMap.of("actions",
                ImmutableList.of(ImmutableMap.of("index", indexName, "alias", indexName + "_alias")));
        performRequest("PUT", "/_alias", aliases);
    }

