    @Test
    public void testSetParams() {
        String aggKey = "myagg";
        String metricKey = "mymetric";
        String valueKey = "myvalue";
        List<String> params = new ArrayList<String>();
        params.add(aggKey);
        params.add(metricKey);
        params.add(valueKey);
        params.add(NestedAggGeoHashGrid.SELECT_SMALLEST);
        params.add(NestedAggGeoHashGrid.RASTER_FROM_KEY);
        params.add("key1:1;key2:2");
        geohashGrid.setParams(params);
        assertEquals(aggKey, geohashGrid.getNestedAggKey());
        assertEquals(metricKey, geohashGrid.getMetricKey());
        assertEquals(valueKey, geohashGrid.getValueKey());
        assertEquals(NestedAggGeoHashGrid.SELECT_SMALLEST, geohashGrid.getSelectionStrategy());
        assertEquals(NestedAggGeoHashGrid.RASTER_FROM_KEY, geohashGrid.getRasterStrategy());
        Map<String, Integer> termsMap = geohashGrid.getTermsMap();
        assertEquals(2, termsMap.size());
        assertEquals(new Integer(1), (Integer) termsMap.get("key1"));
        assertEquals(new Integer(2), (Integer) termsMap.get("key2"));
    }

