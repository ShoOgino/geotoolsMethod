        @Override
        public boolean matches(Request argument) {
            if (argument == null) {
                return false;
            }
            final List<Header> headers = argument.getOptions().getHeaders();
            if (!this.method.equals(argument.getMethod())) {
                return false;
            }
            if (!this.endpoint.equals(argument.getEndpoint())) {
                return false;
            }
            if (this.entityMatcher == null && argument.getEntity() != null) {
                return false;
            }
            if (this.entityMatcher != null && !this.entityMatcher.matches((ByteArrayEntity) argument.getEntity())) {
                return false;
            }
            if (this.headerMatcher != null && headers.isEmpty()) {
                return false;
            }
            if (this.headerMatcher == null && !headers.isEmpty()) {
                return false;
            }
            return this.headerMatcher == null || headerMatcher.matches((BasicHeader) headers.get(0));
        }

