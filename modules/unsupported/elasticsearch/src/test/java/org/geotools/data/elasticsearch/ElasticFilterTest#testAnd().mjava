    @Test
    public void testAnd() {
        And filter = ff.and(ff.id(ff.featureId("id1")), ff.id(ff.featureId("id2")));
        Map<String, Object> expected =
                ImmutableMap.of(
                        "bool",
                        ImmutableMap.of(
                                "must",
                                ImmutableList.of(
                                        ImmutableMap.of(
                                                "ids",
                                                ImmutableMap.of("values", ImmutableList.of("id1"))),
                                        ImmutableMap.of(
                                                "ids",
                                                ImmutableMap.of(
                                                        "values", ImmutableList.of("id2"))))));

        builder.visit(filter, null);
        assertTrue(builder.createCapabilities().fullySupports(filter));
        assertEquals(expected, builder.getQueryBuilder());
    }

