    @Test
    public void testAggregationWithProxyClient() throws IOException {
        final RequestMatcher matcher =
                new RequestMatcher(
                        "POST",
                        "/status_s/_search",
                        "{\"aggregations\":{\"ageohash_grid_agg\":{\"geohash_grid\": {\"field\":\"a_field\",\"precision\":1}}}}",
                        "runAsTest");
        when(mockProxyRestClient.performRequest(argThat(matcher))).thenReturn(mockResponse);

        ElasticRequest request = new ElasticRequest();
        request.setAggregations(
                ImmutableMap.of(
                        "ageohash_grid_agg",
                        ImmutableMap.of(
                                "geohash_grid",
                                ImmutableMap.of("field", "a_field", "precision", 1))));
        proxyClient.search("status_s", "active", request);
    }

