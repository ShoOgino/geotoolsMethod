    @Test
    public void testLegacyGetTypes() throws IOException {
        String content =
                "{\"status_s\": {\"mappings\": "
                        + "{\"active\": {\"properties\": {\"status_s\": {\"type\": \"keyword\"}}}}}}";
        InputStream inputStream = new ByteArrayInputStream(content.getBytes());
        when(mockEntity.getContent()).thenReturn(inputStream);
        mockVersion("6.0.0");
        when(mockRestClient.performRequest(new Request("GET", "/status_s/_mapping")))
                .thenReturn(mockResponse);

        List<String> names = client.getTypes("status_s");
        assertEquals(1, names.size());
        assertEquals("active", names.get(0));
    }

