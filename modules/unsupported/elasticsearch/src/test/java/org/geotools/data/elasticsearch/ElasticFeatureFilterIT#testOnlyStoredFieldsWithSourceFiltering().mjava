    @Test
    public void testOnlyStoredFieldsWithSourceFiltering() throws Exception {
        init();
        dataStore.setSourceFilteringEnabled(true);
        Name name = new NameImpl("active");
        for (final ElasticAttribute attribute : dataStore.getElasticAttributes(name)) {
            if (!attribute.isStored()) {
                attribute.setUse(false);
            }
        }
        assertEquals(11, featureSource.getCount(Query.ALL));
        SimpleFeatureIterator features = featureSource.getFeatures().features();
        for (int i = 0; i < 11; i++) {
            assertTrue(features.hasNext());
            features.next();
        }
    }

