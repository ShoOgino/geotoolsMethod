    @Test
    public void testBuildClientWithoutAuth() throws IOException {
        params = getParams("localhost", 9200, null, null);
        assertNotNull(dataStoreFactory.createDataStore(params));
        verify(clientBuilder, times(1)).build();
        assertEquals(1, hostsCaptor.getValue().length);
        assertEquals("localhost", hostsCaptor.getValue()[0].getHostName());
        assertEquals(9200, hostsCaptor.getValue()[0].getPort());

        assertEquals(1, configCallbackCaptor.getAllValues().size());
        configCallbackCaptor.getAllValues().get(0).customizeHttpClient(httpClientBuilder);
        assertEquals(0, credentialsProviderCaptor.getAllValues().size());

        assertEquals(1, threadFactoryCaptor.getAllValues().size());
        ThreadFactory threadFactory = threadFactoryCaptor.getAllValues().get(0);
        Thread thread = threadFactory.newThread(mock(Runnable.class));
        assertEquals("esrest-asynchttp-ADMIN-1", thread.getName());
    }

