    @Test
    public void testOnlySourceFieldsWithSourceFiltering() throws Exception {
        init();
        dataStore.setSourceFilteringEnabled(true);
        Name name = new NameImpl("active");
        for (final ElasticAttribute attribute : dataStore.getElasticAttributes(name)) {
            if (attribute.isStored()) {
                attribute.setUse(false);
            }
        }
        featureSource = (ElasticFeatureSource) dataStore.getFeatureSource(TYPE_NAME);

        assertEquals(11, featureSource.getCount(Query.ALL));

        try (SimpleFeatureIterator features = featureSource.getFeatures().features()) {
            for (int i = 0; i < 11; i++) {
                assertTrue(features.hasNext());
                features.next();
            }
        }
    }

