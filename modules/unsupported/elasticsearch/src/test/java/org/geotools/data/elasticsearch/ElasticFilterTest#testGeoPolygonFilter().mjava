    @Test
    public void testGeoPolygonFilter() throws CQLException {
        Intersects filter =
                (Intersects)
                        ECQL.toFilter(
                                "INTERSECTS(\"geo_point\", POLYGON((0 0, 0 1.1, 1.1 1.1, 1.1 0, 0 0)))");
        List<List<Double>> points =
                ImmutableList.of(
                        ImmutableList.of(0., 0.),
                        ImmutableList.of(0., 1.1),
                        ImmutableList.of(1.1, 1.1),
                        ImmutableList.of(1.1, 0.),
                        ImmutableList.of(0., 0.));
        Map<String, Object> expected =
                ImmutableMap.of(
                        "bool",
                        ImmutableMap.of(
                                "must",
                                ElasticConstants.MATCH_ALL,
                                "filter",
                                ImmutableMap.of(
                                        "geo_polygon",
                                        ImmutableMap.of(
                                                "geo_point", ImmutableMap.of("points", points)))));

        builder.visit(filter, null);
        assertTrue(builder.createCapabilities().fullySupports(filter));
        assertEquals(expected, builder.getQueryBuilder());
    }

