    @Override
    protected ReferencedEnvelope getBoundsInternal(Query query) throws IOException {
        ReferencedEnvelope env = new ReferencedEnvelope(getDataStore().getCrs());

        if (query.getFilter() == Filter.INCLUDE) {

            try (GeoJSONReader reader = getDataStore().read()) {
                try (FeatureIterator<SimpleFeature> itr = reader.getIterator()) {
                    while (itr.hasNext()) {
                        SimpleFeature f = itr.next();
                        env.expandToInclude(
                                ((Geometry) f.getDefaultGeometry()).getEnvelopeInternal());
                    }
                }
            }
        }
        return env;
    }

