    @Override
    public DataStore createNewDataStore(Map<String, ?> params) throws IOException {
        URL url = (URL) URL_PARAM.lookUp(params);
        File file = (File) FILE_PARAM.lookUp(params);
        if (url == null && file == null) {
            throw new IOException("No file or url parameter provided");
        }
        if (url != null && "file".equalsIgnoreCase(url.getProtocol())) {
            file = URLs.urlToFile(url);
        }
        GeoJSONDataStore ret;
        if (file != null) {
            if (!file.exists()) {
                boolean ok = file.createNewFile();
                if (!ok) {
                    throw new IOException("Unable to create file " + file.getAbsoluteFile());
                }
            }
            ret = new GeoJSONDataStore(file);
        } else {
            ret = new GeoJSONDataStore(url);
        }

        Boolean bounds = (Boolean) WRITE_BOUNDS.lookUp(params);
        if (bounds != null) {
            ret.setWriteBounds(bounds);
        }
        Boolean quick = (Boolean) QUICK_SCHEMA.lookUp(params);
        if (quick != null) {
            ret.setQuickSchema(quick);
        }
        return ret;
    }

