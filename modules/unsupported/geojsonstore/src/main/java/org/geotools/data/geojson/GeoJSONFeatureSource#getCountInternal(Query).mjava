    @Override
    protected int getCountInternal(Query query) throws IOException {
        collection = fetchFeatures();
        FeatureCollection<?, ?> sub = collection.subCollection(query.getFilter());
        return sub.size();
    }

