	@Override
	protected int getCountInternal(Query query) throws IOException {
		collection = fetchFeatures();
		if (query.getFilter() == Filter.INCLUDE) {

			return collection.size();

		} else {

			FeatureCollection sub = collection.subCollection(query.getFilter());
			return sub.size();

		}

	}

