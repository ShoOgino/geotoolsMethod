    @Override
    public SimpleFeatureType getFeatureType() {
        GeoJSONDataStore ds = (GeoJSONDataStore) state.getEntry().getDataStore();
        try {
            SimpleFeatureType schema = (SimpleFeatureType) ds.getSchema(state.getEntry().getName());
            if (schema == null) {
                schema = (SimpleFeatureType) ds.getSchema("features");
            }
            return schema;
        } catch (IOException e) {
            // TODO Auto-generated catch block
            java.util.logging.Logger.getGlobal().log(java.util.logging.Level.INFO, "", e);
        }
        return null;
    }

