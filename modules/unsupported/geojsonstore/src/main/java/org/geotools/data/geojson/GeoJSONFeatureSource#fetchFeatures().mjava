    /**
     * @param query
     * @return
     * @throws IOException
     */
    private FeatureCollection<?, ?> fetchFeatures() throws IOException {
        // Ideally we would cache the features here but then things go badly when using transactions
        LOGGER.fine("fetching reader from datastore");
        GeoJSONReader reader = getDataStore().read();
        collection = reader.getFeatures();
        LOGGER.fine("Got " + collection.size() + " features");

        return collection;
    }

