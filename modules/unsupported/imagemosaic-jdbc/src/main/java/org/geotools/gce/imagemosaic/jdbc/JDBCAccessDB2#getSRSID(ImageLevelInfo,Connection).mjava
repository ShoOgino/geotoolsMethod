    /*
     * (non-Javadoc)
     *
     * @see org.geotools.gce.imagemosaic.jdbc.JDBCAccessBase#getSRSID(org.geotools.gce.imagemosaic.jdbc.ImageLevelInfo,
     *      java.sql.Connection)
     */
    @Override
    protected Integer getSRSID(ImageLevelInfo li, Connection con) throws IOException {
        Integer result = null;
        String schema = null;

        try {
            schema = getSchemaFromSpatialTable(li.getSpatialTableName());

            PreparedStatement s = null;
            try {
                if (schema == null) {
                    s = con.prepareStatement(SRSSelectCurrentSchema);
                    s.setString(1, li.getSpatialTableName());
                    s.setString(2, config.getGeomAttributeNameInSpatialTable());
                } else {
                    s = con.prepareStatement(SRSSelect);
                    s.setString(1, schema);
                    s.setString(2, li.getSpatialTableName());
                    s.setString(3, config.getGeomAttributeNameInSpatialTable());
                }

                try (ResultSet r = s.executeQuery()) {
                    if (r.next()) {
                        result = (Integer) r.getObject(1);
                    }
                }
            } finally {
                if (s != null) s.close();
            }
        } catch (SQLException e) {
            LOGGER.log(Level.SEVERE, e.getMessage(), e);
            throw new IOException(e);
        }

        if (result == null) {
            String msg =
                    MessageFormat.format(
                            "No entry in db2gse.st_geometry_columns for {0},{1},{2}",
                            new Object[] {
                                (schema != null) ? schema : "currrent schema",
                                li.getSpatialTableName(),
                                config.getGeomAttributeNameInSpatialTable()
                            });
            LOGGER.log(Level.SEVERE, msg);
            throw new IOException(msg);
        }

        return result;
    }

