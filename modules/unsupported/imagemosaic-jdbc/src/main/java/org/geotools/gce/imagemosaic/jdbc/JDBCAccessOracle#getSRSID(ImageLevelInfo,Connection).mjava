    /*
     * (non-Javadoc)
     *
     * @see org.geotools.gce.imagemosaic.jdbc.JDBCAccessBase#getSRSID(org.geotools.gce.imagemosaic.jdbc.ImageLevelInfo,
     *      java.sql.Connection)
     */
    @Override
    protected Integer getSRSID(ImageLevelInfo li, Connection con) throws IOException {
        Number result = null;

        String schema = getSchemaFromSpatialTable(li.getSpatialTableName());
        try (PreparedStatement s = prepareSRSStatement(li, con, schema);
                ResultSet r = s.executeQuery()) {

            if (r.next()) {
                result = (Number) r.getObject(1);
            }
        } catch (SQLException e) {
            LOGGER.log(Level.SEVERE, e.getMessage(), e);
            throw new IOException(e);
        }

        if (result == null) {
            String msg = null;

            if (schema != null) {
                msg =
                        MessageFormat.format(
                                "No entry in ALL_SDO_GEOM_METADATA where for {0},{1},{2}",
                                new Object[] {
                                    schema,
                                    li.getSpatialTableName(),
                                    config.getGeomAttributeNameInSpatialTable()
                                });
            } else {
                msg =
                        MessageFormat.format(
                                "No entry in USER_SDO_GEOM_METADATA where for {0},{1}",
                                new Object[] {
                                    li.getSpatialTableName(),
                                    config.getGeomAttributeNameInSpatialTable()
                                });
            }

            LOGGER.log(Level.SEVERE, msg);
            throw new IOException(msg);
        }

        return result.intValue();
    }

