    /** Expand the Transformed Requested Envelope to fit the virtual tiles grid. * */
    private void expandRequestedEnvelope(ImageMosaicJDBCReaderState state) {

        GeneralEnvelope ret = state.getRequestedEnvelopeTransformed();
        ImageLevelInfo levelInfo = state.getImageLevelInfo();

        double xminRe = ret.getMinimum(0);
        double xmaxRe = ret.getMaximum(0);
        double yminRe = ret.getMinimum(1);
        double ymaxRe = ret.getMaximum(1);

        double xminLv = levelInfo.getExtentMinX();
        double yminLv = levelInfo.getExtentMinY();
        double xresLv = levelInfo.getResX();
        double yresLv = levelInfo.getResY();

        // pad one more pixel for a better interpolation
        double xminXt = (Math.floor((xminRe - xminLv) / xresLv) - 1) * xresLv + xminLv;
        double yminXt = (Math.floor((yminRe - yminLv) / yresLv) - 1) * yresLv + yminLv;
        double[] minXY = new double[] {xminXt, yminXt};

        // pad one more pixel for a better interpolation
        double xmaxXt = (Math.ceil((xmaxRe - xminLv) / xresLv) + 1) * xresLv + xminLv;
        double ymaxXt = (Math.ceil((ymaxRe - yminLv) / yresLv) + 1) * yresLv + yminLv;
        double[] maxXY = new double[] {xmaxXt, ymaxXt};

        GeneralEnvelope expanded = new GeneralEnvelope(minXY, maxXY);
        expanded.setCoordinateReferenceSystem(ret.getCoordinateReferenceSystem());

        state.setRequestedEnvelopeTransformedExpanded(expanded);
    }

