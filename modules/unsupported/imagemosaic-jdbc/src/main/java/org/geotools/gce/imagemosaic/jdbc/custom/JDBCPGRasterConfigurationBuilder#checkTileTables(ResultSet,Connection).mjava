    /**
     * Check whether the main metadata table is present and all the tileTables specified inside it
     * (if any) exists too. In that case, no need to do the raster import step.
     *
     * @param set the {@link ResultSet} coming from the previous selection made on tileTable column.
     */
    private boolean checkTileTables(ResultSet set, Connection connection) throws SQLException {
        boolean proceed = true;
        boolean found = false;

        // Check that metadata table exists and all referred tile tables exixst too
        while (set.next() && proceed) {
            // A table with the specified name has been found.
            // Checking whether the raster tile table exist too
            final String tileTableName = set.getString("tiletable");
            final String selectMetadataTableQuery =
                    TILE_TABLE_CHECK_SQL.replace((MOSAIC_KEY), tileTableName);
            try {
                if (LOGGER.isLoggable(Level.FINE)) {
                    LOGGER.fine("Looking for mosaic table already created");
                }
                try (PreparedStatement ps = connection.prepareStatement(selectMetadataTableQuery);
                        ResultSet tileSet = ps.executeQuery()) {
                    if (tileSet.next()) {
                        // We have found the tileTable referred inside metadata table
                        // Therefore, proceeding with the next one
                        if (LOGGER.isLoggable(Level.FINE)) {
                            LOGGER.fine("tile table " + tileTableName + " has been found");
                        }
                        if (set.isLast()) {
                            // I'm checking the latest entry. All tables have been found.
                            // No more checks are needed
                            proceed = false;
                            found = true;
                        }
                        continue;
                    }
                }
            } catch (SQLException sqle) {
                if (LOGGER.isLoggable(Level.FINE)) {
                    LOGGER.fine(sqle.getLocalizedMessage());
                }
                final String message =
                        "Database contains the metadata table but some referred tile tables are missing. \n"
                                + "Please, cleanup your database and retry the configuration";
                // Logging a message reporting that the database is inconsistent (metadata table
                // exists, but only a few
                // referred raster tile table actually exist). We need some user intervention
                if (LOGGER.isLoggable(Level.SEVERE)) {
                    LOGGER.severe(message);
                }
                throw new IllegalArgumentException(message);
            }
        }

        return found;
    }

