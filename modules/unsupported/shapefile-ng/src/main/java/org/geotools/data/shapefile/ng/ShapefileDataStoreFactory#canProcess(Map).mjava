    @Override
    public boolean canProcess(Map params) {
        if (!super.canProcess(params)) {
            return false;
        }
        try {
            String sort = (String) SORT.lookUp(params);
            if( sort == null || "disk".equals( sort )){
                // this is fine we can support that
            }
            else if ("memory".equals(sort) || "none".equals(sort)){
                return false; // not supported
            }
            else {
                LOGGER.warning("Unexpected sort level request: '"+sort+"'");
            }
        } catch (IOException e) {
            return false;
        }
        try {
            URL url = (URL) URLP.lookUp(params);
            if (canProcess(url)) {
                return true;
            } else {
                // maybe it's a directory?
                Object fileType = FILE_TYPE.lookUp(params);
                File dir = DataUtilities.urlToFile(url);
                // check for null fileType for backwards compatibility
                return dir.isDirectory() && (fileType == null || "shapefile".equals(fileType));
            }
        } catch (IOException e) {
            return false;
        }
    }

