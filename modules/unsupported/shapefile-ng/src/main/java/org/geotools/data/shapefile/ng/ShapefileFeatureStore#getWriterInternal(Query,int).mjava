    @Override
    protected FeatureWriter<SimpleFeatureType, SimpleFeature> getWriterInternal(Query query,
            int flags) throws IOException {
        ShapefileFeatureReader reader = (ShapefileFeatureReader) delegate.getReaderInternal(query);
        return new ShapefileFeatureWriter(delegate.shpFiles, reader, getDataStore().getCharset(),
                getDataStore().getTimeZone());
    }

