    protected SimpleFeatureCollection loadFeatures(String resource, Charset charset,
            Query q) throws Exception {
        if (q == null)
            q = new DefaultQuery();
        URL url = TestData.url(resource);
        store = new ShapefileDataStore(url);
        store.setCharset(charset);
        SimpleFeatureSource fs = store.getFeatureSource(store.getTypeNames()[0]);
        return fs.getFeatures(q);
    }

