    /**
     * Update the IM with the sum of the IMs for each component
     *
     * @param IntersectionMatrix
     */
    private void updateIM(IntersectionMatrix im) {

        for (Iterator ei = isolatedEdges.iterator(); ei.hasNext(); ) {
            Edge e = (Edge) ei.next();
            e.updateIM(im);
        }

        for (Iterator ni = nodes.iterator(); ni.hasNext(); ) {
            RelateNode node = (RelateNode) ni.next();
            // System.out.println(node.getCoordinate());
            node.updateIM(im);
            node.updateIMFromEdges(im);
        }
    }

