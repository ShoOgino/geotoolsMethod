    /**
     * Creates a <code>Polygon</code> using the next token in the stream.
     *
     * @return a <code>Polygon</code> specified by the next token in the stream
     * @throws ParseException if the coordinates used to create the <code>Polygon</code> shell and
     *     holes do not form closed linestrings, or if an unexpected token was encountered.
     * @throws IOException if an I/O error occurs
     */
    @SuppressFBWarnings("NP_NULL_PARAM_DEREF_NONVIRTUAL")
    private Surface readPolygonText() throws IOException, ParseException {

        String nextToken = getNextEmptyOrOpener();

        if (nextToken.equals(EMPTY)) {
            // Suppressing for now, but this is actually guaranteed to NPE
            return new SurfaceImpl(
                    (SurfaceBoundary)
                            null); // this.primitiveFactory.createSurface((SurfaceBoundary) null);
        }

        ArrayList<Ring> holes = new ArrayList<Ring>();
        Ring shell = this.readLinearRingText();
        nextToken = getNextCloserOrComma();
        while (nextToken.equals(COMMA)) {
            Ring hole = readLinearRingText();
            holes.add(hole);
            nextToken = getNextCloserOrComma();
        }
        SurfaceBoundary sfb =
                new SurfaceBoundaryImpl(
                        crs, shell,
                        holes); // this.primitiveFactory.createSurfaceBoundary(shell, holes);
        return new SurfaceImpl(sfb); // this.primitiveFactory.createSurface(sfb);
    }

