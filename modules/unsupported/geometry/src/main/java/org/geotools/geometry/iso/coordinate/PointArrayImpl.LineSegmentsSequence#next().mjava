        /** @return LineSegmentImpl */
        public LineSegmentImpl next() {
            double[] p0 = this.getStartCoordinate(this.index);
            double[] p1 = this.getEndCoordinate(this.index);

            //			LineSegmentImpl ls = FeatGeomFactoryImpl
            //					.getDefaultCoordinateFactory(p0.length).createLineSegment(
            //							p0, p1, this.length);
            LineSegmentImpl ls =
                    new LineSegmentImpl(
                            pointArray.getCoordinateReferenceSystem(), p0, p1, this.length);

            this.length = DoubleOperation.add(this.length, AlgoPointND.getDistance(p0, p1));
            // this.length += AlgoPointND.getDistance(p0, p1);

            return ls;
        }

