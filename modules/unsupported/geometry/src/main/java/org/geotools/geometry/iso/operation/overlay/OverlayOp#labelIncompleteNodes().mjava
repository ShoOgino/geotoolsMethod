    /**
     * Incomplete nodes are nodes whose labels are incomplete. (e.g. the location for one Geometry
     * is null). These are either isolated nodes, or nodes which have edges from only a single
     * Geometry incident on them.
     *
     * <p>Isolated nodes are found because nodes in one graph which don't intersect nodes in the
     * other are not completely labelled by the initial process of adding nodes to the nodeList. To
     * complete the labelling we need to check for nodes that lie in the interior of edges, and in
     * the interior of areas.
     *
     * <p>When each node labelling is completed, the labelling of the incident edges is updated, to
     * complete their labelling as well.
     */
    private void labelIncompleteNodes() {
        for (Iterator ni = graph.getNodes().iterator(); ni.hasNext(); ) {
            Node n = (Node) ni.next();
            Label label = n.getLabel();
            if (n.isIsolated()) {
                if (label.isNull(0)) labelIncompleteNode(n, 0);
                else labelIncompleteNode(n, 1);
            }
            // now update the labelling for the DirectedEdges incident on this
            // node
            ((DirectedEdgeStar) n.getEdges()).updateLabelling(label);
            // n.print(System.out);
        }
    }

