    /**
     * Executes a linear Interpolation between two positions and returns the DirectPosition at the
     * distance 'par' on this straight line
     *
     * <p>This method is NON-ROBUST, e.g. it might suffer by errors caused by the Floating-point
     * arithmetic
     *
     * @param p0 - start position of linear interpolation
     * @param p1 - end position of linear interpolation
     * @param par - distance on the straight line, for which to search DirectPosition (from p0 to
     *     p1)
     * @return Position on the straight line at parameter 'par'
     */
    public static DirectPositionImpl linearInterpolate(
            DirectPosition p0, DirectPosition p1, double par) {
        // Test ok

        // 0.0 <= factor <= 1.0
        // par = 0 => result = dp0
        // par = 1 => result = dp1
        double[] coord = AlgoPointND.evaluate(p0.getCoordinate(), p1.getCoordinate(), par);
        return new DirectPositionImpl(p0.getCoordinateReferenceSystem(), coord);
    }

