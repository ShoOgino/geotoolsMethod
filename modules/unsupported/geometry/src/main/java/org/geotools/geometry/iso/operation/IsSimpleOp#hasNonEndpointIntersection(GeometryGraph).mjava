    /**
     * For all edges, check if there are any intersections which are NOT at an endpoint. The
     * Geometry is not simple if there are intersections not at endpoints.
     */
    private boolean hasNonEndpointIntersection(GeometryGraph graph) {
        for (Iterator i = graph.getEdgeIterator(); i.hasNext(); ) {
            Edge e = (Edge) i.next();
            int maxSegmentIndex = e.getMaximumSegmentIndex();
            for (Iterator eiIt = e.getEdgeIntersectionList().iterator(); eiIt.hasNext(); ) {
                EdgeIntersection ei = (EdgeIntersection) eiIt.next();
                if (!ei.isEndPoint(maxSegmentIndex)) return true;
            }
        }
        return false;
    }

