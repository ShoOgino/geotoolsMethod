    /**
     * Returns whether the given quadrant lies within the given halfplane (specified by its
     * right-hand quadrant).
     */
    public static boolean isInHalfPlane(int quad, int halfPlane) {
        if (halfPlane == 3) {
            return quad == 3 || quad == 0;
        }
        return quad == halfPlane || quad == halfPlane + 1;
    }

