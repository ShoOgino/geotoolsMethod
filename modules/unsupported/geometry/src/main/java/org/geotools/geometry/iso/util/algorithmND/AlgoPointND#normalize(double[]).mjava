	/**
	 * Normalizes a vector which begins at the origin and ends at <code>p</code> to length 1
	 * 
	 * Note: This method is NON-ROBUST due to floating-point rounding errors.
	 *       Inexact results according to floating-point rounding errors may be caused.
	 * 
	 * @param p the end point of the vector
	 * 
	 * @return double[] End point of the normalized vector
	 * @return NULL if the result is not valid (for example when <code>p</code> is the origin)
	 */
	public static double[] normalize(double[] p) {
		// Test OK
        double len = getDistanceToOrigin(p);
        double[] rCoord = null;
        if ( len > 0.0 ) {
        	rCoord = scale(p,1.0 / len);
        } else {
    		for (int i=0, n=p.length; i<n; ++i) {
    			p[i] = 0.0;
    		}
        }
        return rCoord;
	}

