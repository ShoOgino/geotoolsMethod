    /**
     * Adds the point(s) defined by a Geometry to the centroid total. If the geometry is not of
     * dimension 0 it does not contribute to the centroid.
     *
     * @param geom the geometry to add
     */
    public void add(GeometryImpl geom) {
        if (geom instanceof PointImpl) {
            this.add(((PointImpl) geom).getDirectPosition());
        } else if (geom instanceof MultiPointImpl) {
            Iterator<Point> points = ((MultiPointImpl) geom).getElements().iterator();
            while (points.hasNext()) {
                this.add((DirectPositionImpl) points.next().getDirectPosition());
            }
        } else if (geom instanceof CompositePointImpl) {
            this.add((DirectPositionImpl) ((CompositePointImpl) geom).getGenerators().get(0));
        }
    }

