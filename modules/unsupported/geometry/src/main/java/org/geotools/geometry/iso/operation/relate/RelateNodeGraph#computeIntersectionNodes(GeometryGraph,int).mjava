    /**
     * Insert nodes for all intersections on the edges of a Geometry. Label the created nodes the
     * same as the edge label if they do not already have a label. This allows nodes created by
     * either self-intersections or mutual intersections to be labelled. Endpoint nodes will already
     * be labelled from when they were inserted.
     *
     * <p>Precondition: edge intersections have been computed.
     */
    public void computeIntersectionNodes(GeometryGraph geomGraph, int argIndex) {
        for (Iterator edgeIt = geomGraph.getEdgeIterator(); edgeIt.hasNext(); ) {
            Edge e = (Edge) edgeIt.next();
            int eLoc = e.getLabel().getLocation(argIndex);
            for (Iterator eiIt = e.getEdgeIntersectionList().iterator(); eiIt.hasNext(); ) {
                EdgeIntersection ei = (EdgeIntersection) eiIt.next();
                RelateNode n = (RelateNode) nodes.addNode(ei.coord);
                if (eLoc == Location.BOUNDARY) n.setLabelBoundary(argIndex);
                else {
                    if (n.getLabel().isNull(argIndex)) n.setLabel(argIndex, Location.INTERIOR);
                }
                // Debug.println(n);
            }
        }
    }

