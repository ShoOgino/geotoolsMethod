    /**
     * Construct a opendatastore using the params.
     * @param params
     * @return DataStore
     * @throws IOException
     */
    public DataStore createDataStore(Map<String, Serializable> params) throws IOException {
        if (!canProcess(params)) {
            throw new IOException("Invalid parameters at createDataStore inside Factory");
        }
        
        URL url = (URL) URLP.lookUp(params);
        String namespaceURI = (String) NAMESPACEP.lookUp(params);
        
        String user = (String) USERP.lookUp(params); 
        String password = (String) PASSWDP.lookUp(params);
        Integer timeout = (Integer) TIMEOUTP.lookUp(params);
        if(timeout == null) {
            timeout = 5000;
        } else {
            timeout *= 1000;
        }
        
        SFSDataStore store = new SFSDataStore(url, namespaceURI, user, password, timeout);
        
        return store;
    }

