    /**
     * This method requests the response from the URL either through GET/POST
     * and returns the response as a stream
     * The request is going to be a POST one if postData is not null, a GET otherwise
     * @param is
     * @return String
     * @throws IOException
     */
    InputStream resourceToStream(String resource, String postData) throws MalformedURLException,
            IOException, ProtocolException {
        // TODO: use commons http client + persistent connections instead
        URL url = new URL(baseURL + resource);
        URLConnection urlConnection = url.openConnection();
        
        urlConnection.setDoInput(true);
        if(postData != null) {
            ((HttpURLConnection) urlConnection).setRequestMethod("POST");
            urlConnection.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");
            urlConnection.setDoOutput(true);
            
            /*write the data to server*/
            OutputStreamWriter wr = null;
            try {
                wr = new OutputStreamWriter(urlConnection.getOutputStream());
                wr.write(postData);
                wr.flush();
            } finally {
                if(wr != null) {
                    wr.close();
                }
            }
        } else {
            ((HttpURLConnection) urlConnection).setRequestMethod("GET");
        }
        
        /* Get the response from the server*/
        InputStream is = urlConnection.getInputStream();
        return is;
    }

