    /**
     * This method has been borrowed from
     * https://svn.osgeo.org/geotools/trunk/modules/library/jdbc/src/main/java/org/geotools/jdbc/JDBCFeatureSource.java
     * Helper method for splitting a filter.
     */
    Filter[] splitFilter(Filter fnOriginalFilter) {
        /* Split filter into 2 parts */
        Filter[] split = new Filter[2];
        if (fnOriginalFilter != null) {
            // create a filter splitter
            PostPreProcessFilterSplittingVisitor splitter =
                    new PostPreProcessFilterSplittingVisitor(
                            ods.ODS_FILTER_CAPABILITIES, getSchema(), null);

            fnOriginalFilter.accept(splitter, null);
            /* Natively supported*/
            split[0] = splitter.getFilterPre();
            /* Not natively supported*/
            split[1] = splitter.getFilterPost();
        }
        /* Getting simplest possible filter*/
        SimplifyingFilterVisitor visitor = new SimplifyingFilterVisitor();
        visitor.setFeatureType(getSchema());

        split[0] = (Filter) split[0].accept(visitor, null);

        split[1] = (Filter) split[1].accept(visitor, null);

        return split;
    }

