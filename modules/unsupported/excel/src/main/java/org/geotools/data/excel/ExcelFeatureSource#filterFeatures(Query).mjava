    /**
     * regenerate the filteredFeatures list if the query has changed since the last time we did
     * this.
     *
     * @param query
     */
    private void filterFeatures(Query query) {
        filteredFeatures = new ArrayList<SimpleFeature>();

        for (SimpleFeature feature : features) {

            if (query.getFilter().evaluate(feature)) {
                filteredFeatures.add(feature);
            }
        }

        lastQuery = query;
    }

