    @Override
    protected int getCountInternal(Query query) throws IOException {
        if (lastQuery != query)
            filterFeatures(query);
        return filteredFeatures.size();
    }

