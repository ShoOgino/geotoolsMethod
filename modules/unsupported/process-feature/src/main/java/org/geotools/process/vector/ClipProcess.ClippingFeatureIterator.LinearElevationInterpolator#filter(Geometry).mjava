            @Override
            public void filter(Geometry geom) {
                if (geom instanceof LineString) {
                    LineString ls = ((LineString) geom);

                    // look for the original line containing this one
                    LineString original = getOriginator(ls);
                    if (original == null) {
                        LOGGER.log(
                                java.util.logging.Level.WARNING,
                                "Could not find the original line from which the output line "
                                        + geom
                                        + " originated");
                        return;
                    }

                    try {
                        applyElevations(ls, original, false);
                    } catch (ClippingException e) {
                        // fine, let's try with the more expensive way then
                        applyElevations(ls, original, true);
                    }
                }
            }

