        public boolean hasNext() {
            while (next == null && delegate.hasNext()) {
                boolean clippedOut = false;

                // try building the clipped feature out of the original feature, if the
                // default geometry is clipped out, skip it
                SimpleFeature f = delegate.next();
                for (AttributeDescriptor ad : f.getFeatureType().getAttributeDescriptors()) {
                    Object attribute = f.getAttribute(ad.getName());
                    if (ad instanceof GeometryDescriptor) {
                        Class target = ad.getType().getBinding();
                        attribute =
                                clipGeometry(
                                        (Geometry) attribute,
                                        target,
                                        ((GeometryDescriptor) ad).getCoordinateReferenceSystem());
                        if (attribute == null && f.getFeatureType().getGeometryDescriptor() == ad) {
                            // the feature has been clipped out
                            fb.reset();
                            clippedOut = true;
                            break;
                        }
                    }
                    fb.add(attribute);
                }

                if (!clippedOut) {
                    // build the next feature
                    next = fb.buildFeature(f.getID());
                }
                fb.reset();
            }

            return next != null;
        }

