    /**
     * Computes the column index of an X ordinate.
     *
     * @param x the X ordinate
     * @return the column index
     */
    public int i(double x) {
        if (isClamped && x > env.getMaxX()) return xSize;
        if (isClamped && x < env.getMinX()) return -1;
        int i = (int) ((x - env.getMinX()) / dx);
        // have already check x is in bounds, so ensure returning a valid value
        if (isClamped && i >= xSize) i = xSize - 1;
        return i;
    }

