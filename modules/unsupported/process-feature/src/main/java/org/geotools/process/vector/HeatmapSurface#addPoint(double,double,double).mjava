    /**
     * Adds a new data point to the surface. Data points can be coincident.
     *
     * @param x the X ordinate of the point
     * @param y the Y ordinate of the point
     * @param value the data value of the point
     */
    public void addPoint(double x, double y, double value) {
        /** Input points are converted to grid space, and offset by the grid expansion offset */
        int gi = gridTrans.i(x) + kernelRadiusGrid;
        int gj = gridTrans.j(y) + kernelRadiusGrid;

        // check if point falls outside grid - skip it if so
        if (gi < 0 || gi > grid.length || gj < 0 || gj > grid[0].length) return;

        grid[gi][gj] += value;
        // System.out.println("data[" + gi + ", " + gj + "] <- " + value);
    }

