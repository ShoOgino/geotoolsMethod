    /**
     * Computes a grid representing the heatmap surface. The grid is structured as an XY matrix,
     * with (0,0) being the bottom left corner of the data space
     * 
     * @return a grid representing the surface
     */
    public float[][] computeSurface() {

        computeHeatmap(grid, kernelRadiusGrid);

        float[][] gridOut = extractGrid(grid, kernelRadiusGrid, kernelRadiusGrid, xSize, ySize);

        return gridOut;
    }

