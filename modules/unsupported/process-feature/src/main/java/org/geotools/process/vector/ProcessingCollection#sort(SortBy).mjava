    /**
     * Convenience implementation that
     */
    @SuppressWarnings("unchecked")
	@Override
    public FeatureCollection<T, F> sort(SortBy order) {
        if (schema instanceof SimpleFeatureType) {
            // go for the most efficient way if possible, otherwise rely on pure in memory
            // sorting...
            return (FeatureCollection<T, F>) new SortedSimpleFeatureCollection(
                    DataUtilities
                            .simple((FeatureCollection<SimpleFeatureType, SimpleFeature>) this),
                    new SortBy[] { order });
        } else {
            // hmm... we don't even have a basic non simple collection... need to implement one
            // before
            // going here
            throw new UnsupportedOperationException("Cannot sort on complex features at the moment");
        }
    }

