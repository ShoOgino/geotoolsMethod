        public IntersectedFeatureCollection(
                SimpleFeatureCollection delegate,
                List<String> firstAttributes,
                SimpleFeatureCollection features,
                List<String> sndAttributes,
                IntersectionMode intersectionMode,
                boolean percentagesEnabled,
                boolean areasEnabled) {
            super(delegate);
            this.features = features;
            this.firstAttributes = firstAttributes;
            this.sndAttributes = sndAttributes;
            this.intersectionMode = intersectionMode;
            this.percentagesEnabled = percentagesEnabled;
            this.areasEnabled = areasEnabled;
            SimpleFeatureTypeBuilder tb = new SimpleFeatureTypeBuilder();

            SimpleFeatureType firstFeatureCollectionSchema = delegate.getSchema();
            SimpleFeatureType secondFeatureCollectionSchema = features.getSchema();

            if (intersectionMode == IntersectionMode.FIRST) {
                geomType = firstFeatureCollectionSchema.getGeometryDescriptor();
            }
            if (intersectionMode == IntersectionMode.SECOND) {
                geomType = secondFeatureCollectionSchema.getGeometryDescriptor();
            }
            if (intersectionMode == IntersectionMode.INTERSECTION) {
                geomType = getIntersectionType(delegate, features);
            }
            tb.add(geomType);

            // gather the attributes from the first feature collection and skip
            collectAttributes(firstFeatureCollectionSchema, firstAttributes, tb);
            // gather the attributes from the second feature collection
            collectAttributes(secondFeatureCollectionSchema, sndAttributes, tb);
            // add the dyamic attributes as needed
            if (percentagesEnabled) {
                tb.add("percentageA", Double.class);
                tb.add("percentageB", Double.class);
            }
            if (areasEnabled) {
                tb.add("areaA", Double.class);
                tb.add("areaB", Double.class);
            }
            tb.add("INTERSECTION_ID", Integer.class);
            tb.setDescription(firstFeatureCollectionSchema.getDescription());
            tb.setCRS(firstFeatureCollectionSchema.getCoordinateReferenceSystem());
            tb.setAbstract(firstFeatureCollectionSchema.isAbstract());
            tb.setSuperType((SimpleFeatureType) firstFeatureCollectionSchema.getSuper());
            tb.setName(firstFeatureCollectionSchema.getName());

            this.fb = new SimpleFeatureBuilder(tb.buildFeatureType());
        }

