    /**
     * Computes a refined estimate for the interpolated surface.
     *
     * @param grid the grid matrix buffer to use
     * @param trans the transform mapping from data space to the grid
     */
    private void refineGrid(float[][] grid, GridTransform trans) {
        for (int i = 0; i < grid.length; i++) {
            for (int j = 0; j < grid[0].length; j++) {
                double x = trans.x(i);
                double y = trans.y(j);

                // skip NO_DATA values
                if (grid[i][j] == noDataValue) continue;

                float del = (float) refinedDelta(x, y, convergenceFactor);
                /*
                 // DEBUGGING
                if (del < 0) {
                    float d = (float) refinedDelta(x, y, convergenceFactor);
                }
                */
                if (!Float.isNaN(del)) grid[i][j] = grid[i][j] + del;
            }
        }
    }

