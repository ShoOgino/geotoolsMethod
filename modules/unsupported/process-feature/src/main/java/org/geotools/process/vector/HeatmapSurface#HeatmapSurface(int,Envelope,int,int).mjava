    /**
     * Creates a new heatmap surface.
     *
     * @param kernelRadius the kernel radius, in grid units
     * @param srcEnv the envelope defining the data space
     * @param xSize the width of the output grid
     * @param ySize the height of the output grid
     */
    public HeatmapSurface(int kernelRadius, Envelope srcEnv, int xSize, int ySize) {
        // radius must be non-negative
        this.kernelRadiusGrid = Math.max(kernelRadius, 0);

        this.srcEnv = srcEnv;
        this.xSize = xSize;
        this.ySize = ySize;

        init();
    }

