    /**
     * Checks if a sequence of values is monotonic, ignoring values at the end of the sequence which
     * are NO_DATA.
     *
     * @param seq
     * @param noDataValue
     * @return
     */
    private boolean isMonotonicSequence(float[] seq, final float noDataValue) {
        int istart = 0;
        for (int i = 0; i < seq.length; i++) {
            if (seq[i] != noDataValue) istart = i;
        }
        int iend = 0;
        for (int i = seq.length - 1; i >= 0; i--) {
            if (seq[i] != noDataValue) iend = i;
        }
        float globalSlope = Math.signum(seq[iend] - seq[istart]);

        // verify slope is identical throughout sequence
        for (int i = istart; i < iend; i++) {
            float localSlope = Math.signum(seq[i + 1] - seq[i]);
            if (localSlope != globalSlope) return false;
        }
        return true;
    }

