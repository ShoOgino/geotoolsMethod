    private void checkSchemaCorrect(SimpleFeatureType ft, boolean includeProportionColumns) {
        if (includeProportionColumns) {
            //assertEquals(5, ft.getAttributeCount()); old version before adding envelope
            assertEquals(7, ft.getAttributeCount());
        } else {
            //assertEquals(3, ft.getAttributeCount()); old version before adding envelope.
            assertEquals(5, ft.getAttributeCount()); 
        }
        assertEquals(Point.class, ft.getGeometryDescriptor().getType().getBinding());
        assertEquals(Integer.class, ft.getDescriptor(PointStackerProcess.ATTR_COUNT).getType()
                .getBinding());
        assertEquals(Integer.class, ft.getDescriptor(PointStackerProcess.ATTR_COUNT_UNIQUE)
                .getType().getBinding());
        if (includeProportionColumns) {
            assertEquals(Double.class, ft.getDescriptor(PointStackerProcess.ATTR_NORM_COUNT)
                    .getType().getBinding());
            assertEquals(Double.class, ft.getDescriptor(PointStackerProcess.ATTR_NORM_COUNT_UNIQUE)
                    .getType().getBinding());
        }

    }

