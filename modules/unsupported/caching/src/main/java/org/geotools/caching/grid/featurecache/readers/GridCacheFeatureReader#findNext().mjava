    /**
     * Finds the next element to read.
     *
     * @return next element or null if no more elements
     */
    private SimpleFeature findNext() {
        SimpleFeature sf = null;

        while (true) {
            if (currentNodeIterator != null && currentNodeIterator.hasNext()) {
                sf = (SimpleFeature) ((GridData) currentNodeIterator.next()).getData();
                if (!collectedFeatureIds.contains(sf.getID())) {
                    // we want to return sf
                    break;
                }
            }
            if (currentNodeIterator == null || !currentNodeIterator.hasNext()) {
                if (tovisit.size() == 0) {
                    // nothing found; no other things to look at
                    return null;
                }
                NodeIdentifier nodeid = tovisit.pop();
                GridNode currentNode = (GridNode) grid.readNode(nodeid);
                currentNodeIterator = currentNode.getData().iterator();
            }
        }

        if (sf != null) {
            collectedFeatureIds.add(sf.getID());
        }
        return sf;
    }

