        @Override
        public XmlResponse getXmlReader(Query query) throws IOException {
            if (Filter.EXCLUDE.equals(query.getFilter())) {
                return null; // empty response
            }

            Query callQuery = new Query(query);

            Filter[] filters = getProtocol().splitFilters(query.getFilter());
            Filter supportedFilter = filters[0];
            Filter postFilter = filters[1];
            callQuery.setFilter(supportedFilter);

            Document doc = getXmlResponse();
            List<Integer> validFeatureIndex =
                    determineValidFeatures(postFilter, doc, query.getMaxFeatures());
            return new XmlResponse(doc, validFeatureIndex);
        }

