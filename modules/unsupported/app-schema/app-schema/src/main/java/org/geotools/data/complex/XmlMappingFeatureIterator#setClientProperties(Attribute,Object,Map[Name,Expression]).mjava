    protected void setClientProperties(final Attribute target, final Object source,
            final Map<Name, Expression> clientProperties) {
        if (clientProperties.size() == 0) {
            return;
        }
        final Map<Name, Object> targetAttributes = new HashMap<Name, Object>();
        for (Map.Entry<Name, Expression> entry : clientProperties.entrySet()) {
            Name propName = entry.getKey();
            Expression propExpr = entry.getValue();
            String propValue = "";

            List<String> ls = getValue(propExpr, source);
            if (!ls.isEmpty()) {
                propValue = ls.get(0);
            }

            if (LOGGER.isLoggable(Level.FINER)) {
                LOGGER.finer("setting target=" + target.getName() + ", property Name=" + propName
                        + ", value=" + propValue);
            }
            targetAttributes.put(propName, propValue);
        }
        // FIXME should set a child Property
        target.getUserData().put(Attributes.class, targetAttributes);
    }

