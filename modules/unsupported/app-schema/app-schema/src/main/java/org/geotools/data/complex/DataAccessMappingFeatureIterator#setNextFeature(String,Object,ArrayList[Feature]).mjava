    protected void setNextFeature(String fId, Object foreignKeyValue, ArrayList<Feature> features) throws IOException {
        if (features.isEmpty()) {
            features.add(curSrcFeature);
        }
        curSrcFeature = null;

        while (getSourceFeatureIterator().hasNext()) {
            Feature next = getSourceFeatureIterator().next();
            if (extractIdForFeature(next).equals(fId)
                    && (foreignKey==null || foreignKey.evaluate(next).equals(foreignKeyValue))) {
                features.add(next);
            } else {
                curSrcFeature = next;
                flagNextFeature(true);
                break;
            }
        }
    }

