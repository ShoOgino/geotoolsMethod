    @Test
    public void testAttribyteOnlyStrategyWrites() throws IOException {
        
        URL states = TestData.url("shapes/statepop.shp");
        FileDataStore store = FileDataStoreFinder.getDataStore(states);
        assertNotNull("couldn't create store",store);
        File file2 = File.createTempFile("CSVTest", ".csv");
        Map<String, Serializable> params2 = new HashMap<String, Serializable>();
        params2.put("file", file2);
        params2.put(CSVDataStoreFactory.STRATEGYP.key, CSVDataStoreFactory.ATTRIBUTES_ONLY_STRATEGY);
        
        CSVDataStoreFactory factory = new CSVDataStoreFactory();
        DataStore duplicate = factory.createNewDataStore(params2);
        SimpleFeatureType featureType = store.getSchema();
        
        duplicate.createSchema( featureType );
        
        FeatureReader<SimpleFeatureType, SimpleFeature> reader;
        FeatureWriter<SimpleFeatureType, SimpleFeature> writer;
        SimpleFeature feature, newFeature;

        
        reader = store.getFeatureReader();
        
        writer = duplicate.getFeatureWriterAppend(duplicate.getTypeNames()[0], Transaction.AUTO_COMMIT);
        try {
            while (reader.hasNext()) {
                feature = reader.next();
                newFeature = writer.next();
                
                newFeature.setAttributes( feature.getAttributes() );
                writer.write();
            }
        } finally {
            reader.close();
            writer.close();
        }
        String contents = checkFileContents(file2);
        BufferedReader lineReader = new BufferedReader(new CharArrayReader(contents.toCharArray()));
        String line = lineReader.readLine(); //header
        assertFalse("Geom is included", line.toLowerCase().contains("the_geom"));
        line = lineReader.readLine();
        assertFalse("Geom is included",line.toLowerCase().contains("multipolygon"));
    }

