    @Test
    public void testCreateSchema() throws IOException {
        SimpleFeatureTypeBuilder builder = new SimpleFeatureTypeBuilder();
        builder.setCRS(DefaultGeographicCRS.WGS84);
        builder.setName("testCreateSchema");
        builder.add("the_geom", Point.class);
        builder.add("id", Integer.class);
        builder.add("int_field", Integer.class);
        builder.add("string_field", String.class);
        SimpleFeatureType featureType = builder.buildFeatureType();

        File csvFile = File.createTempFile("testCreateSchema", ".csv");
        CSVFileState csvFileState = new CSVFileState(csvFile);
        CSVStrategy strategy = new CSVLatLonStrategy(csvFileState, "lat_field", "long_field");
        strategy.createSchema(featureType);

        assertEquals(
                "Stragegy does not have provided feature type",
                featureType,
                strategy.getFeatureType());
        List<String> content = Files.readAllLines(csvFile.toPath());
        assertEquals("long_field,lat_field,id,int_field,string_field", content.get(0));
        csvFile.delete();
    }

