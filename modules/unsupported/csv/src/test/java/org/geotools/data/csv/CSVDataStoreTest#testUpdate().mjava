    /**
     * Test FeatureStore/Writer update
     */
    @Test
    public void testUpdate() throws FileNotFoundException, IOException {
        DataStore csv = this.getDataStore();
        SimpleFeatureStore rows = (SimpleFeatureStore) csv.getFeatureSource( TYPE_NAME );
        rows.modifyFeatures(NUMBER_COL, 333, this.newTestFilter());
        
        // re-open
        csv = this.getDataStore();
        rows = (SimpleFeatureStore) csv.getFeatureSource( TYPE_NAME );
        SimpleFeatureCollection features = rows.getFeatures();
        assertEquals(9, features.size());
        
        SimpleFeatureIterator cursor = features.features();
        List<String> filteredCities = this.filteredCities();
        while (cursor.hasNext()) {
            SimpleFeature feature = cursor.next();
            if (filteredCities.contains(feature.getAttribute(CITY_COL))) {
                assertEquals("333", feature.getAttribute(NUMBER_COL));
            } else {
                assertNotSame("333", feature.getAttribute(NUMBER_COL));
            }
        }
        cursor.close();
    }

