    @Test
    public void testWKTWrites() throws IOException {

        URL states = TestData.url("shapes/statepop.shp");
        FileDataStore store = FileDataStoreFinder.getDataStore(states);
        assertNotNull("couldn't create store", store);
        File file2 = File.createTempFile("CSVTest", ".csv");
        Map<String, Serializable> params2 = new HashMap<String, Serializable>();
        params2.put("file", file2);
        params2.put(CSVDataStoreFactory.STRATEGYP.key, CSVDataStoreFactory.WKT_STRATEGY);
        params2.put(CSVDataStoreFactory.WKTP.key, "the_geom_wkt");

        CSVDataStoreFactory factory = new CSVDataStoreFactory();
        DataStore duplicate = factory.createNewDataStore(params2);
        SimpleFeatureType featureType = store.getSchema();

        duplicate.createSchema(featureType);

        FeatureReader<SimpleFeatureType, SimpleFeature> reader;
        FeatureWriter<SimpleFeatureType, SimpleFeature> writer;
        SimpleFeature feature, newFeature;

        reader = store.getFeatureReader();

        writer =
                duplicate.getFeatureWriterAppend(
                        duplicate.getTypeNames()[0], Transaction.AUTO_COMMIT);
        try {
            while (reader.hasNext()) {
                feature = reader.next();
                newFeature = writer.next();

                newFeature.setAttributes(feature.getAttributes());
                writer.write();
            }
        } finally {
            reader.close();
            writer.close();
        }
        String contents = checkFileContents(file2);
        BufferedReader lineReader = new BufferedReader(new CharArrayReader(contents.toCharArray()));
        String line = lineReader.readLine(); // header
        assertTrue("Geom is not included", line.toLowerCase().contains("the_geom_wkt"));
        line = lineReader.readLine();
        assertTrue("Geom is not included", line.toLowerCase().contains("multipolygon"));
    }

