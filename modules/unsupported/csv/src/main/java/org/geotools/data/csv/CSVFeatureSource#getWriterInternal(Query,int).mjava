    @Override
    protected FeatureWriter<SimpleFeatureType, SimpleFeature> getWriterInternal(Query query, int flags) throws IOException {
        // TODO Perhaps: make separate writers for update and append.
        return new CSVFeatureWriter(getState(), query, (flags | WRITER_ADD) == WRITER_ADD);
    }

