    @Override
    public void close() throws IOException {
        if (this.appending) {
            return;
        }
        this.checkPendingWrite();
        super.close();
        this.csvWriter.close();
        ((CSVDataStore) this.state.getEntry().getDataStore()).write(this.tempFile);
    }

