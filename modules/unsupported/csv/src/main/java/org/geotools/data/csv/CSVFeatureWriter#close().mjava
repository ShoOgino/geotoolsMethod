    @Override
    public void close() throws IOException {
        if (this.currentFeature != null) {
            this.write(); // the previous one was not written, so do it now.
        }
        if( delegate != null ){
            this.delegate.close();
        }
        this.csvWriter.close();
        
        File file = ((CSVDataStore) state.getEntry().getDataStore()).file;
        
        Files.copy(temp.toPath(), file.toPath(), StandardCopyOption.REPLACE_EXISTING );
    }

