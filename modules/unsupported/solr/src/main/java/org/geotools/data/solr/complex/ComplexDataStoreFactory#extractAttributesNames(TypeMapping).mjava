    /**
     * Helper method that retrieves all the attributes names used in a feature type mapping in an
     * App-Schema file.
     *
     * @param typeMapping the feature type mapping
     * @return set of the attributes names found
     */
    @SuppressWarnings("unchecked")
    private Set<String> extractAttributesNames(TypeMapping typeMapping) {
        Set<String> attributes = new HashSet<>();
        List<AttributeMapping> attributesMappings = typeMapping.getAttributeMappings();
        for (AttributeMapping attributeMapping : attributesMappings) {
            // normal attributes
            Expression expression = parseExpression(attributeMapping.getSourceExpression());
            attributes.addAll(extractAttributesNames(expression));
            // identifiers attributes
            expression = parseExpression(attributeMapping.getIdentifierExpression());
            attributes.addAll(extractAttributesNames(expression));
            // client properties
            for (Object value : attributeMapping.getClientProperties().values()) {
                attributes.addAll(extractAttributesNames(parseExpression(value)));
            }
            // solr multiple values expressions
            if (attributeMapping.getMultipleValue() instanceof SolrMultipleValue) {
                SolrMultipleValue multipleValue =
                        (SolrMultipleValue) attributeMapping.getMultipleValue();
                attributes.addAll(extractAttributesNames(multipleValue.getExpression()));
            }
        }
        return attributes;
    }

