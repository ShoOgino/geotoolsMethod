    @Override
    public DataAccessMappingFeatureIterator buildIterator(
            AppSchemaDataAccess store,
            FeatureTypeMapping featureTypeMapping,
            Query query,
            Transaction transaction) {
        if (!(featureTypeMapping.getSource() instanceof SolrFeatureSource)) {
            // not an Apache Solr feature type mapping
            return null;
        }
        // add the sort by expressions to the query
        query.setSortBy(sortByFeatureTypeIds(featureTypeMapping));
        try {
            // build the iterator using the adapted query
            return new DataAccessMappingFeatureIterator(
                    store, featureTypeMapping, query, false, true);
        } catch (Exception exception) {
            throw new RuntimeException(
                    String.format(
                            "Error creating iterator for feature type mapping '%s'.",
                            featureTypeMapping.getMappingName()),
                    exception);
        }
    }

