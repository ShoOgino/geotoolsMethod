    public void testGetFeaturesWithSort() throws Exception {
        init();
        FilterFactory ff = dataStore.getFilterFactory();
        SortBy sort = ff.sort("vendor_s", SortOrder.ASCENDING);
        Query query = new Query();
        query.setSortBy(sort);

        SimpleFeatureCollection features = featureSource.getFeatures(query);
        assertEquals(13, features.size());

        SimpleFeatureIterator iterator = features.features();
        SimpleFeature f;
        try {
            for (int i = 0; i < 3; i++) {
                assertTrue(iterator.hasNext());
                f = iterator.next();
                assertEquals("Asus", f.getAttribute("vendor_s"));
            }
            assertTrue(iterator.hasNext());
            f = iterator.next();
            assertEquals("Cisco", f.getAttribute("vendor_s"));
            assertTrue(iterator.hasNext());
            f = iterator.next();
            assertEquals("Cisco", f.getAttribute("vendor_s"));
        } finally {
            iterator.close();
        }

        sort = ff.sort("vendor_s", SortOrder.DESCENDING);
        query.setSortBy(sort);
        features = featureSource.getFeatures(query);
        iterator = features.features();
        try {
            assertTrue(iterator.hasNext());
            f = iterator.next();
            assertEquals("TP-Link", f.getAttribute("vendor_s"));
            assertTrue(iterator.hasNext());
            f = iterator.next();
            assertEquals("Linksys", f.getAttribute("vendor_s"));
            assertTrue(iterator.hasNext());
            f = iterator.next();
            assertEquals("Linksys", f.getAttribute("vendor_s"));
        } finally {
            iterator.close();
        }
    }

