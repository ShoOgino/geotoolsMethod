    CouchDBAddFeatureWriter(SimpleFeatureType buildFeatureType, CouchDBDataStore dataStore) {
        this.featureType = buildFeatureType;
        this.dataStore = dataStore;
        this.json = new GeometryJSON();
        // @todo non scalable in memory buffer
        this.buffer = new StringWriter();
        featureFactory =
                dataStore.getFeatureFactory() == null
                        ? new LenientFeatureFactoryImpl()
                        : dataStore.getFeatureFactory();

        String localName = featureType.getTypeName(); // this will actuall be the full name
        int idx = localName.lastIndexOf(':');
        idx = localName.indexOf('.', idx);
        this.featureClass = localName.substring(idx + 1);
        buffer.write("{\"docs\":[");
    }

