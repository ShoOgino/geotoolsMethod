    private Expression colorGenerateCategorize(Expression expression) {
        return generateCategorize(expression, (value, stop)->{
            Expression color = parse.color((String)value);
            if( color == null ){
                throw new MBFormatException("Could not convert stop "+stop+" color "+value+" into a color");
            }
            return color;
        });
    }

