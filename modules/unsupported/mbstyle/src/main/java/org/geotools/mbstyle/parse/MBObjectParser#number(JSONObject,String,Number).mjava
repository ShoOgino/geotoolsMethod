    /**
     * Convert the value in the provided JSONObject at 'tag' to a numeric Expression, or a function, with a fallback if the json is null.
     * 
     * @param json The JSONObject in which to look up the value
     * @param tag The tag in the JSONObject at which to look up the value
     * @param fallback default value if the JSONObject is null
     * @return Expression based on provided json, or literal if json was null.
     * @throws MBFormatException
     */
    public Expression number(JSONObject json, String tag, Number fallback)
            throws MBFormatException {
        if (json == null) {
            return ff.literal(fallback);
        }
        Object obj = json.get(tag);
        return number("\"" + tag + "\"", obj, fallback);
    }

