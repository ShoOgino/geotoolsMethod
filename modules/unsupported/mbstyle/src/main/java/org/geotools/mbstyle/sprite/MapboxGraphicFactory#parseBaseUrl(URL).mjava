    /**
     * Return the base URL (without query parameters) from the provided URL.
     * 
     * @param loc The URL from which to remove query parameters.
     * @return The URL, without query parameters.
     * @throws MalformedURLException
     */
    protected URL parseBaseUrl(URL loc) throws MalformedURLException {
        String urlStr = loc.toExternalForm();
        int idx = urlStr.indexOf('?');
        if (idx == -1) {
            return new URL(urlStr);
        } else {
            return new URL(urlStr.substring(0, idx));
        }
    }

