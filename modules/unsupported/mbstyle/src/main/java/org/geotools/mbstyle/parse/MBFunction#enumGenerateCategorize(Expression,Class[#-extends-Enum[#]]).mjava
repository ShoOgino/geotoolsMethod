    private Expression enumGenerateCategorize(Expression input,
            Class<? extends Enum<?>> enumeration) {
        List<Expression> parameters = new ArrayList<>();
        parameters.add(input);
        for (Object obj : getStops()) {
            JSONArray entry = parse.jsonArray(obj);
            Object stop = entry.get(0);
            Object value = entry.get(1);
            parameters.add(ff.literal(stop));
            parameters.add(constant(value,enumeration));
        }
        parameters.add(ff.literal("preceding"));
        return ff.function("Categorize", parameters.toArray(new Expression[parameters.size()]));
    }

