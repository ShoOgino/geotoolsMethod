    /**
     * Transform {@link LineMBLayer} to GeoTools FeatureTypeStyle.
     * <p>
     * Notes:
     * </p>
     * <ul>
     * </ul>
     * 
     * @param layer Describing line styling
     * @return FeatureTypeStyle
     */
    FeatureTypeStyle transform(LineMBLayer layer, MBStyle styleContext) {
        Stroke stroke = sf.stroke(layer.lineColor(), layer.lineOpacity(), layer.lineWidth(),
                layer.lineJoin(), layer.lineCap(), null, null); // last "offset" is really "dash offset"
        
        stroke.setDashArray(layer.lineDasharray());        
        LineSymbolizer ls = sf.lineSymbolizer(layer.getId(), null,
                sf.description(Text.text("line"), null), NonSI.PIXEL, stroke, layer.lineOffset());        
        
        if (layer.hasLinePattern()) {            
            ExternalGraphic eg = createExternalGraphicForSprite(layer.linePattern(), styleContext);
            // GraphicStroke graphicStroke = sf.graphicStroke(Arrays.asList(eg), layer.lineOpacity(), layer.lineWidth(), null, null, null, null, null);
            GraphicFill fill = sf.graphicFill(Arrays.asList(eg), layer.lineOpacity(), null, null, null, null);
            stroke.setGraphicFill(fill);
            //stroke.setGraphicFill(graphicFill);
        }
        
        // Left for the special effects sprint:
        //  // Graphic fill
        // layer.lineBlur();
        // layer.lineGapWidth();
        // layer.lineMiterLimit();
        // layer.lineRoundLimit();
        // layer.getLineTranslateAnchor();
        // layer.toDisplacement()

        List<org.opengis.style.Rule> rules = new ArrayList<>();
        Rule rule = sf.rule(
                layer.getId(),
                null,
                null,
                0.0,
                Double.POSITIVE_INFINITY,
                Arrays.asList(ls),
                layer.filter());
        rule.setLegendGraphic(new Graphic[0]);
        rules.add(rule);
        return sf.featureTypeStyle(layer.getId(),
                sf.description(Text.text("MBStyle " + layer.getId()),
                        Text.text("Generated for " + layer.getSourceLayer())),
                null, Collections.emptySet(), Collections.singleton(SemanticType.LINE), rules);
    }

