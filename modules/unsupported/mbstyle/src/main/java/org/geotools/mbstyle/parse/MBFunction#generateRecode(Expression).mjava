    /**
     * Generates an expression for the output of this {@link MBFunction} (as a {@link MBFunction.FunctionType#CATEGORICAL} function), based on the provided input Expression.
     * 
     * Note: A mapbox "categorical" function is implemented as a GeoTools "recode" function, hence the name of this method.
     * 
     * @param input The expression for the function input
     * @return The expression for the output of this function (as a {@link MBFunction.FunctionType#CATEGORICAL} function)
     */
    private Expression generateRecode(Expression input) {
        List<Expression> parameters = new ArrayList<>();
        parameters.add(input);
        for (Object obj : getStops()) {
            JSONArray entry = parse.jsonArray(obj);
            Object stop = entry.get(0);
            Object value = entry.get(1);
            parameters.add(ff.literal(stop));
            parameters.add(ff.literal(value));
        }
        Function recodeFn = ff.function("Recode", parameters.toArray(new Expression[parameters.size()]));
        return withFallback(recodeFn);
    }

