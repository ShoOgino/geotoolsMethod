    private Graphic getGraphic(MBStyleTransformer transformer, MBStyle styleContext) {
        // If the iconImage is a literal string (not a function), then
        // we need to support Mapbox token replacement.
        // Note: the URL is expected to be a CQL STRING ...
        Expression iconExpression = iconImage();
        if (iconExpression instanceof Literal) {
            iconExpression = transformer.cqlExpressionFromTokens(iconExpression.evaluate(null, String.class));
        }

        ExternalGraphic eg = transformer.createExternalGraphicForSprite(iconExpression, iconSize(), styleContext);
        // layer.iconSize() - MapBox uses multiplier, GeoTools uses pixels
        Graphic g = sf.graphic(Arrays.asList(eg), iconOpacity(), null,
                iconRotate(), null, null);
        Displacement d = iconOffsetDisplacement();
        d.setDisplacementY(d.getDisplacementY());
        g.setDisplacement(d);

        return g;
    }

