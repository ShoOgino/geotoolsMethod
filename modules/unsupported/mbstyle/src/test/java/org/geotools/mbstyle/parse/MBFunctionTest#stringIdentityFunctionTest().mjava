    /**
     * Test a {@link MBFunction} (type = identity) that returns a string value.
     */
    @Test
    public void stringIdentityFunctionTest() throws Exception {
        String jsonStr = "{'property': 'textproperty','type': 'identity', 'default':'defaultText'}";
        MBFunction function = new MBFunction(MapboxTestUtils.object(jsonStr));
        assertTrue("Function category is \"property\"", EnumSet.of(MBFunction.FunctionCategory.PROPERTY).equals(function.category()));
        assertEquals("Function type is \"identity\"", MBFunction.FunctionType.IDENTITY, function.getType());                      
        
        Expression outputExpression = function.function(String.class);
        
        SimpleFeatureType SAMPLE = DataUtilities.createType("SAMPLE",
                "id:\"\",textproperty,location=4326");

        SimpleFeature feature = DataUtilities.createFeature(SAMPLE, "measure1=A|textvalue|POINT(0,0)");
        String output = outputExpression.evaluate(feature, String.class);
        assertEquals("textvalue", output);

        // Check default (for a feature that's missing the function's property)
        SAMPLE = DataUtilities.createType("SAMPLE", "id:\"\",location=4326");
        feature = DataUtilities.createFeature(SAMPLE, "measure1=A|POINT(0,0)");
        output = outputExpression.evaluate(feature, String.class);
        assertEquals("defaultText", output);

    }

