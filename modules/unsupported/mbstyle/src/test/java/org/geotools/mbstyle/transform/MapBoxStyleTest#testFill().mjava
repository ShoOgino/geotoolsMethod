    /**
     * Test parsing a Mapbox fill layer
     */
    @Test
    public void testFill() throws IOException, ParseException {

        // Read file to JSONObject
        InputStream is = this.getClass().getResourceAsStream("fillStyleTest.json");
        String fileContents = IOUtils.toString(is, "utf-8");
        JSONObject jsonObject = (JSONObject) jsonParser.parse(fileContents);

        // Parse to MBStyle
        MBStyle mbStyle = new MBStyle(jsonObject);
        List<MBLayer> layers = mbStyle.layers("geoserver-states");

        assertEquals(1, layers.size());

        // Find the MBFillLayer and assert it contains the correct FeatureTypeStyle.
        assertTrue(layers.get(0) instanceof FillMBLayer);
        FillMBLayer mbFill = (FillMBLayer) layers.get(0);
        FeatureTypeStyle fts = new MBStyleTransformer().transform(mbFill);

        assertEquals(1, fts.rules().size());
        for (Rule r : fts.rules()) {
            assertEquals(1, r.symbolizers().size());
            for (Symbolizer symbolizer : r.symbolizers()) {
                assertTrue(symbolizer instanceof PolygonSymbolizer);
                PolygonSymbolizer psym = (PolygonSymbolizer) symbolizer;
                Expression expr =  psym.getFill().getColor();
                assertNotNull("fillColor set", expr);
                assertEquals( Color.decode("#E100FF"), expr.evaluate(null,Color.class) );
                assertEquals(Double.valueOf(.84),
                        psym.getFill().getOpacity().evaluate(null, Double.class));
            }
        }

    }

