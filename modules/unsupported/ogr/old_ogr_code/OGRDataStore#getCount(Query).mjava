    protected int getCount(Query query) throws IOException {
        if (!Filter.INCLUDE.equals(query.getFilter()))
            return -1;

        DataSource ds = getOGRDataSource(FALSE);
        Layer l = getOGRLayer(ds, query.getTypeName());
        if (l == null)
            throw new IOException("Unknown feature type: " + query.getTypeName());

        // go for the quick computation, return -1 otherwise
        int count = l.GetFeatureCount(FALSE);
        l.delete();
        ds.delete();
        return count;
    }

