    public boolean hasNext() throws IOException {
        // ugly, but necessary to close the reader when getting to the end, because
        // it would break feature appending otherwise (the reader is used in feature
        // writing too)
        if (layerCompleted)
            return false;

        if (curr != null)
            return true;
        boolean hasNext = (curr = layer.GetNextFeature()) != null;
        if (!hasNext)
            layerCompleted = true;
        return hasNext;
    }

