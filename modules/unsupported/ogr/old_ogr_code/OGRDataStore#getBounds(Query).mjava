    public ReferencedEnvelope getBounds(Query q) throws IOException {
        if (!q.getFilter().equals(Filter.INCLUDE))
            return null;

        DataSource ds = getOGRDataSource(OGRDataStore.FALSE);
        Layer l = getOGRLayer(ds, q.getTypeName());
        try {
            if (l.TestCapability(ogr.OLCFastGetExtent)) {
                double[] bbox = new double[4];
                // TODO: hum... going thru this forcing the computation is anyways
                // faster than loading all the features just for the sake of
                // getting out the bbox.... but we don't have this
                // explicit middle ground in Geotools
                l.GetExtent(bbox, OGRDataStore.FALSE);
                CoordinateReferenceSystem crs = getSchema(q.getTypeName()).getCoordinateReferenceSystem();
                return new ReferencedEnvelope(bbox[0], bbox[1], bbox[2], bbox[3], crs);
            } else {
                return null;
            }
        } finally {
            if(l != null)
                l.delete();
            if(ds != null)
                ds.delete();
        }
    }

