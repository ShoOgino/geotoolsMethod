    protected FeatureWriter createFeatureWriter(String typeName, Transaction transaction)
            throws IOException {
        if (supportsInPlaceWrite(typeName)) {
            OGRFeatureReader reader = (OGRFeatureReader) getFeatureReader(typeName, Query.ALL, true);
            return new OGRDirectFeatureWriter(reader);
        } else {
            throw new UnsupportedOperationException(
                    "This file format does not support in place write, "
                            + "can't perform updates/deletes");
        }
    }

