    public void write() throws IOException {
        if (live == null)
            throw new IOException("No current feature to write");

        // this will return true only in update mode, otherwise original is null
        boolean changed = live.equals(original);
        if (!changed && original != null && layer == reader.layer) {
            // nothing to do, just skip
        } else if (changed && original != null && layer == reader.layer) {
            // not equals, we're updating an existing one
            layer.SetFeature(mapper.convertGTFeature(layer.GetLayerDefn(), live));
        } else {
            org.gdal.ogr.Feature ogrFeature = mapper.convertGTFeature(layer.GetLayerDefn(),
                    original != null ? original : live);
            layer.CreateFeature(ogrFeature);
            ((FeatureIdImpl) live.getIdentifier()).setID(mapper.convertOGRFID(featureType, ogrFeature));
            ogrFeature.delete();
        }

        // reset state
        live = null;
        original = null;
    }

