    /**
     * Creates a new direct OGR feature writer
     * 
     * @param reader
     * @param featureType
     * @param layer
     */
    public OGRDirectFeatureWriter(OGRFeatureReader reader, SimpleFeatureType targetSchema,
            SimpleFeatureType originalSchema, GeometryFactory gf) {
        this.reader = reader;
        this.featureType = reader.getFeatureType();
        this.layer = reader.layer;
        this.layerDefinition = OGR_L_GetLayerDefn(layer);
        this.mapper = new FeatureMapper(targetSchema, originalSchema, gf);
        this.deletedFeatures = false;
    }

