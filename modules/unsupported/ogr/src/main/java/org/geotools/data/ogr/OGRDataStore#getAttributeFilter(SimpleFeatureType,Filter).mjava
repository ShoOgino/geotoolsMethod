    /**
     * Parses the GeoTools filter and tries to extract an SQL expression that can
     * be used as the OGR attribute filter
     * @param schema
     * @param filter
     * @return
     */
    protected String getAttributeFilter(SimpleFeatureType schema, Filter filter) {
        // TODO: switch to the non deprecated splitter (that no one seems to be using)
        PostPreProcessFilterSplittingVisitor visitor = new PostPreProcessFilterSplittingVisitor(ATTRIBUTE_FILTER_CAPABILITIES, schema, null);
        filter.accept(visitor, null);
        Filter preFilter = visitor.getFilterPre();
        if(preFilter != Filter.EXCLUDE && preFilter != Filter.INCLUDE) {
            StringWriter writer = new StringWriter();
            FilterToSQL sqlConverter = new FilterToSQL(writer);
            preFilter.accept(sqlConverter, null);
            return writer.getBuffer().toString();
        }
        return null;
    }

