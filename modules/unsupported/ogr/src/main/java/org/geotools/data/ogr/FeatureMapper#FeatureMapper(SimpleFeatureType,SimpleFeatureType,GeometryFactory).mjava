    public FeatureMapper(SimpleFeatureType targetSchema, SimpleFeatureType sourceSchema, GeometryFactory geomFactory) {
        this.schema = targetSchema;
        this.builder = new SimpleFeatureBuilder(schema);
        this.geomMapper = new GeometryMapper.WKB(geomFactory);
        this.geomFactory = geomFactory;
        
        attributeIndexes = new HashMap<String, Integer>();
        List<AttributeDescriptor> descriptors = sourceSchema.getAttributeDescriptors();
        for (int i = 0; i < descriptors.size(); i++) {
            AttributeDescriptor ad = descriptors.get(i);
            if(!(ad instanceof GeometryDescriptor) && targetSchema.getDescriptor(ad.getLocalName()) != null) {
                // the first one is the geometry, which does not count in ogr as an index
                attributeIndexes.put(ad.getLocalName(), i - 1);
            }
        }
    }

