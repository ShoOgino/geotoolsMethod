    @Override
    protected SimpleFeatureType buildFeatureType() throws IOException {
        String typeName = getEntry().getTypeName();
        String namespaceURI = getDataStore().getNamespaceURI();

        Object dataSource = null;
        Object layer = null;
        try {
            // grab the layer definition
            dataSource = getDataStore().openOGRDataSource(false);
            layer = getDataStore().openOGRLayer(dataSource, typeName);

            // map to geotools feature type
            return new FeatureTypeMapper(ogr).getFeatureType(layer, typeName, namespaceURI);
        } finally {
            if (layer != null) {
                ogr.LayerRelease(layer);
            }
            if (dataSource != null) {
                ogr.DataSourceRelease(dataSource);
            }
        }
    }

