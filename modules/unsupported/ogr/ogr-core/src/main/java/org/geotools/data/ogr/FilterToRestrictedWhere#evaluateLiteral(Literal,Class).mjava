    protected Object evaluateLiteral(Literal expression, Class target) {
        Object literal = null;

        // HACK: let expression figure out the right value for numbers,
        // since the context is almost always improperly set and the
        // numeric converters try to force floating points to integrals
        // JD: the above is no longer true, so instead do a safe conversion
        if (target != null) {
            // use the target type
            if (Number.class.isAssignableFrom(target)) {
                literal =
                        Converters.convert(
                                expression.evaluate(null),
                                target,
                                new Hints(ConverterFactory.SAFE_CONVERSION, true));
            } else {
                literal = expression.evaluate(null, target);
            }
        }
        // if the target was not known, of the conversion failed, try the
        // type guessing dance literal expression does only for the following
        // method call
        if (literal == null) literal = expression.evaluate(null);

        // if that failed as well, grab the value as is
        if (literal == null) literal = expression.getValue();

        return literal;
    }

