    /**
     * Create a test file, then continue removing the first entry until there are no features left.
     */
    @Test
    public void testRemoveFromFrontAndClose() throws Throwable {
        OGRDataStore sds = createDataStore();

        String typeName = sds.getTypeNames()[0];
        int idx = loadFeatures(sds, typeName).size();

        while (idx > 0) {
            try (FeatureWriter writer =
                    sds.getFeatureWriter(typeName, Filter.INCLUDE, Transaction.AUTO_COMMIT)) {
                writer.next();
                writer.remove();
            }
            idx--;
            assertEquals(idx, countFeatures(loadFeatures(sds, typeName)));
        }
    }

