    public void setModelTransformation(final AffineTransform rasterToModel) {
        if (modelPixelScale != null && modelPixelScale.isSet())
            throw new IllegalStateException(
                    "ModelPixelScaleTag already set. It is not possible to set the ModelTransformation.");
        if (isModelTiePointsSet())
            throw new IllegalStateException(
                    "ModelTiePointsTag already set. It is not possible to set the ModelTransformation.");

        // //
        //
        // See pag 28 of the spec for an explanation
        //
        // //
        // a
        modelTransformation[0] = rasterToModel.getScaleX();
        // b
        modelTransformation[1] = rasterToModel.getShearX();
        // c
        modelTransformation[2] = 0;
        // d
        modelTransformation[3] = rasterToModel.getTranslateX();
        // e
        modelTransformation[4] = rasterToModel.getShearY();
        // f
        modelTransformation[5] = rasterToModel.getScaleY();
        // g
        modelTransformation[6] = 0;
        // h
        modelTransformation[7] = rasterToModel.getTranslateY();
        // i
        modelTransformation[8] = 0;
        // j
        modelTransformation[9] = 0;
        // k
        modelTransformation[10] = 0;
        // l
        modelTransformation[11] = 0;
        // m
        modelTransformation[12] = 0;
        // n
        modelTransformation[13] = 0;
        // o
        modelTransformation[14] = 0;
        // p
        modelTransformation[15] = 1;
    }

