    private SimpleFeature readNextFeature() throws IOException {
        try {
            // read the fid, check for file end
            String fid = null;
            try {
                fid = (String) is.readObject();
            } catch (Exception e) {
                // we assume we got to the end of the file
                close();
                return null;
            }

            // read the other attributes, build the feature
            for (int i = 0; i < schema.getAttributeCount(); i++) {
                Object att = is.readObject();
                builder.add(att);
            }
            return builder.buildFeature(fid);
        } catch (ClassNotFoundException e) {
            throw new IOException("Failed to read an attribute, its class is missing", e);
        }
    }

