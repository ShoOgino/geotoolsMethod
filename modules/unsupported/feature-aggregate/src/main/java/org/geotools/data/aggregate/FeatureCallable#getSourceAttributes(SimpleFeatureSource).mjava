    /**
     * Collects the attribute names for the specified feature source
     * 
     * @param source
     * @return
     */
    private Set<String> getSourceAttributes(SimpleFeatureSource source) {
        Set<String> result = new HashSet<String>();
        for (AttributeDescriptor ad : source.getSchema().getAttributeDescriptors()) {
            result.add(ad.getLocalName());
        }
        return result;
    }

