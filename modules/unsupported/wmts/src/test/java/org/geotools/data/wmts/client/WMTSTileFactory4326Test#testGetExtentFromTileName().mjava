    @Test
    public void testGetExtentFromTileName() throws Exception {

        WMTSTileService services[] = {
            createRESTService(),
            createKVPService()};

        ReferencedEnvelope expectedEnv[] = {
            new ReferencedEnvelope(1102848.0, 2151424.0, -951424.0, 97152.0, CRS.decode("EPSG:31287")),
            new ReferencedEnvelope(-90, 0.00, -90.0, 0.0, DefaultGeographicCRS.WGS84)};

        for (int i = 0; i < 2; i++) {
            TileService service = services[i];
            // For some reason map proxy has an extra level compared to GeoServer!
            int offset = 0;
            if (((WMTSTileService)service).getType().equals(WMTSServiceType.REST)) {
                offset = 1;
            }
            WMTSZoomLevel zoomLevel = ((WMTSTileService) service).getZoomLevel(1 + offset);
            WMTSTileIdentifier tileId = new WMTSTileIdentifier(1, 1,
                    zoomLevel, "SomeName");
            WMTSTile tile = new WMTSTile(tileId, service);

            ReferencedEnvelope env = WMTSTileFactory.getExtentFromTileName(tileId,service);

            Assert.assertEquals(tile.getExtent(), env);

            Assert.assertEquals(service.getName(), expectedEnv[i].getMinX(), env.getMinX(), 0.001);
            Assert.assertEquals(service.getName(), expectedEnv[i].getMinY(), env.getMinY(), 0.001);
            Assert.assertEquals(service.getName(), expectedEnv[i].getMaxX(), env.getMaxX(), 0.001);
            Assert.assertEquals(service.getName(), expectedEnv[i].getMaxY(), env.getMaxY(), 0.001);
        }
    }

