    /**
     * Create an S3 connector from a URI-ish S3:// string. Notably, this constructor supports
     * awsRegion and useAnon as query parameters to control these settings.
     *
     * <p>Also of note, this URL is largely ignored outside of the query parameters. Mainly this is
     * used to control authentication options
     *
     * @param input an s3:// style URL.
     */
    S3Connector(String input) {
        this.url = input;
        // Parse region and anon from URL
        try {
            URI s3Uri = new URI(input);
            List<NameValuePair> nameValuePairs = URLEncodedUtils.parse(s3Uri, "UTF-8");

            for (NameValuePair nvPair : nameValuePairs) {
                if ("awsRegion".equals(nvPair.getName())) {
                    this.regionString = nvPair.getValue();
                }

                if ("useAnon".equals(nvPair.getName())) {
                    this.useAnon = Boolean.parseBoolean(nvPair.getValue());
                }
            }

        } catch (URISyntaxException e) {
            LOGGER.finer("Error parsing S3 URL in order to parse query options");
        }
    }

