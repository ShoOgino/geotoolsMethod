    private static AmazonS3 getS3Client() {
        Regions region;
        if (System.getProperty("AWS_REGION") != null) {
            try {
                region = Regions.valueOf(System.getProperty("AWS_REGION"));
            } catch (IllegalArgumentException e) {
                // probably not great to have a default, but we can't just blow up if this
                // property isn't set
                LOGGER.warning(
                        "AWS_REGION property is set, but not set correctly. "
                                + "Check that the AWS_REGION property matches the Regions enum");
                region = Regions.US_EAST_1;
            }
        } else {
            LOGGER.warning("No AWS_REGION property set, defaulting to US_EAST_1");
            region = Regions.US_EAST_1;
        }

        AmazonS3 s3;
        if (Boolean.getBoolean("S3_USE_ANON")) {
            s3 = new AmazonS3Client(new AnonymousAWSCredentials());
        } else {
            s3 = new AmazonS3Client();
        }

        s3.setRegion(Region.getRegion(region));

        return s3;
    }

