    private int calculateBlockSizeForBlock(int block) {
        long offsetInFile = this.cacheBlockSize * block;
        long remainingInFile = this.length - offsetInFile;
        return (int) Math.min(this.cacheBlockSize, remainingInFile);
    }

