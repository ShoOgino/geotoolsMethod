    public S3ImageInputStreamImpl(String input) throws IOException {
        this.connector = new S3Connector(input);
        this.url = input;
        String urlWithoutQueryString = input.split("\\?")[0];
        String parts[] = urlWithoutQueryString.split("/");
        StringBuilder keyBuilder = new StringBuilder();
        this.bucket = parts[2];
        for (int i = 3; i < parts.length; i++) {
            keyBuilder.append("/").append(parts[i]);
        }
        this.key = keyBuilder.toString();
        /* Strip leading slash */
        this.key = this.key.startsWith("/") ? this.key.substring(1) : this.key;

        S3Object object = this.getS3Client().getObject(new GetObjectRequest(this.bucket, this.key));
        ObjectMetadata meta = object.getObjectMetadata();

        this.fileName = nameFromKey(this.key);
        this.length = meta.getContentLength();
        this.cacheBlockSize = CacheManagement.DEFAULT.getCacheConfig().getChunkSizeBytes();

    }

