    /**
     * Setting Envelope, GridRange and CRS from the given {@code ImageReader}
     * 
     * @param reader
     *                the {@code ImageReader} from which to retrieve metadata
     *                (if available) for setting properties
     * @throws IOException
     */
    protected void setCoverageProperties(ImageReader reader) throws IOException {
        // //
        //
        // Getting metadata
        //
        // //
        final IIOMetadata metadata = reader.getImageMetadata(0);
        final boolean isSAS= metadata instanceof SASTileMetadata;
        
        // //
        //
        // get the CRS INFO
        //
        // //
        final Object tempCRS = this.hints.get(Hints.DEFAULT_COORDINATE_REFERENCE_SYSTEM);
        if (tempCRS != null) {
            setCoverageCRS((CoordinateReferenceSystem) tempCRS);
            if (LOGGER.isLoggable(Level.FINE))
                LOGGER.log(Level.FINE, "Using forced coordinate reference system "
                        + crs.toWKT());
        } else {
           
            if(!isSAS)
            	parsePRJFile();
            else{
            	getPropertiesFromMetadata((SASTileMetadata) metadata);
            }
            if (getCoverageCRS() == null) {
                parsePRJFile();
            }
            
            if (getCoverageCRS() == null)
                throw new DataSourceException("Coordinate Reference System is not available");            
        }

        // //
        //
        // If no sufficient information have been found to set the
        // envelope, try other ways, such as looking for a WorldFile
        //
        // //
        if(!isSAS)
        	parseWorldFile();
        else{
	        if (getCoverageEnvelope() == null) {
	            parseWorldFile();
	            if (getCoverageEnvelope() == null) {
	                throw new DataSourceException(
	                        "Unavailable envelope for this coverage");
	            }
	        }
        }

        // setting the coordinate reference system for the envelope
        getCoverageEnvelope().setCoordinateReferenceSystem(getCoverageCRS());

        // Additional settings due to "final" methods getOriginalXXX
        originalEnvelope = getCoverageEnvelope();
        originalGridRange = getCoverageGridRange();
        crs = getCoverageCRS();
    }

