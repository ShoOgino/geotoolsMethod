    // This is used mainly for unit testing
    public void setNThreads(int nthreads) {
        this.nthreads = nthreads;
    }

