    /**
     * Drags the map.
     * @param fromXScreen Original x coordinate in screen coordinates
     * @param fromYScreen Original y coordinate in screen coordinates
     * @param toXScreen Target x coordinate in screen coordinates
     * @param toYScreen Target y coordinate in screen coordinates
     */
    private void drag(double fromXScreen, double fromYScreen, double toXScreen, double toYScreen) {
        mapCanvas.setTranslateX(0);
        mapCanvas.setTranslateY(0);
        Point2D.Double from = new Point2D.Double(fromYScreen, fromXScreen);
        Point2D.Double to = new Point2D.Double(toYScreen, toXScreen);
		
		from = transformScreenToWorld(from);
		to = transformScreenToWorld(to);
		
        double fromX = from.getX();
        double fromY = from.getY();
        double toX = to.getX();
        double toY = to.getY();

        double xOffset = (toX - fromX);
        double yOffset = (toY - fromY);
        ReferencedEnvelope bBox = this.mapContent.getViewport().getBounds();

        Point2D.Double minXY = transformScreenToWorld(new Point2D.Double(0 - toXScreen,
            0 - toYScreen));
        Point2D.Double maxXY = transformScreenToWorld(new Point2D.Double(dimensionX - toXScreen,
            dimensionY - toYScreen));

        ReferencedEnvelope newBounds = new ReferencedEnvelope(
            minXY.getX(), maxXY.getX(),
            minXY.getY(), maxXY.getY(), this.crs);
        //TODO: Prevent exceeding max coordinate bounds
        if(!maxBBox.contains(newBounds, true)){
            newBounds = bBox;
        }
        setExtent(newBounds);
    }

