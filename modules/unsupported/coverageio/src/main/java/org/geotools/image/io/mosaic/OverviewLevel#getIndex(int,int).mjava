    /**
     * Returns the flat index for the given 2D index.
     *
     * @param  x,y The tile location, with (0,0) as the upper-left tile.
     * @return The corresponding index in a flat array.
     * @throws IndexOutOfBoundsException if the given index is out of bounds.
     */
    private int getIndex(final int x, final int y) throws IndexOutOfBoundsException {
        if (x < 0 || x >= nx || y < 0 || y >= ny) {
            throw new IndexOutOfBoundsException(Errors.format(
                    ErrorKeys.INDEX_OUT_OF_BOUNDS_$1, "(" + x + ',' + y + ')'));
        }
        return y * nx + x;
    }

