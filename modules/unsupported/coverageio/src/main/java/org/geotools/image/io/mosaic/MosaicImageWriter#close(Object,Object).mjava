    /**
     * Closes the given stream if it is different than the user object. When different, the
     * output is not the {@link File} (or whatever object) given by {@link Tile}. It is probably
     * an {@link ImageOutputStream} created by {@link #getImageWriter}, so we need to close it.
     */
    private static void close(final Object stream, final Object user) throws IOException {
        if (stream != user) {
            if (stream instanceof Closeable) {
                ((Closeable) stream).close();
            } else if (stream instanceof ImageInputStream) {
                ((ImageInputStream) stream).close();
            }
            // Note: ImageOutputStream extends ImageInputStream, so the above check is suffisient.
        }
    }

