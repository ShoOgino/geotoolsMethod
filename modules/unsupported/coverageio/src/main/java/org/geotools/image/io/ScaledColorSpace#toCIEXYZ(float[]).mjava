    /**
     * Convert a color to the CIEXYZ color space.
     */
    public float[] toCIEXYZ(final float[] values) {
        float value = (values[visibleBand] - offset) / scale;
        if (Float.isNaN(value)) {
            value = MIN_VALUE;
        }
        return new float[] {
            value * 0.9642f,
            value * 1.0000f,
            value * 0.8249f
        };
    }

