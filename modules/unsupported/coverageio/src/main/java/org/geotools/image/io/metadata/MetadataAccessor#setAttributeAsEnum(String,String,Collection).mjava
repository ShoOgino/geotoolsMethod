    /**
     * Set the attribute to the specified enumeration value,
     * or remove the attribute if the value is null.
     *
     * @param attribute The attribute name.
     * @param value     The attribute value.
     * @param enums     The set of allowed values, or {@code null} if unknown.
     */
    final void setAttributeAsEnum(final String attribute, String value, final Collection enums) {
        if (value != null) {
            value = value.replace('_', ' ').trim();
            for (final Iterator it=enums.iterator(); it.hasNext();) {
                final String e = (String) it.next();
                if (value.equalsIgnoreCase(e)) {
                    value = e;
                    break;
                }
            }
        }
        setAttributeAsString(attribute, value);
    }

