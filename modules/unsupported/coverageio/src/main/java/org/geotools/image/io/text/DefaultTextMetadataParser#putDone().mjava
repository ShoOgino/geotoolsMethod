    /**
     * {@inheritDoc}
     */
    protected void putDone() {
        final ImageGeometry    geometry    = metadata.getGeometry();
        final ImageReferencing referencing = metadata.getReferencing();
        if (!Double.isNaN(xmin) && !Double.isNaN(xmax)) {
            geometry.setOrdinateRange(0, xmin, xmax);
            referencing.addAxis(null, xdir, unit);
        }
        if (!Double.isNaN(ymin) && !Double.isNaN(ymax)) {
            geometry.setOrdinateRange(1, ymin, ymax);
            referencing.addAxis(null, ydir, unit);
        }
        if (!Double.isNaN(zmin) && !Double.isNaN(zmax)) {
            geometry.setOrdinateRange(2, zmin, zmax);
            referencing.addAxis(null, zdir, unit);
        }
        final int dimension = referencing.getDimension();
        /* Create an array of offset vectors with the value stored in the specified dimension.
         * For example, if we are in a 2D system, offset vector will be like :
         * offsetVector[0] :  ||x||     0
         * offsetVector[1] :    0     ||y||
         * This process assumes that the grid is straight, meaning the offset vector
         * in the X ordinate have a value only in the X direction.
         */
        final double[] offsetVector = new double[dimension];
        if (!Double.isNaN(xres) && dimension > 0) {
            offsetVector[0] = xres;
            geometry.addOffsetVector(offsetVector);
            offsetVector[0] = 0;
        }
        if (!Double.isNaN(yres) && dimension > 1) {
            offsetVector[1] = yres;
            geometry.addOffsetVector(offsetVector);
            offsetVector[1] = 0;
        }
        if (!Double.isNaN(zres) && dimension > 2) {
            offsetVector[2] = zres;
            geometry.addOffsetVector(offsetVector);
            offsetVector[2] = 0;
        }
        /* CoordinateReferenceSystem information. 
         */
        if (crs_name != null || crs_type != null) {
            referencing.setCoordinateReferenceSystem(crs_name, crs_type);
        }
        if (cs_name != null || cs_type != null) {
            referencing.setCoordinateSystem(cs_name, cs_type);
        }
    }

