    /**
     * Returns the specified value as a string.
     *
     * @param  value The value to cast.
     * @param  key The key, for formatting error message if needed.
     * @param  alias The alias, for formatting error message if needed.
     * @return The value as a string.
     * @throws MetadataException if the value can't be cast to a string.
     */
    private String toString(final Object value, final Key key, final String alias)
            throws MetadataException
    {
        if (value == null) {
            return null;
        }
        if (value instanceof CharSequence) {
            return value.toString();
        }
        if (value instanceof IdentifiedObject) {
            return ((IdentifiedObject) value).getName().getCode();
        }
        throw new MetadataException(Errors.getResources(userLocale).getString(
              ErrorKeys.CANT_CONVERT_FROM_TYPE_$1, Classes.getClass(value)), key, alias);
    }

