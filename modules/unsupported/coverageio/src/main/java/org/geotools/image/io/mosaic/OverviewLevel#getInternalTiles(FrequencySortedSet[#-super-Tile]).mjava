    /**
     * Adds all internal tiles to the given set, together with their frequency.
     *
     * @param addTo The collection where to add the internal tiles.
     */
    final void getInternalTiles(final FrequencySortedSet<? super Tile> addTo) {
        int count = 0;
        if (tiles != null) {
            for (final Tile tile : tiles) {
                if (tile != null) {
                    addTo.add(tile);
                    count++;
                }
            }
        }
        if (patterns != null) {
            for (int p=0; p<patterns.length;) {
                final Tile tile = patterns[p++];
                final int n = (patternUsed != null) ? patternUsed.occurence(p) : nx*ny - count;
                addTo.add(tile, n);
            }
        }
    }

