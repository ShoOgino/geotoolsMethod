    /**
     * Returns the {@linkplain Unit unit} from a {@linkplain GridCoverage grid coverage},
     * or {@code null} if the unit was not correctly defined.
     *
     * @param coverage A {@linkplain GridCoverage grid coverage}. Should not be
     *                 {@code null}.
     */
    public static Unit getUnit(final GridCoverage coverage) {
        Unit unit = null;
        final CoordinateReferenceSystem crs = coverage.getCoordinateReferenceSystem();
        if (crs != null) {
            final CoordinateSystem cs = crs.getCoordinateSystem();
            if (cs != null) {
                for (int i = cs.getDimension(); --i >= 0;) {
                    final Unit<?> candidate = cs.getAxis(i).getUnit();
                    if (candidate != null) {
                        if (unit == null) {
                            unit = candidate;
                        } else if (!unit.equals(candidate)) {
                            return null;
                        }
                    }
                }
            }
        }
        return unit;
    }

