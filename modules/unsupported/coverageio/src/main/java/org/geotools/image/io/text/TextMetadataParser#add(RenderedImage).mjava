    /**
     * Add all metadata from the specified image.
     *
     * @param  image The image with metadata to add to this {@code MetadataReader}.
     * @throws AmbiguousMetadataException if a metadata is defined twice.
     *
     * @see #add(GridCoverage)
     * @see #add(PropertySource,String)
     * @see #add(String,Object)
     */
    public synchronized void add(final RenderedImage image)
            throws AmbiguousMetadataException
    {
        if (image instanceof PropertySource) {
            // This version allow the use of deferred properties.
            add((PropertySource) image, null);
        } else {
            final String[] names = image.getPropertyNames();
            if (names != null) {
                for (int i=0; i<names.length; i++) {
                    final String name = names[i];
                    add(name, image.getProperty(name));
                }
            }
        }
    }

