    private SimpleFeatureType getIndexSchema(Name name,CoordinateSystem cs) throws Exception {
        
        // get the name for this variable to check his coveragename
        final String variableName = name.toString();
        // get the coverage definition for this variable, at this stage this exists otherwise we would have skipped it!
        final Coverage coverage = ancillaryFileManager.coveragesMapping.get(variableName);
        
        // now check the schema creation
        SchemaType schema = coverage.getSchema();
        String schemaDef=schema!=null?schema.getAttributes():null;
        
        // no schema was defined yet, let's create a default one
        if (schema == null||schema.getAttributes()==null) {
            // TODO incapsulate in coveragedescriptor
            schemaDef = suggestSchemaFromCoordinateSystem(coverage, cs);
            
            //set the schema name to be the coverageName
            ancillaryFileManager.setSchema(coverage,coverage.getName(),schemaDef);   
            schema = coverage.getSchema();
        } 
        
        // create featuretype, the name is the CoverageName
        final SimpleFeatureType indexSchema = UnidataUtilities.createFeatureType(coverage.getName(),schemaDef,UnidataCRSUtilities.WGS84);
        
        // create 
        forceSchemaCreation(indexSchema);
        
        // return
        return indexSchema;
    }

