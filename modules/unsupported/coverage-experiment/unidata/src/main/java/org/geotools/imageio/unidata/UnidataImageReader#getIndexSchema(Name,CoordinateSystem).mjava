    private SimpleFeatureType getIndexSchema(Name name,CoordinateSystem cs) throws Exception {
        // Getting the schema for this coverage
        SimpleFeatureType indexSchema = null;
        final String coverageName = name.toString();
        Coverage coverage = ancillaryFileManager.coveragesMapping.get(coverageName);
        SchemaType schema = coverage.getSchema();
        String schemaName = null;
        if (schema != null) {
            schemaName = schema.getName();
        }
        
        // no schema was defined yet, let's create a default one
        if (schemaName == null) {
            ancillaryFileManager.setSchemaName(coverage,coverageName);
        } else {
            // we might have a schema suggested from the indexer
            indexSchema = ancillaryFileManager.suggestSchema(coverage);
        }
        
        if (indexSchema==null){
            // TODO incapsulate in coveragedescriptor
            indexSchema = createSchema(coverage, cs);
        }
        return indexSchema;
    }

