    /**
     * Initialize the schema and return the {@link SimpleFeatureType} instance.
     * @param params
     * @param coverage
     * @param cs 
     * @return
     * @throws IOException
     * @throws Exception
     */
    SimpleFeatureType suggestSchema(
            final Coverage coverage) throws Exception {

        // Get the schema for that coverage (if any)
        SchemaType schemaElement = coverage.getSchema();
        if (schemaElement == null) {
            schemaElement = OBJECT_FACTORY.createSchemaType();
            coverage.setSchema(schemaElement);
        }
        
        // Get attributes (if any) defining that schema
        String schemaAttributes = schemaElement.getAttributes();

        // for the moment we only handle data in 4326
        final CoordinateReferenceSystem actualCRS = UnidataCRSUtilities.WGS84;
        SimpleFeatureType indexSchema = null;
        
        // Setting up the simpleFeatureType
        if (schemaAttributes != null) {
            schemaAttributes = schemaAttributes.trim();
            // get the schema
            try {
                indexSchema = DataUtilities.createType(schemaElement.getName(), schemaAttributes);
                indexSchema = DataUtilities.createSubType(indexSchema,DataUtilities.attributeNames(indexSchema), actualCRS);
            } catch (Throwable e) {
                if (LOGGER.isLoggable(Level.FINE))
                    LOGGER.log(Level.FINE, e.getLocalizedMessage(), e);
                indexSchema = null;
            }
        }
        return indexSchema;
    }

