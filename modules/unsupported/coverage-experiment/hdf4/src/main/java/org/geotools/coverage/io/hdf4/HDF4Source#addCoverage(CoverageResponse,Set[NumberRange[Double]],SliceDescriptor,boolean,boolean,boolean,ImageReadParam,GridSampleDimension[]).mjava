    private void addCoverage(final CoverageResponse response, final Set<NumberRange<Double>> verticalSubset, 
            final SliceDescriptor sd, final boolean needTransformation, final boolean emptyRequest,
            final boolean useJAI, final ImageReadParam imageReadParam, final GridSampleDimension[] sampleDimensions) throws IOException {
//        if (!verticalSubset.isEmpty()) {
//            for (NumberRange<Double> envelope : verticalSubset) {
//                VerticalExtent ve = sd.getVerticalExtent();
//                if (ve != null) {
//                	NumberRange<Double> verticalEnvelope = NumberRange.create(ve.getMinimumValue().doubleValue(), ve.getMaximumValue().doubleValue());
//                    if (verticalEnvelope.contains(envelope)) {// TODO check this, it might not be correct
//                        final int imageIndex = ((AbstractSliceDescriptor) sd).getImageIndex();
//                        GridCoverage gc = Utilities.compute(BaseFileDriver
//                                .urlToFile(access.getInput()), imageIndex,
//                                needTransformation, emptyRequest, useJAI,
//                                imageReadParam, false, sampleDimensions, HDF4Driver.spi, this.name.toString(), coverageFactory, access.raster2ModelMap.get(this.name),
//                                access.spatialReferenceSystem2DMap.get(this.name), access.coverageEnvelope2DMap.get(this.name));
//                        if (gc != null)
//                            response.addResult(gc);
//                    }
//                }
//            }
//        } else {
            final int imageIndex = ((AbstractSliceDescriptor) sd)
                    .getImageIndex();
            GridCoverage gc = Utilities.compute(BaseFileDriver.urlToFile(access
                    .getInput()), imageIndex, needTransformation, emptyRequest,
                    useJAI, imageReadParam, false, sampleDimensions, HDF4Driver.spi, this.name.toString(), coverageFactory, access.raster2ModelMap.get(this.name),
                    access.spatialReferenceSystem2DMap.get(this.name), access.coverageEnvelope2DMap.get(this.name));
            if (gc != null)
                response.addResult(gc);
//        }
    }

