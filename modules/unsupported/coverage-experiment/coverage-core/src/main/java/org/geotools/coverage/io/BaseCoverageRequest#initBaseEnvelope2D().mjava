    /**
     * Initialize the 2D properties (CRS and Envelope) of this coverage
     * 
     * @throws FactoryException
     * @throws TransformException
     */
    private void initBaseEnvelope2D() throws FactoryException,
            TransformException {
        // //
        //
        // Get the original envelope 2d and its spatial reference system
        //
        // //
        if (spatialReferenceSystem2D == null) {
            if (coverageCRS.getCoordinateSystem().getDimension() != 2) {
                spatialReferenceSystem2D = CRS.getHorizontalCRS(coverageCRS);
                assert spatialReferenceSystem2D.getCoordinateSystem()
                        .getDimension() == 2;
                baseEnvelope2D = new Envelope2D(
                        CRS
                                .transform(
                                        CRS
                                                .findMathTransform(
                                                        coverageCRS,
                                                        (CoordinateReferenceSystem) spatialReferenceSystem2D),
                                        coverageEnvelope));
            } else {
                spatialReferenceSystem2D = coverageCRS;
                baseEnvelope2D = new Envelope2D(coverageEnvelope);
            }
        }
    }

