    /** Converts a JTS Coordinate to a DirectPosition with the given CRS. */
    public static DirectPosition coordinateToDirectPosition(
            org.locationtech.jts.geom.Coordinate c, CoordinateReferenceSystem crs) {

        Hints hints = new Hints(Hints.CRS, crs);
        GeometryFactory gf = GeometryFactoryFinder.getGeometryFactory(hints);
        PositionFactory pf = GeometryFactoryFinder.getPositionFactory(hints);

        double[] vertices;
        if (crs == null) vertices = new double[3];
        else vertices = new double[crs.getCoordinateSystem().getDimension()];
        DirectPosition result = pf.createDirectPosition(vertices);
        coordinateToDirectPosition(c, result);
        return result;
    }

