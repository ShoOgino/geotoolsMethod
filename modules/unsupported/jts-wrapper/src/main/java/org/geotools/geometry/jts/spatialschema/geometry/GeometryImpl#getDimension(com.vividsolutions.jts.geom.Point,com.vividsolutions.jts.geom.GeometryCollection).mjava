    private static final int getDimension(
            final com.vividsolutions.jts.geom.Point p,
            final com.vividsolutions.jts.geom.GeometryCollection gc) {
        int min = Integer.MAX_VALUE;
        int n = gc.getNumGeometries();
        for (int i = 0; i < n; i++) {
            int d = Integer.MAX_VALUE;
            com.vividsolutions.jts.geom.Geometry g = gc.getGeometryN(i);
            if (g instanceof com.vividsolutions.jts.geom.GeometryCollection) {
                // If it was a nested GeometryCollection, then just recurse
                // until we get down to non-collections.
                d = getDimension(p, (com.vividsolutions.jts.geom.GeometryCollection) g);
            } else {
                if (g.intersects(p)) d = g.getDimension();
            }
            if (d < min) min = d;
        }
        return min;
    }

