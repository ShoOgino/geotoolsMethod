    /**
     * Returns the manifold dimension of the geometry at the given point. The point must lie on the
     * geometry.
     *
     * <p>For geometries that consist of multiple parts, this returns the dimension of the part
     * intersecting the given point. When multiple parts coincide at the given point, this returns
     * the least dimension of those geometries. Returns Integer.MAX_VALUE if the given point is not
     * on this geometry.
     */
    public final int getDimension(final DirectPosition point) {
        com.vividsolutions.jts.geom.Geometry jtsGeom = getJTSGeometry();
        if (jtsGeom instanceof com.vividsolutions.jts.geom.GeometryCollection) {
            com.vividsolutions.jts.geom.Point p = JTSUtils.directPositionToPoint(point);
            return getDimension(p, (com.vividsolutions.jts.geom.GeometryCollection) jtsGeom);
        } else {
            return jtsGeom.getDimension();
        }
    }

