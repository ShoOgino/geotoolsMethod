    protected static ReferencedEnvelope getBounds(
            EFeatureDataStore eDataStore,
            SimpleFeatureType eType,
            FeatureReader<SimpleFeatureType, SimpleFeature> eReader)
            throws IOException {
        //
        // Calculate manually TODO: Optimize
        //
        eDataStore.getLogger().fine("Calculating bounds manually");
        //
        // Grab the 2D-part of the CRS
        //
        CoordinateReferenceSystem flatCRS =
                CRS.getHorizontalCRS(eType.getCoordinateReferenceSystem());
        //
        // Initialize bounds
        //
        ReferencedEnvelope bounds = new ReferencedEnvelope(flatCRS);
        //
        // Calculate bounds
        //
        try {
            if (eReader.hasNext()) {
                //
                // Initialize bounds
                //
                SimpleFeature f = eReader.next();
                bounds.init(f.getBounds());
                //
                // Make union of all bounds
                //
                while (eReader.hasNext()) {
                    f = eReader.next();
                    bounds.include(f.getBounds());
                }
            }
        } finally {
            //
            // Always ensure that reader is closed to prevent memory leakage
            //
            eReader.close();
        }
        //
        // Calculation finished
        //
        return bounds;
    }

