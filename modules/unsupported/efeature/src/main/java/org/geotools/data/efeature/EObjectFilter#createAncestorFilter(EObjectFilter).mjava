    /**
     * Creates a filter matching contents of given object.
     * <p>
     * 
     * @param filter - the ancestor filter
     * @param all - if <code>true</code>, all contents must be matched by the filter
     * @param tree - if <code>true</code>, {@link EObject#eAllContents()} is used instead of
     *        {@link EObject#eContents()}
     * 
     * @return the filter
     * 
     */
    public static EObjectFilter createAncestorFilter(final EObjectFilter filter) {
        return new EObjectFilter() {
            @Override
            public boolean matches(Object object) {
                if (object instanceof EObject) {
                    EObject eObj = (EObject) object;
                    EObject eAncestor = null;
                    while (eObj != null) {
                        if (filter.matches(eObj)) {
                            return true;
                        }
                        eAncestor = eObj.eContainer();
                        // Reached break condition?
                        //
                        eObj = (eObj == eAncestor ? null : eAncestor);
                    }
                }
                return false;
            }
        };
    }

