    private static <T> T toValue(Object v, Class<T> type, T d) {
        return (v == null ? d : type.cast(v));
    }

