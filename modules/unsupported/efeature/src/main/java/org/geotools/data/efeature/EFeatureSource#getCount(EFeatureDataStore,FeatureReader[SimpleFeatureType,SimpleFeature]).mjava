    protected static int getCount(
            EFeatureDataStore eDataStore, FeatureReader<SimpleFeatureType, SimpleFeature> eReader)
            throws IOException {
        //
        // Initialize
        //
        int count = 0;
        //
        // Calculate manually TODO: Optimize
        //
        eDataStore.getLogger().fine("Calculating feature count manually");
        //
        // Calculate feature count
        //
        try {
            //
            // Count all features
            //
            while (eReader.hasNext()) {
                eReader.next();
                count++;
            }
        } finally {
            //
            // Always ensure that reader is closed to prevent memory leakage
            //
            eReader.close();
        }
        //
        // Calculation finished
        //
        return count;
    }

