    public static Class<?> toType(Object value) {
        if (value != null) {
            Class<?> type = value.getClass();
            return type.isArray() ? type.getComponentType() : type;
        }
        return null;
    }

