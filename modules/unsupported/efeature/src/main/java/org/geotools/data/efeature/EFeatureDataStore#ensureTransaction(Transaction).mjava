    protected static Transaction ensureTransaction(Transaction tx) {
        return (tx == null ? Transaction.AUTO_COMMIT : tx);
    }

