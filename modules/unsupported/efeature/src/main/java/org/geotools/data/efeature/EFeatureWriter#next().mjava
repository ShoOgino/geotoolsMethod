    @Override
    public SimpleFeature next() throws IOException {
        if (eReader == null) {
            throw new IOException("Writer has been closed");
        }
        String fid = null;
        try {
            //
            // Has more features?
            //
            if (hasNext()) {
                //
                // Grab next feature matching given query
                //
                eNext = eReader.next(); 
                //
                // Finished 
                //
                return eNext;
                
            } else {
                //
                //  No more EObject found, create new from structure
                //
                EFeature eFeature = eNewInstance();                
                //
                // Get default values
                //
                Object eValues[] = DataUtilities.defaultValues(getFeatureType());
                //
                // Set default values
                //
                eSetValues(eFeature, Arrays.asList(eValues));
                //
                // Finished
                //
                return eGetData(eFeature);
            }
        } catch (IllegalAttributeException e) {
            String message = "Problem creating feature "
                    + (fid != null ? fid : "");
            throw new DataSourceException(message, e);
        }    
    }

