    /**
     * Creates the polygon schema and then inserts a 3D geometry into the
     * datastore and retrieves it back to make sure 3d data is really handled as
     * such
     * 
     * @throws Exception
     */
    public void testCreateSchemaAndInsert() throws Exception {
        data.createSchema(poly3DType);
        SimpleFeatureType actualSchema = data.getSchema(POLY3D);
        assertFeatureTypesEqual(poly3DType, actualSchema);

        // build a 3d polygon (ordinates in ccw order)
        GeometryFactory gf = new GeometryFactory();
        LinearRing shell = gf.createLinearRing(new Coordinate[] { new Coordinate(0, 0, 0),
                new Coordinate(1, 1, 1), new Coordinate(1, 0, 1), new Coordinate(0, 0, 0) });
        Polygon poly = gf.createPolygon(shell, null);

        // insert it
        FeatureWriter<SimpleFeatureType, SimpleFeature> fw = data.getFeatureWriterAppend(
                POLY3D, Transaction.AUTO_COMMIT);
        SimpleFeature f = fw.next();
        f.setAttribute(ID, 0);
        f.setAttribute(GEOM, poly);
        f.setAttribute(NAME, "3dpolygon!");
        fw.write();
        fw.close();

        // read id back and compare
        FeatureReader<SimpleFeatureType, SimpleFeature> fr = data.getFeatureReader(
                new DefaultQuery(POLY3D), Transaction.AUTO_COMMIT);
        assertTrue(fr.hasNext());
        f = fr.next();
        assertTrue(poly.equals((Geometry) f.getDefaultGeometry()));
        fr.close();
    }

