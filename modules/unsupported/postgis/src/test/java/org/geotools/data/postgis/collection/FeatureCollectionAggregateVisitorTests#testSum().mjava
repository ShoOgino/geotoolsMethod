    public void testSum() throws Exception {
        // test against integer data
        SumVisitor sumVisitor = new SumVisitor(roadsId);
        roads.accepts(sumVisitor, null);
        assertTrue(roads.isOptimized); //the optimization was used
        assertEquals(6, sumVisitor.getResult().toInt());
        
        // test complex expression
        Literal one = ff.literal(1);
        Add add = ff.add(roadsId, one);
        SumVisitor sumInt = new SumVisitor(add);
        roads.accepts(sumInt, null);
        assertTrue(roads.isOptimized);
        assertEquals(9, sumInt.getResult().toInt());
        
        // test against float
        Add addFloat = ff.add(riverFlow, one);
        SumVisitor sumFloat = new SumVisitor(addFloat);
        rivers.accepts(sumFloat, null);
        assertTrue(rivers.isOptimized);
        assertEquals(9.5, sumFloat.getResult().toDouble(), 0.0);
    }

