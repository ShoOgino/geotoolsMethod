    public void testGetFeatureReaderRetypeBug() throws Exception {
        // this is here to avoid http://jira.codehaus.org/browse/GEOT-1069
        // to come up again

        Transaction t = new DefaultTransaction();
        SimpleFeatureType type = data.getSchema("river");
         FeatureReader<SimpleFeatureType, SimpleFeature> reader;

        FilterFactory ff = FilterFactoryFinder.createFilterFactory();
        CompareFilter cf = ff.createCompareFilter(Filter.COMPARE_EQUALS);
        cf.addLeftValue(ff.createAttributeExpression("flow"));
        cf.addRightValue(ff.createLiteralExpression(4.5));

        DefaultQuery q = new DefaultQuery("river");
        q.setPropertyNames(new String[] { "geom" });
        q.setFilter(cf);

        // with GEOT-1069 an exception is thrown here
        reader = data.getFeatureReader(q, t);
        assertTrue(reader.hasNext());
        assertEquals(1, reader.getFeatureType().getAttributeCount());
        reader.next();
        assertFalse(reader.hasNext());
        reader.close();
        t.close();
    }

