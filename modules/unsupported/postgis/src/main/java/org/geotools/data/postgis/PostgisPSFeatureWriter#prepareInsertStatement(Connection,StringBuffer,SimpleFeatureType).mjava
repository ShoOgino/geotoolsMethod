    /**
     * Overrides to add the <code>"RETURNING pk"</code> statement to the insert request, so
     * {@link PostGISAutoIncrementFIDMapper#retriveId} can get the generated pk without issueing an
     * extra select to the db.
     */
    @Override
    protected PreparedStatement prepareInsertStatement(Connection conn,
            StringBuffer statementSQL,
            SimpleFeatureType featureType) throws SQLException {

        if (mapper.hasAutoIncrementColumns()) {
            statementSQL.append(" RETURNING ");
            for (int i = 0; i < mapper.getColumnCount(); i++) {
                if (mapper.isAutoIncrement(i)) {
                    statementSQL.append(mapper.getColumnName(i));
                    statementSQL.append(",");
                }
            }
            // remove trailing comma
            statementSQL.deleteCharAt(statementSQL.length() - 1);
        }

        return super.prepareInsertStatement(conn, statementSQL, featureType);
    }

