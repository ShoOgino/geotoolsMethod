    /**
     * @see org.geotools.data.jdbc.FeatureTypeHandler#getFIDMapper(java.lang.String)
     */
    public FIDMapper getFIDMapper(String typeName) throws IOException {
        FIDMapper mapper = (FIDMapper) typeMappers.get(typeName);

        if (mapper != null)
            return mapper;
        
        mapper = dataStore.buildFIDMapper(typeName, fmFactory);
        if(mapper == null)
            throw new RuntimeException("Could not build a FIDMapper for type " + typeName);
        typeMappers.put(typeName, mapper);
        return mapper;
    }

