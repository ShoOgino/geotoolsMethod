    static int fetchNumBands(RasterColumn col, Connection cx) throws SQLException {
        SQL sql =
                new SQL()
                        .append("SELECT max(ST_NumBands(")
                        .name(col.name)
                        .append(")) as num_bands")
                        .append(" FROM ")
                        .table(col)
                        .append(" LIMIT 1");

        try (Statement st = cx.createStatement()) {
            try (ResultSet rs = st.executeQuery(sql.logAndGet(LOG))) {
                if (rs.next()) {
                    return rs.getInt(1);
                }
            }
        }

        return 0;
    }

