    public static void doDelete(DataStore ds, SimpleFeatureType ft, Id ff) throws Exception {
        assertNotNull("doInsertFailed?", ff);
        try (Transaction t = new DefaultTransaction()) {
            SimpleFeatureStore fs = (SimpleFeatureStore) ds.getFeatureSource(ft.getTypeName());
            fs.setTransaction(t);

            // System.out.println("Delete Read 1");
            int count1 = 0;
            try (SimpleFeatureIterator fr = fs.getFeatures().features()) {
                while (fr.hasNext()) {
                    count1++;
                    fr.next();
                }
            }

            // System.out.println("Delete Remove " + ff);
            fs.removeFeatures(ff);

            // System.out.println("Delete Read 2");
            int count2 = 0;
            try (SimpleFeatureIterator fr = fs.getFeatures().features()) {

                while (fr.hasNext()) {
                    count2++;
                    fr.next();
                }
            }
            assertTrue("Read 1 == " + count1 + " Read 2 == " + count2, count2 < count1);

            // System.out.println("Delete Commit");
            t.commit();

            // System.out.println("Delete Read 3");
            int count3 = 0;
            try (SimpleFeatureIterator fr = fs.getFeatures().features()) {
                while (fr.hasNext()) {
                    count3++;
                    fr.next();
                }
            }
            assertEquals(count2, count3);
        }
    }

