    @Test
    public void testGetFeaturesWriterAdd() throws Exception {
        try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                data.getFeatureWriter(first.typeName, Transaction.AUTO_COMMIT)) {

            while (writer.hasNext()) {
                writer.next();
            }

            assertFalse(writer.hasNext());
            SimpleFeature feature = writer.next();
            feature.setAttributes(first.newFeature.getAttributes());
            writer.write();
            assertFalse(writer.hasNext());
        }

        try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                data.getFeatureWriter(first.typeName, Transaction.AUTO_COMMIT)) {
            assertEquals(first.features.length + 1, count(writer));
        }
    }

