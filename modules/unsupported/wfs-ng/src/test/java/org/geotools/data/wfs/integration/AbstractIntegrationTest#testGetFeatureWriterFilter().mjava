    /*
     * Test for FeatureWriter getFeatureWriter(String, boolean, Transaction)
     */
    @Test
    public void testGetFeatureWriterFilter() throws Exception {
        try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                data.getFeatureWriter(first.typeName, Filter.EXCLUDE, Transaction.AUTO_COMMIT)) {
            assertFalse(writer.hasNext());
            assertEquals(0, count(writer));
        }

        try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                data.getFeatureWriter(first.typeName, Filter.INCLUDE, Transaction.AUTO_COMMIT)) {
            assertFalse(writer instanceof FilteringFeatureWriter);
            assertEquals(first.features.length, count(writer));
        }

        try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                data.getFeatureWriter(first.typeName, first.feat1Filter, Transaction.AUTO_COMMIT)) {
            assertEquals(1, count(writer));
        }
    }

