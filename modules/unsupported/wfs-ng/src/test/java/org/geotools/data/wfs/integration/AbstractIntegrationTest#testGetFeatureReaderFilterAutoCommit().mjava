    @Test
    public void testGetFeatureReaderFilterAutoCommit() throws Exception {
        SimpleFeatureType type = data.getSchema(first.typeName);

        Query query = new Query(first.typeName);
        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                data.getFeatureReader(query, Transaction.AUTO_COMMIT)) {
            assertFalse(reader instanceof FilteringFeatureReader);
            assertEquals(type, reader.getFeatureType());
            assertEquals(first.features.length, count(reader));
        }

        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                data.getFeatureReader(
                        new Query(first.typeName, Filter.EXCLUDE), Transaction.AUTO_COMMIT)) {

            assertEquals(type, reader.getFeatureType());
            assertEquals(0, count(reader));
        }

        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                data.getFeatureReader(
                        new Query(first.typeName, first.feat1Filter), Transaction.AUTO_COMMIT)) {

            assertEquals(type, reader.getFeatureType());
            assertEquals(1, count(reader));
        }
    }

