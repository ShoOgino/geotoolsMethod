    @Test
    public void testGetFeatureReaderMutability() throws IOException {
        Query query = new Query(first.typeName);
        SimpleFeature feature;
        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                data.getFeatureReader(query, Transaction.AUTO_COMMIT)) {
            while (reader.hasNext()) {
                feature = reader.next();
                feature.setAttribute(first.stringAttribute, null);
            }
        }

        @SuppressWarnings("PMD.CloseResource") // used to test behavior after close
        FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                data.getFeatureReader(query, Transaction.AUTO_COMMIT);

        while (reader.hasNext()) {
            feature = reader.next();
            assertNotNull(feature.getAttribute(first.stringAttribute));
        }

        reader.close();

        try {
            reader.next();
            fail("next should fail with an IOException or NoSuchElementException");
        } catch (IOException | NoSuchElementException expected) {
        }
    }

