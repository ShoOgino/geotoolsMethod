    /**
     * @param capabilitiesFile
     *            the name of the GetCapabilities document under
     *            {@code /org/geotools/data/wfs/impl/test-data}
     */
    private WFSDataStore testCreateDataStore(final String capabilitiesFile,
            final Version expectedVersion) throws IOException {

        Map<String, Serializable> params = new HashMap<String, Serializable>();
        params.put("TESTING", Boolean.TRUE);

        final URL capabilitiesUrl = getClass().getResource(
                "test-data/" + capabilitiesFile);
        if (capabilitiesUrl == null) {
            throw new IllegalArgumentException(capabilitiesFile + " not found");
        }
        params.put(WFSDataStoreFactory.URL.key, capabilitiesUrl);

        DataStore dataStore = DataStoreFinder.getDataStore(params);
        assertNotNull(dataStore);
        assertTrue(dataStore instanceof WFSDataStore);

        WFSDataStore wfsDs = (WFSDataStore) dataStore;

        assertEquals(expectedVersion.toString(), wfsDs.getInfo().getVersion());

        return wfsDs;
    }

