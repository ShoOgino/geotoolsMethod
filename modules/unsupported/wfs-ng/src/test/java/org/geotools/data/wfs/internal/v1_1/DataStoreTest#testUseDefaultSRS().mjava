    /**
     * Test for the useDefaultSRS parameter set to true. Query in a CRS different from the
     * DefaultSRS should be done in DefaultSRS and then reprojected.
     */
    @Test
    public void testUseDefaultSRS()
            throws IOException, NoSuchAuthorityCodeException, FactoryException, ServiceException {
        TestWFSClient wfs = createWFSClient();
        wfs.mockGetFeatureRequest(CUBEWERX_GOVUNITCE.DATA, qTypeName, Filter.INCLUDE);

        WFSDataStore ds = new WFSDataStore(wfs);
        Query query = new Query(CUBEWERX_GOVUNITCE.FEATURETYPENAME);

        // use the OtherSRS
        CoordinateReferenceSystem otherCrs = CRS.decode(CUBEWERX_GOVUNITCE.CRS);
        query.setCoordinateSystem(otherCrs);
        FeatureReader<SimpleFeatureType, SimpleFeature> featureReader;
        featureReader = ds.getFeatureReader(query, Transaction.AUTO_COMMIT);
        assertNotNull(featureReader);
        assertEquals(otherCrs, featureReader.getFeatureType().getCoordinateReferenceSystem());
        GetFeatureRequest request = wfs.getRequest();
        assertEquals(CUBEWERX_GOVUNITCE.CRS, request.getSrsName());

        // use an SRS not supported by server
        CoordinateReferenceSystem unknownCrs = CRS.decode("EPSG:3003");
        query.setCoordinateSystem(unknownCrs);

        featureReader = ds.getFeatureReader(query, Transaction.AUTO_COMMIT);
        assertNotNull(featureReader);
        assertTrue(featureReader instanceof ReprojectFeatureReader);
        assertEquals(unknownCrs, featureReader.getFeatureType().getCoordinateReferenceSystem());
        request = wfs.getRequest();
        assertNull(request.getSrsName());
    }

