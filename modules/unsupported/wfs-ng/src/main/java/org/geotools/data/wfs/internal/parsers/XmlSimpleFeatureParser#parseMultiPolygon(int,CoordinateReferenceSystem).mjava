    private Geometry parseMultiPolygon(int dimension, CoordinateReferenceSystem crs)
            throws XMLStreamException, IOException, NoSuchAuthorityCodeException, FactoryException {

        parser.require(START_ELEMENT, GML.NAMESPACE, GML.MultiPolygon.getLocalPart());

        List<Polygon> polygons = new ArrayList<>(2);
        parser.nextTag();
        while (true) {
            parser.require(START_ELEMENT, GML.NAMESPACE, GML.polygonMember.getLocalPart());
            parser.nextTag();
            parser.require(START_ELEMENT, GML.NAMESPACE, GML.Polygon.getLocalPart());
            Polygon p = parsePolygon(dimension, crs);
            polygons.add(p);
            parser.nextTag();
            parser.require(END_ELEMENT, GML.NAMESPACE, GML.polygonMember.getLocalPart());
            parser.nextTag();
            if (END_ELEMENT == parser.getEventType()
                    && GML.MultiPolygon.getLocalPart().equals(parser.getLocalName())) {
                // we're done
                break;
            }
        }
        parser.require(END_ELEMENT, GML.NAMESPACE, GML.MultiPolygon.getLocalPart());

        Geometry geom = geomFac.createMultiPolygon(polygons.toArray(new Polygon[polygons.size()]));
        return geom;
    }

