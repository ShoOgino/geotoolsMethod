    @Override
    public SimpleFeature parse() throws IOException {
        final String fid;
        try {
            fid = seekFeature();
            if (fid == null) {
                return null;
            }
            int tagType;
            Object attributeValue;
            while (true) {
                tagType = parser.next();
                if (END_DOCUMENT == tagType) {
                    close();
                    return null;
                }

                if (END_ELEMENT == tagType
                        && featureNamespace.equals(parser.getNamespaceURI())
                        && featureName.equals(parser.getLocalName())) {
                    // found end of current feature
                    break;
                }
                if (START_ELEMENT == tagType) {
                    AttributeDescriptor descriptor = expectedProperties.get(parser.getLocalName());
                    if (descriptor != null) {
                        attributeValue = parseAttributeValue();
                        builder.set(descriptor.getLocalName(), attributeValue);
                    }
                }
            }
        } catch (XMLStreamException e) {
            throw new DataSourceException(e);
        }
        SimpleFeature feature = builder.buildFeature(fid);
        return feature;
    }

