    public HTTPClient getHttpClient(final Map<String, Serializable> params) throws IOException {
        final URL capabilitiesURL = (URL) URL.lookUp(params);
        final WFSConfig config = WFSConfig.fromParams(params);
        return config.isUseHttpConnectionPooling() && isHttp(capabilitiesURL)
                ? new MultithreadedHttpClient()
                : new SimpleHttpClient();
    }

