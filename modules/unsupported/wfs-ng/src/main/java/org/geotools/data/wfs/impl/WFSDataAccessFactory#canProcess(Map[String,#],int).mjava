    protected boolean canProcess(final Map<String, ?> params, int maximumGmlComplianceLevel) {
        /*
         * check required params exist and are of the correct type
         */
        boolean canProcess = DataUtilities.canProcess(params, getParametersInfo());
        if (!canProcess) {
            return false;
        }
        try {
            URL url = URL.lookUp(params);
            if (!"http".equalsIgnoreCase(url.getProtocol())
                    && !"https".equalsIgnoreCase(url.getProtocol())) {
                if (!Boolean.TRUE.equals(params.get("TESTING"))) {
                    Loggers.MODULE.finest("Can't process non http or https GetCapabilities URLs");
                    return false; // must be http or https since we use
                    // SimpleHTTPClient class
                }
            }
        } catch (Exception e) {
            return false;
        }

        // check password / username
        if (params.containsKey(USERNAME.key)) {
            if (!params.containsKey(PASSWORD.key)) {
                return false; // must have both
            }
        } else {
            if (params.containsKey(PASSWORD.key)) {
                return false; // must have both
            }
        }

        // Check compliance level
        try {
            Integer complianceLevel = GML_COMPLIANCE_LEVEL.lookUp(params);
            if (complianceLevel != null && complianceLevel > maximumGmlComplianceLevel) {
                return false;
            }
        } catch (Exception e) {
            return false;
        }

        return true;
    }

