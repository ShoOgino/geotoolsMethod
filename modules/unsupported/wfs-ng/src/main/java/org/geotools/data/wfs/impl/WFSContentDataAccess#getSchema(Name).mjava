    @Override
    public FeatureType getSchema(Name name) throws IOException {
        // If there are no values in this.names it probably means that getNames
        // hasn't been called yet.
        if (this.names.isEmpty()) {
            this.getNames();
        }

        // Generate the URL for the feature request:
        // -----------------------------------------
        DescribeFeatureTypeRequest describeFeatureTypeRequest =
                client.createDescribeFeatureTypeRequest();
        QName qname = this.names.get(name);
        describeFeatureTypeRequest.setTypeName(qname);
        URL describeRequestURL = describeFeatureTypeRequest.getFinalURL();

        // Create type registry and add the schema to it:
        // ----------------------------------------------
        FeatureTypeRegistry typeRegistry = this.getFeatureTypeRegistry();
        SchemaIndex schemaIndex = this.getSchemaParser().parse(describeRequestURL);
        typeRegistry.addSchemas(schemaIndex);

        // Create the attribute type and cast it as a FeatureType:
        // -------------------------------------------------------
        AttributeDescriptor attributeDescriptor = typeRegistry.getDescriptor(name, null);
        return (FeatureType) attributeDescriptor.getType();
    }

