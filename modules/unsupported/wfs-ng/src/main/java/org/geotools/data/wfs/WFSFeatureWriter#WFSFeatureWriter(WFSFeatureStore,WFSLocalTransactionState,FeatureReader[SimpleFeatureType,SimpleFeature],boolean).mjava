    public WFSFeatureWriter(
            final WFSFeatureStore store,
            final WFSLocalTransactionState localSate,
            final FeatureReader<SimpleFeatureType, SimpleFeature> reader,
            final boolean autoCommit) {

        super(
                store,
                localSate.getDiff(),
                reader,
                new SimpleFeatureBuilder(
                        reader.getFeatureType(), new MutableIdentifierFeatureFactory()));

        if (autoCommit) {
            WFSDataStore dataStore = store.getDataStore();
            autoCommitState = new WFSRemoteTransactionState(dataStore);
            autoCommitState.watch(localSate.getState());
        } else {
            autoCommitState = null;
        }
    }

