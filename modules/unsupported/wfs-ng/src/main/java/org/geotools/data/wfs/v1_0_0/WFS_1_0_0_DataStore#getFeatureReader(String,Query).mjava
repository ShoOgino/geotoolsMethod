    protected FeatureReader<SimpleFeatureType, SimpleFeature> getFeatureReader(String typeName,
            Query query) throws IOException {
        if ((query.getTypeName() == null) || !query.getTypeName().equals(typeName)) {
            Query q = new DefaultQuery(query);
            ((DefaultQuery) q).setTypeName(typeName);

            return getFeatureReader(q, Transaction.AUTO_COMMIT);
        }

        return getFeatureReader(query, Transaction.AUTO_COMMIT);
    }

