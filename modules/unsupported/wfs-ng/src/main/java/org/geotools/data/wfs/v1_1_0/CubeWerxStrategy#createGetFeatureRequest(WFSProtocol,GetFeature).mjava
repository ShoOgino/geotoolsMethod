    /**
     * Addresses the following issues with the CubeWerx WFS server:
     * <p>
     * <ul>
     * <li>The request fails if the {@code resultType} parameter is set, either if the value is hits
     * or results, so it sets {@link GetFeatureType#setResultType(net.opengis.wfs.ResultTypeType)}
     * to {@code null}
     * 
     * <li>CubeWerx does not support filtering logical filters containing mixed geometry filters
     * (eg, AND(BBOX, Intersects)), no matter what the capabilities doc says
     * </ul>
     * </p>
     */
    @SuppressWarnings("nls")
    @Override
    public RequestComponents createGetFeatureRequest(WFSProtocol wfs, GetFeature query)
            throws IOException {
        RequestComponents parts = super.createGetFeatureRequest(wfs, query);

        GetFeatureType serverRequest = parts.getServerRequest();
        serverRequest.setResultType(null);
        parts.setServerRequest(serverRequest);

        GetFeatureType nonResultTypeRequest = new CubeWerxGetFeatureType();
        EMFUtils.copy(serverRequest, nonResultTypeRequest);
        // CubeWerx fails if the _mandatory_ resultType attribute is sent
        nonResultTypeRequest.setResultType(null);
        parts.setServerRequest(nonResultTypeRequest);

        parts.getKvpParameters().remove("RESULTTYPE");

        return parts;
    }

