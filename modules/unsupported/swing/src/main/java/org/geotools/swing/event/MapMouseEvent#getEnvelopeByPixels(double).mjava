    /**
     * Gets an envelope of specified width (in pixels) which is centred on the mouse position.
     *
     * @param widthPixels envelope width in pixels
     * @return the envelope
     * @throws IllegalArgumentException if {@code widthPixels} is less than zero
     */
    public ReferencedEnvelope getEnvelopeByPixels(double widthPixels) {
        if (widthPixels < 0) {
            throw new IllegalArgumentException("invalid value for widthPixels: " + widthPixels);
        }

        Rectangle2D screenRect =
                new Rectangle2D.Double(
                        getX() - (widthPixels / 2),
                        getY() - (widthPixels / 2),
                        widthPixels,
                        widthPixels);

        MapPane pane = getSource();
        Rectangle2D worldRect =
                pane.getScreenToWorldTransform().createTransformedShape(screenRect).getBounds2D();

        return new ReferencedEnvelope(
                worldRect, pane.getMapContent().getCoordinateReferenceSystem());
    }

