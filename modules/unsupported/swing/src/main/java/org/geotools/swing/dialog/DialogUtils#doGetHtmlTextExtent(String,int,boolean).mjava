    /**
     * Helper method for {@linkplain #getHtmlLabelTextExtent(java.lang.String, int, boolean)}.
     * This is required because we are creating and invisibly rendering a {@code JLabel} 
     * object in this method, and being virtuous in our Swing usage we should only do that
     * on the event dispatch thread.
     * 
     * @param labelText the text to render, optionally enclosed in {@code <html>...</html>} tags
     * @param fixedDimSize the size of the fixed dimension (either width or height
     * @param width {@code true} if the fixed dimension is width; {@code false} for height
     * 
     * @return the rendered label text extent
     */
    private static Dimension doGetHtmlTextExtent(String labelText, int fixedDimSize, boolean width) {
        final JLabel label = new JLabel();
        if (labelText.startsWith("<html>")) {
            label.setText(labelText);
        } else {
            label.setText("<html>" + labelText + "</html>");
        }
        
        View view = (View) label.getClientProperty(javax.swing.plaf.basic.BasicHTML.propertyKey);
        view.setSize(width ? fixedDimSize : 0, width? 0 : fixedDimSize);

        float w = view.getPreferredSpan(View.X_AXIS);
        float h = view.getPreferredSpan(View.Y_AXIS);
        
        return new java.awt.Dimension((int) Math.ceil(w), (int) Math.ceil(h));
    }

