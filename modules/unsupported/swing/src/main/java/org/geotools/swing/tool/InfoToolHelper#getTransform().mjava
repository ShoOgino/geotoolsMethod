    /**
     * Get the {@code MathTransform} to re-project data from the coordinate system of
     * the {@code MapContent} to that of the {@code Layer}.
     *
     * @return the transform or {@code null} if either the layer's coordinate system is the same
     *         as that of the map content, or either has a {@code null} CRS.
     */
    public MathTransform getTransform() {
        if (transform == null && !transformFailed && dataCRS != null) {
            MapContent content = getMapContent();
            if (content == null) {
                throw new IllegalStateException("null map content");
            }

            CoordinateReferenceSystem contentCRS = content.getCoordinateReferenceSystem();
            try {
                transform = CRS.findMathTransform(contentCRS, dataCRS, true);
            } catch (Exception ex) {
                LOGGER.warning("Can't transform map content to layer CRS");
                transformFailed = true;
            }
        }

        return transform;
    }

