    /**
     * Returns the axis type at the specified dimension. The {@link #prepareVariable} method
     * must be invoked prior this method (this is not verified).
     * <p>
     * This method is not public because it duplicates (in a different form) the informations
     * already provided in image metadata. We use it when we want only this specific information
     * without the the rest of metadata. In many cases this method will not be invoked at all,
     * thus avoiding the need to load metadata.
     *
     * @param  dimension The dimension.
     * @return The axis type, or {@code null} if unknown.
     * @throws IOException If an error occured while reading the NetCDF file.
     */
    private AxisType getAxisType(final int dimension) throws IOException {
        if (variable instanceof VariableDS) {
            ensureMetadataLoaded();
            final List sys = ((VariableDS) variable).getCoordinateSystems();
            if (sys != null) {
                final int count = sys.size();
                for (int i=0; i<count; i++) {
                    final CoordinateSystem cs = (CoordinateSystem) sys.get(i);
                    final List axes = cs.getCoordinateAxes();
                    if (axes != null && axes.size() > dimension) {
                        final CoordinateAxis axis = (CoordinateAxis) axes.get(dimension);
                        if (axis != null) {
                            return axis.getAxisType();
                        }
                    }
                }
            }
        }
        return null;
    }

