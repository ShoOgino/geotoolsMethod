    @Override
    public Geometry decodeGeometryValue(GeometryDescriptor descriptor, ResultSet rs, String column,
            GeometryFactory factory, Connection cx) throws IOException, SQLException {
        try {
            byte[] wkb = rs.getBytes(column + "_inline");
            if (wkb != null) {
                return new WKBReader(factory).read(wkb);
            }
            
            //in "locator" form the geometry comes across as text
            Clob clob = rs.getClob(column);
            InputStream in = clob.getAsciiStream();
            try {
                return new WKTReader(factory).read(new InputStreamReader(in));
            }
            finally {
                if (in != null) in.close();
            }
        }
        catch (ParseException e) {
            throw (IOException) new IOException("Error parsing geometry").initCause(e);
        }
    }

