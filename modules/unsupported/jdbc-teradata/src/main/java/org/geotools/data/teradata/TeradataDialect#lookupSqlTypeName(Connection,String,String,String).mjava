    /**
     * Returns the database typename of the column by inspecting the metadata.
     */
    public String lookupSqlTypeName(Connection cx, String schemaName, String tableName, 
        String columnName) throws SQLException {

        ResultSet columns =  null;
        try {
            columns = cx.getMetaData().getColumns(null, schemaName, tableName, columnName);
            columns.next();
    
            return columns.getString("TYPE_NAME");
        } 
        finally {
            columns.close();
        }
    }

