    /**
     * Adds support for a new featureType to MemoryDataStore.
     * <p>
     * FeatureTypes are stored by typeName, an IOException will be thrown if the
     * requested typeName is already in use.
     * </p>
     * 
     * @param featureType FeatureType to be added
     * @throws IOException If featureType already exists
     * @see org.geotools.data.DataAccess#createSchema(org.opengis.feature.type.FeatureType)
     */
    @Override
    public void createSchema(SimpleFeatureType featureType) throws IOException {
        final Name name = featureType.getName();
        if (memory.containsKey(name)) {
            // we have a conflict
            throw new IOException(featureType.getName() + " already exists");
        }
        // insertion order preserving map
        Map<String, SimpleFeature> featuresMap = new LinkedHashMap<String, SimpleFeature>();
        schema.put(name, featureType);
        memory.put(name, featuresMap);
    }

