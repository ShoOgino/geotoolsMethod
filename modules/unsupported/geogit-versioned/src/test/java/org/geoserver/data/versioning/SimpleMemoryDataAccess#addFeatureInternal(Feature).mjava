    private void addFeatureInternal(Feature feature) {
        if (feature == null) {
            throw new IllegalArgumentException("Provided Feature is empty");
        }

        FeatureType featureType;
        featureType = feature.getType();

        Name typeName = featureType.getName();

        Map<String, SimpleFeature> featuresMap;

        if (!memory.containsKey(typeName)) {
            try {
                createSchema((SimpleFeatureType) featureType);
            } catch (IOException e) {
                // this should not of happened ?!?
                // only happens if typeNames is taken and
                // we just checked
            }
        }

        featuresMap = memory.get(typeName);
        featuresMap.put(feature.getIdentifier().getID(),
                (SimpleFeature) feature);
    }

