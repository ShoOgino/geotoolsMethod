    private static void write(Geometry geometry, int dimension, ByteBuffer buffer)
            throws HanaWKBWriterException {
        if (geometry instanceof Point) {
            write((Point) geometry, dimension, buffer);
        } else if (geometry instanceof LineString) {
            write((LineString) geometry, dimension, buffer);
        } else if (geometry instanceof Polygon) {
            write((Polygon) geometry, dimension, buffer);
        } else if (geometry instanceof MultiPoint) {
            write((MultiPoint) geometry, dimension, buffer);
        } else if (geometry instanceof MultiLineString) {
            write((MultiLineString) geometry, dimension, buffer);
        } else if (geometry instanceof MultiPolygon) {
            write((MultiPolygon) geometry, dimension, buffer);
        } else if (geometry instanceof GeometryCollection) {
            write((GeometryCollection) geometry, dimension, buffer);
        } else {
            throw new HanaWKBWriterException(
                    MessageFormat.format(
                            "Unsupported geometry type {0}", geometry.getGeometryType()));
        }
    }

