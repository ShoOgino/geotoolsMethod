    private BoundingBox clamp(BoundingBox bounds) {
        // In geographic CRS', HANA will reject any points outside the "normalized" range, which is
        // (in radian) [-PI;PI] for longitude and
        // [-PI/2;PI/2] for latitude. As GeoTools seems to expect that larger bounding boxes should
        // be allowed and should not wrap-around, we clamp
        // the bounding boxes for geographic CRS' here.

        CoordinateReferenceSystem crs = bounds.getCoordinateReferenceSystem();
        if (crs == null) {
            return bounds;
        }
        CoordinateReferenceSystem hcrs = CRS.getHorizontalCRS(crs);
        if (!(hcrs instanceof GeographicCRS)) {
            return bounds;
        }

        GeographicCRS gcrs = (GeographicCRS) hcrs;
        @SuppressWarnings("unchecked")
        Unit<Length> u1 = (Unit<Length>) gcrs.getCoordinateSystem().getAxis(0).getUnit();
        Unit<Length> su1 = u1.getSystemUnit();
        UnitConverter uc1 = su1.getConverterTo(u1);
        double minx = uc1.convert(-Math.PI);
        double maxx = uc1.convert(Math.PI);

        @SuppressWarnings("unchecked")
        Unit<Length> u2 = (Unit<Length>) hcrs.getCoordinateSystem().getAxis(1).getUnit();
        Unit<Length> su2 = u2.getSystemUnit();
        UnitConverter uc2 = su2.getConverterTo(u2);
        double miny = uc2.convert(-0.5 * Math.PI);
        double maxy = uc2.convert(0.5 * Math.PI);

        double x1 = Math.min(maxx, Math.max(minx, bounds.getMinX()));
        double y1 = Math.min(maxy, Math.max(miny, bounds.getMinY()));
        double x2 = Math.max(minx, Math.min(maxx, bounds.getMaxX()));
        double y2 = Math.max(miny, Math.min(maxy, bounds.getMaxY()));

        return new ReferencedEnvelope(x1, x2, y1, y2, crs);
    }

