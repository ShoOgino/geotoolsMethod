    private static void write(
            GeometryCollection geometryCollection, int dimension, ByteBuffer buffer)
            throws HanaWKBWriterException {
        writeHeader(GeometryType.GEOMETRYCOLLECTION, dimension, buffer);
        int numGeometries = geometryCollection.getNumGeometries();
        buffer.putInt(numGeometries);
        for (int i = 0; i < numGeometries; ++i) {
            write(geometryCollection.getGeometryN(i), dimension, buffer);
        }
    }

