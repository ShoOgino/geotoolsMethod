    public void testAddReferenceTypeInput() throws ServiceException, IOException {

        // don't run the test if the server is not up
        if (fixture == null) {
            return;
        }

        ExecuteProcessRequest request = wps.createExecuteProcessRequest();

        // reference to the File
        EObject kmzFileReference = Wps10Factory.eINSTANCE.createInputReferenceType();
        ((InputReferenceType) kmzFileReference).setMimeType("application/vnd.google-earth.kmz");
        ((InputReferenceType) kmzFileReference).setMethod(MethodType.GET_LITERAL);
        ((InputReferenceType) kmzFileReference).setHref("file:///testref");

        request.addInput("input Gliders KMZ file", Arrays.asList(kmzFileReference));

        try (ByteArrayOutputStream out = new ByteArrayOutputStream()) {
            request.performPostOutput(out);

            try (InputStream in = new ByteArrayInputStream(out.toByteArray());
                    BufferedReader reader = new BufferedReader(new InputStreamReader(in))) {
                StringBuilder postText = new StringBuilder();

                char[] cbuf = new char[1024];
                int charsRead;
                while ((charsRead = reader.read(cbuf)) != -1) {
                    postText = postText.append(cbuf, 0, charsRead);
                }

                assertTrue(postText.toString().contains("wps:Reference"));
            }
        } catch (Exception e) {
            fail();
        }
    }

