        @Override
        public SeVersion execute(ISession session, SeConnection connection)
                throws SeException, IOException {

            final SeVersion version;
            try {
                version = new SeVersion(connection, versionName);
            } catch (SeException cause) {

                if (cause.getSeError().getSdeError() == -126) {
                    ArrayList<String> available = new ArrayList<>();
                    try {
                        SeVersion[] versionList = connection.getVersionList(null);
                        for (SeVersion v : versionList) {
                            available.add(v.getName());
                        }
                        throw new ArcSdeException(
                                "Specified ArcSDE version does not exist: "
                                        + versionName
                                        + ". Available versions are: "
                                        + available,
                                cause);
                    } catch (SeException ignorable) {
                        // hum... ignore
                        throw new ArcSdeException(
                                "Specified ArcSDE version does not exist: " + versionName, cause);
                    }
                } else {
                    throw cause;
                }
            }
            version.getInfo();
            return version;
        }

