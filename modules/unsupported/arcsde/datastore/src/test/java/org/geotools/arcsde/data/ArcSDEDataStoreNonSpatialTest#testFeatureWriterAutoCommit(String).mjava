    private void testFeatureWriterAutoCommit(final String tableName)
            throws IOException, CQLException, UnavailableConnectionException {
        try (final Transaction transaction = Transaction.AUTO_COMMIT) {
            Query query = new Query(tableName, CQL.toFilter("STRING_COL = 'modified'"));
            Filter f = CQL.toFilter("INT_COL = 1000");
            try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                    addFeatures(tableName, transaction)) {
                writer.close();
                assertEquals(2, ds.getFeatureSource(tableName).getCount(Query.ALL));

                assertEquals(0, ds.getFeatureSource(tableName).getCount(query));
            }
            try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                    ds.getFeatureWriter(tableName, f, transaction)) {
                assertTrue(writer.hasNext());
                writer.next().setAttribute("STRING_COL", "modified");
                writer.write();

                assertEquals(1, ds.getFeatureSource(tableName).getCount(query));
            }

            try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                    ds.getFeatureWriter(tableName, f, transaction)) {
                assertTrue(writer.hasNext());
                assertNotNull(writer.next());
                writer.remove();
                assertFalse(writer.hasNext());
            }
        }
    }

