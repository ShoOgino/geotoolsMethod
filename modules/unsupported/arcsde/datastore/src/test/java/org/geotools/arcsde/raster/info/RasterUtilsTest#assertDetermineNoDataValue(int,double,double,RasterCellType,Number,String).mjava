    private void assertDetermineNoDataValue(
            final int numBands,
            final double statsMin,
            final double statsMax,
            final RasterCellType nativeCellType,
            final Number expectedNoDataValue,
            final String failureMsg) {

        Number noDataValue = determineNoDataValue(numBands, statsMin, statsMax, nativeCellType);
        if (failureMsg == null) {
            assertEquals(expectedNoDataValue.doubleValue(), noDataValue.doubleValue(), 0);
        } else {
            assertEquals(
                    failureMsg, expectedNoDataValue.doubleValue(), noDataValue.doubleValue(), 0);
        }
    }

