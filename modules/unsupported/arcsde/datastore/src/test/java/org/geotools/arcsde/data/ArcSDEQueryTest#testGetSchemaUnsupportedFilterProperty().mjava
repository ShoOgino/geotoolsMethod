    /**
     * Query filter references a property name inside an unsupported filter/expression, then the
     * referenced property should be part of the resulting schema even if the query didn't requested
     * it, so that the filter/expression can be evaluated at runtime.
     */
    @Test
    public void testGetSchemaUnsupportedFilterProperty() throws Exception {
        String[] requestProperties = {"SHAPE"};

        Filter filter = toFilter("Min(INT32_COL, 5) = 5"); // we don't support the Min function
        // natively

        SimpleFeatureType resultingSchema = testGetSchema(requestProperties, filter);

        Assert.assertEquals(2, resultingSchema.getAttributeCount());
        assertNotNull(resultingSchema.getDescriptor("SHAPE"));
        assertNotNull(resultingSchema.getDescriptor("INT32_COL"));
    }

