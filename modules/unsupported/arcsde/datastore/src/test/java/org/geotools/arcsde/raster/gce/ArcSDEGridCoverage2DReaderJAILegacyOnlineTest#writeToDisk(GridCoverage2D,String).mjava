    private void writeToDisk(GridCoverage2D coverage, String fileName) throws Exception {

        OutputStream outStream;
        {
            String file = System.getProperty("user.home");
            file += File.separator + "arcsde_test" + File.separator + fileName + ".tiff";
            File path = new File(file);
            path.getParentFile().mkdirs();
            outStream = new FileOutputStream(path);
        }

        // good for all params
        final GeoTiffWriteParams wp = new GeoTiffWriteParams();
        wp.setCompressionMode(GeoTiffWriteParams.MODE_EXPLICIT);
        wp.setCompressionType("LZW");
        wp.setCompressionQuality(0.75F);
        wp.setTilingMode(GeoToolsWriteParams.MODE_EXPLICIT);
        wp.setTiling(128, 128);
        GeoTiffFormat format = new GeoTiffFormat();
        final ParameterValueGroup writerParams = format.getWriteParameters();
        writerParams
                .parameter(AbstractGridFormat.GEOTOOLS_WRITE_PARAMS.getName().toString())
                .setValue(wp);

        // write down
        GeoTiffWriter writer = (GeoTiffWriter) format.getWriter(outStream);
        try {
            GeneralParameterValue[] params =
                    (GeneralParameterValue[])
                            writerParams.values().toArray(new GeneralParameterValue[1]);
            writer.write(coverage, params);
        } finally {
            writer.dispose();
            outStream.close();
        }
    }

