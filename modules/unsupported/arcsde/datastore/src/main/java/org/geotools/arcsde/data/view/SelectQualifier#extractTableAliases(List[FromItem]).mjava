    private Map<String, Table> extractTableAliases(List<FromItem> fromItems) {
        Map<String, Table> aliases = new HashMap<>();
        for (FromItem fromItem : fromItems) {
            if (fromItem instanceof Table) {
                Table table = (Table) fromItem;
                String alias = table.getAlias();
                if (alias != null) {
                    aliases.put(alias, table);
                }
            }
        }
        return aliases;
    }

