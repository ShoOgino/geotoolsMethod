    /** @see FeatureWriter#write() */
    public void write() throws IOException {

        // make the feature validate against its schema before inserting/updating
        feature.validate();

        if (isNewlyCreated(feature)) {
            Number newId;
            try {
                newId = insertSeRow(feature);
            } catch (IOException e) {
                LOGGER.log(Level.WARNING, "Error inserting " + feature + ": " + e.getMessage(), e);
                throw e;
            }
            MutableFIDFeature mutableFidFeature = (MutableFIDFeature) feature;
            String id = featureType.getTypeName() + "." + newId.longValue();
            mutableFidFeature.setID(id);
            fireAdded(mutableFidFeature);
        } else {
            try {
                updateRow(feature);
                fireChanged(feature);
            } catch (IOException e) {
                LOGGER.log(Level.WARNING, "Error updating " + feature + ": " + e.getMessage(), e);
                throw e;
            }
        }
    }

