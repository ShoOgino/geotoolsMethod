    /**
     * Extra connection parameters from the provided map.
     *
     * @param params Connection parameters
     * @throws NumberFormatException If port could not be parsed into a number
     * @throws IllegalArgumentException If any of the parameters are invalid
     */
    private void init(Map<String, Serializable> params)
            throws NumberFormatException, IllegalArgumentException {
        String dbtype = (String) params.get(DBTYPE_PARAM_NAME);
        String server = (String) params.get(SERVER_NAME_PARAM_NAME);
        String port = String.valueOf(params.get(PORT_NUMBER_PARAM_NAME));
        String instance = (String) params.get(INSTANCE_NAME_PARAM_NAME);
        String user = (String) params.get(USER_NAME_PARAM_NAME);
        String pwd = (String) params.get(PASSWORD_PARAM_NAME);
        /** ESRI Direct Connect needs port parameter as String */
        String _port = checkParams(dbtype, server, port, instance, user, pwd);
        sessionConfig.setServerName(server);
        sessionConfig.setPortNumber(_port);
        sessionConfig.setDatabaseName(instance);
        sessionConfig.setUserName(user);
        sessionConfig.setPassword(pwd);
        setUpOptionalParams(params);
    }

