    /**
     * @param index
     * @return
     * @throws IOException never, since the feature retrieve was done in <code>hasNext()</code>
     * @throws ArrayIndexOutOfBoundsException if <code>index</code> is outside the bounds of the
     *     schema attribute's count
     */
    public Object read(final int index) throws IOException, ArrayIndexOutOfBoundsException {
        Object value = currentRow.getObject(index);
        if (value instanceof SeShape) {
            try {
                final SeShape shape = (SeShape) value;
                final Class<? extends Geometry> actualGeomtryClass;
                if (shape.isNil()) {
                    // actualGeomtryClass = this.schemaGeometryClass;
                    value = null;
                } else {
                    actualGeomtryClass = ArcSDEAdapter.getGeometryTypeFromSeShape(shape);
                    final ArcSDEGeometryBuilder geometryBuilder;
                    geometryBuilder = ArcSDEGeometryBuilder.builderFor(actualGeomtryClass);
                    value = geometryBuilder.construct(shape, geometryFactory);
                    if (!this.schemaGeometryClass.isAssignableFrom(actualGeomtryClass)) {
                        value = adaptGeometry((Geometry) value, schemaGeometryClass);
                    }
                }
            } catch (SeException e) {
                throw new ArcSdeException(e);
            }
        } else if (value instanceof Geometry) {
            if (!this.schemaGeometryClass.isAssignableFrom(value.getClass())) {
                value = adaptGeometry((Geometry) value, schemaGeometryClass);
            }
        }

        return value;
    }

