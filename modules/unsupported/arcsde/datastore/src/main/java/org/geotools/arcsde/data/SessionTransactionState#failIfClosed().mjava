    /**
     * If this state has been closed throws an unchecked exception as its clearly a broken workflow.
     *
     * @throws IllegalStateException if the transaction state has been closed.
     */
    private void failIfClosed() throws IllegalStateException {
        if (session == null) {
            throw new IllegalStateException("This transaction state has already been closed");
        }
    }

