    /**
     * Closes the associated query object and, if this attribute reader is not being run over a
     * connection with a transaction in progress, closes the connection too.
     */
    public void close() throws IOException {
        if (query != null) {
            LOGGER.finest("Closing ArcSDEAttributeReader for " + schema.getTypeName());
            try {
                query.close();
            } finally {
                session.dispose();

                query = null;
                session = null;
                fidReader = null;
                currentRow = null;
            }
        }
    }

