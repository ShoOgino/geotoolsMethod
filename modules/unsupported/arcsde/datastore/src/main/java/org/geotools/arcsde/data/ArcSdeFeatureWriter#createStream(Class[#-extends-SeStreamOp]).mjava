    /**
     * Creates the type of arcsde stream operation specified by the {@code streamType} class and,if
     * the working layer is of a versioned table, sets up the stream to being editing the default
     * database version.
     */
    private SeStreamOp createStream(Class<? extends SeStreamOp> streamType) throws IOException {
        SeStreamOp streamOp;

        if (SeInsert.class == streamType) {
            streamOp = session.createSeInsert();
        } else if (SeUpdate.class == streamType) {
            streamOp = session.createSeUpdate();
        } else if (SeDelete.class == streamType) {
            streamOp = session.createSeDelete();
        } else {
            throw new IllegalArgumentException("Unrecognized stream type: " + streamType);
        }

        versionHandler.setUpStream(session, streamOp);

        return streamOp;
    }

