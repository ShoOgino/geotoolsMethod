    private GridCoverage2D prepareCoverage(final RenderedImage data)
            throws IOException {
        // creating bands
        final SampleModel sm = data.getSampleModel();
        final ColorModel cm = data.getColorModel();
        final int numBands = sm.getNumBands();
        final GridSampleDimension[] bands = new GridSampleDimension[numBands];
        // setting bands names.
        for (int i = 0; i < numBands; i++) {
            final ColorInterpretation colorInterpretation = TypeMap
                    .getColorInterpretation(cm, i);
            if (colorInterpretation == null)
                throw new IOException("Unrecognized sample dimension type");
            bands[i] = new GridSampleDimension(colorInterpretation.name())
                    .geophysics(true);
        }

        // creating the final coverage by keeping into account the fact that we
        // can just use the envelope, but we need to use the G2W
        return coverageFactory.create(rasterManager.getCoverageIdentifier(),
                data, new GridGeometry2D(new GeneralGridEnvelope(data, 2),
                        PixelInCell.CELL_CORNER, finalGridToWorldCorner,
                        this.rasterManager.getCoverageCRS(), null), bands,
                null, null);

    }

