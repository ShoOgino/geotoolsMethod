    @Test
    public void readCountriesBbox() throws IOException {
        URL url =
                getClass()
                        .getClassLoader()
                        .getResource("org/geotools/data/flatgeobuf/countries.fgb");
        Map<String, Serializable> params = new HashMap<>();
        params.put("url", url);
        DataStore store = DataStoreFinder.getDataStore(params);
        SimpleFeatureSource featureSource = store.getFeatureSource("countries");
        SimpleFeatureType schema = featureSource.getSchema();
        FilterFactory2 ff = CommonFactoryFinder.getFilterFactory2();
        String geometryPropertyName = schema.getGeometryDescriptor().getLocalName();
        CoordinateReferenceSystem targetCRS =
                schema.getGeometryDescriptor().getCoordinateReferenceSystem();
        Envelope env = new Envelope(12, 13, 56, 57);
        ReferencedEnvelope bbox = new ReferencedEnvelope(env, targetCRS);
        Filter filter = ff.bbox(ff.property(geometryPropertyName), bbox);
        Query query = new Query(schema.getTypeName(), filter);
        SimpleFeatureCollection featureCollection = featureSource.getFeatures(query);
        try (SimpleFeatureIterator it = featureCollection.features()) {
            int count = 0;
            while (it.hasNext()) {
                it.next();
                count++;
            }
            assertEquals(2, count);
        }
    }

