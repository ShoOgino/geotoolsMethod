    @Override
    protected ContentFeatureSource createFeatureSource(ContentEntry contentEntry)
            throws IOException {
        if (!file.exists() || file.canWrite()) {
            return new FlatgeobufFeatureStore(contentEntry, Query.ALL);
        } else {
            return new FlatgeobufFeatureSource(contentEntry, Query.ALL);
        }
    }

