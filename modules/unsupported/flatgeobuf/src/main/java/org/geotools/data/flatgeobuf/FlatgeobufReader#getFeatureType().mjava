    public SimpleFeatureType getFeatureType() throws IOException {
        if (featureType == null) {
            Header header = getHeader();
            int geometryType = header.geometryType();
            Class<?> geometryClass;
            switch (geometryType) {
                case GeometryType.Point:
                    geometryClass = Point.class;
                    break;
                case GeometryType.MultiPoint:
                    geometryClass = MultiPoint.class;
                    break;
                case GeometryType.LineString:
                    geometryClass = LineString.class;
                    break;
                case GeometryType.MultiLineString:
                    geometryClass = MultiLineString.class;
                    break;
                case GeometryType.Polygon:
                    geometryClass = Polygon.class;
                    break;
                case GeometryType.MultiPolygon:
                    geometryClass = MultiPolygon.class;
                    break;
                default:
                    throw new IOException("Unknown geometry type");
            }

            int columnsLength = header.columnsLength();
            ArrayList<ColumnMeta> columnMetas = new ArrayList<ColumnMeta>();
            for (int i = 0; i < columnsLength; i++) {
                ColumnMeta columnMeta = new ColumnMeta();
                columnMeta.name = header.columns(i).name();
                columnMeta.type = (byte) header.columns(i).type();
                columnMetas.add(columnMeta);
            }

            this.headerMeta = new HeaderMeta();
            headerMeta.columns = columnMetas;
            headerMeta.geometryType = (byte) geometryType;

            SimpleFeatureTypeBuilder ftb = new SimpleFeatureTypeBuilder();
            // @TODO remove hard coded name and geometry property name
            ftb.setName(this.name);
            ftb.add(this.geometryPropertyName, geometryClass);
            for (ColumnMeta columnMeta : columnMetas) {
                ftb.add(columnMeta.name, columnMeta.getBinding());
            }
            this.featureType = ftb.buildFeatureType();
        }
        return this.featureType;
    }

