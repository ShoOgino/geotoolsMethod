    public SimpleFeature getNextFeature() throws IOException {
        SimpleFeatureBuilder fb = new SimpleFeatureBuilder(getFeatureType());
        ByteBuffer bb = getByteBuffer();
        if (bb.hasRemaining()) {
            int featureSize = ByteBufferUtil.getSizePrefix(bb);
            bb.position(offset += SIZE_PREFIX_LENGTH);
            Feature feature = Feature.getRootAsFeature(bb);
            bb.position(offset += featureSize);
            SimpleFeature f =
                    FeatureConversions.deserialize(
                            feature, fb, headerMeta, String.valueOf(featureId++));
            return f;
        } else {
            return null;
        }
    }

