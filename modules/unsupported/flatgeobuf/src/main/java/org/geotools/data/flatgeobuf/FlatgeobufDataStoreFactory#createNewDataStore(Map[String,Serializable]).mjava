    @Override
    public DataStore createNewDataStore(Map<String, Serializable> map) throws IOException {
        File file = (File) FILE_PARAM.lookUp(map);
        if (file.isDirectory()) {
            return new FlatgeobufDirectoryDataStore(file);
        } else {
            if (file.exists()) {
                LOGGER.warning("File already exists: " + file);
            }
            return new FlatgeobufDataStore(file);
        }
    }

