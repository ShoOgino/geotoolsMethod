    protected FlatGeobufDataStore getDataStore(String name) {
        File file = new File(directory, name + ".fgb");
        URL url;
        try {
            url = file.toURI().toURL();
            FlatGeobufDataStore store = new FlatGeobufDataStore(url);
            if (createFeatureTypes.containsKey(name) && !file.exists()) {
                SimpleFeatureType featureType = createFeatureTypes.get(name);
                store.createSchema(featureType);
            }
            return store;
        } catch (MalformedURLException e) {
            throw new RuntimeException(e);
        }
    }

