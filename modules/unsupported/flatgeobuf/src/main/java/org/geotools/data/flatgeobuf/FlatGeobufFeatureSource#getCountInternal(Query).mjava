    @Override
    protected int getCountInternal(Query query) throws IOException {
        int count = -1;
        if (query.getFilter() != Filter.INCLUDE) {
            return count;
        }

        count = (int) getDataStore().getHeaderMeta().featuresCount;

        if (count > 0) {
            return count;
        }

        // NOTE: header does not contain feature count will enumerate features to calculate
        try (FlatGeobufFeatureReader reader = (FlatGeobufFeatureReader) getReaderInternal(query)) {
            count = 0;
            while (reader.hasNext()) {
                reader.next();
                count++;
            }
            return count;
        }
    }

