    @Override
    public DataStore createDataStore(Map<String, Serializable> map) throws IOException {
        File file = (File) FILE_PARAM.lookUp(map);
        if (file.isDirectory()) {
            return new FlatgeobufDirectoryDataStore(file);
        } else {
            return new FlatgeobufDataStore(file);
        }
    }

