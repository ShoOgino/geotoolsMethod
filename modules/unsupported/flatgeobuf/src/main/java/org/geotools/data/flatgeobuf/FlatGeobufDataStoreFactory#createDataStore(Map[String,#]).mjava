    @Override
    public DataStore createDataStore(Map<String, ?> map) throws IOException {
        URL url = (URL) URL_PARAM.lookUp(map);
        URI namespace = (URI) NAMESPACE_PARAM.lookUp(map);
        File file = FlatGeobufDataStore.getFile(url);

        ContentDataStore store;
        if (file != null && file.isDirectory()) {
            store = new FlatGeobufDirectoryDataStore(file);
        } else {
            store = new FlatGeobufDataStore(url);
        }
        if (namespace != null) {
            store.setNamespaceURI(namespace.toString());
        }
        return store;
    }

