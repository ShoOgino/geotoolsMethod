    private byte toGeometryType(Class<?> geometryClass) throws IOException {
        if (geometryClass.isAssignableFrom(MultiPoint.class)) return GeometryType.MultiPoint;
        else if (geometryClass.isAssignableFrom(Point.class)) return GeometryType.Point;
        else if (geometryClass.isAssignableFrom(MultiLineString.class))
            return GeometryType.MultiLineString;
        else if (geometryClass.isAssignableFrom(LineString.class)) return GeometryType.LineString;
        else if (geometryClass.isAssignableFrom(MultiPolygon.class))
            return GeometryType.MultiPolygon;
        else if (geometryClass.isAssignableFrom(Polygon.class)) return GeometryType.Polygon;
        else throw new IOException("Unknown geometry type");
    }

