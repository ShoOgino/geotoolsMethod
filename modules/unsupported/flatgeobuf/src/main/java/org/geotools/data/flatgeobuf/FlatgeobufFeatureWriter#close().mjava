    @Override
    public void close() throws IOException {
        if (this.writer == null) {
            throw new IOException("Writer alread closed");
        }
        if (this.currentFeature != null) {
            this.write();
        }
        while (hasNext()) {
            next();
            write();
        }
        this.outputStream.flush();
        this.outputStream.close();
        this.writer = null;
        FlatBuffers.release(this.builder);
        if (delegate != null) {
            this.delegate.close();
            this.delegate = null;
        }
        Files.copy(temp.toPath(), this.file.toPath(), StandardCopyOption.REPLACE_EXISTING);
        temp.delete();
    }

