    protected SimpleFeatureType getFeatureType() throws IOException {
        if (file.exists()) {
            try (FileInputStream in = new FileInputStream(file)) {
                String name = file.getName();
                name = name.substring(0, name.lastIndexOf('.'));
                FlatgeobufReader reader = new FlatgeobufReader(name, "geom", in);
                return reader.getFeatureType();
            }
        } else {
            return null;
        }
    }

