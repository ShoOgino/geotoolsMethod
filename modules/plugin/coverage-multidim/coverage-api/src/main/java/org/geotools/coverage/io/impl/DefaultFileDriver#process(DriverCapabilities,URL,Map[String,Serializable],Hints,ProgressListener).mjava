    public CoverageAccess process(DriverCapabilities operation, URL url,
            Map<String, Serializable> params, Hints hints, ProgressListener listener)
            throws IOException {

        if (!getDriverCapabilities().contains(operation)){
            throw new UnsupportedOperationException("Operation " + operation
                    + " is not supported by this driver");
        }
        
        // check input URL
        if (url == null) {
            // check for URL
            if (!params.containsKey(URL.key))
                throw new IllegalArgumentException("Unable to find parameter URL in parameters "
                        + params.toString());

            // get the URL
            url = (URL) params.get(URL.key);
        }

        // check the operation
        switch (operation) {
        case CONNECT:
            return connect(url, params, hints, listener);
        case DELETE:
            return delete(url, params, hints, listener);
        case CREATE:
            return create(url, params, hints, listener);
        default:
            throw new IllegalArgumentException("Unrecognized operation " + operation);
        }
    }

