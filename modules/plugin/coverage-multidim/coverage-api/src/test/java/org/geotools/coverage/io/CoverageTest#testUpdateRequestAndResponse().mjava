    @Test
    public void testUpdateRequestAndResponse()
            throws IOException, MismatchedDimensionException, TransformException {
        Map<String, Serializable> connectionParams = new HashMap<>();
        connectionParams.put(DefaultFileDriver.URL.key, new URL(TEST_URL));

        CoverageAccess access =
                driver.access(DriverCapabilities.CONNECT, connectionParams, null, null);

        final CoverageStore store = access.create(TEST_NAME, null, new Hints(), null);

        // Creation of a dummy Request
        CoverageUpdateRequest request = new CoverageUpdateRequest();

        // Setting of the parameters
        Map<String, String> metadata = new HashMap<>();
        metadata.put("testKey", "testMetadata");
        List<GridCoverage2D> data = new ArrayList<>();
        GridCoverage2D cov =
                new GridCoverageFactory()
                        .create(
                                TEST_NAME.getLocalPart(),
                                new float[][] {{1.0f, 1.0f}},
                                new ReferencedEnvelope(0.0d, 1.0d, 0.0d, 1.0d, null));
        data.add(cov);
        request.setMetadata(metadata);
        request.setData(data);

        // Get the response
        CoverageResponse response = store.update(request, null);

        Collection<? extends Coverage> results = response.getResults(null);
        // Ensure the results are not null and it is not empty
        assertNotNull(results);
        assertFalse(results.isEmpty());
        // Get the first result from the collection and ensure it is the same coverage of the input
        GridCoverage2D covOutput = (GridCoverage2D) results.iterator().next();
        assertSame(cov, covOutput);

        // Ensure they have the same metadata
        CoverageUpdateRequest request2 = (CoverageUpdateRequest) response.getRequest();
        assertEquals(metadata.get("testKey"), request2.getMetadata().get("testKey"));
    }

