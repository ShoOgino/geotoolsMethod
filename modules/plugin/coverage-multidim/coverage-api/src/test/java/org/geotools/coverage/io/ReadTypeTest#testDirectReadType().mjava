    @Test
    public void testDirectReadType() throws IOException {
        // Definition of the reader

        // Definition of the read type
        ReadType directRead = ReadType.DIRECT_READ;

        // Test 1 = wrong region
        RenderedImage output =
                testRead(
                        directRead,
                        readParameters,
                        IMAGE_INDEX,
                        granuleUrl,
                        rasterDimensionsWrong,
                        hints,
                        CLOSE_ELEMENTS,
                        true);
        assertNull(output);

        // Test 2 = null URL
        output =
                testRead(
                        directRead,
                        readParameters,
                        IMAGE_INDEX,
                        null,
                        rasterDimensions,
                        hints,
                        CLOSE_ELEMENTS,
                        true);
        assertNull(output);

        // Test 3 = null Reader
        output =
                testRead(
                        directRead,
                        readParameters,
                        IMAGE_INDEX,
                        granuleUrl,
                        rasterDimensions,
                        hints,
                        CLOSE_ELEMENTS,
                        false);
        assertNull(output);

        // Test 4 = correct
        output =
                testRead(
                        directRead,
                        readParameters,
                        IMAGE_INDEX,
                        granuleUrl,
                        rasterDimensions,
                        hints,
                        CLOSE_ELEMENTS,
                        true);
        assertNotNull(output);

        Rectangle sourceRegion = readParameters.getSourceRegion();
        // Calculate the intersection between the raster dimension and the read parameters
        Rectangle.intersect(sourceRegion, rasterDimensions, sourceRegion);
        // Check dimensions
        assertEquals(output.getMinX(), sourceRegion.x);
        assertEquals(output.getMinY(), sourceRegion.y);
        assertEquals(output.getWidth(), sourceRegion.width);
        assertEquals(output.getHeight(), sourceRegion.height);
    }

