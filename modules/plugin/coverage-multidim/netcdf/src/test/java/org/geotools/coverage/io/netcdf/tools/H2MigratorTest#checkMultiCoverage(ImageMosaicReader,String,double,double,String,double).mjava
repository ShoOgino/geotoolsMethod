    /**
     * Check that reading a single data value from an ImageMosaic of multi-coverage NetCDF files
     * yields the expected value.
     *
     * @param reader
     * @param coverageName
     * @param longitude
     * @param latitude
     * @param timestamp
     * @param expected
     * @throws Exception
     */
    private void checkMultiCoverage(
            ImageMosaicReader reader,
            String coverageName,
            double longitude,
            double latitude,
            String timestamp,
            double expected)
            throws Exception {
        ParameterValue<List> time = ImageMosaicFormat.TIME.createValue();
        time.setValue(Arrays.asList(new Date[] {parseTimeStamp(timestamp)}));
        GeneralParameterValue[] params =
                new GeneralParameterValue[] {NO_DEFERRED_LOADING_PARAM, time};
        GridCoverage2D coverage = reader.read(coverageName, params);
        assertNotNull(coverage);
        // delta is zero because an exact match is expected
        assertEquals(
                expected,
                coverage.evaluate(new Point2D.Double(longitude, latitude), (double[]) null)[0],
                0);
    }

