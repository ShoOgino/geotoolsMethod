        public PurgeSetupHelper invoke() throws IOException {
            File directory = new File(TestData.file(NetCDFReaderTest.this, "."), directoryName);
            if (directory.exists()) {
                FileUtils.deleteDirectory(directory);
            }
            assertTrue(directory.mkdirs());

            FileUtils.copyFileToDirectory(TestData.file(NetCDFReaderTest.this, "O3-NO2.nc"), directory);
            File file = new File(directory, "O3-NO2.nc");

            // create a reader and read coverage, should create everything
            reader = new NetCDFReader(file, null);
            GridCoverage2D read = reader.read(reader.getGridCoverageNames()[0], null);
            read.dispose(true);

            // check we have file and the metadata directory
            File[] files = directory.listFiles();
            assertEquals(2, files.length);
            metadataDirectory = Arrays.stream(files)
                    .filter(f -> f.getName().startsWith(".O3-NO2") && f.isDirectory())
                    .findFirst();
            assertTrue(metadataDirectory.isPresent());
            dataFile = Arrays.stream(files).filter(
                    f -> f.getName().equals("O3-NO2.nc")).findFirst();
            assertTrue(dataFile.isPresent());
            return this;
        }

