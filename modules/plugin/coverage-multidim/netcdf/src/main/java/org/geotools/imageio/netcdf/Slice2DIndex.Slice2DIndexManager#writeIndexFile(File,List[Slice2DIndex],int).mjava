        /**
         * Utility method to write an index file.
         * 
         * @param file the file to write to.
         * @param indexList the list of {@link Slice2DIndex} to dump to file.
         * @throws IOException
         */
        public static void writeIndexFile( File file, List<Slice2DIndex> indexList, int dimensions ) throws IOException {
            RandomAccessFile raf = null;
            try {
                raf = new RandomAccessFile(file, "rw");
                int size = indexList.size();
                // write number of records
                raf.writeInt(size);
                long dataPosition = ADDRESS_POSITION + (size + 1) * ADDRESS_SIZE; // the +1 is to have the end address

                long[] pointer = new long[size];
                raf.seek(dataPosition);

                for( int i = 0; i < size; i++ ) {
                    Slice2DIndex slice2DIndex = indexList.get(i);
                    long pos = raf.getFilePointer();
                    pointer[i] = pos;
                    raf.writeInt(slice2DIndex.getTIndex());
                    raf.writeInt(slice2DIndex.getZIndex());
                    raf.write(slice2DIndex.getVariableName().getBytes());
                }
                long dataEnd = raf.getFilePointer();

                raf.seek(ADDRESS_POSITION);
                for( long address : pointer ) {
                    raf.writeLong(address);
                }
                // add also the data end position
                raf.writeLong(dataEnd);

            } finally {
                if (raf != null) {
                    raf.close();
                }
            }
        }

