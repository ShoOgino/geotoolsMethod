    public SimpleFeatureType getIndexSchema(
            Name coverageName, CoordinateSystem coordinateSystem, boolean isShared)
            throws Exception {
        // get the name for this variable to check his coveragename
        final String _coverageName = coverageName.toString();
        // get the coverage definition for this variable, at this stage this exists otherwise we
        // would have skipped it!
        final Coverage coverage = ancillaryFileManager.coveragesMapping.get(_coverageName);

        // now check the schema creation
        SchemaType schema = coverage.getSchema();
        String schemaDef = schema != null ? schema.getAttributes() : null;

        // no schema was defined yet, let's create a default one
        if (schema == null || schema.getAttributes() == null) {
            // TODO incapsulate in coveragedescriptor
            schemaDef = suggestSchemaFromCoordinateSystem(coverage, coordinateSystem, isShared);

            // set the schema name to be the coverageName
            ancillaryFileManager.setSchema(coverage, coverage.getName(), schemaDef);
            schema = coverage.getSchema();
        }
        String variableName = ancillaryFileManager.variablesMap.get(coverageName);
        CoordinateReferenceSystem crs = georeferencing.getCoordinateReferenceSystem(variableName);

        // create featuretype, the name is the CoverageName
        final SimpleFeatureType indexSchema =
                NetCDFUtilities.createFeatureType(coverage.getName(), schemaDef, crs);

        // create
        forceSchemaCreation(indexSchema);

        // return
        return indexSchema;
    }

