    /** */
    public static int getTimeSubUnitsValue(String units, Double vd) {
        if (units == null || units.isEmpty()) {
            return 0;
        }
        String unit = units.toLowerCase();
        if (MONTH_SET.contains(unit)) {
            int subUnit = getTimeUnits(units, vd);
            // Using Panoply approach where a month is made of 30 days
            // Note that UCAR recommends not using "month" as unit
            if (subUnit == Calendar.DAY_OF_MONTH) {
                double days = vd * 30;
                return (int) days;
            } else if (subUnit == Calendar.HOUR) {
                double hours = vd * 30 * 24;
                return (int) hours;
            } else if (subUnit == Calendar.MINUTE) {
                double minutes = vd * 30 * 24 * 60;
                return (int) minutes;
            } else if (subUnit == Calendar.SECOND) {
                double seconds = vd * 30 * 24 * 60 * 60;
                return (int) seconds;
            } else if (subUnit == Calendar.MILLISECOND) {
                double milliseconds = vd * 30 * 24 * 60 * 60 * 1000;
                return (int) milliseconds;
            }
        } else if (DAY_SET.contains(unit)) {
            int subUnit = getTimeUnits(units, vd);
            if (subUnit == Calendar.HOUR) {
                double hours = vd * 24;
                return (int) hours;
            } else if (subUnit == Calendar.MINUTE) {
                double minutes = vd * 24 * 60;
                return (int) minutes;
            } else if (subUnit == Calendar.SECOND) {
                double seconds = vd * 24 * 60 * 60;
                return (int) seconds;
            } else if (subUnit == Calendar.MILLISECOND) {
                double milliseconds = vd * 24 * 60 * 60 * 1000;
                return (int) milliseconds;
            }
        } else if (HOUR_SET.contains(unit)) {
            int subUnit = getTimeUnits(units, vd);
            if (subUnit == Calendar.MINUTE) {
                double minutes = vd * 60;
                return (int) minutes;
            } else if (subUnit == Calendar.SECOND) {
                double seconds = vd * 60 * 60;
                return (int) seconds;
            } else if (subUnit == Calendar.MILLISECOND) {
                double milliseconds = vd * 60 * 60 * 1000;
                return (int) milliseconds;
            }
        } else if (MINUTE_SET.contains(unit)) {
            int subUnit = getTimeUnits(units, vd);
            if (subUnit == Calendar.SECOND) {
                double seconds = vd * 60;
                return (int) seconds;
            } else if (subUnit == Calendar.MILLISECOND) {
                double milliseconds = vd * 60 * 1000;
                return (int) milliseconds;
            }
        } else if (SECOND_SET.contains(unit)) {
            int subUnit = getTimeUnits(units, vd);
            if (subUnit == Calendar.MILLISECOND) {
                double milliseconds = vd * 1000;
                return (int) milliseconds;
            }
        }

        return 0;
    }

