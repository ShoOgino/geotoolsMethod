    /**
     * Returns the coverage names provided by the user, or tries to guess them by looking at
     * property files in the mosaic directory
     */
    private String[] getCoverageNames() {
        String[] names = configuration.getCoverageNames();
        if (names == null) {
            final File mosaicDirectory = configuration.getMosaicDirectory();
            // simplifying assumption, the coverages are the ones that have a config file with
            // a sidecar sample image file
            names =
                    Arrays.stream(
                                    mosaicDirectory.list(
                                            (dir, name) -> {
                                                if (!name.endsWith(".properties")) {
                                                    return false;
                                                }
                                                String baseName = FilenameUtils.getBaseName(name);
                                                return new File(
                                                                        dir,
                                                                        baseName
                                                                                + Utils
                                                                                        .SAMPLE_IMAGE_NAME)
                                                                .exists()
                                                        || new File(
                                                                        dir,
                                                                        baseName
                                                                                + Utils
                                                                                        .SAMPLE_IMAGE_NAME_LEGACY)
                                                                .exists();
                                            }))
                            .map(f -> FilenameUtils.getBaseName(f))
                            .toArray(n -> new String[n]);
        }

        return names;
    }

