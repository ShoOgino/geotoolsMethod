    /**
     * Return features for that variable adapter, starting from slices with index = "startIndex", and up to "limit" elements.
     * This allows for paging. Put the created features inside the provided collection
     * 
     * @param startIndex the first slice to be returned
     * @param limit the max number of features to be created
     * @param collection the feature collection where features need to be stored
     */
    public void getFeatures(final int startIndex, final int limit, final ListFeatureCollection collection) {
        final boolean hasVerticalAxis = coordinateSystem.hasVerticalAxis() || zDimensionIndex != -1;
        final SimpleFeatureType indexSchema = collection.getSchema();
        final int bandDimension = rank - NetCDFUtilities.Z_DIMENSION;
        final int slicesNum = getNumberOfSlices();
        if (startIndex > slicesNum) {
            throw new IllegalArgumentException("The paging start index can't be higher than the number of available slices");
        }
        int lastIndex = startIndex + limit;
        if (lastIndex > slicesNum) {
            lastIndex = slicesNum;
        }
        final String varName = variableDS.getFullName();
        for (int imageIndex = startIndex; imageIndex < lastIndex; imageIndex++) {
            int zIndex = -1;
            int tIndex = -1;
            for (int i = 0; i < rank; i++) {
                switch (rank - i) {
                case NetCDFUtilities.X_DIMENSION:
                case NetCDFUtilities.Y_DIMENSION:
                    break;
                default: {
                    if (i == bandDimension && hasVerticalAxis) {
                        zIndex = getZIndex(imageIndex);
                    } else {
                        tIndex =  getTIndex(imageIndex);
                    }
                    break;
                }
                }
            }

            //Put a new sliceIndex in the list
            final Slice2DIndex variableIndex = new Slice2DIndex(tIndex, zIndex, varName);
            reader.ancillaryFileManager.addSlice(variableIndex);

            // Create a feature for that index to be put in the CoverageSlicesCatalog
            final SimpleFeature feature = createFeature(
                    variableDS, 
                    coverageName.toString(), 
                    tIndex, 
                    zIndex, 
                    coordinateSystem, 
                    imageIndex, 
                    indexSchema);
            collection.add(feature);
        }
    }

