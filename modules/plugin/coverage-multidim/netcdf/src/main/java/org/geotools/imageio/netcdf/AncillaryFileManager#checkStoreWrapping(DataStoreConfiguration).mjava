    /**
     * Check whether the dataStore needs to be wrapped 
     * (as an instance, to allow long typeNames and attributes).
     * 
     * @param datastoreConfiguration
     * @throws IOException
     */
    private void checkStoreWrapping(DataStoreConfiguration datastoreConfiguration) throws IOException {
        Map<String, Serializable> params = datastoreConfiguration.getParams();
        ParametersType indexerParams = indexer != null ? indexer.getParameters() : null;
        String param = IndexerUtils.getParam(indexerParams, Utils.Prop.WRAP_STORE);
        if (param != null && param.trim().equalsIgnoreCase("true")) {
            params.put(Utils.Prop.WRAP_STORE, true);
            params.put(Utils.Prop.PARENT_LOCATION, DataUtilities.fileToURL(getDestinationDir())
                    .toString());
        }
    }

