    public Properties loadStoreProperties(String configPath) {
        File configFile = new File(configPath);
        if (!configFile.exists() || !configFile.isFile()) {
            throw new ConfigurationException(
                    "Target store configuration file does not exist: " + configPath);
        }
        Properties properties = new Properties();
        try (InputStream is = new FileInputStream(configFile)) {
            properties.load(is);
        } catch (IOException e) {
            throw new ConfigurationException(
                    "Could not load the store configuration from: " + configPath, e);
        }
        try {
            final DataStore dataStore = getDataStore(properties);
            if (dataStore == null) {
                throw new ConfigurationException(
                        "No datastore could be loaded with the given properties, make sure you have all the required jars for it in the classpath. Tried to use: "
                                + configPath);
            }
            dataStore.dispose();
        } catch (Exception e) {
            throw new ConfigurationException(
                    "Failed to load data store from configuration at "
                            + configPath
                            + ": "
                            + e.getMessage(),
                    e);
        }
        return properties;
    }

