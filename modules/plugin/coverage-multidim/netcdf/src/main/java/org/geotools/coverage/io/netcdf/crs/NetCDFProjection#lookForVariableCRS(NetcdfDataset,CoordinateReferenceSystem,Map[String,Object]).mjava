    /** Look for a CoordinateReferenceSystem defined into a variable */
    public static CoordinateReferenceSystem lookForVariableCRS(
            NetcdfDataset dataset,
            CoordinateReferenceSystem defaultCrs,
            Map<String, Object> crsProperties)
            throws FactoryException {
        List<Variable> variables = dataset.getVariables();
        CoordinateReferenceSystem crs = defaultCrs;
        for (Variable variable : variables) {
            CRSParser attrib = CRSParser.getCRSParser(variable);
            if (attrib != null) {
                // Referencing info found
                crs = NetCDFProjection.parseProjection(variable, attrib, crsProperties);
                if (LOGGER.isLoggable(Level.FINE)) {
                    LOGGER.fine(
                            "Detected NetCDFProjection through gridMapping variable: "
                                    + (crs != null ? crs.toWKT() : "null"));
                }
                break;
            }
        }
        return crs;
    }

