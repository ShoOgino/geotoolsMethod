    @Override
    public IIOMetadata getImageMetadata(int imageIndex) throws IOException {
        checkImageIndex(imageIndex);

        final Slice2DIndex slice2DIndex = getSlice2DIndex(imageIndex);
        final String variableName = slice2DIndex.getVariableName();
        final VariableAdapter wrapper = getCoverageDescriptor(new NameImpl(variableName));

        CoordinateReferenceSystem crs = georeferencing.getCoordinateReferenceSystem(variableName);
        int width = wrapper.getWidth();
        int height = wrapper.getHeight();
        SampleModel sampleModel =
                new BandedSampleModel(
                        wrapper.getSampleModel().getDataType(),
                        width,
                        height,
                        wrapper.getNumBands());
        final ColorModel colorModel = ImageIOUtilities.createColorModel(sampleModel);
        NetCDFImageMetadata metadata =
                new NetCDFImageMetadata(variableName, sampleModel, colorModel, crs);

        double[] noData = getNoData(wrapper);
        if (noData != null) {
            metadata.setNoData(noData);
        }

        return metadata;
    }

