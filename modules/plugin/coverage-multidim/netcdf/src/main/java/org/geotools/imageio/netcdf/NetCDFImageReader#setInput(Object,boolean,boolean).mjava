    @Override
    public void setInput( Object input, boolean seekForwardOnly, boolean ignoreMetadata) {
        super.setInput(input, seekForwardOnly, ignoreMetadata);
        if (dataset != null) {
            reset();
        }

        if (input instanceof ImageInputStream) {
            this.imageInputStream = (ImageInputStream) input;
        }
        try {
            dataset = extractDataset(input);
            file = NetCDFUtilities.getFile(input);
            if (file != null) {
                ancillaryFileManager = new AncillaryFileManager(file, getAuxiliaryFilesPath(), getAuxiliaryDatastorePath());
            }

            init();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
    }

