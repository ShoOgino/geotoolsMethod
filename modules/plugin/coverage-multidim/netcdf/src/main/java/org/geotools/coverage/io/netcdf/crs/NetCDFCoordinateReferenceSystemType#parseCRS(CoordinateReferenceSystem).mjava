    /**
     * Return a proper {@link NetCDFCoordinateReferenceSystemType} depending on the input OGC {@link
     * CoordinateReferenceSystem} instance.
     */
    public static NetCDFCoordinateReferenceSystemType parseCRS(CoordinateReferenceSystem crs) {
        NetCDFCoordinateReferenceSystemType crsType = null;
        if (crs instanceof DefaultGeographicCRS) {
            crsType = WGS84;
        } else if (crs instanceof ProjectedCRS) {
            ProjectedCRS projectedCRS = (ProjectedCRS) crs;
            // NetCDF supports a reduced number of CRS Type (WGS84 + some projection).
            // Some ProjectedCRS may have unit of measure resulting in concatenated transforms.
            if (hasConcatenatedTransform(projectedCRS)) {
                Projection projection = projectedCRS.getConversionFromBase();
                MathTransform mt = projection.getMathTransform();
                ConcatenatedTransform cmt = ((ConcatenatedTransform) mt);
                crsType = extractProjectionType(cmt);
            } else {
                crsType = getProjectionType(projectedCRS);
            }

        } else {
            // Fallback on SPATIAL_REF to deal with projection which
            // doesn't have a CF Mapping.
            crsType = SPATIAL_REF;
        }

        if (LOGGER.isLoggable(Level.FINE)) {
            LOGGER.fine("Using a NetCDF CRS based on " + crsType);
        }
        return crsType;
    }

