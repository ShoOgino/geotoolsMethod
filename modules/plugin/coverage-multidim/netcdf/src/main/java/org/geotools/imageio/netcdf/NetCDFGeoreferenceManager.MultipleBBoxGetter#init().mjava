        @Override
        protected void init() throws FactoryException, IOException {

            isLonLat = false;
            CoordinatesManager manager = new CoordinatesManager();
            for (CoordinateVariable<?> cv : getCoordinatesVariables()) {
                if (cv.isNumeric()) {
                    // is it lat or lon (or geoY or geoX)?
                    AxisType type = cv.getAxisType();
                    switch (type) {
                        case GeoY:
                        case Lat:
                            manager.setYLat(cv);
                            break;
                        case GeoX:
                        case Lon:
                            manager.setXlon(cv);
                            break;
                        default:
                            break;
                    }
                }
            }
            // create the envelope
            CoordinateReferenceSystem crs = NetCDFCRSUtilities.WGS84;

            // Looking for all coordinates pairs
            List<Variable> variables = dataset.getVariables();
            for (Variable var : variables) {
                Attribute gridMappingAttribute = var.findAttribute(NetCDFUtilities.GRID_MAPPING);
                String coordinates = manager.getCoordinateNames(var);
                if (coordinates != null && !boundingBoxes.containsKey(coordinates)) {
                    // Computing the bbox
                    crs = lookForCrs(crs, gridMappingAttribute, var);
                    ReferencedEnvelope boundingBox = manager.computeEnvelope(coordinates, crs);
                    boundingBoxes.put(coordinates, boundingBox);
                }
            }
            manager.dispose();
        }

