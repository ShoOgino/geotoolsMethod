    private GeoPkgMetadataReference mapReference(ResultSet rs, GeoPkgMetadata metadata)
            throws SQLException {
        Long rowId = rs.getLong("row_id_value");
        if (rs.wasNull()) rowId = null;
        return new GeoPkgMetadataReference(
                rs.getLong("rowid"), // Hack to get a PK, the definition of the table left this open
                getReferenceScope(rs.getString("reference_scope")),
                rs.getString("table_name"),
                rs.getString("column_name"),
                rowId,
                toDate(rs.getString("timestamp")),
                metadata,
                getMetadata(rs.getLong("md_parent_id")));
    }

