    /**
     * Helper that returns the key generated by an insert, run with the provided prepared statement
     */
    protected long getGeneratedKey(PreparedStatement ps) throws SQLException {
        ResultSet keys = ps.getGeneratedKeys();
        keys.next();
        return keys.getLong(1);
    }

