    /**
     * Helper that returns the key generated by an insert, run with the provided prepared statement
     */
    protected long getGeneratedKey(PreparedStatement ps) throws SQLException {
        try (ResultSet keys = ps.getGeneratedKeys()) {
            if (keys.next()) return keys.getLong(1);
            else throw new SQLException("Coult not find a generated key!");
        }
    }

