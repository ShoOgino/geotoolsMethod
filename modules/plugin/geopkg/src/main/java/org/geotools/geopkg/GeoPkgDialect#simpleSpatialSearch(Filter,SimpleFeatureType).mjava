    /**
     * Checks if the filter uses a single spatial attribute, and such spatial attribute is indexed
     */
    private GeometryDescriptor simpleSpatialSearch(Filter filter, SimpleFeatureType schema) {
        FilterAttributeExtractor attributeExtractor = new FilterAttributeExtractor();
        filter.accept(attributeExtractor, null);
        Set<String> attributes = attributeExtractor.getAttributeNameSet();
        GeometryDescriptor geometryAttribute = null;
        for (String name : attributes) {
            // handle default geometry case
            AttributeDescriptor ad;
            if ("".equals(name)) {
                ad = schema.getGeometryDescriptor();
            } else {
                ad = schema.getDescriptor(name);
            }
            // check if geometris
            if (ad instanceof GeometryDescriptor) {
                if (geometryAttribute != null) {
                    // two different attributes found
                    return null;
                }
                // can run both on spatial filters and without
                geometryAttribute = (GeometryDescriptor) ad;
            }
        }

        return geometryAttribute;
    }

