    @Override
    public void setArrayValue(
            Object value,
            AttributeDescriptor att,
            PreparedStatement ps,
            int columnIdx,
            Connection cx)
            throws SQLException {
        Class binding = att.getType().getBinding();
        if (value == null) {
            Integer sqlType = dataStore.getMapping(binding);
            ps.setNull(columnIdx, sqlType);
            return;
        }

        // preserve array nature by writing it as a JSON array
        if (value.getClass().isArray()) {
            writeArray(
                    value, ps, columnIdx, (EnumMapper) att.getUserData().get(GPKG_ARRAY_ENUM_MAP));
        } else {
            throw new IllegalArgumentException("Cannot handle this array value: " + value);
        }
    }

