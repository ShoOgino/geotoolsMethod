    /**
     * SQLite dates are just strings, they don't get converted to Date in case of aggregation, do it
     * here instead
     */
    @Override
    public Function<Object, Object> getAggregateConverter(
            FeatureVisitor visitor, SimpleFeatureType featureType) {
        Optional<List<Class>> maybeResultTypes = getResultTypes(visitor, featureType);
        if (maybeResultTypes.isPresent()) {
            List<Class> resultTypes = maybeResultTypes.get();
            if (resultTypes.size() == 1) {
                Class<?> targetType = resultTypes.get(0);
                if (java.util.Date.class.isAssignableFrom(targetType)) {
                    return v -> {
                        Object converted = Converters.convert(v, targetType);
                        if (converted == null) {
                            LOGGER.log(
                                    Level.WARNING,
                                    "Could not convert "
                                            + v
                                            + " to the desired return type "
                                            + targetType);
                            return v;
                        }
                        return converted;
                    };
                }
            }
        }
        // otherwise no conversion needed
        return Function.identity();
    }

