    public BufferedImage read(byte[] data) throws IOException {
        if (lastReader != null) {
            lastReader.reset();
            lastReader.setInput(getImageInputStream(data));
        }
        if (lastReader == null
                || !lastReader.getOriginatingProvider().canDecodeInput(getImageInputStream(data))) {
            boolean found = false;
            for (ImageReader ir : readersCache) {
                if (ir != lastReader) {
                    ir.reset();
                    ir.setInput(getImageInputStream(data));
                    if (ir.canReadRaster()) {
                        lastReader = ir;
                        found = true;
                    }
                }
            }
            if (!found) {
                Iterator<ImageReader> readers = ImageIO.getImageReaders(getImageInputStream(data));
                if (!readers.hasNext()) {
                    throw new IOException(
                            "Unexpected, cannot find a reader for the current tile image format");
                }
                lastReader = readers.next();
                lastReader.setInput(getImageInputStream(data));
                readersCache.add(lastReader);
            }
        }

        ImageReadParam param = lastReader.getDefaultReadParam();
        return lastReader.read(0, param);
    }

