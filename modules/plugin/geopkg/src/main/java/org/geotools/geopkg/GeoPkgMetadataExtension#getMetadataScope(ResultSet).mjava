    private GeoPkgMetadata.Scope getMetadataScope(ResultSet rs) throws SQLException {
        String scope = rs.getString("md_scope");
        if (scope != null) {
            Optional<GeoPkgMetadata.Scope> enumValue =
                    Arrays.stream(GeoPkgMetadata.Scope.values())
                            .filter(s -> scope.equals(s.getSqlValue()))
                            .findFirst();
            if (enumValue.isPresent()) return enumValue.get();
        }

        LOGGER.log(
                Level.FINE,
                "md_scope is supposed to be non null and in a finite set of values defined by the spec, but got '"
                        + scope
                        + "' instead. Using the default value, 'dataset'.");
        return GeoPkgMetadata.Scope.Dataset;
    }

