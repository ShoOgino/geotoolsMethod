    private static SQLiteConfig setupSQLiteConfig(Map<String, ?> params) throws IOException {
        SQLiteConfig config = new SQLiteConfig();
        config.setSharedCache(true);
        config.enableLoadExtension(true);
        Object readOnly = READ_ONLY.lookUp(params);
        if (Boolean.TRUE.equals(readOnly)) {
            config.setPragma(SQLiteConfig.Pragma.SYNCHRONOUS, "OFF");
            config.setReadOnly(true);
        }
        Object map = (Integer) MEMORY_MAP_SIZE.lookUp(params);
        if (map instanceof Integer && ((Integer) map) >= 0) {
            int memoryMB = (Integer) map;
            config.setPragma(SQLiteConfig.Pragma.MMAP_SIZE, String.valueOf(memoryMB * 1024 * 1024));
        }
        return config;
    }

