    public void testScreenMapSkip() throws Exception {
        SimpleFeatureSource fs = dataStore.getFeatureSource(tname("ft1"));
        assertTrue(fs.getSupportedHints().contains(Hints.SCREENMAP));

        Query q = new Query(tname("ft1"));
        q.setPropertyNames(new String[] {"stringProperty", "geometry"});
        FilterFactory ff = dataStore.getFilterFactory();
        q.setSortBy(new SortBy[] {ff.sort("doubleProperty", SortOrder.ASCENDING)});

        // setup the screenmap so that we have a feature that gets skipped due to screenmap
        // but the next one is not
        ScreenMap screenMap =
                new ScreenMap(
                        -1,
                        -1,
                        10,
                        10,
                        new AffineTransform2D(AffineTransform.getScaleInstance(0.5, 0.5)));
        screenMap.setSpans(1, 1);
        Hints hints = new Hints(Hints.SCREENMAP, screenMap);
        q.setHints(hints);

        try (SimpleFeatureIterator it = fs.getFeatures(q).features()) {
            while (it.hasNext()) {
                // System.out.println(it.next());
                it.next();
            }
        }

        // check the screenmap has been updated
        assertTrue(screenMap.get(0, 0));
    }

