    @Test
    public void testGroupBy() throws IOException {
        FilterFactory ff = CommonFactoryFinder.getFilterFactory(null);
        GroupByVisitor visitor =
                new GroupByVisitor(
                        Aggregate.MAX,
                        ff.property("date"),
                        Arrays.asList(ff.property("txt")),
                        NULL_LISTENER);

        SimpleFeatureSource fs = gpkg.getFeatureSource(gpkg.getTypeNames()[0]);
        SimpleFeatureCollection features = fs.getFeatures();
        features.accepts(visitor, NULL_LISTENER);
        Map results = (Map) visitor.getResult().toMap();
        assertEquals(java.sql.Date.valueOf("2020-02-19"), results.get(singletonList("1")));
        assertEquals(java.sql.Date.valueOf("2020-02-20"), results.get(singletonList("2")));
    }

