    public void testDistanceSimplification() throws Exception {
        SimpleFeatureSource fs = dataStore.getFeatureSource(tname("road"));
        assertTrue(fs.getSupportedHints().contains(Hints.GEOMETRY_DISTANCE));

        FilterFactory factory = dataStore.getFilterFactory();
        Query q = new Query(tname("road"), factory.id(Collections.singleton(factory.featureId("road.0"))));
        Hints hints = new Hints(Hints.GEOMETRY_DISTANCE, new Double(10));
        q.setHints(hints);

        try(SimpleFeatureIterator it = fs.getFeatures(q).features()) {
            it.hasNext();

            // original feature:
            //      0 | LINESTRING( 1 1, 2 2, 4 2, 5 1 );srid=4326 | "r1"
            // but geometry has been simplified to its bbox (which is ok, no need to respect connectivity,
            // same logic as in ShapefileDataStore
            SimpleFeature f = it.next();
            LineString ls = (LineString) f.getDefaultGeometry();
            assertEquals(2, ls.getNumPoints());
            assertEquals(new Coordinate(1, 1), ls.getStartPoint().getCoordinate());
            assertEquals(new Coordinate(5, 2), ls.getEndPoint().getCoordinate());
        }
    }

