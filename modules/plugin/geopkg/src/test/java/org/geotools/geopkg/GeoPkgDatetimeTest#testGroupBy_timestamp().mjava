    @Test
    public void testGroupBy_timestamp() throws IOException {
        FilterFactory ff = CommonFactoryFinder.getFilterFactory(null);
        GroupByVisitor visitor =
                new GroupByVisitor(
                        Aggregate.MAX,
                        ff.property("time"),
                        Arrays.asList(ff.property("txt")),
                        NULL_LISTENER);

        SimpleFeatureSource fs = gpkg.getFeatureSource(gpkg.getTypeNames()[0]);
        SimpleFeatureCollection features = fs.getFeatures();
        features.accepts(visitor, NULL_LISTENER);
        Map results = (Map) visitor.getResult().toMap();

        assertEquals(5, results.size());

        assertEquals(
                java.sql.Timestamp.valueOf("2020-02-19 22:00:00.0"),
                results.get(singletonList("1")));
        assertEquals(
                java.sql.Timestamp.valueOf("2020-02-19 23:00:00.0"),
                results.get(singletonList("2")));
        assertEquals(
                java.sql.Timestamp.valueOf("2020-03-19 00:00:00.0"),
                results.get(singletonList("3")));
        assertEquals(
                java.sql.Timestamp.valueOf("2020-03-19 01:00:00.0"),
                results.get(singletonList("4")));
        assertEquals(
                java.sql.Timestamp.valueOf("2020-02-20 02:00:00.0"),
                results.get(singletonList("5")));
    }

