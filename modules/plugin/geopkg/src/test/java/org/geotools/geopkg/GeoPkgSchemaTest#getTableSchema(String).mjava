    private ArrayList<Map<String, Object>> getTableSchema(String tableName) throws SQLException {
        ArrayList<Map<String, Object>> columnDefinitions = new ArrayList<>();
        try (Connection cx = geopackage.getDataSource().getConnection();
                Statement st = cx.createStatement()) {
            ResultSet rs = st.executeQuery(String.format("PRAGMA table_info('%s')", tableName));
            while (rs.next()) {
                Map<String, Object> columnDefinition = new HashMap<>();
                columnDefinition.put("cid", rs.getInt("cid"));
                columnDefinition.put("name", rs.getString("name"));
                columnDefinition.put("typeval", rs.getString("type"));
                columnDefinition.put("notnull", rs.getBoolean("notnull"));
                columnDefinition.put("default_value", rs.getString("dflt_value"));
                columnDefinition.put("pk", rs.getBoolean("pk"));
                columnDefinitions.add(columnDefinition);
            }
        } catch (Exception e) {
            fail(e.getMessage());
        }
        return columnDefinitions;
    }

