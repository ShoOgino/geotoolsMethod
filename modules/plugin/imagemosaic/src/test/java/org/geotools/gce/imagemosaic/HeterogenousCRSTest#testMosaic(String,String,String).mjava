    private void testMosaic(String testLocation, String sortOrder, String resultLocation) throws URISyntaxException, IOException {
        URL storeUrl = org.geotools.TestData.url(this, testLocation);

        File testDataFolder = new File(storeUrl.toURI());
        File testDirectory = crsMosaicFolder.newFolder(testLocation);
        FileUtils.copyDirectory(testDataFolder, testDirectory);
        Hints creationHints = new Hints();
        ImageMosaicReader imReader = new ImageMosaicReader(testDirectory, creationHints);
        Assert.assertNotNull(imReader);

        //Let's do a sort order to get the correct results

        ParameterValue<String> sortByParam = ImageMosaicFormat.SORT_BY.createValue();
        sortByParam.setValue(sortOrder);

        GridCoverage2D gc2d = imReader
                .read(new GeneralParameterValue[]{sortByParam});
        RenderedImage renderImage = gc2d.getRenderedImage();

        File resultsFile = org.geotools.TestData
                .file(this, resultLocation);

        //number 1000 was a bit arbitrary for differences, should account for small differences in
        //interpolation and such, but not the reprojection of the blue tiff. Correct and incorrect
        //images will be pretty similar anyway
        ImageAssert.assertEquals(resultsFile, renderImage, 1000);
    }

