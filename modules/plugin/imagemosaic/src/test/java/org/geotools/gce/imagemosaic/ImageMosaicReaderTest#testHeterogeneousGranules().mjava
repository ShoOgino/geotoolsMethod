    /**
     * Tests the {@link ImageMosaicReader} with support for different resolutions/different number
     * of overviews.
     *
     * <p>world_a.tif => Pixel Size = (0.833333333333333,-0.833333333333333); 4 overviews
     * world_b1.tif => Pixel Size = (1.406250000000000,-1.406250000000000); 2 overviews world_b2.tif
     * => Pixel Size = (0.666666666666667,-0.666666666666667); 0 overviews
     *
     * @throws Exception
     */
    @Test
    // @Ignore
    public void testHeterogeneousGranules() throws Exception {

        final AbstractGridFormat format = TestUtils.getFormat(heterogeneousGranulesURL);
        ImageMosaicReader reader = TestUtils.getReader(heterogeneousGranulesURL, format);

        final ParameterValue<GridGeometry2D> gg =
                AbstractGridFormat.READ_GRIDGEOMETRY2D.createValue();
        final GeneralEnvelope envelope = reader.getOriginalEnvelope();
        final Dimension dim = new Dimension();
        dim.setSize(10, 10);
        final Rectangle rasterArea = ((GridEnvelope2D) reader.getOriginalGridRange());
        rasterArea.setSize(dim);
        final GridEnvelope2D range = new GridEnvelope2D(rasterArea);
        gg.setValue(new GridGeometry2D(range, envelope));

        // use imageio with defined tiles
        final ParameterValue<Boolean> useJai = AbstractGridFormat.USE_JAI_IMAGEREAD.createValue();
        useJai.setValue(false);

        final ParameterValue<OverviewPolicy> op = AbstractGridFormat.OVERVIEW_POLICY.createValue();

        LOGGER.info("\nTesting with OverviewPolicy = QUALITY");
        op.setValue(OverviewPolicy.QUALITY);
        TestUtils.checkCoverage(
                reader,
                new GeneralParameterValue[] {gg, useJai, op},
                "heterogeneous granules test: OverviewPolicy=QUALITY",
                rasterArea);

        LOGGER.info("\nTesting with OverviewPolicy = SPEED");
        reader = TestUtils.getReader(heterogeneousGranulesURL, format);
        op.setValue(OverviewPolicy.SPEED);
        TestUtils.checkCoverage(
                reader,
                new GeneralParameterValue[] {gg, useJai, op},
                "heterogeneous granules test: OverviewPolicy=SPEED",
                rasterArea);

        LOGGER.info("\nTesting with OverviewPolicy = NEAREST");
        reader = TestUtils.getReader(heterogeneousGranulesURL, format);
        op.setValue(OverviewPolicy.NEAREST);
        TestUtils.checkCoverage(
                reader,
                new GeneralParameterValue[] {gg, useJai, op},
                "heterogeneous granules test: OverviewPolicy=NEAREST",
                rasterArea);

        LOGGER.info("\nTesting with OverviewPolicy = IGNORE");
        reader = TestUtils.getReader(heterogeneousGranulesURL, format);
        op.setValue(OverviewPolicy.IGNORE);
        TestUtils.checkCoverage(
                reader,
                new GeneralParameterValue[] {gg, useJai, op},
                "heterogeneous granules test: OverviewPolicy=IGNORE",
                rasterArea);

        reader.dispose();
    }

