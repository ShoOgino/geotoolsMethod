    public void assertMultipleFileHarvest(
            Collection<File> files, ImageMosaicReader reader, GranuleCatalog originalCatalog)
            throws IOException {
        String[] metadataNames = reader.getMetadataNames();
        assertNotNull(metadataNames);
        assertEquals("true", reader.getMetadataValue("HAS_TIME_DOMAIN"));
        assertEquals(
                "2004-02-01T00:00:00.000Z,2004-05-01T00:00:00.000Z",
                reader.getMetadataValue(metadataNames[0]));

        // now go and harvest the other directory
        List<HarvestedSource> summary = reader.harvest(null, files, null);
        assertSame(originalCatalog, reader.granuleCatalog);
        assertEquals(2, summary.size());
        for (HarvestedSource hf : summary) {
            assertTrue(hf.success());
        }

        // the harvest put the file in the same coverage
        assertEquals(1, reader.getGridCoverageNames().length);
        metadataNames = reader.getMetadataNames();
        assertNotNull(metadataNames);
        assertEquals("true", reader.getMetadataValue("HAS_TIME_DOMAIN"));
        assertEquals(
                "2004-02-01T00:00:00.000Z,2004-03-01T00:00:00.000Z,2004-04-01T00:00:00.000Z,"
                        + "2004-05-01T00:00:00.000Z",
                reader.getMetadataValue(metadataNames[0]));
    }

