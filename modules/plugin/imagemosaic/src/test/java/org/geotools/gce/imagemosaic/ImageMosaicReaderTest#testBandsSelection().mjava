    @Test
    public void testBandsSelection() throws Exception {
        // instantiate image mosaic reader
        AbstractGridFormat format = TestUtils.getFormat(rgbURL);
        ImageMosaicReader reader = TestUtils.getReader(rgbURL, format);
        // reade the coverage select bands in different order and multiple times
        ParameterValue<int[]> selectedBands = AbstractGridFormat.BANDS.createValue();
        selectedBands.setValue(new int[] {2, 0, 1, 0, 1});
        GridCoverage2D coverage =
                TestUtils.checkCoverage(reader, new GeneralParameterValue[] {selectedBands}, null);
        // checking that we have five bands (the bands selection operation was delegated on JAI
        // BandsSelect operation)
        SampleModel sampleModel = coverage.getRenderedImage().getSampleModel();
        assertThat(sampleModel.getNumBands(), is(5));
    }

