    @Test
    public void testIgnoreInvalidGranule() throws Exception {
        // Get the resources as needed.
        final AbstractGridFormat format = TestUtils.getFormat(rgbURL);
        final ImageMosaicReader reader = TestUtils.getReader(rgbURL, format);

        GranuleStore granules =
                (GranuleStore) reader.getGranules(reader.getGridCoverageNames()[0], false);
        SimpleFeature first = DataUtilities.first(granules.getGranules(Query.ALL));
        // poison it
        first.setAttribute("location", "global_mosaic_11-invalid.png");
        Transaction t = new DefaultTransaction();
        granules.setTransaction(t);
        granules.addGranules(DataUtilities.collection(first));
        t.commit();
        t.close();

        // Test the output coverage
        TestUtils.checkCoverage(reader, new GeneralParameterValue[0], "Ignore invalid granule");
    }

