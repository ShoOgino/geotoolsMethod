    @Test
    public void testInitFromExistingStore() throws Exception {
        File testMosaic = new File(TestData.file(this, "."), "existingStore");
        if (testMosaic.exists()) {
            FileUtils.deleteDirectory(testMosaic);
        }
        File mosaicSource = TestData.file(this, "rgb");
        FileUtils.copyDirectory(mosaicSource, testMosaic);

        // create the base mosaic we are going to use
        cleanConfigurationFiles(testMosaic, "rgb");
        URL testMosaicUrl = fileToUrl(testMosaic);

        // place H2 file in the dir
        File dataStoreProperties = new File(testMosaic, "datastore.properties");
        try (FileWriter out = new FileWriter(dataStoreProperties)) {
            out.write("database=imagemosaic\n");
            out.write(H2_SAMPLE_PROPERTIES);
            out.flush();
        }

        // force its initialization the "normal" way
        final AbstractGridFormat format = TestUtils.getFormat(testMosaicUrl);
        final ImageMosaicReader reader = TestUtils.getReader(testMosaicUrl, format);
        reader.dispose();

        // cleanup configuration, test image, and so on
        cleanConfigurationFiles(testMosaic, "existingStore");

        // rename the table
        Properties h2Connection = new Properties();
        try (FileReader fr = new FileReader(dataStoreProperties)) {
            h2Connection.load(fr);
        }
        h2Connection.put("database", new File(testMosaic, "imagemosaic").getCanonicalPath());
        JDBCDataStore store = (JDBCDataStore) DataStoreFinder.getDataStore(h2Connection);
        try (Connection c = store.getConnection(Transaction.AUTO_COMMIT);
                Statement st = c.createStatement()) {
            st.execute("ALTER TABLE \"existingStore\" RENAME TO \"testMosaic\"");
            st.execute("UPDATE GEOMETRY_COLUMNS SET F_TABLE_NAME = 'testMosaic'");
        }
        store.dispose();

        // force it to use the existing schema
        Properties indexer = new Properties();
        indexer.put(Utils.Prop.USE_EXISTING_SCHEMA, "true");
        indexer.put(Utils.Prop.TYPENAME, "testMosaic");
        try (FileOutputStream fos =
                new FileOutputStream(new File(testMosaic, "indexer.properties"))) {
            indexer.store(fos, null);
        }

        // now read again, see if the config gets read properly
        final ImageMosaicReader reader2 = TestUtils.getReader(testMosaicUrl, format);
        GridCoverage2D coverage = reader2.read(null);
        coverage.dispose(true);
        reader2.dispose();
    }

