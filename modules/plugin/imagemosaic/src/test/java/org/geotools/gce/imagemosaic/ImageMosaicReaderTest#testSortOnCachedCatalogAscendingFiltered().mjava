    @Test
    public void testSortOnCachedCatalogAscendingFiltered() throws Exception {
        File timeCached = setupTimeCachedMosaic();

        // read reference image (the one that should be on top)
        BufferedImage expected = ImageIO
                .read(new File(timeCached, "world.200403.3x5400x2700.tiff"));

        // sort on time attribute
        final ParameterValue<String> sortBy = ImageMosaicFormat.SORT_BY.createValue();
        sortBy.setValue("time A");
        final ParameterValue<Filter> filter = ImageMosaicFormat.FILTER.createValue();
        // during does not include the limits apparently, so we end up with a weird filter
        filter.setValue(ECQL.toFilter("time during 2004-02-28T23:59:59/2004-05-01T00:00:00"));
        ImageMosaicReader reader = new ImageMosaicReader(timeCached);
        GridCoverage2D coverage = reader.read(new GeneralParameterValue[] { sortBy, filter });
        ImageAssert.assertEquals(expected, coverage.getRenderedImage(), 0);
        coverage.dispose(true);
        reader.dispose();
    }

