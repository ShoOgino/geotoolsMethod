    @Test
    public void testExistingSchema() throws Exception {

        final File workDir = new File(TestData.file(this, "."), "water_temp4");
        if (!workDir.mkdir()) {
            FileUtils.deleteDirectory(workDir);
            assertTrue("Unable to create workdir:" + workDir, workDir.mkdir());
        }
        FileUtils.copyFile(
                TestData.file(this, "watertemp.zip"), new File(workDir, "watertemp.zip"));
        TestData.unzipFile(this, "water_temp4/watertemp.zip");
        final URL timeElevURL = TestData.url(this, "water_temp4");

        // now start the test
        AbstractGridFormat format = TestUtils.getFormat(timeElevURL);
        assertNotNull(format);
        ImageMosaicReader reader = getReader(timeElevURL, format);
        assertNotNull(reader);

        reader.dispose();

        // append the parameter to the indexer.properties
        FileWriter out = null;
        try {
            out =
                    new FileWriter(
                            new File(TestData.file(this, "."), "/water_temp4/indexer.properties"),
                            true);
            out.write("UseExistingSchema=true\n");
            out.flush();
        } finally {
            if (out != null) {
                IOUtils.closeQuietly(out);
            }
        }

        // remove existing properties file and sample_image
        File sampleImage =
                new File(TestData.file(this, "."), "/water_temp4/" + Utils.SAMPLE_IMAGE_NAME);
        assertTrue(sampleImage.exists());
        sampleImage.delete();
        File mosaicProperties =
                new File(TestData.file(this, "."), "/water_temp4/water_temp4.properties");
        assertTrue(mosaicProperties.exists());
        mosaicProperties.delete();

        // now start the test
        format = TestUtils.getFormat(timeElevURL);
        assertNotNull(format);
        reader = getReader(timeElevURL, format);
        assertNotNull(reader);

        // the mosaic is correctly created
        assertTrue(sampleImage.exists());
        assertTrue(mosaicProperties.exists());

        // clean up
        reader.dispose();
        if (!INTERACTIVE) {
            FileUtils.deleteDirectory(TestData.file(this, "water_temp4"));
        }
    }

