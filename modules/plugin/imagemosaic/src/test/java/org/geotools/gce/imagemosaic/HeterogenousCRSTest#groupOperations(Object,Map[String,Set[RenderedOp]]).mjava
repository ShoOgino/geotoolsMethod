    private void groupOperations(Object ri, Map<String, Set<RenderedOp>> operationsSet) {
        if (ri instanceof RenderedOp) {
            RenderedOp op = (RenderedOp) ri;
            String opName = op.getOperationName();
            Set<RenderedOp> set = operationsSet.get(opName);
            if (set == null) {
                set = new HashSet<>();
            }
            set.add(op);
            operationsSet.put(opName, set);
            Vector sources = op.getSources();
            Iterator it = sources.iterator();
            while (it.hasNext()) {
                Object source = it.next();
                groupOperations(source, operationsSet);
            }
            return;
        }
    }

