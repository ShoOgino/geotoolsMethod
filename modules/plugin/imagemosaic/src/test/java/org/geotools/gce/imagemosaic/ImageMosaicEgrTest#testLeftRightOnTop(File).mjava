    public void testLeftRightOnTop(File expectedOutput) throws Exception {
        ImageMosaicReader reader = new ImageMosaicReader(testMosaicUrl, hints);

        // filter out the large granule, the left and right ones will still cover the mid one
        Filter filter = ECQL.toFilter("z <> 0");

        // test with no EGR
        GeneralParameterValue[] readParams =
                getFootprintReadParams(
                        reader,
                        new SimpleEntry<>(ImageMosaicFormat.SORT_BY, "z A"),
                        new SimpleEntry<>(ImageMosaicFormat.FILTER, filter));
        testOutputCoverage(
                reader, readParams, expectedOutput, "1_left.tiff", "2_right.tiff", "3_mid.tiff");

        // test with EGR, should be the same, all features are essential
        readParams =
                getFootprintReadParams(
                        reader,
                        new SimpleEntry<>(ImageMosaicFormat.SORT_BY, "z A"),
                        new SimpleEntry<>(ImageMosaicFormat.FILTER, filter),
                        new SimpleEntry<>(
                                ImageMosaicFormat.EXCESS_GRANULE_REMOVAL, ExcessGranulePolicy.ROI));
        testOutputCoverage(reader, readParams, expectedOutput, "1_left.tiff", "2_right.tiff");

        // test with EGR and MT
        readParams =
                getFootprintReadParams(
                        reader,
                        new SimpleEntry<>(ImageMosaicFormat.SORT_BY, "z A"),
                        new SimpleEntry<>(ImageMosaicFormat.FILTER, filter),
                        new SimpleEntry<>(
                                ImageMosaicFormat.EXCESS_GRANULE_REMOVAL, ExcessGranulePolicy.ROI),
                        new SimpleEntry<>(ImageMosaicFormat.ALLOW_MULTITHREADING, true));
        testOutputCoverage(reader, readParams, expectedOutput, "1_left.tiff", "2_right.tiff");
    }

