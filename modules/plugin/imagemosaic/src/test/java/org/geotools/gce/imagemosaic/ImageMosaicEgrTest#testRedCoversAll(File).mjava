    private void testRedCoversAll(File expectedOutput) throws Exception {
        ImageMosaicReader reader = new ImageMosaicReader(testMosaicUrl, hints);

        // test with no EGR
        GeneralParameterValue[] readParams =
                getFootprintReadParams(reader, new SimpleEntry<>(ImageMosaicFormat.SORT_BY, "z A"));
        testOutputCoverage(
                reader,
                readParams,
                expectedOutput,
                "0_large.tiff",
                "1_left.tiff",
                "2_right.tiff",
                "3_mid.tiff");

        // test with EGR, should be the same, all features are essential
        readParams =
                getFootprintReadParams(
                        reader,
                        new SimpleEntry<>(ImageMosaicFormat.SORT_BY, "z A"),
                        new SimpleEntry<>(
                                ImageMosaicFormat.EXCESS_GRANULE_REMOVAL, ExcessGranulePolicy.ROI));
        testOutputCoverage(reader, readParams, expectedOutput, "0_large.tiff");

        // test with EGR and MT
        readParams =
                getFootprintReadParams(
                        reader,
                        new SimpleEntry<>(ImageMosaicFormat.SORT_BY, "z A"),
                        new SimpleEntry<>(
                                ImageMosaicFormat.EXCESS_GRANULE_REMOVAL, ExcessGranulePolicy.ROI),
                        new SimpleEntry<>(ImageMosaicFormat.ALLOW_MULTITHREADING, true));
        testOutputCoverage(reader, readParams, expectedOutput, "0_large.tiff");
        reader.dispose();
    }

