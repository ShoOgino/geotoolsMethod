    @Test
    public void testSQLServerCreateAndDrop() throws Exception {
        ImageMosaicReader reader = null;
        try {
            createMetadataTable();
            final File workDir = new File(TestData.file(this, "."), tempFolderName4);
            workDir.mkdir();
            assertTrue(workDir.exists());
            FileUtils.copyFile(
                    TestData.file(this, "watertemp.zip"), new File(workDir, "watertemp.zip"));
            TestData.unzipFile(this, tempFolderName4 + "/watertemp.zip");
            final URL timeElevURL = TestData.url(this, tempFolderName4);

            setupDataStoreProperties(tempFolderName4);

            // now start the test
            final AbstractGridFormat format = TestUtils.getFormat(timeElevURL);
            assertNotNull(format);
            reader = TestUtils.getReader(timeElevURL, format);
            assertNotNull(reader);
            reader.delete(true);
            boolean dropSuccessfull = false;
            try {
                dropTables(new String[] {tempFolderName4});
                dropSuccessfull = true;
            } catch (SQLException E) {
                // The tables have been already deleted with the database drop performed
                // by the delete operation.
                assertFalse(dropSuccessfull);
            }
        } finally {
            reader.dispose();
        }
    }

