    /** Check if the provided reader is a MultiCRS Reader and it can support the specified crs. */
    public static boolean isSupportedCRS(GridCoverage2DReader reader, CoordinateReferenceSystem crs)
            throws FactoryException, IOException {
        String multiCrsReader =
                reader.getMetadataValue(AbstractGridCoverage2DReader.MULTICRS_READER);
        boolean isMultiCRS = multiCrsReader != null && Boolean.valueOf(multiCrsReader);
        String supportedEpsgCodes = "";
        if (isMultiCRS) {
            supportedEpsgCodes =
                    reader.getMetadataValue(AbstractGridCoverage2DReader.MULTICRS_EPSGCODES);
        }
        if (!StringUtils.isBlank(supportedEpsgCodes) && crs != null) {
            Integer targetCRSEpsgCode = CRS.lookupEpsgCode(crs, false);
            if (targetCRSEpsgCode != null) {
                String code = String.valueOf(targetCRSEpsgCode);
                supportedEpsgCodes = supportedEpsgCodes.replaceAll("[^0-9,]", "");
                String[] epsgCodes = supportedEpsgCodes.split(",");
                for (String epsgCode : epsgCodes) {
                    if (code.equalsIgnoreCase(epsgCode)) {
                        return true;
                    }
                }
            }
        }
        return false;
    }

