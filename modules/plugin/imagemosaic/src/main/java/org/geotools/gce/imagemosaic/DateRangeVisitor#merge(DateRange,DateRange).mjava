    /**
     * Merge 2 ranges together. In order to speed up the computations, 
     * this method does the assumption that the 2 date ranges are already sorted
     * (first < second) and they intersect together.
     * 
     * @param firstDateRange
     * @param secondDateRange
     * @return
     */
    private static DateRange merge(DateRange firstDateRange, DateRange secondDateRange) {
        Utilities.ensureNonNull("firstDateRange", firstDateRange);
        Utilities.ensureNonNull("secondDateRange", secondDateRange);
        long beginFirst = firstDateRange.getMinValue().getTime();
        long endFirst = firstDateRange.getMaxValue().getTime();
        long beginSecond = secondDateRange.getMinValue().getTime();
        long endSecond = secondDateRange.getMaxValue().getTime();
        long max = Math.max(endFirst, endSecond);
        long min = Math.min(beginFirst, beginSecond);
        Date beginDate = new Date(min);
        Date endDate = new Date(max);
        return new DateRange(beginDate, endDate);
    }

