    /**
     * Merge 2 ranges together. In order to speed up the computations, this method does the
     * assumption that the 2 date ranges are already sorted (first < second) and they intersect
     * together.
     *
     * @param firstDateRange
     * @param secondDateRange
     * @return
     */
    private static DateRange merge(DateRange firstDateRange, DateRange secondDateRange) {
        Utilities.ensureNonNull("firstDateRange", firstDateRange);
        Utilities.ensureNonNull("secondDateRange", secondDateRange);
        final long beginFirst = firstDateRange.getMinValue().getTime();
        final long endFirst = firstDateRange.getMaxValue().getTime();
        final long beginSecond = secondDateRange.getMinValue().getTime();
        final long endSecond = secondDateRange.getMaxValue().getTime();
        final long max = Math.max(endFirst, endSecond);
        final long min = Math.min(beginFirst, beginSecond);
        final Date beginDate = new Date(min);
        final Date endDate = new Date(max);
        return new DateRange(beginDate, endDate);
    }

