    private Map<String, Integer> calcToCountMap(CalcResult result) {
        // the result is a map going from list of grouping attributes to value
        @SuppressWarnings("unchecked")
        Map<List<String>, Integer> map = result.toMap();
        return map.entrySet()
                .stream()
                .collect(Collectors.toMap(x -> x.getKey().get(0), x -> x.getValue()));
    }

