    /**
     * This method checks the {@link ColorModel} of the current image with the one of the first image in order to check if they are compatible or
     * not in order to perform a mosaic operation.
     * 
     * <p>
     * It is worth to point out that we also check if, in case we have two index color model image, we also try to suggest whether or not we
     * should do a color expansion.
     * 
     * @param defaultCM
     * @param defaultPalette
     * @param actualCM
     * @return a boolean asking to skip this feature.
     */
    public static boolean checkColorModels(ColorModel defaultCM, byte[][] defaultPalette,
			ColorModel actualCM) {

        // check the number of color components
        final int defNumComponents = defaultCM.getNumColorComponents();
        int actualNumComponents = actualCM.getNumColorComponents();
        int colorComponentsDifference = Math.abs(defNumComponents - actualNumComponents);

        if (colorComponentsDifference != 0) {
            if ((defNumComponents == 1 && defaultCM instanceof ComponentColorModel)
                    || (actualNumComponents == 1 && actualCM instanceof ComponentColorModel)) {
                // gray expansion can be performed
                return false;
            }
        } else {
            return false;
        }

        //
        // if we get here this means that the two color models where completely
        // different, hence skip this feature.
        //
        return true;
    }

