    @Override
    public int removeGranules(Filter filter) {
        int removed = catalog.removeGranules(new Query(typeName, filter));
        try {
            // we cannot re-initialize a raster manager if there are no granules
            Query q = new Query(manager.getTypeName());
            q.setMaxFeatures(1);
            if (DataUtilities.count(catalog.getGranules(q)) > 0) {
                manager.initialize(true);
            }
        } catch (IOException e) {
            throw new RuntimeException(e);
        }
        return removed;
    }

