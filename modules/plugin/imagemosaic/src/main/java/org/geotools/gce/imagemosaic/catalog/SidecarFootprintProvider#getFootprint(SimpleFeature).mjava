    @Override
    public Geometry getFootprint(SimpleFeature feature) throws IOException {
        Object value = feature.getAttribute("location");
        if (value != null && value instanceof String) {
            String strValue = (String) value;
            String path = getFullPath(strValue);
            String noExtension = getNoExtensionPath(path);

            // Try to reuse over and over the last loader, to avoid checking the others
            // The last loader is kept in a volatile variable and all the work is done via
            // a local copy of it to avoid concurrency issues
            FootprintLoader loader = lastLoader;
            Geometry result = null;
            try {
                if (loader != null) {
                    result = loader.loadFootprint(noExtension);
                }
                if (result == null) {
                    for (FootprintLoader test : LOADERS) {
                        try {
                            result = test.loadFootprint(noExtension);
                            if (result != null) {
                                lastLoader = test;
                                break;
                            }
                        } catch (Exception e) {
                            if (LOGGER.isLoggable(Level.FINE)) {
                                LOGGER.log(Level.FINE, test.getClass().getName()+" threw exception loading footprint", e);
                            }
                        }
                    }
                }
            } catch (Exception e) {
                throw new IOException("Failed to load the footprint for granule " + strValue, e);
            }

            return result;
        } else {
            if (LOGGER.isLoggable(Level.FINE)) {
                LOGGER.fine("Could not use the location attribute value to search for "
                        + "a sidecar file, the value was: " + value);
            }
            return null;
        }
    }

