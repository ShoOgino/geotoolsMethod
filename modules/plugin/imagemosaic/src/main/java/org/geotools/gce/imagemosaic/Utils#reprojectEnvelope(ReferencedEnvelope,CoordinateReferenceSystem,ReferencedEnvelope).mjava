    public static ReferencedEnvelope reprojectEnvelope(
            ReferencedEnvelope sourceEnvelope,
            CoordinateReferenceSystem targetCRS,
            ReferencedEnvelope targetReferenceEnvelope)
            throws FactoryException, TransformException {
        Geometry reprojected =
                Utils.reprojectEnvelopeToGeometry(
                        sourceEnvelope, targetCRS, targetReferenceEnvelope);
        if (reprojected == null) {
            return new ReferencedEnvelope(targetCRS);
        } else {
            if (reprojected.getNumGeometries() > 1) {
                return new ReferencedEnvelope(
                        reprojected.getGeometryN(0).getEnvelopeInternal(), targetCRS);
            } else {
                return new ReferencedEnvelope(reprojected.getEnvelopeInternal(), targetCRS);
            }
        }
    }

