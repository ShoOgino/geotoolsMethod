    /**
     * Delete granules from query.
     * @param query
     * @throws IOException
     */
    private void deleteGranulesFromDisk(Query query) throws IOException {
        final SimpleFeatureCollection collection = granuleCatalog.getGranules(query);
        
        collection.accepts(new AbstractFeatureVisitor() {
            public void visit(Feature feature) {
                if (feature instanceof SimpleFeature) {
                    // get the feature
                    final SimpleFeature sf = (SimpleFeature) feature;
                    final String location = (String) sf.getAttribute(parentReader.locationAttributeName);
                    URL rasterPath = pathType.resolvePath(DataUtilities.fileToURL(parentReader.parentDirectory).toString(), location);
                    boolean removed = FileUtils.deleteQuietly(DataUtilities.urlToFile(rasterPath));
                    if (removed && LOGGER.isLoggable(Level.FINE)) {
                        LOGGER.fine("File: " + rasterPath + " has been removed:");
                    }
                }
            }
        }, null);
    }

