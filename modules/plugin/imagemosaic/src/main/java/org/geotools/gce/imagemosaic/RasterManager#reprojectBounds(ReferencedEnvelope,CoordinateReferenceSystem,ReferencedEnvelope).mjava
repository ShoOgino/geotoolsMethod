    private ReferencedEnvelope reprojectBounds(ReferencedEnvelope referenceBounds,
            CoordinateReferenceSystem targetCRS, ReferencedEnvelope bounds)
            throws FactoryException, TransformException {
        ProjectionHandler ph = ProjectionHandlerFinder.getHandler(referenceBounds, targetCRS, true);
        ReferencedEnvelope targetBounds = null;
        if(ph != null) {
            List<ReferencedEnvelope> queryEnvelopes = ph.getQueryEnvelopes();
            for (ReferencedEnvelope envelope : queryEnvelopes) {
                ReferencedEnvelope transformed = envelope.transform(targetCRS, true);
                if(targetBounds == null) {
                    targetBounds = transformed;
                } else {
                    targetBounds.expandToInclude(transformed);
                }
            }
        } else {
            targetBounds = bounds.transform(targetCRS, true);
        }
        return targetBounds;
    }

