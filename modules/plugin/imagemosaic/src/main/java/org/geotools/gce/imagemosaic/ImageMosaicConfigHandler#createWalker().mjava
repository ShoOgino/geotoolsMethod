    /** Create a proper {@link ImageMosaicWalker} based on the current configuration */
    public ImageMosaicWalker createWalker() {
        ImageMosaicWalker walker;

        if (isCog()) {
            // COG CASE:
            // Create an ImageMosaicURLConsumer to consume urls and an ImageMosaicDatastoreWalker
            // to provide them to the consumer
            URLSourceSPIProvider urlSourceSPIProvider =
                    new CogConfiguration(getRunConfiguration().getIndexer());
            ImageMosaicURLFeatureConsumer.ImageMosaicURLConsumer urlsConsumer =
                    new ImageMosaicURLFeatureConsumer.ImageMosaicURLConsumer(urlSourceSPIProvider);
            walker =
                    new ImageMosaicDatastoreWalker(
                            this, eventHandler, new ImageMosaicURLFeatureConsumer(urlsConsumer));
        } else if (isUseExistingSchema()) {
            // walks existing granules in the origin store
            walker =
                    new ImageMosaicDatastoreWalker(
                            this, eventHandler, new ImageMosaicFileFeatureConsumer());
        } else {
            // Classic Case:
            // collecting granules from the file system
            walker = new ImageMosaicDirectoryWalker(this, eventHandler);
        }
        return walker;
    }

