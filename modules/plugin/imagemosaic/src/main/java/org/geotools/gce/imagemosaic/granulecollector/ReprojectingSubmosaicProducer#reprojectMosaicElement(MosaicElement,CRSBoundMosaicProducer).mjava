    private MosaicElement reprojectMosaicElement(MosaicElement mosaicElement,
            CRSBoundMosaicProducer mosaicProducer) throws FactoryException {

        if (!CRS.equalsIgnoreMetadata(targetCRS, mosaicProducer.getCrs())) {
            GridCoverageFactory factory = new GridCoverageFactory(null);

            ReferencedEnvelope submosaicBBOX = computeSubmosaicBoundingBox(mosaicProducer,
                    mosaicElement);
            GridCoverage2D submosaicCoverage = factory.create("submosaic",
                    mosaicElement.getSource(), submosaicBBOX);
            GridCoverage2D resampledCoverage = (GridCoverage2D) operations
                    .resample(submosaicCoverage, targetCRS);

            RenderedImage resampledImage = positionInOutputMosaic(resampledCoverage);

            PlanarImage alphaBand = resampledImage.getColorModel().hasAlpha()
                    ? new ImageWorker(resampledImage).retainLastBand().getPlanarImage() : null;

            Object property = resampledImage.getProperty("ROI");
            ROI overallROI = (property instanceof ROI) ? (ROI) property : null;
            return new MosaicElement(alphaBand, overallROI, resampledImage,
                    mosaicElement.getPamDataset());
        } else {
            return mosaicElement;
        }
    }

