    private void setupNoData(ImageReader reader) throws IOException {
        // grabbing the nodata if possible
        int index = 0;
        if (originator != null) {
            Object imageIndex = originator.getAttribute("imageindex");
            if (imageIndex instanceof Integer) {
                index = (Integer) imageIndex;
            }
        }
        try {
            IIOMetadata metadata = reader.getImageMetadata(index);
            if (metadata instanceof CoreCommonImageMetadata) {
                double[] noData = ((CoreCommonImageMetadata) metadata).getNoData();
                if (noData != null) {
                    this.noData = new NoDataContainer(noData);
                }
            }
        } catch(UnsupportedOperationException e) {
            // some imageio-ext plugin throw this because they do not support getting the metadata
            // instead of returning null
            if (LOGGER.isLoggable(Level.FINER)) {
                LOGGER.log(Level.FINER, "Failed to gather metadata, might not be fatal, some readers do not support it", e);
            }
        }
    }

