    @Override
    public int getCount(Query q) throws IOException {
        q = setupBaseQuery(q);
        //TODO Optimize this call
        Collection<GranuleDescriptor> granules = catalog.getGranules(q);
        return granules.size();
    }

