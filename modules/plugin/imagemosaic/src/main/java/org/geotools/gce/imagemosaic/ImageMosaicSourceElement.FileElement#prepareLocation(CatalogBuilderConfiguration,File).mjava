        /** Prepare the location on top of the configuration and file to be processed. */
        private static String prepareLocation(
                CatalogBuilderConfiguration runConfiguration, final File fileBeingProcessed)
                throws IOException {
            // absolute
            String pathType = runConfiguration.getParameter(Utils.Prop.PATH_TYPE);
            String absolutePath = runConfiguration.getParameter(Utils.Prop.ABSOLUTE_PATH);
            if (Boolean.valueOf(absolutePath) || PathType.ABSOLUTE.name().equals(pathType)) {
                return fileBeingProcessed.getAbsolutePath();
            }

            // relative (harvesting of PathType.URL is not supported)
            String targetPath = fileBeingProcessed.getCanonicalPath();
            String basePath = runConfiguration.getParameter(Utils.Prop.ROOT_MOSAIC_DIR);
            String relative = getRelativePath(targetPath, basePath, File.separator);
            // escaping
            return relative;
        }

