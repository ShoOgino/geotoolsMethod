    public RasterManager(final ImageMosaicReader parentReader, MosaicConfigurationBean configuration)
            throws IOException {

        Utilities.ensureNonNull("ImageMosaicReader", parentReader);

        this.parentReader = parentReader;
        this.expandMe = parentReader.expandMe;
        boolean checkAuxiliaryMetadata = configuration.isCheckAuxiliaryMetadata();
        this.heterogeneousGranules = parentReader.heterogeneousGranules;
        this.configuration = configuration;
        hints = parentReader.getHints();
        if (configuration != null && configuration.getAuxiliaryFilePath() != null) {
            hints.add(new RenderingHints(Utils.AUXILIARY_FILES_PATH, configuration.getAuxiliaryFilePath()));
        }
        if (checkAuxiliaryMetadata) {
            hints.add(new RenderingHints(Utils.CHECK_AUXILIARY_METADATA, checkAuxiliaryMetadata));
        }

        // take ownership of the index : TODO: REMOVE THAT ONCE DEALING WITH MORE CATALOGS/RASTERMANAGERS
        // granuleCatalog = new HintedGranuleCatalog(parentReader.granuleCatalog, hints);
        granuleCatalog = parentReader.granuleCatalog;
        this.coverageFactory = parentReader.getGridCoverageFactory();
        this.coverageIdentifier = configuration != null ? configuration.getName() : ImageMosaicReader.UNSPECIFIED;
        this.pathType = configuration.getCatalogConfigurationBean().isAbsolutePath() ? PathType.ABSOLUTE : PathType.RELATIVE;

        extractOverviewPolicy();
        extractDecimationPolicy();

        // load defaultSM and defaultCM by using the sample_image if it was provided
        loadSampleImage(configuration);

        if (configuration != null) {
            CatalogConfigurationBean catalogBean = configuration.getCatalogConfigurationBean();
            typeName = catalogBean != null ? catalogBean.getTypeName() : null;
            initDomains(configuration);
            if (defaultSM == null) {
                defaultSM = configuration.getSampleModel();
            }

            if (defaultCM == null) {
                defaultCM = configuration.getColorModel();
            }
            
            if (defaultSM != null && defaultCM != null && defaultImageLayout == null) {
                defaultImageLayout= new ImageLayout().setColorModel(defaultCM).setSampleModel(defaultSM);
            }
            
            levels = configuration.getLevels();
            final double[] highRes = levels[0];
            final int numOverviews = configuration.getLevelsNum() - 1;
            double[][] overviews = null;
            if (numOverviews > 0) {
                overviews = new double[numOverviews][2];
                for (int i = 0; i < numOverviews; i++) {
                    overviews[i][0] = levels[i+1][0];
                    overviews[i][1] = levels[i+1][1];
                }
            }
            overviewsController = new OverviewsController(highRes,
                  numOverviews, overviews);
            imposedEnvelope = configuration.getEnvelope();
        }
    }

