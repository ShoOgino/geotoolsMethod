    @Override
    protected DataStore getTileIndexStore() {
        DataStore dataStore = null;
        try {
            // try getting the store, the specific repository implementation might throw
            // an exception if the store is a DataAccess (DefaultRepository does for example)
            dataStore = repository.dataStore(storeName);
        } catch (Exception e) {
            // ignore
        }
        if (dataStore == null) {
            // see if we can fall back on a data access exposing simple feature types
            DataAccess access = repository.access(storeName);
            if (access != null) {
                dataStore = new DataAccessStoreWrapper(access);
            } else {
                throw new IllegalStateException(
                        "Could not find a data store with name " + flatStoreName);
            }
        }

        return dataStore;
    }

