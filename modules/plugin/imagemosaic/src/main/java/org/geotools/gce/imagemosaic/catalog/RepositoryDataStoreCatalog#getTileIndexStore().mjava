    @Override
    protected DataStore getTileIndexStore() {
        DataStore dataStore = null;
        try {
            // try getting the store, the specific repository implementation might throw
            // an exception if the store is a DataAccess (DefaultRepository does for example)
            dataStore = repository.dataStore(storeName);
        } catch (Exception e) {
            // ignore
        }
        if (dataStore == null) {
            // see if we can fall back on a data access exposing simple feature types
            @SuppressWarnings("unchecked")
            DataAccess<FeatureType, Feature> access =
                    (DataAccess<FeatureType, Feature>) repository.access(storeName);
            if (access != null) {
                if (cachedWrapped != null && cachedWrapped.wraps(access)) {
                    return cachedWrapped;
                } else {
                    DataAccessStoreWrapper wrapper = new DataAccessStoreWrapper(access);
                    cachedWrapped = wrapper;
                    dataStore = wrapper;
                }
            } else {
                throw new IllegalStateException(
                        "Could not find a data store with name " + flatStoreName);
            }
        }

        return dataStore;
    }

