    private Query setupBaseQuery(Query q) {
        Query baseQuery = new Query();
        baseQuery.setHints(hints);
        baseQuery.setTypeName(typeName);

        if (q == null) {
            return baseQuery;
        } else {
            if (q.getTypeName() != null && !Objects.equals(this.typeName, q.getTypeName())) {
                throw new IllegalArgumentException(
                        "Invalid type name in query "
                                + q.getTypeName()
                                + ", this granule source only returns "
                                + this.typeName);
            }
            if (hints != null) {
                q.getHints().putAll(hints);
            }

            return DataUtilities.mixQueries(baseQuery, q, null);
        }
    }

