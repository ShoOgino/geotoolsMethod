    ReprojectingSubmosaicProducer(
            RasterLayerRequest request,
            RasterLayerResponse response,
            RasterManager rasterManager,
            boolean dryRun) {
        super(response, dryRun);
        this.targetCRS = rasterManager.getConfiguration().getCrs();
        Envelope2D requestedBounds = request.getRequestedBounds();
        if (rasterManager.getConfiguration().getCatalogConfigurationBean().isHeterogeneousCRS()
                && requestedBounds != null) {
            CoordinateReferenceSystem crs = requestedBounds.getCoordinateReferenceSystem();
            Integer code = null;
            try {
                code = CRS.lookupEpsgCode(crs, false);
                // Let's switch the targetCRS to the requested one if supported
                if (request.isUseAlternativeCRS() && rasterManager.hasAlternativeCRS(code)) {
                    targetCRS = crs;
                }
            } catch (IOException | FactoryException e) {
                if (LOGGER.isLoggable(Level.WARNING)) {
                    LOGGER.warning(
                            "Unable to check for alternative CRS: "
                                    + code
                                    + " Proceeding with default target CRS");
                }
            }
        }
        this.dryRun = dryRun;

        Hints hints = rasterManager.getHints();
        this.renderingHints = createRenderingHints(hints, request);
        this.operations = new Operations(renderingHints);
    }

