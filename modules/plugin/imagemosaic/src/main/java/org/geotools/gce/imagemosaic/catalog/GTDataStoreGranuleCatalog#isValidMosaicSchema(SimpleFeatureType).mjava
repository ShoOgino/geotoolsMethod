    /**
     * Returns true if the type is usable as a mosaic index, that is, it has a geometry and the
     * expected location property
     */
    private boolean isValidMosaicSchema(SimpleFeatureType schema) {
        // does it have a geometry?
        if (schema.getGeometryDescriptor() == null) {
            return false;
        }

        // does it have the location property
        String locationName = getLocationAttributeName();
        AttributeDescriptor location = schema.getDescriptor(locationName);
        return location != null
                && CharSequence.class.isAssignableFrom(location.getType().getBinding());
    }

