    public PropertyFeatureWriter(ContentFeatureSource source, ContentState contentState, Query query, boolean append) throws IOException {
        this.state = contentState;
        this.featureSource = source;
        PropertyDataStore store = (PropertyDataStore) contentState.getEntry().getDataStore();
        String namespaceURI = store.getNamespaceURI();
        String typeName = query.getTypeName();
        
        File dir = store.dir;
        read = new File( store.dir, typeName+".properties");
        write = File.createTempFile(typeName + System.currentTimeMillis(),null, dir);
        
        // start reading
        delegate = new PropertyFeatureReader(namespaceURI, read );
        type = delegate.getFeatureType();
        
        // open writer
        writer = new BufferedWriter(new FileWriter(write));
        // write header
        writer.write("_=");
        writer.write(DataUtilities.encodeType(type));
    }
    // constructor end

