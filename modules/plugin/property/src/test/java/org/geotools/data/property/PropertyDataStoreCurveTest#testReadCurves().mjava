    @Test
    public void testReadCurves() throws Exception {
        String names[] = store.getTypeNames();
        Assert.assertEquals(1, names.length);
        Assert.assertEquals("curvelines", names[0]);
        Query query = new Query("curvelines");
        try (FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                store.getFeatureReader(query, Transaction.AUTO_COMMIT)) {
            Assert.assertTrue(reader.hasNext());
            Object geom = reader.next().getDefaultGeometry();
            Assert.assertTrue(geom instanceof CompoundRing);
            CurvedGeometry<?> curved = (CurvedGeometry<?>) geom;
            Assert.assertEquals(Double.MAX_VALUE, curved.getTolerance(), 0d);

            Assert.assertTrue(reader.hasNext());
            geom = reader.next().getDefaultGeometry();
            Assert.assertTrue(geom instanceof CircularRing);
            curved = (CurvedGeometry<?>) geom;
            Assert.assertEquals(Double.MAX_VALUE, curved.getTolerance(), 0d);

            Assert.assertTrue(reader.hasNext());
            geom = reader.next().getDefaultGeometry();
            Assert.assertTrue(geom instanceof CircularString);
            curved = (CurvedGeometry<?>) geom;
            Assert.assertEquals(Double.MAX_VALUE, curved.getTolerance(), 0d);
        }
    }

