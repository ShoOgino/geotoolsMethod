    /** Test CRS being passed into Geometry user data. */
    @Test
    public void testCRS() throws Exception {
        SimpleFeatureSource road = sridStore.getFeatureSource("road2");
        SimpleFeatureCollection features = road.getFeatures();
        Assert.assertEquals(4, features.size());

        SimpleFeature feature;
        Geometry geom;
        Property prop;
        GeometryType geomType;
        SimpleFeatureIterator iterator = features.features();
        while (iterator.hasNext()) {
            feature = iterator.next();
            prop = feature.getProperty("geom");
            Assert.assertTrue(prop.getType() instanceof GeometryType);
            geomType = (GeometryType) prop.getType();

            Object val = prop.getValue();
            Assert.assertTrue(val != null && val instanceof Geometry);
            geom = (Geometry) val;

            Object userData = geom.getUserData();
            Assert.assertTrue(userData != null && userData instanceof CoordinateReferenceSystem);
            // ensure the same CRS is passed on to userData for encoding
            Assert.assertEquals(userData, geomType.getCoordinateReferenceSystem());
        }
    }

