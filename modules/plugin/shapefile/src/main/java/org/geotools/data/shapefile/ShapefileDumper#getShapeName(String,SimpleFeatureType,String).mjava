    /**
     * Returns the shape name from the given suggested name (if available), schema and geometry
     * type.
     *
     * @param fileName
     * @param schema
     * @param geometryType
     * @return
     */
    private String getShapeName(String fileName, SimpleFeatureType schema, String geometryType) {
        if (fileName == null) {
            return getShapeName(schema, geometryType);
        } else {
            return getShapeName(fileName, geometryType);
        }
    }

