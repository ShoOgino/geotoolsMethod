    /**
     * Copy the next record into the array starting at offset.
     *
     * @param entry Th array to copy into.
     * @param offset The offset to start at
     * @throws IOException If an error occurs.
     * @return The same array passed in.
     */
    public Object[] readEntry(final Object[] entry, final int offset) throws IOException {
        if (entry.length - offset < header.getNumFields()) {
            throw new ArrayIndexOutOfBoundsException();
        }

        read();
        if (row.deleted) {
            return null;
        }

        // retrieve the record length
        final int numFields = header.getNumFields();

        for (int j = 0; j < numFields; j++) {
            entry[j + offset] = readObject(fieldOffsets[j], j);
        }

        return entry;
    }

