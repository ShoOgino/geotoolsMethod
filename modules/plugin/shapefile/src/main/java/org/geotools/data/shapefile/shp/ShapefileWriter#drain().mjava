    /** Drain internal buffers into underlying channels. */
    private void drain() throws IOException {
        ((Buffer) shapeBuffer).flip();
        indexBuffer.flip();
        while (shapeBuffer.remaining() > 0) shpChannel.write(shapeBuffer);
        while (indexBuffer.remaining() > 0) shxChannel.write(indexBuffer);
        shapeBuffer.flip().limit(shapeBuffer.capacity());
        indexBuffer.flip().limit(indexBuffer.capacity());
    }

