    private void readRecord(int index) throws IOException {
        check();
        int pos = 100 + index * 8;
        if (!this.useMemoryMappedBuffer) {
            if (pos - this.channelOffset < 0
                    || this.channelOffset + buf.limit() <= pos
                    || this.lastIndex == -1) {
                LOGGER.finest("Filling buffer...");
                this.channelOffset = pos;
                this.channel.position(pos);
                ((Buffer) buf).clear();
                this.channel.read(buf);
                ((Buffer) buf).flip();
            }
        }

        ((Buffer) buf).position(pos - this.channelOffset);
        this.recOffset = buf.getInt();
        this.recLen = buf.getInt();
        this.lastIndex = index;
    }

