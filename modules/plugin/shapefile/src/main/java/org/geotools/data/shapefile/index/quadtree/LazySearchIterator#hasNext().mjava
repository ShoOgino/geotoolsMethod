    @Override
    public boolean hasNext() {
        if (closed) throw new IllegalStateException("Iterator has been closed!");
        if (next != null) return true;
        if (data != null && data.hasNext()) {
            next = data.next();
        } else {
            data = null;
            fillCache();
            if (data != null && data.hasNext()) next = data.next();
        }
        return next != null;
    }

