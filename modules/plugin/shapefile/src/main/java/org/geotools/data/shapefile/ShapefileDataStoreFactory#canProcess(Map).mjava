    @Override
    public boolean canProcess(Map params) {
        if (!DataUtilities.canProcess(params, getParametersInfo())) {
            return false; // fail basic param check
        }
        try {
            URL url = (URL) URLP.lookUp(params);
            if (canProcess(url)) {
                return true;
            } else {
                // maybe it's a directory?
                Object fileType = FILE_TYPE.lookUp(params);
                File dir = URLs.urlToFile(url);

                // check for null fileType for backwards compatibility

                // Return false if this is a VPF directory
                if (dir != null && dir.isDirectory() && fileType == null) {
                    String dirPath = dir.getPath();
                    String pathLAT = dirPath.concat(File.separator).concat("LAT");
                    String pathLHT = dirPath.concat(File.separator).concat("LHT");
                    String pathDHT = dirPath.concat(File.separator).concat("DHT");

                    if (new File(pathLAT).exists()
                            || new File(pathLHT).exists()
                            || new File(pathDHT).exists()
                            || new File(pathLAT.toLowerCase()).exists()
                            || new File(pathLHT.toLowerCase()).exists()
                            || new File(pathDHT.toLowerCase()).exists()) {
                        return false;
                    }
                }

                return dir != null
                        && dir.isDirectory()
                        && (fileType == null || "shapefile".equals(fileType));
            }
        } catch (IOException e) {
            return false;
        }
    }

