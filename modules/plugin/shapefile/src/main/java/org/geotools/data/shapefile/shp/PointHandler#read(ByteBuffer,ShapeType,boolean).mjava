    public Object read(ByteBuffer buffer, ShapeType type, boolean flatGeometry) {
        if (type == ShapeType.NULL) {
            return createNull();
        }

        Coordinate c;
        if (shapeType == ShapeType.POINTZ && !flatGeometry) {

            c = new CoordinateXYZM();
        } else if (shapeType == ShapeType.POINTM && !flatGeometry) {
            c = new CoordinateXYM();
        } else {
            c = new CoordinateXY();
        }
        c.setX(buffer.getDouble());
        c.setY(buffer.getDouble());

        if (shapeType == ShapeType.POINTM && !flatGeometry) {
            c.setM(buffer.getDouble());
        }

        if (shapeType == ShapeType.POINTZ && !flatGeometry) {
            c.setZ(buffer.getDouble());
            if (buffer.hasRemaining()) c.setM(buffer.getDouble());
        }

        return geometryFactory.createPoint(c);
    }

