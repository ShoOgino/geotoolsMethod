    // do important cleanup stuff.
    // Closes channel !
    /**
     * Clean up any resources. Closes the channel.
     *
     * @throws IOException If errors occur while closing the channel.
     */
    public void close() throws IOException {
        // don't throw NPE on double close
        if (channel == null) return;
        try {
            if (channel.isOpen()) {
                channel.close();
                streamLogger.close();
            }
            NIOUtilities.clean(buffer, useMemoryMappedBuffer);
        } finally {
            if (shxReader != null) shxReader.close();
        }
        shxReader = null;
        channel = null;
        header = null;
    }

