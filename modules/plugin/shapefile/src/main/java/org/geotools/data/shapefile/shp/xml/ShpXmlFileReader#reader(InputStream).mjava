    private XMLStreamReader reader(InputStream in) throws XMLStreamException {
        XMLInputFactory inputFactory = XMLInputFactory.newInstance();
        // disable resolving of external DTD entities (coalescing needs to be false)
        inputFactory.setProperty(IS_COALESCING, false);
        inputFactory.setProperty(IS_REPLACING_ENTITY_REFERENCES, false);
        // disallow DTDs entirely
        inputFactory.setProperty(SUPPORT_DTD, false);

        return inputFactory.createXMLStreamReader(in, "UTF-8");
    }

