    @Override
    public void removeSchema(Name typeName) throws IOException {
        // check file
        ContentEntry entry = ensureEntry(typeName);
        org.geotools.data.shapefile.files.FileWriter writer = () -> "TheShapefileRemover";
        for (ShpFileType type : ShpFileType.values()) {
            File file = shpFiles.acquireWriteFile(type, writer);
            try {
                if (file.exists()) {
                    if (!file.delete()) {
                        throw new IOException("Failed to delete " + file.getAbsolutePath());
                    }
                }
            } finally {
                shpFiles.unlockWrite(file, writer);
            }
        }
        removeEntry(entry.getName());
    }

