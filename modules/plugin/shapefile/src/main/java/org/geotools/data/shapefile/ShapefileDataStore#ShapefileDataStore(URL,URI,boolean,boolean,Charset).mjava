	/**
     * this sets the datastore's namespace during construction (so the schema -
     * FeatureType - will have the correct value) You can call this with
     * namespace = null, but I suggest you give it an actual namespace.
     * 
     * @param url
     * @param namespace
     * @param useMemoryMapped
     * @param dbfCharset
     */
    public ShapefileDataStore(URL url, URI namespace, boolean useMemoryMapped,
            boolean cacheMemoryMap, Charset dbfCharset) throws java.net.MalformedURLException {
        this.namespace = namespace;
        shpFiles = new ShpFiles(url);
        if (!isLocal() || !shpFiles.exists(SHP)) {
            this.useMemoryMappedBuffer = false;
        } else {
            this.useMemoryMappedBuffer = useMemoryMapped;
        }
        shpFiles.setMemoryMapCacheEnabled(this.useMemoryMappedBuffer && cacheMemoryMap);
        this.dbfCharset = dbfCharset;
        if(TRACE_ENABLED) {
        	trace = new Exception();
        	trace.fillInStackTrace();
        }
    }

