    private void finishLastWrite() throws IOException {
        while (hasNext()) {
            next();
        }

        if (current != -1) {
            write();
        }

        drain();
        writeHeader();
    }

