    private void checkFieldNames(
            Fields fields, FeatureSource<SimpleFeatureType, SimpleFeature> source) {
        int i = 0;
        SimpleFeatureType schema = source.getSchema();
        for (AttributeDescriptor descriptor : schema.getAttributeDescriptors()) {
            String name = descriptor.getLocalName();
            if (name.equals("the_geom")) continue;
            assertThat(name, is(equalTo(fields.names.get(i))));
            i++;
        }
    }

