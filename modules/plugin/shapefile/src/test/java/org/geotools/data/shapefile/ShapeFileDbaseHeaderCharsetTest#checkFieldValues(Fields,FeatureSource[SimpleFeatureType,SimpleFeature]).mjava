    private void checkFieldValues(
            Fields fields, FeatureSource<SimpleFeatureType, SimpleFeature> source)
            throws IOException {
        Filter filter = Filter.INCLUDE;
        FeatureCollection<SimpleFeatureType, SimpleFeature> collection = source.getFeatures(filter);

        int j = 0;
        try (FeatureIterator<SimpleFeature> features = collection.features()) {
            while (features.hasNext()) {
                SimpleFeature feature = features.next();
                Fields.Row row = fields.rows.get(j);
                int k = 0;
                for (Property attribute : feature.getProperties()) {
                    // a geometry attribute isn't the purpose of this test case
                    if (attribute instanceof GeometryAttribute) continue;
                    String value = (String) attribute.getValue();
                    assertThat(value, is(equalTo(row.get(k))));
                    k++;
                }
                j++;
            }
        }
    }

