    @Test
    public void testFieldFormatter() throws Exception {
        DbaseFileWriter.FieldFormatter formatter =
                new DbaseFileWriter.FieldFormatter(
                        StandardCharsets.UTF_8, TimeZone.getDefault(), false);

        int sizeInBytes = 8;

        // A null string should result in padding
        String formattedString = formatter.getFieldString(sizeInBytes, null);
        assertEquals(sizeInBytes, formattedString.getBytes().length);
        assertEquals("        ", formattedString);

        // A short string will be padded
        formattedString = formatter.getFieldString(sizeInBytes, "cat");
        assertEquals(sizeInBytes, formattedString.getBytes().length);
        assertEquals("cat     ", formattedString);

        // A string that has the right number of bytes needs no padding
        formattedString = formatter.getFieldString(sizeInBytes, "12345678");
        assertEquals(sizeInBytes, formattedString.getBytes().length);
        assertEquals("12345678", formattedString);

        // larger strings get trucated
        formattedString = formatter.getFieldString(sizeInBytes, "12345678910");
        assertEquals(sizeInBytes, formattedString.getBytes().length);
        assertEquals("12345678", formattedString);
    }

