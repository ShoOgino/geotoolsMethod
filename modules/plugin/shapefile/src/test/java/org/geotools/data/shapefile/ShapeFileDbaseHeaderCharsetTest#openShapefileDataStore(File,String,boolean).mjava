    private ShapefileDataStore openShapefileDataStore(
            File shpfile, String charsetName, boolean memoryMapped) throws IOException {
        ShapefileDataStoreFactory dataStoreFactory = new ShapefileDataStoreFactory();
        Map<String, Serializable> params = new HashMap<>();
        params.put("url", shpfile.toURI().toURL());
        if (charsetName != null && !charsetName.isEmpty()) {
            params.put("charset", charsetName);
        }
        if (memoryMapped) {
            params.put("memory mapped buffer", true);
        }
        return (ShapefileDataStore) dataStoreFactory.createDataStore(params);
    }

