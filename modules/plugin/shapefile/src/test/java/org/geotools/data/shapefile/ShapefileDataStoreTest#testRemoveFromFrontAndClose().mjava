    /**
     * Create a test file, then continue removing the first entry until there are no features left.
     */
    @Test
    public void testRemoveFromFrontAndClose() throws Throwable {
        ShapefileDataStore sds = createDataStore();

        int idx = loadFeatures(sds).size();

        while (idx > 0) {
            try (FeatureWriter<SimpleFeatureType, SimpleFeature> writer =
                    sds.getFeatureWriter(
                            sds.getTypeNames()[0], Filter.INCLUDE, Transaction.AUTO_COMMIT)) {
                writer.next();
                // System.out.println(feature);
                writer.remove();
            }
            assertEquals(--idx, loadFeatures(sds).size());
        }
        sds.dispose();
    }

