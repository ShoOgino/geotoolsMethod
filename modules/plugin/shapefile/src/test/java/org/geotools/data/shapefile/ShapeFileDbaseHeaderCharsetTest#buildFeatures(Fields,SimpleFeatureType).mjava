    private List<SimpleFeature> buildFeatures(Fields fields, SimpleFeatureType featureType) {
        List<SimpleFeature> features = new ArrayList<>();
        SimpleFeatureBuilder featureBuilder = new SimpleFeatureBuilder(featureType);
        GeometryFactory geometryFactory = new GeometryFactory();

        double longitude;
        double latitude;

        int rowCount = 0;
        for (Fields.Row row : fields.rows) {
            rowCount++;
            longitude = Double.parseDouble(row.getLongitude());
            latitude = Double.parseDouble(row.getLatitude());

            Point point = geometryFactory.createPoint(new Coordinate(longitude, latitude));
            featureBuilder.add(point);
            for (int k = 0; k < row.size(); k++) {
                String fieldName = fields.names.get(k);
                String fieldValue = row.get(k);
                featureBuilder.set(fieldName, fieldValue);
            }
            SimpleFeature feature = featureBuilder.buildFeature("" + rowCount);
            features.add(feature);
        }

        return features;
    }

