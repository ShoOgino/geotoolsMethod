    @Test
    public void testGMLJP2Geographic() throws Exception {
        // GMLJP2 parsing is available only when Kakadu is enabled
        if (!testingEnabled() || !KakaduUtilities.isKakaduAvailable()) {
            throw new AssumptionViolatedException("Testing not enabled or Kakadu not available");
        }

        File file = getInputFile("sample_gml.jp2");

        // check georeferencing has been loaded properly
        final AbstractGridCoverage2DReader reader = new JP2KReader(file);
        final int nCov = reader.getGridCoverageCount();
        assertEquals(nCov, 1);
        CoordinateReferenceSystem expected = CRS.decode("EPSG:4326", true);
        assertTrue(CRS.equalsIgnoreMetadata(expected, reader.getCoordinateReferenceSystem()));
        GeneralEnvelope envelope = reader.getOriginalEnvelope();
        final double EPS = 1e-6;
        assertEquals(-180, envelope.getMinimum(0), EPS);
        assertEquals(180, envelope.getMaximum(0), EPS);
        assertEquals(-90, envelope.getMinimum(1), EPS);
        assertEquals(90, envelope.getMaximum(1), EPS);
    }

