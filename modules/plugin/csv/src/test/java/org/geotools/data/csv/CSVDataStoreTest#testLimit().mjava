    /**
     * Test query with maxFeatures
     *
     * @throws IOException
     * @throws FileNotFoundException
     */
    @Test
    public void testLimit() throws FileNotFoundException, IOException {
        Query query = new Query(Query.ALL);
        query.setMaxFeatures(3);
        SimpleFeatureSource rows = csvDataStore.getFeatureSource();
        SimpleFeatureCollection matches = rows.getFeatures(query);
        List<String> limitCities = Arrays.asList("Trento", "St Paul", "Bangkok");
        int count = 0;
        try (SimpleFeatureIterator iter = matches.features()) {
            while (iter.hasNext()) {
                SimpleFeature f = iter.next();
                String city = (String) f.getAttribute("CITY");

                assertTrue("Didn't find " + city, limitCities.contains(city));
                count++;
            }
        }
        assertEquals(3, count);
        assertEquals(3, matches.size());
        assertEquals(3, rows.getCount(query));
    }

