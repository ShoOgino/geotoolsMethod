    @Override
    public FileDataStore createDataStore(Map<String, ?> params) throws IOException {
        File file = fileFromParams(params);
        if (file == null) {
            throw new IllegalArgumentException(
                    "Could not find file from params to create csv data store");
        }
        String path = file.getPath();
        if (path.startsWith("file:")) {
            file = new File(path.replace("file:", ""));
        }

        URI namespace = (URI) NAMESPACEP.lookUp(params);
        return createDataStoreFromFile(file, namespace, params);
    }

