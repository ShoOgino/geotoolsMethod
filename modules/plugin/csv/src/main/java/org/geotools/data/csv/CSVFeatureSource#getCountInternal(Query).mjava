    @Override
    protected int getCountInternal(Query query) throws IOException {
        try (FeatureReader<SimpleFeatureType, SimpleFeature> featureReader =
                getReaderInternal(query)) {
            int n = 0;
            while (featureReader.hasNext()) {
                featureReader.next();
                n++;
            }
            return n;
        }
    }

