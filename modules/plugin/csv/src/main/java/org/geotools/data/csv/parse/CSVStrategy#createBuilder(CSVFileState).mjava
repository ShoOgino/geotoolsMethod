    /**
     * Originally in a strategy support class - giving a chance to override them to improve
     * efficiency and utilise the different strategies
     */
    public static SimpleFeatureTypeBuilder createBuilder(CSVFileState csvFileState) {
        Map<String, Class<?>> typesFromData;
        String[] headers;
        try (CSVReader csvReader = csvFileState.openCSVReader()) {
            headers = csvFileState.getCSVHeaders();
            typesFromData = findMostSpecificTypesFromData(csvReader, headers);
        } catch (IOException | CsvValidationException e) {
            throw new RuntimeException("Failure reading csv file", e);
        }
        return createBuilder(csvFileState, headers, typesFromData);
    }

