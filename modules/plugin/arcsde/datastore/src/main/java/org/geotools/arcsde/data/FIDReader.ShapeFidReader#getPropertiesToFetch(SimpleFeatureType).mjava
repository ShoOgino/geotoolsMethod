        /**
         * Overrides to include the geometry column whether it is required by the {@code schema} or
         * not, since we need to get the fid from the geometry id.
         */
        @Override
        public String[] getPropertiesToFetch(SimpleFeatureType schema) throws IOException {
            List<String> attNames = new ArrayList<String>(schema.getAttributeCount() + 1);

            // /List attDescriptors = Descriptors.nodes(schema.getDescriptor());
            List<AttributeDescriptor> attDescriptors = schema.getAttributeDescriptors();
            for (AttributeDescriptor property : attDescriptors) {
                attNames.add(property.getLocalName());
            }

            shapeIndex = attNames.indexOf(shapeColName);
            if (shapeIndex == -1) {
                String fidColumn = getFidColumn();
                int fidIndex = attNames.indexOf(shapeColName);
                if (fidIndex == -1) {
                    attNames.add(fidColumn);
                    fidIndex = attNames.size() - 1;
                }
                setColumnIndex(fidIndex);
            }
            return attNames.toArray(new String[attNames.size()]);
        }

