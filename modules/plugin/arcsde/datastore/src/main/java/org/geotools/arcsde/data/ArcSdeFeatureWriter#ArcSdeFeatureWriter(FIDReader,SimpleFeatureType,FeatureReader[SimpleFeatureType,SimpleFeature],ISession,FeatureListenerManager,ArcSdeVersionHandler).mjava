    public ArcSdeFeatureWriter(final FIDReader fidReader, final SimpleFeatureType featureType,
            final FeatureReader<SimpleFeatureType, SimpleFeature> filteredContent,
            final ISession session, final FeatureListenerManager listenerManager,
            final ArcSdeVersionHandler versionHandler) throws IOException {

        assert fidReader != null;
        assert featureType != null;
        assert filteredContent != null;
        assert session != null;
        assert listenerManager != null;
        assert versionHandler != null;

        if (!(fidReader instanceof FIDReader.SdeManagedFidReader || fidReader instanceof FIDReader.UserManagedFidReader)) {
            throw new DataSourceException("fid reader is not user nor sde managed: " + fidReader);
        }

        this.fidReader = fidReader;
        this.featureType = featureType;
        this.filteredContent = filteredContent;
        this.session = session;
        this.listenerManager = listenerManager;
        this.featureBuilder = new SimpleFeatureBuilder(featureType);
        this.versionHandler = versionHandler;
    }

