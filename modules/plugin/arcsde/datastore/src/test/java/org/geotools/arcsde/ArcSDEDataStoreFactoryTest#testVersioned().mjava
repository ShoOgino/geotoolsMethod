    @Test
    public void testVersioned() throws IOException, UnavailableConnectionException {
        ISession session = testData.getConnectionPool().getSession(true);
        final String versionName = "testVersioned";
        try {
            testData.createVersion(session, versionName,
                    SeVersion.SE_QUALIFIED_DEFAULT_VERSION_NAME);
        } finally {
            session.dispose();
        }

        Map<String, Serializable> paramsWithVersion = new HashMap<String, Serializable>(
                workingParams);
        paramsWithVersion.put(VERSION_PARAM_NAME, versionName);
        DataStore ds = dsFactory.createDataStore(paramsWithVersion);
        assertNotNull(ds);
        ds.dispose();

        String qualifiedVersionName = session.getUser() + "." + versionName;
        paramsWithVersion.put(VERSION_PARAM_NAME, qualifiedVersionName);
        ds = dsFactory.createDataStore(paramsWithVersion);
        assertNotNull(ds);
        ds.dispose();

        // version name should be case insensitive
        // EDIT: version name is NOT case sensitive, at least for sde10/oracle
        // qualifiedVersionName = qualifiedVersionName.toUpperCase();
        // paramsWithVersion.put(VERSION_PARAM_NAME, qualifiedVersionName);
        // ds = dsFactory.createDataStore(paramsWithVersion);
        // assertNotNull(ds);
        // ds.dispose();

        // qualifiedVersionName = qualifiedVersionName.toLowerCase();
        // paramsWithVersion.put(VERSION_PARAM_NAME, qualifiedVersionName);
        // ds = dsFactory.createDataStore(paramsWithVersion);
        // assertNotNull(ds);
        // ds.dispose();
    }

