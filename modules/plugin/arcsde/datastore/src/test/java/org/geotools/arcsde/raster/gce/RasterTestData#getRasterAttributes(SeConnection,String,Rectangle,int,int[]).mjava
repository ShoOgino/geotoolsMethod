    public SeRasterAttr getRasterAttributes(
            SeConnection conn,
            final String rasterName,
            final Rectangle tiles,
            final int level,
            final int[] bands)
            throws IOException {

        try {
            final SeQuery query =
                    new SeQuery(conn, new String[] {"RASTER"}, new SeSqlConstruct(rasterName));
            query.prepareQuery();
            query.execute();
            final SeRow r = query.fetch();

            // Now build a SeRasterConstraint object which queries the db for
            // the right tiles/bands/pyramid level
            SeRasterConstraint rConstraint = new SeRasterConstraint();
            rConstraint.setEnvelope(
                    (int) tiles.getMinX(),
                    (int) tiles.getMinY(),
                    (int) tiles.getMaxX(),
                    (int) tiles.getMaxY());
            rConstraint.setLevel(level);
            rConstraint.setBands(bands);

            // Finally, execute the raster query aganist the already-opened
            // SeQuery object which already has an SeRow fetched against it.

            query.queryRasterTile(rConstraint);
            final SeRasterAttr rattr = r.getRaster(0);

            query.close();

            return rattr;
        } catch (SeException e) {
            throw new ArcSdeException(e);
        }
    }

