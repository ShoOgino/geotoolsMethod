    /** */
    private static SeColumnDefinition[] createBaseTable(
            final ISession session,
            final SeTable table,
            final SeLayer layer,
            final String configKeyword)
            throws IOException {

        Command<SeColumnDefinition[]> createTableCmd =
                new Command<SeColumnDefinition[]>() {

                    @Override
                    public SeColumnDefinition[] execute(ISession session, SeConnection connection)
                            throws SeException, IOException {

                        SeColumnDefinition[] colDefs = getTestTableCols();

                        try {
                            table.delete();
                        } catch (Exception e) {
                            // ignore
                        }
                        /*
                         * Create the table using the DBMS default configuration keyword. Valid keywords are
                         * defined in the dbtune table.
                         */
                        table.create(colDefs, configKeyword);

                        /*
                         * Register the column to be used as feature id and managed by sde
                         */
                        SeRegistration reg = new SeRegistration(connection, table.getName());
                        LOGGER.fine(
                                "setting rowIdColumnName to ROW_ID in table " + reg.getTableName());
                        reg.setRowIdColumnName("ROW_ID");
                        final int rowIdColumnType =
                                SeRegistration.SE_REGISTRATION_ROW_ID_COLUMN_TYPE_SDE;
                        reg.setRowIdColumnType(rowIdColumnType);
                        reg.alter();

                        /*
                         * Define the attributes of the spatial column
                         */
                        layer.setSpatialColumnName("SHAPE");

                        /*
                         * Set the type of shapes that can be inserted into the layer. Shape type can be
                         * just one or many. NOTE: Layers that contain more than one shape type can only be
                         * accessed through the C and Java APIs and Arc Explorer Java 3.x. They cannot be
                         * seen from ArcGIS desktop applications.
                         */
                        layer.setShapeTypes(
                                SeLayer.SE_NIL_TYPE_MASK
                                        | SeLayer.SE_POINT_TYPE_MASK
                                        | SeLayer.SE_LINE_TYPE_MASK
                                        | SeLayer.SE_SIMPLE_LINE_TYPE_MASK
                                        | SeLayer.SE_AREA_TYPE_MASK
                                        | SeLayer.SE_MULTIPART_TYPE_MASK);
                        layer.setGridSizes(1100.0, 0.0, 0.0);
                        layer.setDescription("Layer Example");

                        /*
                         * Define the layer's Coordinate Reference
                         */
                        SeCoordinateReference coordref = getGenericCoordRef();

                        // SeExtent ext = new SeExtent(-1000000.0, -1000000.0,
                        // 1000000.0,
                        // 1000000.0);
                        SeExtent ext = coordref.getXYEnvelope();
                        layer.setExtent(ext);
                        layer.setCoordRef(coordref);

                        layer.setCreationKeyword(configKeyword);

                        /*
                         * Spatially enable the new table...
                         */
                        layer.create(3, 4);

                        return colDefs;
                    }
                };
        SeColumnDefinition[] colDefs = session.issue(createTableCmd);
        return colDefs;
    }

