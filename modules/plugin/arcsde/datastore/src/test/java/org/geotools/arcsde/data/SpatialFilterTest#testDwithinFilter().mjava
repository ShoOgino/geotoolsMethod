    @Test
    public void testDwithinFilter() throws Exception {
        FeatureType ft = this.dataStore.getSchema(testData.getTempTableName());

        // Available geometries:
        // 1. POINT(0 0)
        // 2. MULTIPOINT(0 0, 170 0)
        // 3. LINESTRING(0 0, 170 80)
        // 4. MULTILINESTRING((-170 -80, 170 80), (-170 80, 170 -80))
        // 5. POLYGON((-10 -10, -10 10, 10 10, 10 -10, -10 -10))
        // 6. MULTIPOLYGON( ((-1 -1, -1 1, 1 1, 1 -1, -1 -1)), ((-170 -80, -170 -70, -160 -70, -160
        // -80, -170 -80)) )
        // 7. POINT EMPTY
        // 8. null

        final PropertyName property = ff.property("SHAPE");
        Geometry geom;
        Filter filter;

        geom = geom("POINT(170 0)");
        filter = ff.dwithin(property, ff.literal(geom), 1d, "");
        runTestWithFilter(ft, filter, false, 1);

        geom = geom("POINT(-1 -1)");
        filter = ff.dwithin(property, ff.literal(geom), 0.1, "");
        runTestWithFilter(ft, filter, false, 2); // geoms 4. and 6.
    }

