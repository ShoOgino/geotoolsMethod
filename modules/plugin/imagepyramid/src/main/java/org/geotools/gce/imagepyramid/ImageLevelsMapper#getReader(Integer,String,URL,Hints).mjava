    protected ImageMosaicReader getReader(
            Integer imageChoice, String coverageName, URL sourceURL, Hints hints)
            throws IOException {
        int imageIndex = getImageReaderIndex(imageChoice);
        // light check to see if this reader had been disposed, not synching for performance.
        if (readers == null) {
            throw new IllegalStateException("This ImagePyramidReader has already been disposed");
        }
        ImageMosaicReader reader = readers.get(imageIndex);

        if (reader == null) {

            //
            // we must create the underlying mosaic
            //
            final String levelDirName = levelsDirs[imageIndex];
            final URL parentUrl = URLs.getParentUrl(sourceURL);
            // look for a shapefile first
            final String extension =
                    new StringBuilder(levelDirName)
                            .append("/")
                            .append(coverageName)
                            .append(".shp")
                            .toString();
            final URL shpFileUrl = URLs.extendUrl(parentUrl, extension);
            if (shpFileUrl.getProtocol() != null
                    && shpFileUrl.getProtocol().equalsIgnoreCase("file")
                    && !URLs.urlToFile(shpFileUrl).exists()) {
                reader = new ImageMosaicReader(URLs.extendUrl(parentUrl, levelDirName), hints);
            } else {
                reader = new ImageMosaicReader(shpFileUrl, hints);
            }
            final ImageMosaicReader putByOtherThreadJustNow =
                    readers.putIfAbsent(imageIndex, reader);
            if (putByOtherThreadJustNow != null) {
                // some other thread just did inserted this
                try {
                    reader.dispose();
                } catch (Exception e) {
                    if (LOGGER.isLoggable(Level.FINE)) {
                        LOGGER.log(Level.FINE, e.getLocalizedMessage(), e);
                    }
                }

                // use the other one
                reader = putByOtherThreadJustNow;
            }
        }
        return reader;
    }

