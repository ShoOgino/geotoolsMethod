    /**
     * Sets up the authority factory.
     *
     * @throws SQLException If the connection to the database failed.
     */
    @Before
    public void setUp() throws Exception {
        if (factory == null) {
            factory =
                    (ThreadedEpsgFactory)
                            ReferencingFactoryFinder.getCRSAuthorityFactory(
                                    "EPSG",
                                    new Hints(
                                            Hints.CRS_AUTHORITY_FACTORY,
                                            ThreadedEpsgFactory.class));
            extensive |= TestData.isExtensiveTest();
            if (verbose) {
                System.out.print("Database version: ");
                System.out.println(factory.getImplementationHints().get(Hints.VERSION));
            }
        }
        // calling dispose clears all the caches, making tests runs independent of each other
        factory.dispose();
        // No 'tearDown()' method: we rely on the DefaultFactory shutdown hook.
    }

