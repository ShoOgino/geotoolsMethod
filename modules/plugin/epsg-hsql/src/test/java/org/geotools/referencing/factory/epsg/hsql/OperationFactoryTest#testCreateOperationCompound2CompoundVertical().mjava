    /**
     * Tests findOperations method for CompoundCRS with a VerticalCRS component using the same datum
     * for the horizontal component. EPSG:5555 (Projected+Vertical) to EPSG:5554
     * (Projected+Vertical) using same datum. EPSG:25831+EPSG:5783 (Projected+Vertical) to EPSG:5554
     * (Projected+Vertical) using same datum.
     */
    @Test
    public void testCreateOperationCompound2CompoundVertical() throws Exception {
        final CRSAuthorityFactory crsAuthFactory;
        final CoordinateOperationFactory opFactory;
        CoordinateReferenceSystem sourceCRS, sourceHorizontalCRS, sourceVerticalCRS;
        CoordinateReferenceSystem targetCRS;
        CoordinateOperation operation;
        Map<String, Object> properties;
        CoordinateReferenceSystem[] elements;

        CRSFactory crsFactory = ReferencingFactoryFinder.getCRSFactory(null);
        crsAuthFactory = ReferencingFactoryFinder.getCRSAuthorityFactory("EPSG", null);
        opFactory = ReferencingFactoryFinder.getCoordinateOperationFactory(null);

        sourceCRS = crsAuthFactory.createCoordinateReferenceSystem("EPSG:5555");
        targetCRS = crsAuthFactory.createCoordinateReferenceSystem("EPSG:5554");
        // direct order
        operation = opFactory.createOperation(sourceCRS, targetCRS);
        assertOperation(operation, sourceCRS, targetCRS);

        // try reverse order
        operation = opFactory.createOperation(targetCRS, sourceCRS);
        assertOperation(operation, targetCRS, sourceCRS);

        sourceHorizontalCRS = crsAuthFactory.createCoordinateReferenceSystem("EPSG:25831");
        sourceVerticalCRS = crsAuthFactory.createCoordinateReferenceSystem("EPSG:5783");
        properties = new HashMap<>();
        properties.put(
                IdentifiedObject.NAME_KEY,
                new NamedIdentifier(Citations.fromName("TEST"), "Compound 28530+5783"));
        elements = new CoordinateReferenceSystem[] {sourceHorizontalCRS, sourceVerticalCRS};
        sourceCRS = crsFactory.createCompoundCRS(properties, elements);

        // direct order
        operation = opFactory.createOperation(sourceCRS, targetCRS);
        assertOperation(operation, sourceCRS, targetCRS);

        // try reverse order
        operation = opFactory.createOperation(targetCRS, sourceCRS);
        assertOperation(operation, targetCRS, sourceCRS);
    }

