    private static MemoryDataStore createMemStoreVertical(
            SimpleFeatureType typ, String name, String fname) throws IOException {
        MemoryDataStore memDS = new MemoryDataStore();

        List<AttributeDescriptor> attrs = new ArrayList<AttributeDescriptor>();
        attrs.addAll(typ.getAttributeDescriptors());
        // have a non linear mapping between source attributes and target attributes
        Collections.shuffle(attrs, new Random(1));

        SimpleFeatureTypeImpl sft =
                new SimpleFeatureTypeImpl(
                        new NameImpl(fname),
                        attrs,
                        typ.getGeometryDescriptor(),
                        typ.isAbstract(),
                        typ.getRestrictions(),
                        typ.getSuper(),
                        typ.getDescription());

        memDS.createSchema(sft);
        REPOSITORY.register(name, memDS);
        return memDS;
    }

