    protected void testGetCount(String configName) {

        try {

            PreGeneralizedDataStore ds = getDataStore(configName);

            SimpleFeatureSource fs = ds.getFeatureSource("GenStreams");
            assertTrue(fs.getSupportedHints().contains(Hints.GEOMETRY_DISTANCE));

            Filter filter = CQL.toFilter("CAT_ID = 2");

            Query[] queries = new Query[2];
            queries[0] = new Query("GenStreams");
            queries[1] = new Query("GenStreams", filter);

            for (Query q : queries) {

                q.getHints().put(Hints.GEOMETRY_DISTANCE, 1.0);
                int count = fs.getCount(q);

                q.getHints().put(Hints.GEOMETRY_DISTANCE, 5.0);
                assertTrue(count == fs.getCount(q));

                q.getHints().put(Hints.GEOMETRY_DISTANCE, 10.0);
                assertTrue(count == fs.getCount(q));

                q.getHints().put(Hints.GEOMETRY_DISTANCE, 20.0);
                assertTrue(count == fs.getCount(q));

                q.getHints().put(Hints.GEOMETRY_DISTANCE, 25.0);
                assertTrue(count == fs.getCount(q));
            }
        } catch (Exception ex) {
            Assert.fail(ex.getMessage());
        }
    }

