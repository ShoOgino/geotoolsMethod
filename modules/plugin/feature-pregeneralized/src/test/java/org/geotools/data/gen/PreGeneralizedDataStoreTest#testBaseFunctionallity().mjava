    @Test
    public void testBaseFunctionallity() {

        GeneralizationInfosProvider provider = new GeneralizationInfosProviderImpl();
        GeneralizationInfos ginfos = null;
        try {
            ginfos = provider.getGeneralizationInfos("src/test/resources/geninfo_only_base.xml");
            PreGeneralizedDataStore ds = new PreGeneralizedDataStore(ginfos, TestSetup.REPOSITORY);

            String typeName = ds.getTypeNames()[0];
            Assert.assertEquals("GenStreams", typeName);
            Query query = new Query(typeName);

            try (FeatureReader<SimpleFeatureType, SimpleFeature> reader =
                    ds.getFeatureReader(query, Transaction.AUTO_COMMIT)) {
                Assert.assertNotNull(reader);
            }

            SimpleFeatureSource fsource = ds.getFeatureSource(typeName);
            Assert.assertNotNull(fsource);

            fsource = ds.getFeatureSource(new NameImpl(typeName));
            Assert.assertNotNull(fsource);

            ServiceInfo si = ds.getInfo();
            Assert.assertNotNull(si);
            // System.out.println(si);

            List<Name> names = ds.getNames();
            Assert.assertTrue(names.contains(new NameImpl(typeName)));
            Assert.assertEquals("GenStreams", ds.getNames().get(0).getLocalPart());

            fsource = DataUtilities.createView(ds, query);
            Assert.assertNotNull(fsource);

            Assert.assertNotNull(ds.getSchema(typeName));
            Assert.assertNotNull(ds.getSchema(new NameImpl(typeName)));

            ds.dispose();
        } catch (Exception e) {
            java.util.logging.Logger.getGlobal().log(java.util.logging.Level.INFO, "", e);
            Assert.fail();
        }
    }

