    @Override
    public <O> O[] toArray(O[] a) {
        O[] res = backendCollection.toArray(a);
        for (int i = 0; i < res.length; i++) {
            @SuppressWarnings("unchecked")
            O cast =
                    (O)
                            new PreGeneralizedSimpleFeature(
                                    getSchema(),
                                    getSchema(),
                                    indexMapping,
                                    (SimpleFeature) res[i],
                                    geomPropertyName,
                                    backendGeomPropertyName);
            res[i] = cast;
        }
        return res;
    }

