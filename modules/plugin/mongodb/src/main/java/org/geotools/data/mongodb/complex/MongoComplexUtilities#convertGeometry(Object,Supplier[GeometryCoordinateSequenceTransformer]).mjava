    /**
     * Helper method that checks if a mongodb value is a geometry and perform the proper conversion.
     */
    private static Object convertGeometry(
            Object value, Supplier<GeometryCoordinateSequenceTransformer> transformer) {
        if (!(value instanceof DBObject) || value instanceof List) {
            // not a mongodb object or a list of values so nothing to do
            return value;
        }
        DBObject object = (DBObject) value;
        Set keys = object.keySet();
        if (keys.size() != 2 || !keys.contains("coordinates") || !keys.contains("type")) {
            // is mongo db object but not a geometry
            return value;
        }
        // we have a geometry so let's try to convert it
        MongoGeometryBuilder builder = new MongoGeometryBuilder();
        try {
            // return the converted geometry
            Geometry geom = builder.toGeometry(object);
            if (transformer != null) {
                geom = transformer.get().transform(geom);
            }
            return geom;
        } catch (Exception exception) {
            // well could not convert the mongo db object to a geometry
        }
        return value;
    }

