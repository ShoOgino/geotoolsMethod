    @Override
    protected FeatureWriter<SimpleFeatureType, SimpleFeature> getWriterInternal(
            Query query, int flags) throws IOException {
        if ((flags & (WRITER_ADD | WRITER_UPDATE | WRITER_COMMIT)) != 0) {
            return new MongoFeatureWriter(delegate.getCollection(), getSchema(), this);
        }
        return null;
    }

