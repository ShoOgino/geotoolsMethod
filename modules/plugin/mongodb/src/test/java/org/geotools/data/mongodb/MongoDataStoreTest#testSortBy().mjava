    public void testSortBy() throws Exception {
        FilterFactory2 ff = CommonFactoryFinder.getFilterFactory2();
        SortBy f = ff.sort("properties.dateProperty", SortOrder.ASCENDING);

        SimpleFeatureSource source = dataStore.getFeatureSource("ft1");

        Query q = new Query("ft1", Filter.INCLUDE);
        q.setSortBy(new SortBy[] {f});

        SimpleFeatureCollection features = source.getFeatures(q);
        try (SimpleFeatureIterator it = features.features()) {
            List<Date> dates = new ArrayList<>(3);
            while (it.hasNext()) {
                dates.add((Date) it.next().getAttribute("properties.dateProperty"));
            }
            assertEquals(dates.size(), 3);
            Date first = dates.get(0);
            Date second = dates.get(1);
            Date third = dates.get(2);
            assertTrue(first.before(second));
            assertTrue(second.before(third));
        }
    }

