    public void testTwoSortByWithNullableAttribute() throws Exception {
        FilterFactory2 ff = CommonFactoryFinder.getFilterFactory2();
        // sort before on nullable so that second sort overcome
        SortBy[] sorts =
                new SortBy[] {
                    ff.sort("properties.nullableAttribute", SortOrder.DESCENDING),
                    ff.sort("properties.dateProperty", SortOrder.ASCENDING),
                };

        SimpleFeatureSource source = dataStore.getFeatureSource("ft1");
        assertTrue(source.getQueryCapabilities().supportsSorting(sorts));
        Query q = new Query("ft1", Filter.INCLUDE);
        q.setSortBy(sorts);

        SimpleFeatureCollection features = source.getFeatures(q);
        SimpleFeatureIterator it = features.features();
        List<Date> dates = new ArrayList<>(3);
        while (it.hasNext()) {
            SimpleFeature feature = it.next();
            dates.add((Date) feature.getAttribute("properties.dateProperty"));
        }
        assertEquals(dates.size(), 3);
        Date first = dates.get(0);
        Date second = dates.get(1);
        Date third = dates.get(2);
        assertTrue(first.before(second));
        assertTrue(second.before(third));
    }

