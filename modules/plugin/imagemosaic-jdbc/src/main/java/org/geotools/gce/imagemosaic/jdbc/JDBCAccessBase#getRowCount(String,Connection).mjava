    /**
     * @param tableName sql table name
     * @param con JDBC Connection
     * @return return number of rows in the table
     * @throws SQLException
     */
    private int getRowCount(String tableName, Connection con) throws SQLException {
        PreparedStatement s = con.prepareStatement("select count(*) from " + tableName);
        ResultSet res = s.executeQuery();
        if (!res.next()) {
            throw new SQLException("Cannot get a count");
        }

        int count = res.getInt(1);
        res.close();
        s.close();

        return count;
    }

