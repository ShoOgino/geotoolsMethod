    @Test
    @SuppressWarnings("PMD.CloseResource")
    public void testWrappedStream() throws Exception {
        // Input geotiff including noData information
        final File input = TestData.file(GeoTiffReaderTest.class, "nodata.tiff");

        // reading the coverage, checking it has nodata
        GeoTiffReader reader = new GeoTiffReader(input);
        GridCoverage2D coverage = reader.read(null);

        final File geotiff = TestData.temp(this, "testfile");

        // The streams will be closed by the writeAndRead method doing a dispose
        FileImageOutputStream fos = new FileImageOutputStream(geotiff);
        OutputStream os = new OutputStreamAdapter(fos);
        GeoTiffWriter writer = new GeoTiffWriter(os);

        // Check the writer is actually using the wrapped ImageOutputStream for writing
        Assert.assertSame(fos, writer.getDestination());

        // Check the write
        writeAndRead(coverage, null, -9999d, geotiff, writer);
    }

