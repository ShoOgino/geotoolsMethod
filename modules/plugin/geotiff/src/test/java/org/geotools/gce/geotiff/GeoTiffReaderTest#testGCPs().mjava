    /** Test that the reader can read a GeoTIFF with GCPs (even if it cannot reference it) */
    @Test
    public void testGCPs() throws Exception {
        // Reading file
        final File file = TestData.file(GeoTiffReaderTest.class, "box_gcp.tif");
        assertNotNull(file);
        final AbstractGridFormat format = new GeoTiffFormat();
        assertTrue(format.accepts(file));
        AbstractGridCoverage2DReader reader = format.getReader(file);
        GridCoverage2D coverage = reader.read(null);

        // Get CRS and transform, they should be 404000 and
        CoordinateReferenceSystem crs = coverage.getCoordinateReferenceSystem();
        assertEquals(AbstractGridFormat.getDefaultCRS(), crs);
        assertEquals(
                ProjectiveTransform.create(new AffineTransform()),
                coverage.getGridGeometry().getGridToCRS());
        // Getting its string definition
        String crsDef = crs.toWKT();
        // Ensure the Unit of Measure define is Meter
        assertTrue(crsDef.contains("UNIT[\"m\", 1.0]"));

        // Ground control points
        GroundControlPoints gcps = reader.getGroundControlPoints();
        assertNotNull(gcps);
        // the tie point CRS has the same size as WGS84)
        GeographicCRS gcrs = (GeographicCRS) gcps.getCoordinateReferenceSystem();
        Ellipsoid ellipsoid = gcrs.getDatum().getEllipsoid();
        assertEquals(
                ellipsoid.getSemiMajorAxis(),
                DefaultGeographicCRS.WGS84.getDatum().getEllipsoid().getSemiMajorAxis(),
                1e-6);
        assertEquals(
                ellipsoid.getInverseFlattening(),
                DefaultGeographicCRS.WGS84.getDatum().getEllipsoid().getInverseFlattening(),
                1e-6);
        // check the tie points
        final double EPS = 1e-9;
        List<TiePoint> tiePoints = gcps.getTiePoints();
        // t1
        assertEquals(49.5005, tiePoints.get(0).getValueAt(0), EPS);
        assertEquals(250.909, tiePoints.get(0).getValueAt(1), EPS);
        assertEquals(-84, tiePoints.get(0).getValueAt(3), EPS);
        assertEquals(33, tiePoints.get(0).getValueAt(4), EPS);
        // t2
        assertEquals(49.5005, tiePoints.get(1).getValueAt(0), EPS);
        assertEquals(51.8182, tiePoints.get(1).getValueAt(1), EPS);
        assertEquals(-84, tiePoints.get(1).getValueAt(3), EPS);
        assertEquals(34, tiePoints.get(1).getValueAt(4), EPS);
        // t3
        assertEquals(248.824, tiePoints.get(2).getValueAt(0), EPS);
        assertEquals(51.8182, tiePoints.get(2).getValueAt(1), EPS);
        assertEquals(-83, tiePoints.get(2).getValueAt(3), EPS);
        assertEquals(34, tiePoints.get(2).getValueAt(4), EPS);
    }

