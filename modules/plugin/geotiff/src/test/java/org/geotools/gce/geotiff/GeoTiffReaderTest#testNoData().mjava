    /** Test that the reader is able to read NoData */
    @Test
    public void testNoData() throws Exception {
        final File file = TestData.file(GeoTiffReaderTest.class, "nodata.tiff");
        assertNotNull(file);
        final AbstractGridFormat format = new GeoTiffFormat();
        GridCoverage2D coverage = format.getReader(file).read(null);
        // Ensure proper NoData is set
        NoDataContainer noDataProperty = CoverageUtilities.getNoDataProperty(coverage);
        assertNotNull(noDataProperty);

        Range nd = noDataProperty.getAsRange();
        assertNotNull(nd);

        assertTrue(nd.isPoint());
        assertEquals(nd.getMin().doubleValue(), -9999, 0.001);
        assertEquals(nd.getMax().doubleValue(), -9999, 0.001);

        // check the image too
        RenderedImage image = coverage.getRenderedImage();
        Object property = image.getProperty(NoDataContainer.GC_NODATA);
        assertThat(property, CoreMatchers.instanceOf(NoDataContainer.class));
        NoDataContainer nc = (NoDataContainer) property;
        assertEquals(-9999, nc.getAsSingleValue(), 0.0001);
    }

