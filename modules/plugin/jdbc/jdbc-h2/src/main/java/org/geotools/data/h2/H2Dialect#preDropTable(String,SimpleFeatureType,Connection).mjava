    @Override
    public void preDropTable(String schemaName, SimpleFeatureType featureType, Connection cx)
            throws SQLException {
        String tableName = featureType.getTypeName();
        Statement st = cx.createStatement();

        try {
            // drop the spatial index
            StringBuffer sql = new StringBuffer();
            sql.append("CALL DropSpatialIndex(");
            if (schemaName == null) {
                sql.append("NULL");
            } else {
                sql.append("'").append(schemaName).append("'");
            }

            sql.append(",'").append(tableName).append("')");
            LOGGER.fine(sql.toString());

            try {
                st.execute(sql.toString());
            } catch (SQLException e) {
                // table may not have had a spatial index
                // TODO: do a better check
                LOGGER.log(Level.FINE, e.getLocalizedMessage(), e);
            }

            // remove the geometry metadata
            sql = new StringBuffer();
            sql.append("CALL DropGeometryColumns(");
            if (schemaName == null) {
                sql.append("NULL");
            } else {
                sql.append("'").append(schemaName).append("'");
            }

            sql.append(",'").append(tableName).append("')");
            LOGGER.fine(sql.toString());

            st.execute(sql.toString());
        } finally {
            dataStore.closeSafe(st);
        }
    }

