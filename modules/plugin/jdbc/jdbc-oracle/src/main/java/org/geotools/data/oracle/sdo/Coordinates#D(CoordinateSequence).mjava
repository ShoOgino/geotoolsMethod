    public static int D(CoordinateSequence cs) {
        if (cs instanceof CoordinateAccess) {
            return ((CoordinateAccess) cs).getDimension();
        }

        if (cs.size() > 0) {
            return Double.isNaN(cs.getCoordinate(0).getZ()) ? 2 : 3;
        }

        return 3;
    }

