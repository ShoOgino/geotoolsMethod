    /**
     * Reads the SRID from the geometry metadata table, if available
     */
    private Integer lookupSRIDOnMetadataTable(String schema, String tableName, String columnName, Connection cx) throws SQLException {
        if(geometryMetadataTable == null) {
            return null;
        }
        
        // setup the sql to use for the ALL_SDO table
        String metadataTableStatement = "SELECT SRID FROM " + geometryMetadataTable 
                + " WHERE F_TABLE_NAME = '" + tableName + "'" 
                + " AND F_GEOMETRY_COLUMN = '" + columnName + "'";

        if(schema != null && !"".equals(schema)) {
            metadataTableStatement += " AND F_TABLE_SCHEMA = '" + schema + "'";
        }
        
        return readIntegerFromStatement(cx, metadataTableStatement);
    }

