    /** Reads the SRID from the geometry metadata table, if available */
    private Integer lookupSRIDOnMetadataTable(
            String schema, String tableName, String columnName, Connection cx) throws SQLException {
        if (geometryMetadataTable == null) {
            return null;
        }

        List<String> parameters = new ArrayList<String>();

        // setup the sql to use for the ALL_SDO table
        String metadataTableStatement =
                "SELECT SRID FROM "
                        + geometryMetadataTable
                        + " WHERE F_TABLE_NAME = ?"
                        + " AND F_GEOMETRY_COLUMN = ?";

        parameters.add(tableName);
        parameters.add(columnName);

        if (schema != null && !"".equals(schema)) {
            metadataTableStatement += " AND F_TABLE_SCHEMA = ?";
            parameters.add(schema);
        }

        return readIntegerFromStatement(cx, metadataTableStatement, parameters);
    }

