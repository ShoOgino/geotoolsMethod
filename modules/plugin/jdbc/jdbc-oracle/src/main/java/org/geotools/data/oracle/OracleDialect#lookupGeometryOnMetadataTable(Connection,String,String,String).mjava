    /**
     * Tries to use the geometry metadata table, if available
     * @param cx
     * @param tableName
     * @param columnName
     * @param schema
     * @return
     * @throws SQLException
     */
    private Class<?> lookupGeometryOnMetadataTable(Connection cx, String tableName,
            String columnName, String schema) throws SQLException {
        if(geometryMetadataTable == null) {
            return null;
        }
        
        // setup the sql to use for the ALL_SDO table
        String metadataTableStatement = "SELECT TYPE FROM " + geometryMetadataTable 
                + " WHERE F_TABLE_NAME = '" + tableName + "'" 
                + " AND F_GEOMETRY_COLUMN = '" + columnName + "'";

        if(schema != null && !"".equals(schema)) {
            metadataTableStatement += " AND F_TABLE_SCHEMA = '" + schema + "'";
        }
        
        return readGeometryClassFromStatement(cx, metadataTableStatement);
    }

