    /**
     * Writes a {@link Geometry} to an {@link OutStream}.
     *
     * @param geom the geometry to write
     * @param os the out stream to write to
     * @throws IOException if an I/O error occurs
     */
    public void write(Geometry geom, OutStream os) throws IOException
    {
       outputDimension=guessCoordinateDimension(geom); 
        
      if (geom instanceof Point)
        writePoint((Point) geom, os);
      // LinearRings will be written as LineStrings
      else if (geom instanceof LineString)
        writeLineString((LineString) geom, os);
      else if (geom instanceof Polygon)
        writePolygon((Polygon) geom, os);
      else if (geom instanceof MultiPoint)
        writeGeometryCollection(DB2WKBConstants.wkbMultiPoint2D, (MultiPoint) geom, os);
      else if (geom instanceof MultiLineString)
        writeGeometryCollection(DB2WKBConstants.wkbMultiLineString2D,
            (MultiLineString) geom, os);
      else if (geom instanceof MultiPolygon)
        writeGeometryCollection(DB2WKBConstants.wkbMultiPolygon2D,
            (MultiPolygon) geom, os);
      else if (geom instanceof GeometryCollection)
        writeGeometryCollection(DB2WKBConstants.wkbGeomCollection2D,
            (GeometryCollection) geom, os);
      else {
        Assert.shouldNeverReachHere("Unknown Geometry type");
      }
    }

