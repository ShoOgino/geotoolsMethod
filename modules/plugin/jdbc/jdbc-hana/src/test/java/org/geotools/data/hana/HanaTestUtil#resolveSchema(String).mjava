    public String resolveSchema(String schemaName) throws SQLException {
        if (schemaName == null) {
            Statement stmt = null;
            ResultSet rs = null;
            try {
                stmt = conn.createStatement();
                rs = stmt.executeQuery("SELECT CURRENT_SCHEMA FROM DUMMY");
                if (!rs.next()) {
                    throw new AssertionError();
                }
                schemaName = rs.getString(1);
            } finally {
                safeClose(rs);
                safeClose(stmt);
            }
        }
        return schemaName;
    }

