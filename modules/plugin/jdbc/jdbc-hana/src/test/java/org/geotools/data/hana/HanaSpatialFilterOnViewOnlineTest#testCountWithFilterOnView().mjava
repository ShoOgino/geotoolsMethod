    public void testCountWithFilterOnView() throws Exception {
        GeometryFactory gf = new GeometryFactory();
        PackedCoordinateSequenceFactory sf = new PackedCoordinateSequenceFactory();
        LinearRing shell =
                gf.createLinearRing(sf.create(new double[] {0, 0, 4, 0, 4, 4, 0, 4, 0, 0}, 2));
        Polygon polygon = gf.createPolygon(shell, null);
        FilterFactory2 ff = CommonFactoryFinder.getFilterFactory2(null);
        Intersects intersects = ff.intersects(ff.property(aname("geom")), ff.literal(polygon));
        Query q = new Query(aname("geom"), intersects);
        int count = dataStore.getFeatureSource(tname("viewoftab")).getCount(q);
        assertEquals(1, count);
    }

