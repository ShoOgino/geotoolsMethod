    @SuppressWarnings("PMD.CloseResource") // try-with-resources would be nicer
    public boolean viewExists(String schemaName, String viewName) throws SQLException {
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            if (schemaName == null) {
                ps =
                        conn.prepareStatement(
                                "SELECT COUNT(*) FROM PUBLIC.VIEWS WHERE SCHEMA_NAME = CURRENT_SCHEMA AND VIEW_NAME = ?");
                ps.setString(1, viewName);
            } else {
                ps =
                        conn.prepareStatement(
                                "SELECT COUNT(*) FROM PUBLIC.VIEWS WHERE SCHEMA_NAME = ? AND VIEW_NAME = ?");
                ps.setString(1, schemaName);
                ps.setString(2, viewName);
            }
            rs = ps.executeQuery();
            if (!rs.next()) {
                throw new AssertionError();
            }
            int count = rs.getInt(1);
            return (count == 1);
        } finally {
            safeClose(rs);
            safeClose(ps);
        }
    }

