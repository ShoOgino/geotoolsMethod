    public void insertFieldsIntoTable(
            String schemaName, String tableName, Object... fieldsAndValues) throws SQLException {
        int numFields = fieldsAndValues.length / 2;
        StringBuilder sql = new StringBuilder();
        sql.append("INSERT INTO ");
        encodeIdentifiers(sql, schemaName, tableName);
        sql.append(" (");
        for (int i = 0; i < numFields; ++i) {
            if (i > 0) {
                sql.append(", ");
            }
            String name = (String) fieldsAndValues[i];
            encodeIdentifiers(sql, name);
        }
        sql.append(") VALUES (");
        for (int i = numFields; i < fieldsAndValues.length; ++i) {
            if (i > numFields) {
                sql.append(", ");
            }
            addObject(sql, fieldsAndValues[i]);
        }
        sql.append(")");
        execute(sql.toString());
    }

