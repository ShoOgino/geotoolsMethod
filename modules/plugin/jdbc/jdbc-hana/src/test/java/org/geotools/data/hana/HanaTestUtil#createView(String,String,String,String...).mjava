    public void createView(
            String schemaName, String viewName, String sourceTableName, String... selectedFields)
            throws SQLException {
        StringBuilder sql = new StringBuilder();
        sql.append("CREATE VIEW ");
        encodeIdentifiers(sql, schemaName, viewName);
        sql.append(" AS SELECT ");
        if (selectedFields.length == 0) {
            sql.append("*");
        } else {
            for (int i = 0; i < selectedFields.length; ++i) {
                if (i > 0) {
                    sql.append(", ");
                }
                encodeIdentifiers(sql, selectedFields[i]);
            }
        }
        sql.append(" FROM ");
        encodeIdentifiers(sql, schemaName, sourceTableName);
        execute(sql.toString());
    }

