        private byte[] decodeHex(String s) {
            int l = s.length();
            if ((l % 2) != 0) throw new IllegalArgumentException("Invalid hexstring length");
            byte[] ret = new byte[l / 2];
            for (int i = 0; i < l; i += 2) {
                int hi = hexToBin(s.charAt(i));
                int lo = hexToBin(s.charAt(i + 1));
                ret[i / 2] = (byte) (16 * hi + lo);
            }
            return ret;
        }

