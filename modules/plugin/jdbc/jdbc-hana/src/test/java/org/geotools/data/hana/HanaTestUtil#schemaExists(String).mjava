    public boolean schemaExists(String schemaName) throws SQLException {
        if (schemaName == null) {
            return true;
        }
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            ps = conn.prepareStatement("SELECT COUNT(*) FROM PUBLIC.SCHEMAS WHERE SCHEMA_NAME = ?");
            ps.setString(1, schemaName);
            rs = ps.executeQuery();
            if (!rs.next()) {
                throw new AssertionError();
            }
            int count = rs.getInt(1);
            return (count == 1);
        } finally {
            safeClose(rs);
            safeClose(ps);
        }
    }

