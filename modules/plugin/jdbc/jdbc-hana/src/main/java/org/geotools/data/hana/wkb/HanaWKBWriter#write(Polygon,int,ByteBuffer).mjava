    private static void write(Polygon polygon, int dimension, ByteBuffer buffer) {
        writeHeader(GeometryType.POLYGON, dimension, buffer);
        LineString shell = polygon.getExteriorRing();
        if ((shell == null) || (shell.getNumPoints() == 0)) {
            buffer.putInt(0);
            return;
        }
        int numHoles = polygon.getNumInteriorRing();
        buffer.putInt(1 + numHoles);

        write(shell.getCoordinateSequence(), dimension, buffer);
        for (int i = 0; i < numHoles; ++i) {
            LineString hole = polygon.getInteriorRingN(i);
            write(hole.getCoordinateSequence(), dimension, buffer);
        }
    }

