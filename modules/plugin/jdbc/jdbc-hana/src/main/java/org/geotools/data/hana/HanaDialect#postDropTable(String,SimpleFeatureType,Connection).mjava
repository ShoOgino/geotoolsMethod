    @Override
    public void postDropTable(String schemaName, SimpleFeatureType featureType, Connection cx)
            throws SQLException {
        if (!tableExists(schemaName, METADATA_TABLE_NAME, cx)) {
            return;
        }
        StringBuffer sql = new StringBuffer();
        sql.append("DELETE FROM ");
        encodeIdentifiers(sql, schemaName, METADATA_TABLE_NAME);
        sql.append(" WHERE TABLE_NAME = ?");

        PreparedStatement ps = cx.prepareStatement(sql.toString());
        try {
            ps.setString(1, featureType.getTypeName());
            ps.executeUpdate();
        } finally {
            dataStore.closeSafe(ps);
        }
    }

