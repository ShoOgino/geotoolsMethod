    private Integer getGeometrySRIDViaSelect(
            String schemaName, String tableName, String columnName, Connection cx)
            throws SQLException {
        // Try the first non-NULL geometry
        StringBuffer sql = new StringBuffer();
        sql.append("SELECT ");
        encodeIdentifiers(sql, columnName);
        sql.append(".ST_SRID() FROM ");
        encodeIdentifiers(sql, schemaName, tableName);
        sql.append(" WHERE ");
        encodeIdentifiers(sql, columnName);
        sql.append(" IS NOT NULL LIMIT 1");

        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            ps = cx.prepareStatement(sql.toString());
            rs = ps.executeQuery();
            if (rs.next()) {
                return rs.getInt(1);
            }
            return null;
        } finally {
            dataStore.closeSafe(rs);
            dataStore.closeSafe(ps);
        }
    }

