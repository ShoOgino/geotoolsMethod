    private char[] encodeAsHex(byte[] data) {
        int l = data.length;
        char[] ret = new char[2 * l];
        for (int i = 0, j = 0; i < l; i++) {
            ret[j++] = HEXDIGITS[(0xF0 & data[i]) >>> 4];
            ret[j++] = HEXDIGITS[0x0F & data[i]];
        }
        return ret;
    }

