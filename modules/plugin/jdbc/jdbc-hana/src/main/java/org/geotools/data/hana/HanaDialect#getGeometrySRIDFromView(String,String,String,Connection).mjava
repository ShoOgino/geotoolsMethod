    private Integer getGeometrySRIDFromView(
            String schemaName, String tableName, String columnName, Connection cx)
            throws SQLException {
        PreparedStatement ps = null;
        ResultSet rs = null;
        try {
            if (schemaName != null) {
                ps =
                        cx.prepareStatement(
                                "SELECT SRS_ID FROM PUBLIC.ST_GEOMETRY_COLUMNS WHERE SCHEMA_NAME = ? AND TABLE_NAME = ? AND COLUMN_NAME = ?");
                ps.setString(1, schemaName);
                ps.setString(2, tableName);
                ps.setString(3, columnName);
            } else {
                ps =
                        cx.prepareStatement(
                                "SELECT SRS_ID FROM PUBLIC.ST_GEOMETRY_COLUMNS WHERE SCHEMA_NAME = CURRENT_SCHEMA AND TABLE_NAME = ? AND COLUMN_NAME = ?");
                ps.setString(1, tableName);
                ps.setString(2, columnName);
            }
            rs = ps.executeQuery();
            if (!rs.next()) return null;
            int srid = rs.getInt(1);
            if (rs.next()) return null;
            return srid;
        } finally {
            dataStore.closeSafe(rs);
            dataStore.closeSafe(ps);
        }
    }

