    @SuppressWarnings({"rawtypes", "unchecked"})
    @Override
    protected String getJDBCUrl(Map params) throws IOException {
        String host = (String) HOST.lookUp(params);
        Integer port = (Integer) PORT.lookUp(params);
        Integer instance = (Integer) INSTANCE.lookUp(params);
        String database = (String) DATABASE.lookUp(params);
        Boolean useSsl = (Boolean) USE_SSL.lookUp(params);

        HashMap<String, String> options = new HashMap<String, String>();
        if ((useSsl != null) && (useSsl == true)) {
            options.put("encrypt", "true");
        }
        if ((port != null) && (port != 0)) {
            return HanaConnectionParameters.forPort(host, port, options).buildUrl();
        }
        if (instance == null) {
            throw new IOException(
                    "Either a port or an instance number must be given in the connection properties");
        }
        if ((database != null) && (!database.isEmpty())) {
            return HanaConnectionParameters.forMultiContainer(host, instance, database, options)
                    .buildUrl();
        }
        return HanaConnectionParameters.forSingleContainer(host, instance, options).buildUrl();
    }

