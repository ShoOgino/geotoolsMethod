    /**
     * Override to use a {@code java.time.LocalDateTime} instead of a {@code java.util.Date} because
     * that is what the MySQL JDBC driver always returns since 8.0.23 and there is no automatic
     * conversion from {@LocalDateTime} to {@Date}.
     *
     * @param query actual query
     * @param dates expected dates
     * @throws Exception if any
     * @link https://osgeo-org.atlassian.net/browse/GEOT-6821
     */
    @Override
    protected void assertDatesMatch(Query query, String... dates) throws Exception {
        SimpleFeatureSource source = dataStore.getFeatureSource(tname("dates"));

        assertEquals(dates.length, source.getCount(query));

        SimpleFeatureCollection features = source.getFeatures(query);
        try (SimpleFeatureIterator it = features.features()) {
            int i = 0;
            while (it.hasNext()) {
                SimpleFeature f = it.next();
                LocalDateTime expected =
                        new java.sql.Timestamp(date(dates[i++]).getTime()).toLocalDateTime();

                assertEquals(
                        Converters.convert(expected, LocalDateTime.class),
                        f.getAttribute(aname("dt")));
            }
        }
    }

