    private Geometry decode(int shapeIndex, Type type) throws SqlServerBinaryParseException {
        switch (type) {
            case GEOMETRYCOLLECTION:
                return decodeGeometryCollection(shapeIndex);
            case POINT:
                return decodePoint(shapeIndex);
            case LINESTRING:
                return decodeLinestring(shapeIndex);
            case POLYGON:
                return decodeCurvePolygon(shapeIndex);
            case MULTILINESTRING:
                return decodeMultiLinestring(shapeIndex);
            case MULTIPOINT:
                return decodeMultiPoint(shapeIndex);
            case MULTIPOLYGON:
                return decodeMultiPolygon(shapeIndex);
            case CIRCULARSTRING:
                return decodeCircularString(shapeIndex);
            case COMPOUNDCURVE:
                return decodeCompoundCurve(shapeIndex);
            case CURVEPOLYGON:
                return decodeCurvePolygon(shapeIndex);
            default:
                throw new SqlServerBinaryParseException("Geometry type unsupported " + type);
        }
    }

