    private void encode2DGeometry(
            GeometryDescriptor gatt, String prefix, StringBuffer sql, Double distance) {
        if (distance != null) {
            if (stPreserveTopologyEnabled) {
                sql.append("ST_SimplifyPreserveTopology(");
            } else {
                sql.append("ST_Simplify(");
            }
        }

        sql.append(dialect.getForce2DFunction() + "(");
        dialect.encodeColumnName(prefix, gatt.getLocalName(), sql);
        sql.append(")");

        if (distance != null) {
            String preserveCollapsed = (atLeast2_2_0 && !stPreserveTopologyEnabled) ? ", true" : "";
            sql.append(", " + distance + preserveCollapsed + ")");
        }
    }

