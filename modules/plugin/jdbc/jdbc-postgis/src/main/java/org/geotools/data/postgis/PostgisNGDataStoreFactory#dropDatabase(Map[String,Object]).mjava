    /**
     * Drops the database specified in the connection params. The database must not be in use, and
     * the user must have the necessary privileges
     *
     * @param params
     * @throws IOException
     */
    public void dropDatabase(Map<String, Object> params) throws IOException {
        JDBCDataStore closer = new JDBCDataStore();
        // get the connection params
        String host = (String) HOST.lookUp(params);
        int port = (Integer) PORT.lookUp(params);
        String db = (String) DATABASE.lookUp(params);
        String user = (String) USER.lookUp(params);
        String password = (String) PASSWD.lookUp(params);

        Connection cx = null;
        Statement st = null;
        try {
            // connect to template1 instead
            String url = "jdbc:postgresql" + "://" + host + ":" + port + "/template1";
            cx = getConnection(user, password, url);

            // drop the database
            String sql = "DROP DATABASE \"" + db + "\"";
            st = cx.createStatement();
            st.execute(sql);
        } catch (SQLException e) {
            throw new IOException("Failed to drop the target database", e);
        } finally {
            closer.closeSafe(st);
            closer.closeSafe(cx);
        }
    }

