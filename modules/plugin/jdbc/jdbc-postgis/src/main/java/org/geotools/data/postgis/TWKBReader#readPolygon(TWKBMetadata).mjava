    private Polygon readPolygon(TWKBMetadata metadata) throws IOException {
        if (!metadata.isEmpty()) {
            int numRings = dis.readUnsignedInt();
            LinearRing[] holes = null;
            if (numRings > 1) holes = new LinearRing[numRings - 1];

            LinearRing shell = readLinearRing(metadata);
            for (int i = 0; i < numRings - 1; i++) {
                holes[i] = readLinearRing(metadata);
            }
            return factory.createPolygon(shell, holes);
        } else {
            return factory.createPolygon();
        }
    }

