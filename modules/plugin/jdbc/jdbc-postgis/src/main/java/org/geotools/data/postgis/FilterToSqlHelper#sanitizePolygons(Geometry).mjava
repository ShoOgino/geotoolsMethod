    /**
     * Given a geometry that might contain heterogeneous components extracts only the polygonal ones
     */
    private Geometry sanitizePolygons(Geometry geometry) {
        // already sane?
        if (geometry == null || geometry instanceof Polygon || geometry instanceof MultiPolygon) {
            return geometry;
        }

        // filter out only polygonal parts
        final List<Polygon> polygons = new ArrayList<>();
        geometry.apply(
                (GeometryComponentFilter)
                        geom -> {
                            if (geom instanceof Polygon) {
                                polygons.add((Polygon) geom);
                            }
                        });

        // turn filtered selection into a geometry
        return toPolygon(geometry.getFactory(), polygons);
    }

