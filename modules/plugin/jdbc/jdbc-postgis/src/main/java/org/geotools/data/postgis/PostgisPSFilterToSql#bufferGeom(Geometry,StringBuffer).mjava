    private void bufferGeom(Geometry geom, StringBuffer sb) {
        if (geom instanceof LinearRing) {
            // postgis does not handle linear rings, convert to just a line string
            geom = geom.getFactory().createLineString(((LinearRing) geom).getCoordinateSequence());
        }

        Object typename =
                featureType
                        .getGeometryDescriptor()
                        .getUserData()
                        .get(JDBCDataStore.JDBC_NATIVE_TYPENAME);
        if ("geography".equals(typename)) {
            sb.append("ST_GeogFromText('");
            sb.append(geom.toText());
            sb.append("')");
        } else {
            sb.append("ST_GeomFromText('");
            sb.append(geom.toText());
            sb.append("', " + getFeatureTypeGeometrySRID() + ")");
        }
    }

