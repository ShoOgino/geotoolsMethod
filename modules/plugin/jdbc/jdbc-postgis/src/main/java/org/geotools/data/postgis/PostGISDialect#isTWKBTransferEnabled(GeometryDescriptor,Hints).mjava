    private boolean isTWKBTransferEnabled(GeometryDescriptor descriptor, Hints hints) {
        Double distance = (Double) hints.get(Hints.GEOMETRY_SIMPLIFICATION);
        boolean geography =
                "geography"
                        .equals(descriptor.getUserData().get(JDBCDataStore.JDBC_NATIVE_TYPENAME));
        return !geography
                && distance != null
                && version.compareTo(V_2_2_0) >= 0
                && isStraightSegmentsGeometry(descriptor);
    }

