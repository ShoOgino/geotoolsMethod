    private String toNativeUnits(DistanceBufferOperator operator) {
        double distance;
        if(isCurrentGeography()) { 
            // need the value in meters
            if(delegate instanceof PostgisPSFilterToSql) {
                distance = ((PostgisPSFilterToSql) delegate).getDistanceInMeters(operator);
            } else {
                distance = ((PostgisFilterToSQL) delegate).getDistanceInMeters(operator);
            }
        } else {
            // need the value in native units
            if(delegate instanceof PostgisPSFilterToSql) {
                distance = ((PostgisPSFilterToSql) delegate).getDistanceInNativeUnits(operator);
            } else {
                distance = ((PostgisFilterToSQL) delegate).getDistanceInNativeUnits(operator);
            }
        }

        return String.valueOf(distance);
    }

