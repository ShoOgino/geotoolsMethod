    @Test
    public void testMatchOneBetween() throws Exception {
        FilterFactory ff = dataStore.getFilterFactory();
        ContentFeatureSource fs = dataStore.getFeatureSource(tname("arraytest"));

        // strings
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("strings")),
                        ff.literal("B"),
                        ff.literal("C"),
                        MatchAction.ONE),
                0,
                1);
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("strings")),
                        ff.literal("A"),
                        ff.literal("B"),
                        MatchAction.ONE));
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("strings")),
                        ff.literal("C"),
                        ff.literal("F"),
                        MatchAction.ONE),
                1);
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("strings")),
                        ff.literal("D"),
                        ff.literal("F"),
                        MatchAction.ONE));

        // ints
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("ints")), ff.literal(1), ff.literal(5), MatchAction.ONE),
                1);
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("ints")), ff.literal(1), ff.literal(2), MatchAction.ONE));
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("ints")), ff.literal(3), ff.literal(5), MatchAction.ONE),
                1);
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("ints")),
                        ff.literal(8),
                        ff.literal(100),
                        MatchAction.ONE));

        // timestamps
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("timestamps")),
                        ff.literal(expectedDate),
                        ff.literal(expectedDate),
                        MatchAction.ONE),
                0,
                1);
        LocalDateTime futureDateTime = expectedDate.toLocalDateTime().plusDays(1);
        Date laterDate = Date.from(futureDateTime.atZone(ZoneId.systemDefault()).toInstant());
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("timestamps")),
                        ff.literal(laterDate),
                        ff.literal(laterDate),
                        MatchAction.ONE));
    }

