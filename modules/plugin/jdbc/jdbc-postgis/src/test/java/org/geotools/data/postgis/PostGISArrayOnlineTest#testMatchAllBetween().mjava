    @Test
    public void testMatchAllBetween() throws Exception {
        FilterFactory ff = dataStore.getFilterFactory();
        ContentFeatureSource fs = dataStore.getFeatureSource(tname("arraytest"));

        // strings
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("strings")),
                        ff.literal("A"),
                        ff.literal("C"),
                        MatchAction.ALL),
                0);
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("strings")),
                        ff.literal("D"),
                        ff.literal("F"),
                        MatchAction.ONE));

        // ints
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("ints")), ff.literal(1), ff.literal(5), MatchAction.ALL),
                0);
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("ints")), ff.literal(2), ff.literal(3), MatchAction.ALL));

        // timestamps
        assertMatchedFeatureIds(
                fs,
                ff.between(
                        ff.property(aname("timestamps")),
                        ff.literal(expectedDate),
                        ff.literal(expectedDate),
                        MatchAction.ALL),
                0);
    }

