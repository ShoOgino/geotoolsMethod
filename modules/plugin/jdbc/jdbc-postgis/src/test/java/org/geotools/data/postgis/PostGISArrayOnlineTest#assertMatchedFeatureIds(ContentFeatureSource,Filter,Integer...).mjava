    private void assertMatchedFeatureIds(ContentFeatureSource fs, Filter filter, Integer... ids)
            throws IOException {
        ContentFeatureCollection fc = fs.getFeatures(filter);
        if (ids.length > 0) {
            Set<Integer> expected = new HashSet<>(Arrays.asList(ids));
            fc.accepts(
                    feature -> {
                        String id = feature.getIdentifier().getID();
                        assertThat(id, CoreMatchers.startsWith(tname("arraytest") + "."));
                        int key = Integer.parseInt(id.substring("arraytest".length() + 1));
                        assertTrue("Found unexpected id " + key, expected.remove(key));
                    },
                    null);
            assertTrue("Some of the expected ids were not found " + expected, expected.isEmpty());
        } else {
            assertEquals(
                    "Expected to find an empty result, but instead it was "
                            + new ListFeatureCollection(fc),
                    0,
                    fc.size());
        }
    }

