    @Override
    @SuppressWarnings("PMD.SystemPrintln")
    protected boolean isOnline() throws Exception {
        PostgisNGDataStoreFactory factory = new PostgisNGDataStoreFactory();
        Class.forName(factory.getDriverClassName());

        // get host and port
        String host = fixture.getProperty(HOST.key);
        String port = fixture.getProperty(PORT.key);
        String user = fixture.getProperty(USER.key);
        String password = fixture.getProperty(PASSWD.key);
        String url = "jdbc:postgresql" + "://" + host + ":" + port + "/template1";

        try (Connection cx = DriverManager.getConnection(url, user, password);
                Statement st = cx.createStatement()) {
            try (ResultSet rs =
                    st.executeQuery(
                            "select rolcreatedb from pg_authid where rolname = '" + user + "'")) {
                boolean canCreate = false;
                if (rs.next()) {
                    canCreate = rs.getBoolean(1);
                }

                if (!canCreate) {
                    System.out.println(
                            "User " + user + " has no database creation options, skipping test");
                    return false;
                }
            }

            // creation options available, let's check if we have the postgis extension available
            // then
            try (ResultSet rs =
                    st.executeQuery(
                            "select * from pg_available_extensions where name = 'postgis'")) {
                boolean hasPostgisExtension = false;
                if (rs.next()) {
                    hasPostgisExtension = true;
                }

                if (!hasPostgisExtension) {
                    System.out.println(
                            "This version of postgresql has no postgis extension available (as in, one that can be used by the \"create extension\" command, skipping it");
                    return false;
                }
            }

            // drop the database if available
            try (ResultSet rs =
                    st.executeQuery(
                            "select * from pg_database where datname = 'create_drop_testdb'")) {
                boolean databaseExists = rs.next();

                if (databaseExists) {
                    st.execute("drop database " + CREATE_DROP_TESTDB);
                }
            }

            return true;
        } catch (SQLException e) {
            System.out.println(
                    "Failed to check if the user has database creation privileges and postgis is an available extension");
            java.util.logging.Logger.getGlobal().log(java.util.logging.Level.INFO, "", e);
            return false;
        }
    }

